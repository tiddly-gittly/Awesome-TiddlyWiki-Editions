{"title":"$:/plugins/inmysocks/Calendar","description":"A calendar thing","author":"inmysocks","version":"0.0.8","core-version":">=5.1.6","source":"https://github.com/inmysocks/TW5-NoLearningRequired-Full","plugin-type":"plugin","dependents":"","type":"application/json","text":"{\n    \"tiddlers\": {\n        \"$:/plugins/inmysocks/Calendar/Calendar Default Macros\": {\n            \"tags\": \"$:/tags/Macro\",\n            \"title\": \"$:/plugins/inmysocks/Calendar/Calendar Default Macros\",\n            \"text\": \"\\\\define CalendarListDailyThingsFullDateString(day month year)\\n<$button class='tc-btn-invisible' style='width:100%;height:100%'>\\n<$action-navigate $to=\\\"$(day)$-$(month)$-$(year)$\\\"/>\\n<div style='height:100%;width:100%;position:relative;text-align:left;vertical-align:top;z-index=0'>\\n''$day$''<br>\\n<$list filter='[has[$day$-$month$-$year$]]-[[$:/temp/MakeCalendarEntry]]'>\\n<$view field='title'/><br>\\n</$list>\\n</div>\\n</$button>\\n\\\\end\\n\\n\\\\define CalendarListDailyThingsTags(day month year)\\n<$button class='tc-btn-invisible' style='width:100%;height:100%'>\\n<$action-navigate $to=\\\"\\\"\\\"$day$-$month$-$year$\\\"\\\"\\\"/>\\n<div style='height:100%;width:100%;position:relative;text-align:left;vertical-align:top;z-index=0'>\\n''$day$''<br>\\n<$list filter='[tag[$day$-$month$-$year$]]-[[$:/temp/MakeCalendarEntry]]'>\\n<$view field='title'/><br>\\n</$list>\\n</div>\\n</$button>\\n\\\\end\\n\\n\\\\define CalendarListDailyThings(day month year)\\n<$button class='tc-btn-invisible' style='width:100%;height:100%'>\\n<$action-navigate $to=\\\"\\\"\\\"$day$-$month$-$year$\\\"\\\"\\\"/>\\n<div style='height:100%;width:100%;position:relative;text-align:left;vertical-align:top;z-index=0'>\\n''$day$''<br>\\n<$list filter='[day[$day$]month[$month$]year[$year$]]-[[$:/temp/MakeCalendarEntry]]'>\\n<$view field='title'/><br>\\n</$list>\\n</div>\\n</$button>\\n\\\\end\"\n        },\n        \"$:/plugins/inmysocks/Calendar/Calendar Table Style\": {\n            \"created\": \"20150212024632244\",\n            \"modified\": \"20150212042506838\",\n            \"tags\": \"$:/tags/Stylesheet\",\n            \"title\": \"$:/plugins/inmysocks/Calendar/Calendar Table Style\",\n            \"type\": \"text/css\",\n            \"text\": \".calendar-table {\\n\\tborder: 0px;\\n    overflow: hidden;\\n    vertical-align: top;\\n    width: 100%;\\n}\\n\\n.calendar-table table {\\n\\twidth:100%;\\n}\\n\\n.calendar-table td, th {\\n    width: 14%;\\n    vertical-align: top;\\n}\\n\\n.calendar-table td {\\n        height: 100px;\\n}\"\n        },\n        \"$:/plugins/inmysocks/Calendar/readme\": {\n            \"month\": \"1\",\n            \"title\": \"$:/plugins/inmysocks/Calendar/readme\",\n            \"year\": \"1990\",\n            \"text\": \"To see this plugin in use you can see it on my page [[here|http://ooktech.com/jed/externalbrain/#Calendar%20Archives]]\\n\\nThis plugin has:\\n\\n*The calendar-month widget\\n*Default css class for the calendar month widget\\n*Default macro for calendar days\\n*This readme\\n\\n!The calendar-month widget\\n\\nUsage: `<$calendar-month year=YYYY month=MM day_macro=someMacro class=someCSSClass/>`\\n\\nContent of the `<$calendar-month>` widget is ignored.\\n\\n|!Attribute |!Description |\\n|year |The year that the month displayed is from. It must be in 4 digit YYYY format and has no default value. |\\n|month |The month to display. See list below for valid month values. month has no default value. |\\n|day_macro |(optional) The macro that defines the content of each calendar day. It is passed the parameter `day` with the value of the current day of the month. Defaluts to `CalendarListDailyThings` defined in [[Calendar Default Macros|$:/plugins/inmysocks/Calendar/Calendar Default Macros]] |\\n|class |(optional) A css class to use. Defaults to the class `calendar-table` defined in [[Calendar Table Style|$:/plugins/inmysocks/Calendar/Calendar Table Style]] |\\n\\n!The default ~CalendarListDailyThings macro\\n\\nThis macro lists any tiddlers that have fields called `day`, `month` and `year` in the matching calendar day. If you click on a cell than a tiddler with a title in the form of (day)-(month)-(year) is opened.\\n\\n!Month values\\n\\nThis is a complete list of the month values the widget understands, if you want some other format added leave a message at [[my site|http://www.inmysocks.tiddlyspot.com]].:\\n\\n1\\n01\\nJan\\nJan.\\nJanuary\\n\\n2\\n02\\nFeb\\nFeb.\\nFebruary\\n\\n3\\n03\\nMar\\nMar.\\nMarch\\n\\n4\\n04\\nApr\\nApr.\\nApril\\n\\n5\\n05\\nMay\\n\\n6\\n06\\nJun\\nJun.\\nJune\\n\\n7\\n07\\nJul\\nJul.\\nJuly\\n\\n8\\n08\\nAug\\nAug.\\nAugust\\n\\n9\\n09\\nSep\\nSep.\\nSept\\nSept.\\nSeptember\\n\\n10\\nOct\\nOct.\\nOctober\\n\\n11\\nNov\\nNov.\\nNovember\\n\\n12\\nDec\\nDec.\\nDecember\\n\\n!Example:\\n\\n```\\nSelect year: <$select field='year'><$list filter='1990 1991 1992 1993 1994 1995 1996 1997 1998 1999 2000'><option><<currentTiddler>></option></$list></$select>\\n\\nSelect month: <$select field='month'><$list filter='1 2 3 4 5 6 7 8 9 10 11 12'><option><<currentTiddler>></option></$list></$select>\\n\\n<$calendar-month year={{!!year}} month={{!!month}}/>\\n```\\n\\nSelect year: <$select field='year'><$list filter='1990 1991 1992 1993 1994 1995 1996 1997 1998 1999 2000'><option><<currentTiddler>></option></$list></$select>\\n\\nSelect month: <$select field='month'><$list filter='1 2 3 4 5 6 7 8 9 10 11 12'><option><<currentTiddler>></option></$list></$select>\\n\\n<$calendar-month year={{!!year}} month={{!!month}}/>\\n\"\n        },\n        \"$:/plugins/inmysocks/Calendar/calendar-widget.js\": {\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/inmysocks/Calendar/calendar-widget.js\\ntype: application/javascript\\nmodule-type: widget\\n\\nA widget that creates a calendar given a year and month.\\n\\n\\\\*/\\n\\n(function(){\\n\\n/*jslint node: true, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\nvar Widget = require(\\\"$:/core/modules/widgets/widget.js\\\").widget;\\nvar widgets;\\nvar container;\\n\\nvar Calendar = function(parseTreeNode,options) {\\n\\tthis.initialise(parseTreeNode,options);\\n};\\n\\n/*\\nInherit from the base widget class\\n*/\\nCalendar.prototype = new Widget();\\n\\n/*\\nRender this widget into the DOM\\n*/\\nCalendar.prototype.render = function(parent,nextSibling) {\\n\\tthis.parentDomNode = parent;\\n\\tthis.computeAttributes();\\n\\tthis.execute();\\n\\tvar domNode = this.document.createElement(\\\"div\\\");\\n\\tparent.insertBefore(domNode,nextSibling);\\n\\tdomNode.className = this.CalendarCSS;\\n\\tthis.renderChildren(domNode,null);\\n\\tthis.domNodes.push(domNode);\\n};\\n\\n/*\\nCompute the internal state of the widget\\n*/\\nCalendar.prototype.execute = function() {\\n\\t//Get widget attributes.\\n\\tvar thisMonth = this.getAttribute(\\\"month\\\",-1);\\n\\tvar thisYear = this.getAttribute(\\\"year\\\",-1);\\n\\tvar thisDayMacro = this.getAttribute(\\\"day_macro\\\",\\\"CalendarListDailyThings\\\");\\n\\tvar thisCalendarCSS = this.getAttribute(\\\"class\\\", \\\"calendar-table\\\");\\n\\n\\tvar badYear;\\n\\tvar isLeap = 0;\\n\\tvar numDays;\\n\\tvar calendarString;\\n\\tvar thisMonthNum;\\n\\n\\t//Check to make sure a 4 digit year was passed\\n\\tif(thisYear/1000 < 1 || thisYear === -1 || isNaN(parseFloat(thisYear))) {\\n\\t\\tbadYear = 1;\\n\\t} else {\\n\\t\\tbadYear = 0;\\n\\t}\\n\\n\\t//If it is February, check if the current year is a leap year. Then get the number of days in the current month.\\n\\tif(thisMonth === \\\"2\\\" || thisMonth === \\\"02\\\" || thisMonth === \\\"Feb\\\" || thisMonth === \\\"Feb.\\\" || thisMonth === \\\"February\\\") {\\n\\t\\tisLeap = ((((thisYear % 4) === 0) && (thisYear % 100 !== 0)) || (((thisYear % 100) === 0) && (thisYear % 400) === 0));\\n\\t}\\n\\tswitch (thisMonth){\\n\\t\\tcase \\\"1\\\": numDays = 31; thisMonthNum = 1; break;\\n\\t\\tcase \\\"01\\\": numDays = 31; thisMonthNum = 1; break;\\n\\t\\tcase \\\"Jan\\\": numDays = 31; thisMonthNum = 1; break;\\n\\t\\tcase \\\"Jan.\\\": numDays = 31; thisMonthNum = 1; break;\\n\\t\\tcase \\\"January\\\": numDays = 31; thisMonthNum = 1; break;\\n\\t\\tcase \\\"2\\\": numDays = isLeap ? 29:28; thisMonthNum = 2; break;\\n\\t\\tcase \\\"02\\\": numDays = isLeap ? 29:28; thisMonthNum = 2; break;\\n\\t\\tcase \\\"Feb\\\": numDays = isLeap ? 29:28; thisMonthNum = 2; break;\\n\\t\\tcase \\\"Feb.\\\": numDays = isLeap ? 29:28; thisMonthNum = 2; break;\\n\\t\\tcase \\\"February\\\": numDays = isLeap ? 29:28; thisMonthNum = 2; break;\\n\\t\\tcase \\\"3\\\": numDays = 31; thisMonthNum = 3; break;\\n\\t\\tcase \\\"03\\\": numDays = 31; thisMonthNum = 3; break;\\n\\t\\tcase \\\"Mar\\\": numDays = 31; thisMonthNum = 3; break;\\n\\t\\tcase \\\"Mar.\\\": numDays = 31; thisMonthNum = 3; break;\\n\\t\\tcase \\\"March\\\": numDays = 31; thisMonthNum = 3; break;\\n\\t\\tcase \\\"4\\\": numDays = 30; thisMonthNum = 4; break;\\n\\t\\tcase \\\"04\\\": numDays = 30; thisMonthNum = 4; break;\\n\\t\\tcase \\\"Apr\\\": numDays = 30; thisMonthNum = 4; break;\\n\\t\\tcase \\\"Apr.\\\": numDays = 30; thisMonthNum = 4; break;\\n\\t\\tcase \\\"April\\\": numDays = 30; thisMonthNum = 4; break;\\n\\t\\tcase \\\"5\\\": numDays = 31; thisMonthNum = 5; break;\\n\\t\\tcase \\\"05\\\": numDays = 31; thisMonthNum = 5; break;\\n\\t\\tcase \\\"May\\\": numDays = 31; thisMonthNum = 5; break;\\n\\t\\tcase \\\"6\\\": numDays = 30; thisMonthNum = 6; break;\\n\\t\\tcase \\\"06\\\": numDays = 30; thisMonthNum = 6; break;\\n\\t\\tcase \\\"Jun\\\": numDays = 30; thisMonthNum = 6; break;\\n\\t\\tcase \\\"Jun.\\\": numDays = 30; thisMonthNum = 6; break;\\n\\t\\tcase \\\"June\\\": numDays = 30; thisMonthNum = 6; break;\\n\\t\\tcase \\\"7\\\": numDays = 31; thisMonthNum = 7; break;\\n\\t\\tcase \\\"07\\\": numDays = 31; thisMonthNum = 7; break;\\n\\t\\tcase \\\"Jul\\\": numDays = 31; thisMonthNum = 7; break;\\n\\t\\tcase \\\"Jul.\\\": numDays = 31; thisMonthNum = 7; break;\\n\\t\\tcase \\\"July\\\": numDays = 31; thisMonthNum = 7; break;\\n\\t\\tcase \\\"8\\\": numDays = 31; thisMonthNum = 8; break;\\n\\t\\tcase \\\"08\\\": numDays = 31; thisMonthNum = 8; break;\\n\\t\\tcase \\\"Aug\\\": numDays = 31; thisMonthNum = 8; break;\\n\\t\\tcase \\\"Aug.\\\": numDays = 31; thisMonthNum = 8; break;\\n\\t\\tcase \\\"August\\\": numDays = 31; thisMonthNum = 8; break;\\n\\t\\tcase \\\"9\\\": numDays = 30; thisMonthNum = 9; break;\\n\\t\\tcase \\\"09\\\": numDays = 30; thisMonthNum = 9; break;\\n\\t\\tcase \\\"Sep\\\": numDays = 30; thisMonthNum = 9; break;\\n\\t\\tcase \\\"Sep.\\\": numDays = 30; thisMonthNum = 9; break;\\n\\t\\tcase \\\"Sept\\\": numDays = 30; thisMonthNum = 9; break;\\n\\t\\tcase \\\"Sept.\\\": numDays = 30; thisMonthNum = 9; break;\\n\\t\\tcase \\\"September\\\": numDays = 30; thisMonthNum = 9; break;\\n\\t\\tcase \\\"10\\\": numDays = 31; thisMonthNum = 10; break;\\n\\t\\tcase \\\"Oct\\\": numDays = 31; thisMonthNum = 10; break;\\n\\t\\tcase \\\"Oct.\\\": numDays = 31; thisMonthNum = 10; break;\\n\\t\\tcase \\\"October\\\": numDays = 31; thisMonthNum = 10; break;\\n\\t\\tcase \\\"11\\\": numDays = 30; thisMonthNum = 11; break;\\n\\t\\tcase \\\"Nov\\\": numDays = 30; thisMonthNum = 11; break;\\n\\t\\tcase \\\"Nov.\\\": numDays = 30; thisMonthNum = 11; break;\\n\\t\\tcase \\\"November\\\": numDays = 30; thisMonthNum = 11; break;\\n\\t\\tcase \\\"12\\\": numDays = 31; thisMonthNum = 12; break;\\n\\t\\tcase \\\"Dec\\\": numDays = 31; thisMonthNum = 12; break;\\n\\t\\tcase \\\"Dec.\\\": numDays = 31; thisMonthNum = 12; break;\\n\\t\\tcase \\\"December\\\": numDays = 31; thisMonthNum = 12; break;\\n\\t\\tdefault: numDays = -1;\\t\\t\\n\\t}\\n\\n\\tif(badYear === 1 || numDays === -1) {\\n\\t\\t//If the input doesn't make sense give an error.\\n\\t\\tvar parser = this.wiki.parseText(\\\"text/vnd.tiddlywiki\\\",\\\"Invalid month or year. Years need to be 4 digits, months must be given as a numeric value from 1...12.\\\",{parseAsInline: false});\\n    \\tvar parseTreeNodes = parser ? parser.tree : [];\\n\\t\\tthis.CalendarCSS = thisCalendarCSS;\\n\\t\\tthis.makeChildWidgets(parseTreeNodes);\\n\\t\\tthis.innerHTML = \\\"Invalid month or year. Years need to be 4 digits, see readme for accepted month names.\\\";\\n\\t} else {\\n\\t\\t//Get the first of the month to base everything else off of.\\n\\t\\tvar firstDate = new Date(thisYear,thisMonthNum-1,1);\\n\\t\\tvar startingDay = firstDate.getDay();\\n\\t\\t\\n\\t\\t//Make the first week, adding empty days to the front as needed.\\n\\t\\tvar currentDate = 1;\\n\\t\\tcalendarString = \\\"<table><tr><th>Sunday</th><th>Monday</th><th>Tuesday</th><th>Wednesday</th><th>Thursday</th><th>Friday</th><th>Saturday</th></tr>\\\";\\n\\t\\twhile(currentDate <= numDays) {\\n\\t\\t\\tcalendarString = calendarString + \\\"<tr>\\\";\\n\\t\\t\\tfor(var i = 0; i < 7; i++) {\\n\\t\\t\\t\\tif(currentDate === 1 && i < startingDay) {\\n\\t\\t\\t\\t\\tcalendarString = calendarString + \\\"<td></td>\\\";\\n\\t\\t\\t\\t} else if(currentDate <= numDays) {\\n\\t\\t\\t\\t\\tcalendarString = calendarString + \\\"<td><$macrocall $name='\\\" + thisDayMacro + \\\"' day=\\\" + currentDate + \\\" month=\\\" + thisMonthNum + \\\" year=\\\" + thisYear + \\\"/></td>\\\";\\n\\t\\t\\t\\t\\tcurrentDate++;\\n\\t\\t\\t\\t} if(currentDate > numDays && i < 6) {\\n\\t\\t\\t\\t\\tcalendarString = calendarString + \\\"<td></td>\\\";\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t\\tcalendarString = calendarString + \\\"</tr>\\\";\\n\\t\\t}\\n\\t\\tcalendarString = calendarString + \\\"</table>\\\";\\n\\t}\\n\\n\\tvar stringPassed = calendarString;\\n\\tvar parser = this.wiki.parseText(\\\"text/vnd.tiddlywiki\\\",calendarString,{parseAsInline: false});\\n    var parseTreeNodes = parser ? parser.tree : [];\\n\\tthis.CalendarCSS = thisCalendarCSS;\\n\\tthis.makeChildWidgets(parseTreeNodes);\\n};\\n\\n/*\\nRefresh the widget by ensuring our attributes are up to date\\n*/\\nCalendar.prototype.refresh = function(changedTiddlers) {\\n\\tvar changedAttributes = this.computeAttributes();\\n\\tif(changedAttributes[\\\"month\\\"] || changedAttributes[\\\"year\\\"] || changedAttributes[\\\"day_macro\\\"] || changedAttributes[\\\"class\\\"]) {\\n\\t\\tthis.refreshSelf();\\n\\t\\treturn true;\\n\\t}\\n\\treturn this.refreshChildren(changedTiddlers);\\n};\\n\\nexports[\\\"calendar-month\\\"] = Calendar;\\n\\n})();\",\n            \"title\": \"$:/plugins/inmysocks/Calendar/calendar-widget.js\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"widget\"\n        }\n    }\n}","name":"Calendar"}