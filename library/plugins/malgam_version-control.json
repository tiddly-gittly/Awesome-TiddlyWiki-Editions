{"type":"application/json","text":"{\n    \"tiddlers\": {\n        \"$:/plugins/malgam/version-control/versionTab\": {\n            \"created\": \"20180713032258699\",\n            \"creator\": \"malgam\",\n            \"text\": \"\\\\define myText()\\n$:/_commit_message/$(currentTiddler)$\\n\\\\end\\n\\n\\\\define sourceTiddler()\\n[[$(currentTiddler)$]]\\n\\\\end\\n\\n\\\\define statedifftext()\\n$:/state/verTab/$(currentVersion)$/difftext\\n\\\\end\\n\\n\\\\define statevertab()\\n$:/state/verTab/$(currentVersion)$/vertab\\n\\\\end\\n\\n\\\\define statetabtype()\\n$:/state/verTab/$(currentVersion)$/type\\n\\\\end\\n\\n\\\\define RestoreButton()\\n<$button class=\\\"tc-btn-invisible tc-tiddlylink\\\">(restore this version)\\n<$action-setfield $tiddler=<<currentVersion>> $field=\\\"text\\\" $value={{{ [<verTitle>get[text]] }}} $timestamp=\\\"no\\\"/>\\n<$list filter=\\\"[<verTitle>fields[]prefix[_vc-]]\\\" variable=\\\"vcfield\\\">\\n<$action-setfield $tiddler=<<currentVersion>> $field={{{ [<vcfield>removeprefix[_vc-]] }}} $value={{{ [<verTitle>get<vcfield>] }}} $timestamp=\\\"no\\\"/>\\n</$list>\\n<$list filter=\\\"[<currentVersion>fields[]] -title -text \\\" variable=\\\"cv-field\\\">\\n<$wikify name=\\\"vcfield\\\" text=\\\"_vc-<<cv-field>>\\\">\\n<$list filter=\\\"[<verTitle>!has:field<vcfield>]\\\">\\n<$action-deletefield $tiddler=<<currentVersion>> $field=<<cv-field>>/>\\n</$list>\\n</$wikify>\\n</$list>\\n</$button>\\n\\\\end\\n\\n\\\\define DeleteButton()\\n<$button class=\\\"tc-btn-invisible tc-tiddlylink\\\">(delete this version)\\n<$action-deletetiddler $tiddler=<<verTitle>>/>\\n</$button>\\n\\\\end\\n\\n\\\\define DiffTextButton()\\n<$list filter=\\\"[<statedifftext>!text[yes]]\\\" emptyMessage=\\\"\\\"\\\"\\n<$button set=<<statedifftext>> setTo=\\\"no\\\" class=\\\"tc-btn-invisible tc-tiddlylink\\\">(hide differences)</$button>\\\"\\\"\\\">\\n<$button set=<<statedifftext>> setTo=\\\"yes\\\" class=\\\"tc-btn-invisible tc-tiddlylink\\\">(show differences)</$button>\\n</$list>\\n\\\\end\\n\\n\\\\define verTabs(type)\\n<div class=\\\"tc-tab-set $type$\\\">\\n<!-- Set up tabs -->\\n<div class=\\\"tc-tab-buttons $type$\\\">\\n<$list filter=\\\"[<statetabtype>!text[vertical]]\\\" emptyMessage=\\\"\\\"\\\"\\n<$button set=<<statetabtype>> setTo=\\\"horizontal\\\" style=\\\"width: auto; margin-left: auto;\\\">→</$button>\\\"\\\"\\\">\\n<$button set=<<statetabtype>> setTo=\\\"vertical\\\" style=\\\"width: auto; margin-left: auto;\\\">↓</$button>\\n</$list>\\n<$list filter=\\\"[<currentVersion>] [<currentVersion>listed[]prefix[$:/_vc]!sort[]]\\\" variable=\\\"verTitle\\\">\\n<$button set=<<statevertab>> setTo=<<verTitle>> selectedClass=\\\" tc-tab-selected\\\">\\n<$text text={{{ [<currentVersion>listed[]prefix[$:/_vc]allbefore:include<verTitle>count[]] }}}/>\\n</$button>\\n</$list>\\n</div>\\n<div class=\\\"tc-tab-divider $type$\\\"></div>\\n\\n<!-- Version header info -->\\n<div class=\\\"tc-tab-content $type$\\\" style=\\\"overflow: auto;\\\">\\n<$set name=\\\"verTitle\\\" value={{{ [<statevertab>get[text]] }}}>\\n<$list filter=\\\"[<verTitle>has:field[commit_message]]\\\"><b>Commit Message:</b> <$text text={{{ [<verTitle>get[commit_message]] }}}/><br></$list>\\n<$list filter=\\\"[<verTitle>prefix[$:/_vc]]\\\" emptyMessage=\\\"<b>Current Version</b>\\\"><b>Version Tiddler</b>: \\n<$link to=<<verTitle>>><$text text=<<verTitle>>/></$link><br></$list>\\n<div style=\\\"padding-bottom: 0.4em; float: right;\\\"><<DiffTextButton>> <$list filter=\\\"[<verTitle>prefix[$:/_vc]]\\\"> <<RestoreButton>> <<DeleteButton>> </$list></div>\\n\\n<!-- Display diff text -->\\n<div class=\\\"diff-wrapper\\\">\\n<$list filter=\\\"[<verTitle>fields[]prefix[_vc-]] ~[<verTitle>fields[]] -text -title +[sort[]] +[prepend[text]]\\\" variable=\\\"field\\\">\\n<b style=\\\"float: left;\\\"><$text text={{{ [<field>removeprefix[_vc-]] ~[<field>] }}}/>:&nbsp;</b>\\n<$list filter=\\\"[<statedifftext>!text[yes]]\\\">\\n<div><pre><$text text={{{ [<verTitle>get<field>] }}}/></pre></div>\\n</$list>\\n<$list filter=\\\"[<statedifftext>text[yes]]\\\">\\n<$set name=\\\"vcfield\\\" value={{{ [<field>regexp[^text$]] [<field>prefix[_vc-]] ~[<field>addprefix[_vc-]] }}}>\\n<$set name=\\\"source\\\" value={{{ [<currentVersion>] [<currentVersion>listed[]prefix[$:/_vc/]!sort[]] +[after<verTitle>get<vcfield>] }}}>\\n<$set name=\\\"destination\\\" value={{{ [<verTitle>get<field>] }}}>\\n<$diff-text source=<<source>> dest=<<destination>>/>\\n</$set>\\n</$set>\\n</$set>\\n</$list>\\n</$list>\\n\\n<b>Extra fields in previous version:</b><br>\\n<$set name=\\\"sourceVer\\\" value={{{ [<currentVersion>] [<currentVersion>listed[]prefix[$:/_vc/]!sort[]] +[after<verTitle>] }}}>\\n<$list filter=\\\"[<sourceVer>fields[]prefix[_vc-]] +[sort[]]\\\" variable=\\\"field\\\">\\n<$set name=\\\"fieldtrimmed\\\" value={{{ [<field>removeprefix[_vc-]] }}}>\\n<$list filter=\\\"[<verTitle>!prefix[$:/_vc/]!has:field<fieldtrimmed>]\\\"><<fieldtrimmed>></$list>\\n<$list filter=\\\"[<verTitle>prefix[$:/_vc/]!has:field<field>]\\\"><<fieldtrimmed>></$list>\\n</$set>\\n</$list><br>\\n</$set>\\n\\n</div>\\n\\n</$set><!-- verTitle -->\\n\\n</div>\\n</div>\\n\\\\end\\n\\n\\\\define commitActions()\\n<$wikify name=\\\"versionTitle\\\" text=\\\"\\\"\\\"<$macrocall $name=\\\"now\\\" format=\\\"$:/_vc/YYYY0MM0DD0hh0mm0ss/{{!!title}}\\\"/>\\\"\\\"\\\">\\n<$action-createtiddler $basetitle=<<versionTitle>> $savetitle=\\\"$:/temp/saveTid\\\" text={{!!text}} list=<<sourceTiddler>>/>\\n<$action-setfield $tiddler={{$:/temp/saveTid}} $field=\\\"commit_message\\\" $value={{{ [<myText>get[text]] }}}/>\\n<$list filter=\\\"[all[current]fields[]] -title -text\\\" variable=\\\"field\\\">\\n<$action-setfield $tiddler={{$:/temp/saveTid}} $field={{{ [<field>addprefix[_vc-]] }}} $value={{{ [all[current]get<field>] }}}/>\\n</$list>\\n</$wikify>\\n\\\\end\\n\\n<style>\\n.diff-wrapper { margin: 0 0 1em 0; }\\n.diff-wrapper div { width: 100%; }\\n.diff-wrapper pre {\\n    margin: 0;\\n    width: 100%;\\n    max-height: 24em;\\n    overflow-y: auto;\\n}\\n.my-container {\\n  display: flex;\\n  flex-flow: row wrap;\\n  align-items: baseline;\\n}\\n</style>\\n\\n<div class=\\\"my-container\\\">\\nCommit message: <span style=\\\"flex-grow: 1\\\">\\n<$edit-text tiddler=<<myText>> tag=\\\"input\\\" default=\\\"Enter commit message...\\\" class=\\\"tc-edit-texteditor\\\"/>\\n</span>\\n<$button tooltip=\\\"Commit changes\\\" actions=<<commitActions>>>Commit</$button>\\n</div>\\n\\n---\\n''Versions:''<br>\\n<$set name=\\\"currentVersion\\\" value=<<currentTiddler>>>\\n<$list filter=\\\"[<statetabtype>!text[vertical]]\\\" emptyMessage=\\\"\\\"\\\"<<verTabs \\\"tc-vertical\\\">>\\\"\\\"\\\">\\n<<verTabs>>\\n</$list>\\n</$set>\\n\",\n            \"type\": \"\",\n            \"title\": \"$:/plugins/malgam/version-control/versionTab\",\n            \"tags\": \"$:/tags/TiddlerInfo\",\n            \"revision\": \"\",\n            \"modifier\": \"malgam\",\n            \"modified\": \"20190211063130504\",\n            \"caption\": \"Versions\"\n        },\n        \"$:/plugins/malgam/version-control/usage\": {\n            \"created\": \"20190125063501230\",\n            \"creator\": \"malgam\",\n            \"text\": \"This plugin provides a simple tiddler versioning system.\\n\\nIt allows versions of any tiddler to be \\\"committed\\\" along with a message to describe the version being saved.  The version control functions are visible in the \\\"Versions\\\" tab in the \\\"Info\\\" {{$:/core/images/info-button}} area if a the tiddler.\\n\\nThis tab displays a text entry field for a commit message and a button for committing the current tiddler version as a new committed version.\\n\\nIt also allows for the following functions:\\n\\n* → / ↓ : show the version list as horizontal or vertical tabs\\n* ''(show differences)'' / ''(hide differences)'' : shows/hides the differences between the selected version and the next previously committed version.\\n* ''(restore)'' : replace the current state of the tiddler with that revision (all fields including //tags//, except //title//).\\n* ''(delete)'' : deletes the selected revision.\\n\\nWhen the tab for a committed version of the tiddler is selected, the relevant commit message is displayed along with a link to the version tiddler.\\n\\n!!! ''Changing the source tiddler's title''\\n\\n* The current tiddler's title may be changed; its version tiddlers will always follow it as long as \\\"//Update (oldtitle) to (newtitle) in the tags and list fields of other tiddlers//\\\" is checked when editing the current tiddler's title.\\n\\n!!! ''Filter search for version tiddlers''\\n\\nFor version tiddlers of `Tiddler title`:\\n\\n`[prefix[$:/_vc/]search:list[Tiddler title]]`\\n\\n!!! ''Version tiddler structure''\\n\\n```\\ntitle: $:/_vc/YYYY0MM0DD0hh0mm0ss/Title of source tiddler\\nlist: [[Title of source tiddler]]\\n_vc-list: listItems [[inside list field]] of [[source tiddler]]\\n_vc-tags: [[tag 1]] tag2\\n_vc-someotherfield: someotherfield's value\\n... and all other fields of source tiddler, to be prefixed '_vc-'\\n```\\n\\nRestoring the version will re-copy the stored _vc-fields (the \\\"_vc-\\\" prefix will be removed) and remove from the current version any fields not present in the restored version. \\n\\n!!! ''Notes''\\n\\n* Restoring a saved version will irretrievable delete the current version and any uncommitted editing changes will be lost!\\n* If the current version of the tiddler is deleted, it's committed versions will remain as system tiddlers.  They will need to be found using the Advanced Search and deleted manually if needed.\\n\\n\",\n            \"title\": \"$:/plugins/malgam/version-control/usage\",\n            \"tags\": \"\",\n            \"modifier\": \"malgam\",\n            \"modified\": \"20190208052045982\"\n        },\n        \"$:/plugins/malgam/version-control/readme\": {\n            \"text\": \"!! Simple Tiddler Version Control\\n\\nThis plugin provides a simple tiddler versioning system.  Refer to the [[usage tiddler|$:/plugins/malgam/version-control/usage]] for guidance.\\n\\nIt was created to meet the following basic requirements:\\n\\n* The code for the plugin resides in a single wikitext tiddler.\\n* The version control functionality does not interfere with the normal operation of a tiddlywiki and is contained in the \\\"Versions\\\" tab in the tiddler Info panel.\\n* Committed versions of any tiddler can be saved at any time along with a simple commit message.\\n* There is no automatic saving of versions during the edit process.\\n* Committed versions can be restored to replace the current version of the subject tiddler.\\n* Committed versions can be deleted.\\n* Committed versions are saved as system tiddlers so that they do not show up in normal searches.\\n* Incremental differences between each version and the next previous version can be displayed.\\n\\nThe plugin code is contained in the single tiddler [[$:/plugins/malgam/version-control/versionTab]] and consists of just wikitext, widgets and macros.\\n\\nAcknowledgements:\\n\\n* This plugin was inspired by and uses some code from JD's [[Plain Revisions Plugin|http://j.d.revisions.tiddlyspot.com/]]\\n\",\n            \"title\": \"$:/plugins/malgam/version-control/readme\",\n            \"tags\": \"\",\n            \"modifier\": \"malgam\",\n            \"modified\": \"20190129071109995\",\n            \"creator\": \"malgam\",\n            \"created\": \"20190127044108901\"\n        },\n        \"$:/plugins/malgam/version-control/history\": {\n            \"created\": \"20190207061738145\",\n            \"creator\": \"malgam\",\n            \"text\": \"!! Release History\\n\\n!!! 0.0.7 - 2019-02-11\\n\\n* Reformat Commit Message text box to fill available horizontal space\\n\\n!!! 0.0.6 - 2019-02-08\\n\\n* Hide Restore and Delete buttons when current version selected\\n* Fix error with display of field diffs\\n* During version restore, remove fields from current version not present in restored version\\n* Added warning to readme tiddler\\n* Added History tiddler\\n\\n!!! 0.0.5 - 2019-02-04\\n\\n* Fixed problem with restoring fields from saved version\\n* Added placeholder text to commit message text box\\n\\n!!! 0.0.4 - 2019-01-30\\n\\n* Initial released version\\n\",\n            \"title\": \"$:/plugins/malgam/version-control/history\",\n            \"tags\": \"\",\n            \"modifier\": \"malgam\",\n            \"modified\": \"20190211070523500\"\n        }\n    }\n}","author":"malgam","core-version":"5.1.19","created":"20190207062311983","creator":"malgam","description":"Simple Tiddler Version Control","list":"readme usage history","modified":"20190208052913254","modifier":"malgam","plugin-type":"plugin","title":"$:/plugins/malgam/version-control","version":"0.0.7","name":"version-control"}