{"type":"application/json","text":"{\n    \"tiddlers\": {\n        \"$:/language/Buttons/HtmlConverter/Caption\": {\n            \"text\": \"HTML Converter\",\n            \"created\": \"20150304032218670\",\n            \"creator\": \"Stephen\",\n            \"modified\": \"20150304032351873\",\n            \"modifier\": \"Stephen\",\n            \"tags\": \"ske\",\n            \"title\": \"$:/language/Buttons/HtmlConverter/Caption\"\n        },\n        \"$:/language/Buttons/HtmlConverter/Hint\": {\n            \"text\": \"convert an HTML page imported from the Internet\",\n            \"created\": \"20150129182744418\",\n            \"creator\": \"Stephen\",\n            \"modified\": \"20150204202033738\",\n            \"modifier\": \"Stephen\",\n            \"tags\": \"ske\",\n            \"title\": \"$:/language/Buttons/HtmlConverter/Hint\"\n        },\n        \"$:/core/ui/TextEditorToolbar/htmlconvert\": {\n            \"text\": \"<$action-sendmessage\\n\\t$message=\\\"tm-edit-text-operation\\\"\\n\\t$param=\\\"htmlconverter\\\"\\n/>\",\n            \"caption\": \"{{$:/language/Buttons/HtmlConverter/Caption}}\",\n            \"condition\": \"[all[current]!is[image]]\",\n            \"created\": \"20160316212443637\",\n            \"creator\": \"Stephen\",\n            \"description\": \"{{$:/language/Buttons/HtmlConverter/Hint}}\",\n            \"icon\": \"$:/core/images/format-html\",\n            \"list-after\": \"$:/core/ui/TextEditorToolbar/tablehelper\",\n            \"modified\": \"20160505115755238\",\n            \"modifier\": \"Stephen\",\n            \"shortcuts\": \"((htmlconvert))\",\n            \"tags\": \"$:/tags/EditorToolbar\",\n            \"title\": \"$:/core/ui/TextEditorToolbar/htmlconvert\"\n        },\n        \"$:/core/modules/editor-operations/text/htmlconverter.js\": {\n            \"text\": \"/*\\\\\\ntitle: $:/core/modules/editor-operations/text/replace-selection.js\\ntype: application/javascript\\nmodule-type: texteditoroperation\\n\\nText editor operation to replace the selection\\n\\n\\\\*/\\n\\n// skimmel insertion =============\\nfunction lister(str){\\nvar prefix=\\\"\\\";\\nvar ops=[\\\"<ol>\\\",\\\"<ul>\\\",\\\"</ol>\\\",\\\"</ul>\\\",\\\"<li>\\\",\\\"</li>\\\"];\\nvar index=-1;\\n\\n     str=\\\" \\\"+str;\\n     var len= str.length;\\n\\n/* Strip the trailing li */\\n    var re = /<\\\\/li>/gim;\\n    var subst = '\\\\n';\\n    str = str.replace(re, subst);\\n/* Strip anything but core stuff in the ops */\\n    re = /<([l|u|o])([l|i])(.*?)>/gim; \\n    subst = '<$1$2>'; \\n    str = str.replace(re, subst);\\n\\n/* Find First op */\\n\\ndo {\\nvar firstop= 999;\\nvar first=str.length;\\n\\nfor (index=0; index<ops.length;index++) {\\nvar dummy = ops[index];\\nvar n = str.indexOf(dummy);\\nif (n>-1 && n<first) {\\nfirst = n;\\nvar firstop = index;\\n}/* end if */\\n}/* end for */\\n\\nif (firstop<999){\\nswitch (firstop) {\\ncase 0: /* <ol> */\\n    prefix=prefix+\\\"#\\\";\\n    re = /<ol>/im; \\n    subst=\\\"\\\\n\\\";\\n    str = str.replace(re, subst);\\n    break;\\ncase 1:/* <ul> */\\n    prefix = prefix +\\\"*\\\";\\n    var re = /<ul>/im; \\n    subst=\\\"\\\\n\\\";\\n    str = str.replace(re, subst);\\n    break;\\ncase 2: /* </ol> */\\n    prefix=prefix.slice(0,prefix.length-1);\\n    var re = /<\\\\/ol>/im; \\n    subst=\\\"\\\\n\\\";\\n    str = str.replace(re, subst);\\n    break;\\ncase 3: /* </ul> */\\n    prefix=prefix.slice(0,prefix.length-1);\\n    var re = /<\\\\/ul>/im; \\n    subst=\\\"\\\\n\\\";\\n    str = str.replace(re, subst);\\n    break;\\ncase 4: /* <li> */\\n    var re = /<li>/im; \\n    subst=\\\"\\\"+prefix;\\n    str = str.replace(re, subst);\\n\\n} /* end switch */\\n\\n} /* end if */\\n\\n}\\nwhile (firstop<999)\\nvar re =/\\\\n\\\\n([*|#])/gmi;\\nsubst=\\\"\\\\n$1\\\";\\nstr = str.replace(re, subst);\\n\\nvar re = /#\\\\n# /gm; \\nvar subst = '\\\\n#'; \\nstr = str.replace(re, subst);\\n\\nstr=str.slice(1, str.length);\\nreturn str;\\n\\n}/* end function */\\n// ====== End List Converter =====\\n\\n(function(){\\n\\n/*jslint node: true, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\nexports[\\\"htmlconverter\\\"] = function(event,operation) {\\nvar listtext=operation.selection;\\nlisttext=lister(listtext);\\nvar re = /<\\\\/div>/gm;\\nvar subst =\\\"\\\\n\\\";\\nvar listtext = listtext.replace(re, subst);\\n\\nvar re = /<header.*?>|<\\\\/header>/gmi; \\nvar subst = ''; \\nvar listtext = listtext.replace(re, subst);\\n\\n// ===== start image processing =====\\nvar str = listtext;\\nvar n = str.indexOf(\\\"<img \\\");\\nwhile (n>-1){\\nvar n2 = str.indexOf(\\\">\\\",n);\\nvar imagesub = str.substring(n,n2+1);\\nvar front = str.substring(0,n);\\nvar len=str.length;\\nvar back = str.substring(n2+1,len);\\nvar re = /<img (.*?)>/gmi; \\nvar subst = '$1'; \\nimagesub = imagesub.replace(re, subst);\\n// get the title if any\\nvar nalt=imagesub.indexOf('src=\\\"');\\nvar title=\\\"\\\";\\nif (nalt>-1){\\nnalt=nalt+5;\\nvar nalte=imagesub.indexOf('\\\"',nalt);\\ntitle=imagesub.substring(nalt,nalte);\\n}\\n\\nvar nalt=imagesub.indexOf('class=\\\"');\\nvar nclass=\\\"\\\";\\nif (nalt>-1){\\nvar nalte=imagesub.indexOf('\\\"',nalt+7)+1;\\nnclass=imagesub.substring(nalt,nalte)+\\\" \\\";\\n}\\n\\nvar nalt=imagesub.indexOf(' width=\\\"');\\nvar nwidth=\\\"\\\";\\nif (nalt>-1){\\nvar nalte=imagesub.indexOf('\\\"',nalt+7)+1;\\nnwidth=imagesub.substring(nalt,nalte)+\\\" \\\";\\n}\\n\\nvar nalt=imagesub.indexOf(' height=\\\"');\\nvar nheight=\\\"\\\";\\nif (nalt>-1){\\nvar nalte=imagesub.indexOf('\\\"',nalt+8)+1;\\nnheight=imagesub.substring(nalt,nalte)+\\\" \\\";\\n}\\n\\nvar nalt=imagesub.indexOf('alt=\\\"');\\nvar alt=\\\"\\\";\\nif (nalt>-1){\\nvar nalte=imagesub.indexOf('\\\"',nalt+5)+1;\\nalt=imagesub.substring(nalt,nalte)+\\\" \\\";\\n}\\n\\nimagesub = \\\"[img \\\"+alt+nclass+nwidth+nheight+\\\"[\\\"+title+\\\"]]\\\";\\nlisttext=front+imagesub+back;\\nstr=listtext;\\nn = str.indexOf(\\\"<img \\\");\\n}\\n\\n//----- End Image Processing\\n\\nvar re = /amp;/gm;\\nvar subst =\\\"\\\";\\nvar listtext = listtext.replace(re, subst);\\n\\nre = /<small.*?>|<\\\\/small>/gm; \\nsubst = ''; \\nlisttext = listtext.replace(re, subst);\\n\\nre = /<pre.*?>|<\\\\/pre>/gm; \\nsubst = '\\\\n```\\\\n'; \\nlisttext = listtext.replace(re, subst);\\n\\nvar re = /<p .*?>|<p>|<\\\\/p>/gm;\\nvar subst = \\\"\\\\n\\\";  \\nvar listtext = listtext.replace(re, subst);\\n\\nvar re = /<u>|<\\\\/u>|<ins>|<\\\\/ins>/gm;\\nsubst = '__';\\nlisttext = listtext.replace(re, subst);\\n\\nvar re = /<mark>/gm;\\nsubst = '@@.highlight ';\\nlisttext = listtext.replace(re, subst);\\n\\nvar re = /<\\\\/mark>/gm;\\nsubst = '@@';\\nlisttext = listtext.replace(re, subst);\\n\\nre = /\\\\t/gmi\\nsubst = '';  \\nlisttext = listtext.replace(re, subst);\\n\\nre = /<b>|<\\\\/b>|<strong>|<\\\\/strong>/gmi;\\nsubst = '\\\\'\\\\'';  \\nlisttext = listtext.replace(re, subst);\\n\\nre = /<i>|<\\\\/i>|<em>|<\\\\/em>/gmi;\\nsubst = '//';  \\nlisttext = listtext.replace(re, subst);\\n\\nre = /<sup(.*?)>|<\\\\/sup>/gmi;\\nsubst = '^^';  \\nlisttext = listtext.replace(re, subst);\\n\\nre = /<sub>|<\\\\/sub>/gmi;\\nsubst = ',,';  \\nlisttext = listtext.replace(re, subst);\\n\\nre = /<del>|<\\\\/del>|<strike>|<\\\\/strike>/gmi;\\nsubst = '~~';  \\nlisttext = listtext.replace(re, subst);\\n\\nre = /<h1(.*?)>/gmi;\\nsubst = '\\\\n! ';  \\nlisttext = listtext.replace(re, subst);\\nre = /<h2(.*?)>/gmi;\\nsubst = '\\\\n!! ';  \\nlisttext = listtext.replace(re, subst);\\nre = /<h3(.*?)>/gmi;\\nsubst = '\\\\n!!! ';  \\nlisttext = listtext.replace(re, subst);\\nre = /<h4(.*?)>/gmi;\\nsubst = '\\\\n!!!! ';  \\nlisttext = listtext.replace(re, subst);\\nre = /<h5(.*?)>/gmi;\\nsubst = '\\\\n!!!!! ';  \\nlisttext = listtext.replace(re, subst);\\nre = /<h6(.*?)>/gmi;\\nsubst = '\\\\n!!!!!! ';  \\nlisttext = listtext.replace(re, subst);\\nre = /<\\\\/h.>/gmi;\\nsubst = '';  \\nlisttext = listtext.replace(re, subst);\\n\\nre = /<blockquote.*?>|<\\\\/blockquote>/gmi;\\nsubst='\\\\n<<<\\\\n';\\nlisttext = listtext.replace(re, subst);\\n\\nre = /<a.*?href=\\\"(.*?)\\\".*?>(.*?)<\\\\/a>/gmi;\\nsubst = \\\"[[$2|$1]]\\\"; \\nlisttext = listtext.replace(re, subst);\\n\\n//Stray characters\\nre=/%24/gm;\\nsubst=\\\"$\\\";\\nlisttext = listtext.replace(re, subst);\\nre=/%3A/gm;\\nsubst=\\\":\\\";\\nlisttext = listtext.replace(re, subst);\\nre=/%2F/gm;\\nsubst=\\\"/\\\";\\nlisttext = listtext.replace(re, subst);\\n\\nre = /<li(.*?)>/gmi; \\nsubst = '<li>';\\nlisttext = listtext.replace(re, subst);\\n\\n// ------------- Tables  --------\\nre = /<\\\\/td.*?>|<\\\\/th>|<tr.*?>|<tbody.*?>|<\\\\/tbody>|<\\\\/table>/gmi; \\nsubst = '';\\nlisttext = listtext.replace(re, subst);\\n\\nre = /<td.*?>/gmi; \\nsubst = '|';\\nlisttext = listtext.replace(re, subst);\\n\\nre = /<th.*?>/gmi; \\nsubst = '|';\\nlisttext = listtext.replace(re, subst);\\n\\nre = /<\\\\/thead(.*?)>/gmi; \\nsubst = '|h';\\nlisttext = listtext.replace(re, subst);\\n\\nre = /<table.*?class=\\\"(.*?)\\\".*?>/gmi;\\nsubst='\\\\n\\\\n|$1|k\\\\n\\\\n';\\nlisttext = listtext.replace(re, subst);\\n\\nre= /<caption.*?>(.*?)<\\\\/caption>/gm;\\nsubst='\\\\n|$1|c\\\\n\\\\n';\\nlisttext = listtext.replace(re, subst);\\n\\nre = /<table(.*?)>|<\\\\/tr>/gmi; \\nsubst = '|\\\\n';\\nlisttext = listtext.replace(re, subst);\\n\\nre = /<span(.*?)>|<\\\\/span>|<div.*?>/gmi; \\nsubst = ' ';\\nlisttext = listtext.replace(re, subst);\\n\\nre = /\\\\n\\\\|/gm; \\nsubst = '|';\\nlisttext = listtext.replace(re, subst);\\n\\nre = /([0-9a-z.!?\\\"\\\\]\\\\^])\\\\n\\\\|/gmi; \\nsubst = '$1|'; \\nlisttext = listtext.replace(re, subst);\\n\\nre = /<\\\\/div>\\\\n\\\\|/gmi; \\nsubst = '</div>|'; \\nlisttext = listtext.replace(re, subst);\\n\\nre = /\\\\|\\\\n\\\\n\\\\|/gmi; \\nsubst = '|\\\\n|'; \\nlisttext = listtext.replace(re, subst);\\n\\nre=/<dl>|<\\\\/dl>|<\\\\/dt>|<\\\\/dd>/gmi;\\nsubst = '';\\nlisttext = listtext.replace(re, subst);\\n\\nre=/<dt>/gmi;\\nsubst = ';';\\nlisttext = listtext.replace(re, subst);\\n\\nre=/<dd>/gmi;\\nsubst = ':';\\nlisttext = listtext.replace(re, subst);\\n\\n// Correct issue with images in links\\nvar re = /\\\\[\\\\[(\\\\[img.*?\\\\[.*?\\\\|)(.*?)\\\\]\\\\]/gmi; \\nsubst = '<a href=\\\"$2\\\">$1</a>'; \\nlisttext = listtext.replace(re, subst);\\n\\n// Clean up\\n// Remove excess linebreaks and tabs\\nvar lenb=listtext.length;\\ndo {\\nvar lena=lenb;\\n  listtext= listtext.replace(/\\\\n\\\\n\\\\n/gm,'\\\\n\\\\n');\\n  listtext= listtext.replace(/\\\\n \\\\n/gm,'\\\\n\\\\n');\\n  listtext= listtext.replace(/<br>\\\\n<br>/gm,'\\\\n');\\n  listtext= listtext.replace(/^\\\\n/,'');\\n// Strip multiple blanks \\n  listtext = listtext.replace(/  /,' ');\\n  lenb=listtext.length;\\n}\\nwhile (lenb<lena);\\n\\noperation.replacement=listtext;\\n\\toperation.cutStart = operation.selStart;\\n\\toperation.cutEnd = operation.selEnd;\\n\\toperation.newSelStart = operation.selStart;\\n\\toperation.newSelEnd = operation.selStart + operation.replacement.length;\\n};\\n\\n})();\\n\",\n            \"created\": \"20160328021828150\",\n            \"modified\": \"20160328024105960\",\n            \"module-type\": \"texteditoroperation\",\n            \"tags\": \"\",\n            \"title\": \"$:/core/modules/editor-operations/text/htmlconverter.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/core/images/format-html\": {\n            \"text\": \"<svg class=\\\"tc-image-format-bold tc-image-button\\\" width=\\\"38pt\\\" height=\\\"32pt\\\" viewBox=\\\"0 0 34 34\\\">\\n    <g fill-rule=\\\"evenodd\\\">\\n<text  style=\\\"font-family: Arial; font-size: 26px; font-weight: bold;\\\" x=\\\"-2.5211\\\" y=\\\"16.7774\\\" id=\\\"e4_texte\\\" transform=\\\"matrix(0.558332, 0, 0, 0.6606, 1.53576, 9.12324)\\\">HTML</text>\\n    </g>\\n</svg>\",\n            \"created\": \"20160314124318483\",\n            \"modified\": \"20160316130747994\",\n            \"tags\": \"$:/tags/Image\",\n            \"title\": \"$:/core/images/format-html\"\n        },\n        \"$:/config/ShortcutInfo/htmlconvert\": {\n            \"text\": \"{{$:/language/Buttons/HtmlConverter/Hint}}\",\n            \"created\": \"20160505025108629\",\n            \"creator\": \"Stephen\",\n            \"modified\": \"20160505025137755\",\n            \"modifier\": \"Stephen\",\n            \"tags\": \"\",\n            \"title\": \"$:/config/ShortcutInfo/htmlconvert\"\n        },\n        \"$:/config/shortcuts/htmlconvert\": {\n            \"text\": \"ctrl-alt-H\",\n            \"created\": \"20160505025144746\",\n            \"creator\": \"Stephen\",\n            \"modified\": \"20160505122149630\",\n            \"modifier\": \"Stephen\",\n            \"tags\": \"\",\n            \"title\": \"$:/config/shortcuts/htmlconvert\"\n        }\n    }\n}","author":"Stephen Kimmel","description":"HTML Converter","list":"HTML Convert List","plugin-type":"plugin","title":"$:/plugins/sk/HTMLConvert","version":"0.0.4","name":"HTMLConvert"}