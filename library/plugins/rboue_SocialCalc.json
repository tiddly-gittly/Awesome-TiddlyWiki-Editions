{"type":"application/json","text":"{\n    \"tiddlers\": {\n        \"$:/plugins/rboue/SocialCalc/Languages/en-GB\": {\n            \"type\": \"application/json\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Languages/en-GB\",\n            \"text\": \"{\\n\\\"\\\":\\\"Translation process :\\\",\\n\\\"\\\":\\\"  . Translate all messages.\\\",\\n\\\"\\\":\\\"  . Add tiddler to your TiddlyWiki with the title :\\\",\\n\\\"\\\":\\\"    $:/plugins/<not sure>/SocialCalc/Languages/<your language>\\\",\\n\\\"\\\":\\\"    <your language> must match with the $:/language tiddler.\\\",\\n\\\"\\\":\\\"    Exemple : fr-FR for French.\\\",\\n\\n\\\"\\\":\\\"Common error messages\\\",\\n  \\\"s_BrowserNotSupported\\\": \\\"Browser not supported.\\\",\\n  \\\"s_InternalError\\\": \\\"Internal SocialCalc error (probably an internal bug): \\\",\\n\\n\\\"\\\":\\\"Errors thrown on unexpected value in save file\\\",\\n  \\\"s_pssUnknownColType\\\": \\\"Unknown col type item\\\",\\n  \\\"s_pssUnknownRowType\\\": \\\"Unknown row type item\\\",\\n  \\\"s_pssUnknownLineType\\\": \\\"Unknown line type\\\",\\n\\n\\\"\\\":\\\"Error thrown on unexpected cell type\\\",\\n  \\\"s_cfspUnknownCellType\\\": \\\"Unknown cell type item\\\",\\n\\n\\\"\\\":\\\"ExecuteSheetCommand\\\",\\n  \\\"s_escUnknownSheetCmd\\\": \\\"Unknown sheet command: \\\",\\n  \\\"s_escUnknownSetCoordCmd\\\": \\\"Unknown set coord command: \\\",\\n  \\\"s_escUnknownCmd\\\": \\\"Unknown command: \\\",\\n\\n\\\"\\\":\\\"SocialCalc.CheckAndCalcCell\\\",\\n  \\\"s_caccCircRef\\\": \\\"Circular reference to \\\",\\n\\n\\\"\\\":\\\"SocialCalc.RenderContext\\\",\\n  \\\"s_rcMissingSheet\\\": \\\"Render Context must have a sheet object\\\",\\n\\n\\\"\\\":\\\"SocialCalc.EditorGetStatuslineString -- strings shown on status line\\\",\\n  \\\"s_statusline_executing\\\": \\\"Executing...\\\",\\n  \\\"s_statusline_displaying\\\": \\\"Displaying...\\\",\\n  \\\"s_statusline_ordering\\\": \\\"Ordering...\\\",\\n  \\\"s_statusline_calculating\\\": \\\"Calculating...\\\",\\n  \\\"s_statusline_calculatingls\\\": \\\"Calculating... Loading Sheet...\\\",\\n  \\\"s_statusline_doingserverfunc\\\": \\\"doing server function \\\",\\n  \\\"s_statusline_incell\\\": \\\" in cell \\\",\\n  \\\"s_statusline_calcstart\\\": \\\"Calculation start...\\\",\\n  \\\"s_statusline_sum\\\": \\\"SUM\\\",\\n  \\\"s_statusline_recalcneeded\\\": \\\"<span style=\\\\\\\"color:#999;\\\\\\\">(Recalc needed)</span>\\\",\\n  \\\"s_statusline_circref\\\": \\\"<span style=\\\\\\\"color:red;\\\\\\\">Circular reference: \\\",\\n\\n\\\"\\\":\\\"SocialCalc.InputBoxDisplayCellContents\\\",\\n  \\\"s_inputboxdisplaymultilinetext\\\": \\\"[Multi-line text: Click icon on right to edit]\\\",\\n  \\\"ietUnknownFunction\\\": \\\"Unknown function \\\", \\\"\\\":\\\"displayed when typing \\\\\\\"=unknown(\\\",\\n  \\\"s_CHfillAllTooltip\\\": \\\"Fill Contents and Formats Down/Right\\\", \\\"\\\":\\\"tooltip for fill all handle\\\",\\n  \\\"s_CHfillContentsTooltip\\\": \\\"Fill Contents Only Down/Right\\\", \\\"\\\":\\\"tooltip for fill formulas handle\\\",\\n  \\\"s_CHmovePasteAllTooltip\\\": \\\"Move Contents and Formats\\\", \\\"\\\":\\\"etc.\\\",\\n  \\\"s_CHmovePasteContentsTooltip\\\": \\\"Move Contents Only\\\",\\n  \\\"s_CHmoveInsertAllTooltip\\\": \\\"Slide Contents and Formats within Row/Col\\\",\\n  \\\"s_CHmoveInsertContentsTooltip\\\": \\\"Slide Contents within Row/Col\\\",\\n  \\\"s_CHindicatorOperationLookup\\\": {\\n     \\\"Fill\\\": \\\"Fill\\\", \\\"FillC\\\": \\\"Fill Contents\\\",\\n     \\\"Move\\\": \\\"Move\\\", \\\"MoveI\\\": \\\"Slide\\\", \\n     \\\"MoveC\\\": \\\"Move Contents\\\", \\\"MoveIC\\\": \\\"Slide Contents\\\"\\n   },\\n  \\\"s_CHindicatorDirectionLookup\\\": {\\n     \\\"Down\\\": \\\" Down\\\", \\\"Right\\\": \\\" Right\\\",\\n     \\\"Horizontal\\\": \\\" Horizontal\\\", \\\"Vertical\\\": \\\" Vertical\\\"\\n   },\\n\\n\\\"\\\":\\\"Constants for default Format tab (settings)\\\",\\n\\\"\\\":\\\"\\\",\\n\\\"\\\":\\\"*** EVEN THOUGH THESE DON'T START WITH s_: ***\\\",\\n\\\"\\\":\\\"\\\",\\n\\\"\\\":\\\"These should be carefully checked for localization. Make sure you understand what they do and how they work!\\\",\\n\\\"\\\":\\\"The first part of \\\\\\\"first:second|first:second|...\\\\\\\" is what is displayed and the second is the value to be used.\\\",\\n\\\"\\\":\\\"The value is normally not translated -- only the displayed part. The [cancel], [break], etc., are not translated --\\\",\\n\\\"\\\":\\\"they are commands to SocialCalc.SettingsControls.PopupListInitialize\\\",\\n\\n  \\\"SCFormatNumberFormats\\\": \\\"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Auto w/ commas!:[,]General|[break]:|00:00|000:000|0000:0000|00000:00000|[break]:|%loc!Formula!:formula|%loc!Hidden!:hidden|[newcol]:1234:0|1,234:#,##0|1,234.5:#,##0.0|1,234.56:#,##0.00|1,234.567:#,##0.000|1,234.5678:#,##0.0000|[break]:|1,234%:#,##0%|1,234.5%:#,##0.0%|1,234.56%:#,##0.00%|[newcol]:|$1,234:$#,##0|$1,234.5:$#,##0.0|$1,234.56:$#,##0.00|[break]:|(1,234):#,##0_);(#,##0)|(1,234.5):#,##0.0_);(#,##0.0)|(1,234.56):#,##0.00_);(#,##0.00)|[break]:|($1,234):#,##0_);($#,##0)|($1,234.5):$#,##0.0_);($#,##0.0)|($1,234.56):$#,##0.00_);($#,##0.00)|[newcol]:|1/4/06:m/d/yy|01/04/2006:mm/dd/yyyy|2006-01-04:yyyy-mm-dd|4-Jan-06:d-mmm-yy|04-Jan-2006:dd-mmm-yyyy|January 4, 2006:mmmm d, yyyy|[break]:|1\\\\\\\\c23:h:mm|1\\\\\\\\c23 PM:h:mm AM/PM|1\\\\\\\\c23\\\\\\\\c45:h:mm:ss|01\\\\\\\\c23\\\\\\\\c45:hh:mm:ss|26\\\\\\\\c23 (h\\\\\\\\cm):[hh]:mm|69\\\\\\\\c45 (m\\\\\\\\cs):[mm]:ss|69 (s):[ss]|[newcol]:|2006-01-04 01\\\\\\\\c23\\\\\\\\c45:yyyy-mm-dd hh:mm:ss|January 4, 2006:mmmm d, yyyy hh:mm:ss|Wed:ddd|Wednesday:dddd|\\\",\\n  \\\"SCFormatTextFormats\\\": \\\"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Plain Text!:text-plain|HTML:text-html|%loc!Wikitext!:text-wiki|%loc!Link!:text-link|%loc!Formula!:formula|%loc!Hidden!:hidden|\\\",\\n  \\\"SCFormatPadsizes\\\": \\\"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!No padding!:0px|[newcol]:|1 pixel:1px|2 pixels:2px|3 pixels:3px|4 pixels:4px|5 pixels:5px|6 pixels:6px|7 pixels:7px|8 pixels:8px|[newcol]:|9 pixels:9px|10 pixels:10px|11 pixels:11px|12 pixels:12px|13 pixels:13px|14 pixels:14px|16 pixels:16px|18 pixels:18px|[newcol]:|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|\\\",\\n  \\\"SCFormatFontsizes\\\": \\\"[cancel]:|[break]:|%loc!Default!:|[custom]:|X-Small:x-small|Small:small|Medium:medium|Large:large|X-Large:x-large|[newcol]:|6pt:6pt|7pt:7pt|8pt:8pt|9pt:9pt|10pt:10pt|11pt:11pt|12pt:12pt|14pt:14pt|16pt:16pt|[newcol]:|18pt:18pt|20pt:20pt|22pt:22pt|24pt:24pt|28pt:28pt|36pt:36pt|48pt:48pt|72pt:72pt|[newcol]:|8 pixels:8px|9 pixels:9px|10 pixels:10px|11 pixels:11px|12 pixels:12px|13 pixels:13px|14 pixels:14px|[newcol]:|16 pixels:16px|18 pixels:18px|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|\\\",\\n  \\\"SCFormatFontfamilies\\\": \\\"[cancel]:|[break]:|%loc!Default!:|[custom]:|Verdana:Verdana,Arial,Helvetica,sans-serif|Arial:arial,helvetica,sans-serif|Courier:'Courier New',Courier,monospace|\\\",\\n  \\\"SCFormatFontlook\\\": \\\"[cancel]:|[break]:|%loc!Default!:|%loc!Normal!:normal normal|%loc!Bold!:normal bold|%loc!Italic!:italic normal|%loc!Bold Italic!:italic bold\\\",\\n  \\\"SCFormatTextAlignhoriz\\\":  \\\"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|\\\",\\n  \\\"SCFormatNumberAlignhoriz\\\":  \\\"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|\\\",\\n  \\\"SCFormatAlignVertical\\\": \\\"[cancel]:|[break]:|%loc!Default!:|%loc!Top!:top|%loc!Middle!:middle|%loc!Bottom!:bottom|\\\",\\n  \\\"SCFormatColwidth\\\": \\\"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|20 pixels:20|40:40|60:60|80:80|100:100|120:120|140:140|160:160|[newcol]:|180 pixels:180|200:200|220:220|240:240|260:260|280:280|300:300|\\\",\\n  \\\"SCFormatRecalc\\\": \\\"[cancel]:|[break]:|%loc!Auto!:|%loc!Manual!:off|\\\",\\n  \\\"SCFormatUserMaxCol\\\": \\\"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|Unlimited:0|10:10|20:20|30:30|40:40|50:50|60:60|80:80|100:100|\\\",\\n  \\\"SCFormatUserMaxRow\\\": \\\"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|Unlimited:0|10:10|20:20|30:30|40:40|50:50|60:60|80:80|100:100|\\\",\\n\\n\\\"\\\":\\\"SocialCalc.SettingsControls.PopupListInitialize\\\",\\n  \\\"s_PopupListCancel\\\": \\\"[Cancel]\\\",\\n  \\\"s_PopupListCustom\\\": \\\"Custom\\\",\\n\\n\\\"\\\":\\\"***\\\",\\n\\\"\\\":\\\"\\\",\\n\\\"\\\":\\\"s_loc_ constants accessed by SocialCalc.LocalizeString and SocialCalc.LocalizeSubstrings\\\",\\n\\\"\\\":\\\"\\\",\\n\\\"\\\":\\\"Used extensively by socialcalcspreadsheetcontrol.js\\\",\\n\\\"\\\":\\\"\\\",\\n\\\"\\\":\\\"***\\\",\\n  \\\"s_loc_align_center\\\": \\\"Align Center\\\",\\n  \\\"s_loc_align_left\\\": \\\"Align Left\\\",\\n  \\\"s_loc_align_right\\\": \\\"Align Right\\\",\\n  \\\"s_loc_alignment\\\": \\\"Alignment\\\",\\n  \\\"s_loc_audit\\\": \\\"Audit\\\",\\n  \\\"s_loc_audit_trail_this_session\\\": \\\"Audit Trail This Session\\\",\\n  \\\"s_loc_auto\\\": \\\"Auto\\\",\\n  \\\"s_loc_auto_sum\\\": \\\"Auto Sum\\\",\\n  \\\"s_loc_auto_wX_commas\\\": \\\"Auto w/ commas\\\",\\n  \\\"s_loc_automatic\\\": \\\"Automatic\\\",\\n  \\\"s_loc_background\\\": \\\"Background\\\",\\n  \\\"s_loc_bold\\\": \\\"Bold\\\",\\n  \\\"s_loc_bold_XampX_italics\\\": \\\"Bold &amp; Italics\\\",\\n  \\\"s_loc_bold_italic\\\": \\\"Bold Italic\\\",\\n  \\\"s_loc_borders\\\": \\\"Borders\\\",\\n  \\\"s_loc_borders_off\\\": \\\"Borders Off\\\",\\n  \\\"s_loc_borders_on\\\": \\\"Borders On\\\",\\n  \\\"s_loc_bottom\\\": \\\"Bottom\\\",\\n  \\\"s_loc_bottom_border\\\": \\\"Bottom Border\\\",\\n  \\\"s_loc_cell_settings\\\": \\\"CELL SETTINGS\\\",\\n  \\\"s_loc_csv_format\\\": \\\"CSV format\\\",\\n  \\\"s_loc_cancel\\\": \\\"Cancel\\\",\\n  \\\"s_loc_category\\\": \\\"Category\\\",\\n  \\\"s_loc_center\\\": \\\"Center\\\",\\n  \\\"s_loc_clear\\\": \\\"Clear\\\",\\n  \\\"s_loc_clear_socialcalc_clipboard\\\": \\\"Clear SocialCalc Clipboard\\\",\\n  \\\"s_loc_clipboard\\\": \\\"Clipboard\\\",\\n  \\\"s_loc_color\\\": \\\"Color\\\",\\n  \\\"s_loc_column_\\\": \\\"Column \\\",\\n  \\\"s_loc_comment\\\": \\\"Comment\\\",\\n  \\\"s_loc_copy\\\": \\\"Copy\\\",\\n  \\\"s_loc_custom\\\": \\\"Custom\\\",\\n  \\\"s_loc_cut\\\": \\\"Cut\\\",\\n  \\\"s_loc_default\\\": \\\"Default\\\",\\n  \\\"s_loc_default_alignment\\\": \\\"Default Alignment\\\",\\n  \\\"s_loc_default_column_width\\\": \\\"Default Column Width\\\",\\n  \\\"s_loc_default_font\\\": \\\"Default Font\\\",\\n  \\\"s_loc_default_format\\\": \\\"Default Format\\\",\\n  \\\"s_loc_default_padding\\\": \\\"Default Padding\\\",\\n  \\\"s_loc_delete\\\": \\\"Delete\\\",\\n  \\\"s_loc_delete_column\\\": \\\"Delete Column\\\",\\n  \\\"s_loc_delete_contents\\\": \\\"Delete Contents\\\",\\n  \\\"s_loc_delete_row\\\": \\\"Delete Row\\\",\\n  \\\"s_loc_description\\\": \\\"Description\\\",\\n  \\\"s_loc_display_clipboard_in\\\": \\\"Display Clipboard in\\\",\\n  \\\"s_loc_down\\\": \\\"Down\\\",\\n  \\\"s_loc_edit\\\": \\\"Edit\\\",\\n  \\\"s_loc_existing_names\\\": \\\"Existing Names\\\",\\n  \\\"s_loc_family\\\": \\\"Family\\\",\\n  \\\"s_loc_fill_down\\\": \\\"Fill Down\\\",\\n  \\\"s_loc_fill_right\\\": \\\"Fill Right\\\",\\n  \\\"s_loc_font\\\": \\\"Font\\\",\\n  \\\"s_loc_format\\\": \\\"Format\\\",\\n  \\\"s_loc_formula\\\": \\\"Formula\\\",\\n  \\\"s_loc_function_list\\\": \\\"Function List\\\",\\n  \\\"s_loc_functions\\\": \\\"Functions\\\",\\n  \\\"s_loc_grid\\\": \\\"Grid\\\",\\n  \\\"s_loc_hidden\\\": \\\"Hidden\\\",\\n  \\\"s_loc_hide_column\\\": \\\"Hide Column\\\",\\n  \\\"s_loc_hide_row\\\": \\\"Hide Row\\\",\\n  \\\"s_loc_horizontal\\\": \\\"Horizontal\\\",\\n  \\\"s_loc_insert_column\\\": \\\"Insert Column\\\",\\n  \\\"s_loc_insert_row\\\": \\\"Insert Row\\\",\\n  \\\"s_loc_italic\\\": \\\"Italic\\\",\\n  \\\"s_loc_last_sort\\\": \\\"Last Sort\\\",\\n  \\\"s_loc_left\\\": \\\"Left\\\",\\n  \\\"s_loc_left_border\\\": \\\"Left Border\\\",\\n  \\\"s_loc_link\\\": \\\"Link\\\",\\n  \\\"s_loc_link_input_box\\\": \\\"Link Input Box\\\",\\n  \\\"s_loc_list\\\": \\\"List\\\",\\n  \\\"s_loc_load_socialcalc_clipboard_with_this\\\": \\\"Load SocialCalc Clipboard With This\\\",\\n  \\\"s_loc_lock\\\": \\\"Lock\\\",\\n  \\\"s_loc_major_sort\\\": \\\"Major Sort\\\",\\n  \\\"s_loc_manual\\\": \\\"Manual\\\",\\n  \\\"s_loc_merge_cells\\\": \\\"Merge Cells\\\",\\n  \\\"s_loc_middle\\\": \\\"Middle\\\",\\n  \\\"s_loc_minor_sort\\\": \\\"Minor Sort\\\",\\n  \\\"s_loc_move_insert\\\": \\\"Move Insert\\\",\\n  \\\"s_loc_move_paste\\\": \\\"Move Paste\\\",\\n  \\\"s_loc_multiXline_input_box\\\": \\\"Multi-line Input Box\\\",\\n  \\\"s_loc_name\\\": \\\"Name\\\",\\n  \\\"s_loc_names\\\": \\\"Names\\\",\\n  \\\"s_loc_no_padding\\\": \\\"No padding\\\",\\n  \\\"s_loc_normal\\\": \\\"Normal\\\",\\n  \\\"s_loc_number\\\": \\\"Number\\\",\\n  \\\"s_loc_number_horizontal\\\": \\\"Number Horizontal\\\",\\n  \\\"s_loc_ok\\\": \\\"OK\\\",\\n  \\\"s_loc_padding\\\": \\\"Padding\\\",\\n  \\\"s_loc_page_name\\\": \\\"Page Name\\\",\\n  \\\"s_loc_paste\\\": \\\"Paste\\\",\\n  \\\"s_loc_paste_formats\\\": \\\"Paste Formats\\\",\\n  \\\"s_loc_plain_text\\\": \\\"Plain Text\\\",\\n  \\\"s_loc_recalc\\\": \\\"Recalc\\\",\\n  \\\"s_loc_recalculation\\\": \\\"Recalculation\\\",\\n  \\\"s_loc_redo\\\": \\\"Redo\\\",\\n  \\\"s_loc_right\\\": \\\"Right\\\",\\n  \\\"s_loc_right_border\\\": \\\"Right Border\\\",\\n  \\\"s_loc_sheet_settings\\\": \\\"SHEET SETTINGS\\\",\\n  \\\"s_loc_save\\\": \\\"Save\\\",\\n  \\\"s_loc_save_to\\\": \\\"Save to\\\",\\n  \\\"s_loc_set_cell_contents\\\": \\\"Set Cell Contents\\\",\\n  \\\"s_loc_set_cells_to_sort\\\": \\\"Set Cells To Sort\\\",\\n  \\\"s_loc_set_value_to\\\": \\\"Set Value To\\\",\\n  \\\"s_loc_set_to_link_format\\\": \\\"Set to Link format\\\",\\n  \\\"s_loc_setXclear_move_from\\\": \\\"Set/Clear Move From\\\",\\n  \\\"s_loc_show_cell_settings\\\": \\\"Show Cell Settings\\\",\\n  \\\"s_loc_show_sheet_settings\\\": \\\"Show Sheet Settings\\\",\\n  \\\"s_loc_show_in_new_browser_window\\\": \\\"Show in new browser window\\\",\\n  \\\"s_loc_size\\\": \\\"Size\\\",\\n  \\\"s_loc_socialcalcXsave_format\\\": \\\"SocialCalc-save format\\\",\\n  \\\"s_loc_sort\\\": \\\"Sort\\\",\\n  \\\"s_loc_sort_\\\": \\\"Sort \\\",\\n  \\\"s_loc_sort_cells\\\": \\\"Sort Cells\\\",\\n  \\\"s_loc_swap_colors\\\": \\\"Swap Colors\\\",\\n  \\\"s_loc_tabXdelimited_format\\\": \\\"Tab-delimited format\\\",\\n  \\\"s_loc_text\\\": \\\"Text\\\",\\n  \\\"s_loc_text_horizontal\\\": \\\"Text Horizontal\\\",\\n  \\\"s_loc_this_is_aXbrXsample\\\": \\\"This is a<br>sample\\\",\\n  \\\"s_loc_top\\\": \\\"Top\\\",\\n  \\\"s_loc_top_border\\\": \\\"Top Border\\\",\\n  \\\"s_loc_undone_steps\\\": \\\"UNDONE STEPS\\\",\\n  \\\"s_loc_url\\\": \\\"URL\\\",\\n  \\\"s_loc_undo\\\": \\\"Undo\\\",\\n  \\\"s_loc_unlock\\\": \\\"Unlock\\\",\\n  \\\"s_loc_unmerge_cells\\\": \\\"Unmerge Cells\\\",\\n  \\\"s_loc_up\\\": \\\"Up\\\",\\n  \\\"s_loc_value\\\": \\\"Value\\\",\\n  \\\"s_loc_vertical\\\": \\\"Vertical\\\",\\n  \\\"s_loc_wikitext\\\": \\\"Wikitext\\\",\\n  \\\"s_loc_workspace\\\": \\\"Workspace\\\",\\n  \\\"s_loc_XnewX\\\": \\\"[New]\\\",\\n  \\\"s_loc_XnoneX\\\": \\\"[None]\\\",\\n  \\\"s_loc_Xselect_rangeX\\\": \\\"[select range]\\\",\\n\\n\\\"\\\":\\\"The following constants are arrays of strings with the short (3 character) and full names of days and months\\\",\\n  \\\"s_FormatNumber_daynames\\\": [\\\"Sunday\\\", \\\"Monday\\\", \\\"Tuesday\\\", \\\"Wednesday\\\", \\\"Thursday\\\", \\\"Friday\\\", \\\"Saturday\\\"],\\n  \\\"s_FormatNumber_daynames3\\\": [\\\"Sun\\\", \\\"Mon\\\", \\\"Tue\\\", \\\"Wed\\\", \\\"Thu\\\", \\\"Fri\\\", \\\"Sat\\\"],\\n  \\\"s_FormatNumber_monthnames\\\": [\\\"January\\\", \\\"February\\\", \\\"March\\\", \\\"April\\\", \\\"May\\\", \\\"June\\\", \\\"July\\\", \\\"August\\\", \\\"September\\\",\\n                                      \\\"October\\\", \\\"November\\\", \\\"December\\\"],\\n  \\\"s_FormatNumber_monthnames3\\\": [\\\"Jan\\\", \\\"Feb\\\", \\\"Mar\\\", \\\"Apr\\\", \\\"May\\\", \\\"Jun\\\", \\\"Jul\\\", \\\"Aug\\\", \\\"Sep\\\", \\\"Oct\\\", \\\"Nov\\\", \\\"Dec\\\"],\\n  \\\"s_FormatNumber_am\\\": \\\"AM\\\",\\n  \\\"s_FormatNumber_am1\\\": \\\"A\\\",\\n  \\\"s_FormatNumber_pm\\\": \\\"PM\\\",\\n  \\\"s_FormatNumber_pm1\\\": \\\"P\\\",\\n\\n\\\"\\\":\\\"\\\",\\n\\\"\\\":\\\"SocialCalc Spreadsheet Formula module, formula1.js:\\\",\\n\\\"\\\":\\\"\\\",\\n  \\\"s_parseerrexponent\\\": \\\"Improperly formed number exponent\\\",\\n  \\\"s_parseerrchar\\\": \\\"Unexpected character in formula\\\",\\n  \\\"s_parseerrstring\\\": \\\"Improperly formed string\\\",\\n  \\\"s_parseerrspecialvalue\\\": \\\"Improperly formed special value\\\",\\n  \\\"s_parseerrtwoops\\\": \\\"Error in formula (two operators inappropriately in a row)\\\",\\n  \\\"s_parseerrmissingopenparen\\\": \\\"Missing open parenthesis in list with comma(s). \\\",\\n  \\\"s_parseerrcloseparennoopen\\\": \\\"Closing parenthesis without open parenthesis. \\\",\\n  \\\"s_parseerrmissingcloseparen\\\": \\\"Missing close parenthesis. \\\",\\n  \\\"s_parseerrmissingoperand\\\": \\\"Missing operand. \\\",\\n  \\\"s_parseerrerrorinformula\\\": \\\"Error in formula.\\\",\\n  \\\"s_calcerrerrorvalueinformula\\\": \\\"Error value in formula\\\",\\n  \\\"s_parseerrerrorinformulabadval\\\": \\\"Error in formula resulting in bad value\\\",\\n  \\\"s_formularangeresult\\\": \\\"Formula results in range value:\\\",\\n  \\\"s_calcerrnumericnan\\\": \\\"Formula results in an bad numeric value\\\",\\n  \\\"s_calcerrnumericoverflow\\\": \\\"Numeric overflow\\\",\\n  \\\"s_sheetunavailable\\\": \\\"Sheet unavailable:\\\", \\\"\\\":\\\"when FindSheetInCache returns null\\\",\\n  \\\"s_calcerrcellrefmissing\\\": \\\"Cell reference missing when expected.\\\",\\n  \\\"s_calcerrsheetnamemissing\\\": \\\"Sheet name missing when expected.\\\",\\n  \\\"s_circularnameref\\\": \\\"Circular name reference to name\\\",\\n  \\\"s_calcerrunknownname\\\": \\\"Unknown name\\\",\\n  \\\"s_calcerrincorrectargstofunction\\\": \\\"Incorrect arguments to function\\\",\\n  \\\"s_sheetfuncunknownfunction\\\": \\\"Unknown function\\\",\\n  \\\"s_sheetfunclnarg\\\": \\\"LN argument must be greater than 0\\\",\\n  \\\"s_sheetfunclog10arg\\\": \\\"LOG10 argument must be greater than 0\\\",\\n  \\\"s_sheetfunclogsecondarg\\\": \\\"LOG second argument must be numeric greater than 0\\\",\\n  \\\"s_sheetfunclogfirstarg\\\": \\\"LOG first argument must be greater than 0\\\",\\n  \\\"s_sheetfuncroundsecondarg\\\": \\\"ROUND second argument must be numeric\\\",\\n  \\\"s_sheetfuncddblife\\\": \\\"DDB life must be greater than 1\\\",\\n  \\\"s_sheetfuncslnlife\\\": \\\"SLN life must be greater than 1\\\",\\n\\n\\\"\\\":\\\"Function definition text\\\",\\n  \\\"s_fdef_ABS\\\": \\\"Absolute value function. \\\",\\n  \\\"s_fdef_ACOS\\\": \\\"Trigonometric arccosine function. \\\",\\n  \\\"s_fdef_AND\\\": \\\"True if all arguments are true. \\\",\\n  \\\"s_fdef_ASIN\\\": \\\"Trigonometric arcsine function. \\\",\\n  \\\"s_fdef_ATAN\\\": \\\"Trigonometric arctan function. \\\",\\n  \\\"s_fdef_ATAN2\\\": \\\"Trigonometric arc tangent function (result is in radians). \\\",\\n  \\\"s_fdef_AVERAGE\\\": \\\"Averages the values. \\\",\\n  \\\"s_fdef_CHOOSE\\\": \\\"Returns the value specified by the index. The values may be ranges of cells. \\\",\\n  \\\"s_fdef_COLUMNS\\\": \\\"Returns the number of columns in the range. \\\",\\n  \\\"s_fdef_COS\\\": \\\"Trigonometric cosine function (value is in radians). \\\",\\n  \\\"s_fdef_COUNT\\\": \\\"Counts the number of numeric values, not blank, text, or error. \\\",\\n  \\\"s_fdef_COUNTA\\\": \\\"Counts the number of non-blank values. \\\",\\n  \\\"s_fdef_COUNTBLANK\\\": \\\"Counts the number of blank values. (Note: \\\\\\\"\\\\\\\" is not blank.) \\\",\\n  \\\"s_fdef_COUNTIF\\\": \\\"Counts the number of number of cells in the range that meet the criteria. The criteria may be a value (\\\\\\\"x\\\\\\\", 15, 1+3) or a test (>25). \\\",\\n  \\\"s_fdef_DATE\\\": \\\"Returns the appropriate date value given numbers for year, month, and day. For example: DATE(2006,2,1) for February 1, 2006. Note: In this program, day \\\\\\\"1\\\\\\\" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day \\\\\\\"1\\\\\\\" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. \\\",\\n  \\\"s_fdef_DAVERAGE\\\": \\\"Averages the values in the specified field in records that meet the criteria. \\\",\\n  \\\"s_fdef_DAY\\\": \\\"Returns the day of month for a date value. \\\",\\n  \\\"s_fdef_DCOUNT\\\": \\\"Counts the number of numeric values, not blank, text, or error, in the specified field in records that meet the criteria. \\\",\\n  \\\"s_fdef_DCOUNTA\\\": \\\"Counts the number of non-blank values in the specified field in records that meet the criteria. \\\",\\n  \\\"s_fdef_DDB\\\": \\\"Returns the amount of depreciation at the given period of time (the default factor is 2 for double-declining balance).   \\\",\\n  \\\"s_fdef_DEGREES\\\": \\\"Converts value in radians into degrees. \\\",\\n  \\\"s_fdef_DGET\\\": \\\"Returns the value of the specified field in the single record that meets the criteria. \\\",\\n  \\\"s_fdef_DMAX\\\": \\\"Returns the maximum of the numeric values in the specified field in records that meet the criteria. \\\",\\n  \\\"s_fdef_DMIN\\\": \\\"Returns the maximum of the numeric values in the specified field in records that meet the criteria. \\\",\\n  \\\"s_fdef_DPRODUCT\\\": \\\"Returns the result of multiplying the numeric values in the specified field in records that meet the criteria. \\\",\\n  \\\"s_fdef_DSTDEV\\\": \\\"Returns the sample standard deviation of the numeric values in the specified field in records that meet the criteria. \\\",\\n  \\\"s_fdef_DSTDEVP\\\": \\\"Returns the standard deviation of the numeric values in the specified field in records that meet the criteria. \\\",\\n  \\\"s_fdef_DSUM\\\": \\\"Returns the sum of the numeric values in the specified field in records that meet the criteria. \\\",\\n  \\\"s_fdef_DVAR\\\": \\\"Returns the sample variance of the numeric values in the specified field in records that meet the criteria. \\\",\\n  \\\"s_fdef_DVARP\\\": \\\"Returns the variance of the numeric values in the specified field in records that meet the criteria. \\\",\\n  \\\"s_fdef_EVEN\\\": \\\"Rounds the value up in magnitude to the nearest even integer. \\\",\\n  \\\"s_fdef_EXACT\\\": \\\"Returns \\\\\\\"true\\\\\\\" if the values are exactly the same, including case, type, etc. \\\",\\n  \\\"s_fdef_EXP\\\": \\\"Returns e raised to the value power. \\\",\\n  \\\"s_fdef_FACT\\\": \\\"Returns factorial of the value. \\\",\\n  \\\"s_fdef_FALSE\\\": \\\"Returns the logical value \\\\\\\"false\\\\\\\". \\\",\\n  \\\"s_fdef_FIND\\\": \\\"Returns the starting position within string2 of the first occurrence of string1 at or after \\\\\\\"start\\\\\\\". If start is omitted, 1 is assumed. \\\",\\n  \\\"s_fdef_FV\\\": \\\"Returns the future value of repeated payments of money invested at the given rate for the specified number of periods, with optional present value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). \\\",\\n  \\\"s_fdef_HLOOKUP\\\": \\\"Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the row offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. \\\",\\n  \\\"s_fdef_HOUR\\\": \\\"Returns the hour portion of a time or date/time value. \\\",\\n  \\\"s_fdef_IF\\\": \\\"Results in true-value if logical-expression is TRUE or non-zero, otherwise results in false-value. \\\",\\n  \\\"s_fdef_INDEX\\\": \\\"Returns a cell or range reference for the specified row and column in the range. If range is 1-dimensional, then only one of rownum or colnum are needed. If range is 2-dimensional and rownum or colnum are zero, a reference to the range of just the specified column or row is returned. You can use the returned reference value in a range, e.g., sum(A1:INDEX(A2:A10,4)). \\\",\\n  \\\"s_fdef_INT\\\": \\\"Returns the value rounded down to the nearest integer (towards -infinity). \\\",\\n  \\\"s_fdef_IRR\\\": \\\"Returns the interest rate at which the cash flows in the range have a net present value of zero. Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). \\\",\\n  \\\"s_fdef_ISBLANK\\\": \\\"Returns \\\\\\\"true\\\\\\\" if the value is a reference to a blank cell. \\\",\\n  \\\"s_fdef_ISERR\\\": \\\"Returns \\\\\\\"true\\\\\\\" if the value is of type \\\\\\\"Error\\\\\\\" but not \\\\\\\"NA\\\\\\\". \\\",\\n  \\\"s_fdef_ISERROR\\\": \\\"Returns \\\\\\\"true\\\\\\\" if the value is of type \\\\\\\"Error\\\\\\\". \\\",\\n  \\\"s_fdef_ISLOGICAL\\\": \\\"Returns \\\\\\\"true\\\\\\\" if the value is of type \\\\\\\"Logical\\\\\\\" (true/false). \\\",\\n  \\\"s_fdef_ISNA\\\": \\\"Returns \\\\\\\"true\\\\\\\" if the value is the error type \\\\\\\"NA\\\\\\\". \\\",\\n  \\\"s_fdef_ISNONTEXT\\\": \\\"Returns \\\\\\\"true\\\\\\\" if the value is not of type \\\\\\\"Text\\\\\\\". \\\",\\n  \\\"s_fdef_ISNUMBER\\\": \\\"Returns \\\\\\\"true\\\\\\\" if the value is of type \\\\\\\"Number\\\\\\\" (including logical values). \\\",\\n  \\\"s_fdef_ISTEXT\\\": \\\"Returns \\\\\\\"true\\\\\\\" if the value is of type \\\\\\\"Text\\\\\\\". \\\",\\n  \\\"s_fdef_LEFT\\\": \\\"Returns the specified number of characters from the text value. If count is omitted, 1 is assumed. \\\",\\n  \\\"s_fdef_LEN\\\": \\\"Returns the number of characters in the text value. \\\",\\n  \\\"s_fdef_LN\\\": \\\"Returns the natural logarithm of the value. \\\",\\n  \\\"s_fdef_LOG\\\": \\\"Returns the logarithm of the value using the specified base. \\\",\\n  \\\"s_fdef_LOG10\\\": \\\"Returns the base 10 logarithm of the value. \\\",\\n  \\\"s_fdef_LOWER\\\": \\\"Returns the text value with all uppercase characters converted to lowercase. \\\",\\n  \\\"s_fdef_MATCH\\\": \\\"Look for the matching value for the given value in the range and return position (the first is 1) in that range. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. If rangelookup is -1, act like 1 but the bracket is match>=value. \\\",\\n  \\\"s_fdef_MAX\\\": \\\"Returns the maximum of the numeric values. \\\",\\n  \\\"s_fdef_MID\\\": \\\"Returns the specified number of characters from the text value starting from the specified position. \\\",\\n  \\\"s_fdef_MIN\\\": \\\"Returns the minimum of the numeric values. \\\",\\n  \\\"s_fdef_MINUTE\\\": \\\"Returns the minute portion of a time or date/time value. \\\",\\n  \\\"s_fdef_MOD\\\": \\\"Returns the remainder of the first value divided by the second. \\\",\\n  \\\"s_fdef_MONTH\\\": \\\"Returns the month part of a date value. \\\",\\n  \\\"s_fdef_N\\\": \\\"Returns the value if it is a numeric value otherwise an error. \\\",\\n  \\\"s_fdef_NA\\\": \\\"Returns the #N/A error value which propagates through most operations. \\\",\\n  \\\"s_fdef_NOT\\\": \\\"Returns FALSE if value is true, and TRUE if it is false. \\\",\\n  \\\"s_fdef_NOW\\\": \\\"Returns the current date/time. \\\",\\n  \\\"s_fdef_NPER\\\": \\\"Returns the number of periods at which payments invested each period at the given rate with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period) has the given present value. \\\",\\n  \\\"s_fdef_NPV\\\": \\\"Returns the net present value of cash flows (which may be individual values and/or ranges) at the given rate. The flows are positive if income, negative if paid out, and are assumed at the end of each period. \\\",\\n  \\\"s_fdef_ODD\\\": \\\"Rounds the value up in magnitude to the nearest odd integer. \\\",\\n  \\\"s_fdef_OR\\\": \\\"True if any argument is true \\\",\\n  \\\"s_fdef_PI\\\": \\\"The value 3.1415926... \\\",\\n  \\\"s_fdef_PMT\\\": \\\"Returns the amount of each payment that must be invested at the given rate for the specified number of periods to have the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). \\\",\\n  \\\"s_fdef_POWER\\\": \\\"Returns the first value raised to the second value power. \\\",\\n  \\\"s_fdef_PRODUCT\\\": \\\"Returns the result of multiplying the numeric values. \\\",\\n  \\\"s_fdef_PROPER\\\": \\\"Returns the text value with the first letter of each word converted to uppercase and the others to lowercase. \\\",\\n  \\\"s_fdef_PV\\\": \\\"Returns the present value of the given number of payments each invested at the given rate, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). \\\",\\n  \\\"s_fdef_RADIANS\\\": \\\"Converts value in degrees into radians. \\\",\\n  \\\"s_fdef_RATE\\\": \\\"Returns the rate at which the given number of payments each invested at the given rate has the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). \\\",\\n  \\\"s_fdef_REPLACE\\\": \\\"Returns text1 with the specified number of characters starting from the specified position replaced by text2. \\\",\\n  \\\"s_fdef_REPT\\\": \\\"Returns the text repeated the specified number of times. \\\",\\n  \\\"s_fdef_RIGHT\\\": \\\"Returns the specified number of characters from the text value starting from the end. If count is omitted, 1 is assumed. \\\",\\n  \\\"s_fdef_ROUND\\\": \\\"Rounds the value to the specified number of decimal places. If precision is negative, then round to powers of 10. The default precision is 0 (round to integer). \\\",\\n  \\\"s_fdef_ROWS\\\": \\\"Returns the number of rows in the range. \\\",\\n  \\\"s_fdef_SECOND\\\": \\\"Returns the second portion of a time or date/time value (truncated to an integer). \\\",\\n  \\\"s_fdef_SIN\\\": \\\"Trigonometric sine function (value is in radians) \\\",\\n  \\\"s_fdef_SLN\\\": \\\"Returns the amount of depreciation at each period of time using the straight-line method. \\\",\\n  \\\"s_fdef_SQRT\\\": \\\"Square root of the value \\\",\\n  \\\"s_fdef_STDEV\\\": \\\"Returns the sample standard deviation of the numeric values. \\\",\\n  \\\"s_fdef_STDEVP\\\": \\\"Returns the standard deviation of the numeric values. \\\",\\n  \\\"s_fdef_SUBSTITUTE\\\": \\\"Returns text1 with the all occurrences of oldtext replaced by newtext. If \\\\\\\"occurrence\\\\\\\" is present, then only that occurrence is replaced. \\\",\\n  \\\"s_fdef_SUM\\\": \\\"Adds the numeric values. The values to the sum function may be ranges in the form similar to A1:B5. \\\",\\n  \\\"s_fdef_SUMIF\\\": \\\"Sums the numeric values of cells in the range that meet the criteria. The criteria may be a value (\\\\\\\"x\\\\\\\", 15, 1+3) or a test (>25). If range2 is present, then range1 is tested and the corresponding range2 value is summed. \\\",\\n  \\\"s_fdef_SYD\\\": \\\"Depreciation by Sum of Year\\\\\\\"s Digits method. \\\",\\n  \\\"s_fdef_T\\\": \\\"Returns the text value or else a null string. \\\",\\n  \\\"s_fdef_TAN\\\": \\\"Trigonometric tangent function (value is in radians) \\\",\\n  \\\"s_fdef_TIME\\\": \\\"Returns the time value given the specified hour, minute, and second. \\\",\\n  \\\"s_fdef_TODAY\\\": \\\"Returns the current date (an integer). Note: In this program, day \\\\\\\"1\\\\\\\" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day \\\\\\\"1\\\\\\\" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. \\\",\\n  \\\"s_fdef_TRIM\\\": \\\"Returns the text value with leading, trailing, and repeated spaces removed. \\\",\\n  \\\"s_fdef_TRUE\\\": \\\"Returns the logical value \\\\\\\"true\\\\\\\". \\\",\\n  \\\"s_fdef_TRUNC\\\": \\\"Truncates the value to the specified number of decimal places. If precision is negative, truncate to powers of 10. \\\",\\n  \\\"s_fdef_UPPER\\\": \\\"Returns the text value with all lowercase characters converted to uppercase. \\\",\\n  \\\"s_fdef_VALUE\\\": \\\"Converts the specified text value into a numeric value. Various forms that look like numbers (including digits followed by %, forms that look like dates, etc.) are handled. This may not handle all of the forms accepted by other spreadsheets and may be locale dependent. \\\",\\n  \\\"s_fdef_VAR\\\": \\\"Returns the sample variance of the numeric values. \\\",\\n  \\\"s_fdef_VARP\\\": \\\"Returns the variance of the numeric values. \\\",\\n  \\\"s_fdef_VLOOKUP\\\": \\\"Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the column offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match>=value) instead of exact match. \\\",\\n  \\\"s_fdef_WEEKDAY\\\": \\\"Returns the day of week specified by the date value. If type is 1 (the default), Sunday is day and Saturday is day 7. If type is 2, Monday is day 1 and Sunday is day 7. If type is 3, Monday is day 0 and Sunday is day 6. \\\",\\n  \\\"s_fdef_YEAR\\\": \\\"Returns the year part of a date value. \\\",\\n  \\\"s_fdef_SUMPRODUCT\\\": \\\"Sums the pairwise products of 2 or more ranges. The ranges must be of equal length.\\\",\\n  \\\"s_fdef_CEILING\\\": \\\"Rounds the given number up to the nearest integer or multiple of significance. Significance is the value to whose multiple of ten the value is to be rounded up (.01, .1, 1, 10, etc.)\\\",\\n  \\\"s_fdef_FLOOR\\\": \\\"Rounds the given number down to the nearest multiple of significance. Significance is the value to whose multiple of ten the number is to be rounded down (.01, .1, 1, 10, etc.)\\\",\\n\\n  \\\"s_farg_v\\\": \\\"value\\\",\\n  \\\"s_farg_vn\\\": \\\"value1, value2, ...\\\",\\n  \\\"s_farg_xy\\\": \\\"valueX, valueY\\\",\\n  \\\"s_farg_choose\\\": \\\"index, value1, value2, ...\\\",\\n  \\\"s_farg_range\\\": \\\"range\\\",\\n  \\\"s_farg_rangec\\\": \\\"range, criteria\\\",\\n  \\\"s_farg_date\\\": \\\"year, month, day\\\",\\n  \\\"s_farg_dfunc\\\": \\\"databaserange, fieldname, criteriarange\\\",\\n  \\\"s_farg_ddb\\\": \\\"cost, salvage, lifetime, period, [factor]\\\",\\n  \\\"s_farg_find\\\": \\\"string1, string2, [start]\\\",\\n  \\\"s_farg_fv\\\": \\\"rate, n, payment, [pv, [paytype]]\\\",\\n  \\\"s_farg_hlookup\\\": \\\"value, range, row, [rangelookup]\\\",\\n  \\\"s_farg_iffunc\\\": \\\"logical-expression, true-value, [false-value]\\\",\\n  \\\"s_farg_index\\\": \\\"range, rownum, colnum\\\",\\n  \\\"s_farg_irr\\\": \\\"range, [guess]\\\",\\n  \\\"s_farg_tc\\\": \\\"text, count\\\",\\n  \\\"s_farg_log\\\": \\\"value, base\\\",\\n  \\\"s_farg_match\\\": \\\"value, range, [rangelookup]\\\",\\n  \\\"s_farg_mid\\\": \\\"text, start, length\\\",\\n  \\\"s_farg_nper\\\": \\\"rate, payment, pv, [fv, [paytype]]\\\",\\n  \\\"s_farg_npv\\\": \\\"rate, value1, value2, ...\\\",\\n  \\\"s_farg_pmt\\\": \\\"rate, n, pv, [fv, [paytype]]\\\",\\n  \\\"s_farg_pv\\\": \\\"rate, n, payment, [fv, [paytype]]\\\",\\n  \\\"s_farg_rate\\\": \\\"n, payment, pv, [fv, [paytype, [guess]]]\\\",\\n  \\\"s_farg_replace\\\": \\\"text1, start, length, text2\\\",\\n  \\\"s_farg_vp\\\": \\\"value, [precision]\\\",\\n  \\\"s_farg_valpre\\\": \\\"value, precision\\\",\\n  \\\"s_farg_csl\\\": \\\"cost, salvage, lifetime\\\",\\n  \\\"s_farg_cslp\\\": \\\"cost, salvage, lifetime, period\\\",\\n  \\\"s_farg_subs\\\": \\\"text1, oldtext, newtext, [occurrence]\\\",\\n  \\\"s_farg_sumif\\\": \\\"range1, criteria, [range2]\\\",\\n  \\\"s_farg_hms\\\": \\\"hour, minute, second\\\",\\n  \\\"s_farg_txt\\\": \\\"text\\\",\\n  \\\"s_farg_vlookup\\\": \\\"value, range, col, [rangelookup]\\\",\\n  \\\"s_farg_weekday\\\": \\\"date, [type]\\\",\\n  \\\"s_farg_dt\\\": \\\"date\\\",\\n  \\\"s_farg_rangen\\\": \\\"range1, range2, ...\\\",\\n  \\\"s_farg_vsig\\\": \\\"value, [significance]\\\",\\n\\n  \\\"function_classlist\\\": [\\\"all\\\", \\\"stat\\\", \\\"lookup\\\", \\\"datetime\\\", \\\"financial\\\", \\\"test\\\", \\\"math\\\", \\\"text\\\"],\\n\\n  \\\"s_fclass_all\\\": \\\"All\\\",\\n  \\\"s_fclass_stat\\\": \\\"Statistics\\\",\\n  \\\"s_fclass_lookup\\\": \\\"Lookup\\\",\\n  \\\"s_fclass_datetime\\\": \\\"Date & Time\\\",\\n  \\\"s_fclass_financial\\\": \\\"Financial\\\",\\n  \\\"s_fclass_test\\\": \\\"Test\\\",\\n  \\\"s_fclass_math\\\": \\\"Math\\\",\\n  \\\"s_fclass_text\\\": \\\"Text\\\",\\n\\n\\\"\\\":\\\"Graph tab\\\",\\n  \\\"s_loc_plain\\\": \\\"Plain\\\",\\n  \\\"s_loc_graph\\\": \\\"Graph\\\",\\n  \\\"s_loc_cells_to_graph\\\": \\\"Cells to Graph\\\",\\n  \\\"s_loc_set_cells_to_graph\\\": \\\"Set Cells To Graph\\\",\\n  \\\"s_loc_graph_type\\\": \\\"Graph Type\\\",\\n  \\\"s_loc_help\\\": \\\"Help\\\",\\n  \\\"s_loc_horizontal_bar\\\": \\\"Horizontal Bar\\\",\\n  \\\"s_loc_vertical_bar\\\": \\\"Vertical Bar\\\",\\n  \\\"s_loc_pie_chart\\\": \\\"Pie Chart\\\",\\n  \\\"s_loc_line_chart\\\": \\\"Line Chart\\\",\\n  \\\"s_loc_scatter_chart\\\": \\\"Plot Points\\\",\\n  \\\"s_loc_not_set\\\": \\\"Not Set\\\",\\n  \\\"s_loc_unknown_range_name\\\": \\\"Unknown range name\\\",\\n  \\\"s_loc_hide_help\\\": \\\"Hide Help\\\",\\n  \\\"s_loc_x\\\": \\\"X\\\",\\n  \\\"s_loc_y\\\": \\\"Y\\\",\\n  \\\"s_loc_max\\\": \\\"Max\\\",\\n  \\\"s_loc_min\\\": \\\"Min\\\",\\n  \\\"s_loc_Xselect_rangeX\\\": \\\"[select range]\\\",\\n  \\\"s_GraphRangeNotSelected\\\": \\\"Select a range of cells with numeric values to graph and use the OK button above to set the range as the graph range.\\\",\\n  \\\"s_graph_error_selection\\\": \\\"<b>Range selection error</b>.<br>You must select cells in a single row or column !\\\",\\n  \\\"s_graph_help_intro\\\": \\\"This is the help text for graph type: \\\",\\n  \\\"s_graph_VerticalBar_help\\\": \\\"The <b>Graph</b> tab displays a bar graph of the cells which have been selected (either in a single row across or column down). If the row above (or column to the left) of the selection has values, those values are used as labels. Otherwise the cell coordinates are used (e.g., B5).\\\",\\n  \\\"s_graph_HorizontalBar_help\\\": \\\"The <b>Graph</b> tab displays a bar graph of the cells which have been selected (either in a single row across or column down). If the row above (or column to the left) of the selection has values, those values are used as labels. Otherwise the cell coordinates are used (e.g., B5).\\\",\\n  \\\"s_graph_PieChart_help\\\": \\\"The <b>Graph</b> tab displays a pie chart of the cells which have been selected (either in a single row across or column down). If the row above (or column to the left) of the selection has values, those values are used as labels. Otherwise the cell coordinates are used (e.g., B5).\\\",\\n  \\\"s_graph_PieChart_error_selection\\\": \\\"<b>Selection error</b><br>You must select cells with positive value !\\\",\\n  \\\"s_graph_LineChart_help\\\": \\\"The <b>Graph</b> tab displays a XY profile line of the cells which have been selected (either in a single row across or column down). The row above (or column to the left) of the selection is used as X coordinates.\\\",\\n  \\\"s_graph_ScatterChart_help\\\": \\\"The <b>Graph</b> tab displays a XY scattered chart of the cells which have been selected (either in a single row across or column down). The row above (or column to the left) of the selection is used as X coordinates. If row below (or column to the right) have values, they are interpreted as plot dimensions.\\\",\\n\\n\\\"\\\":\\\"Clipboard tab\\\",\\n  \\\"s_loc_to\\\": \\\"to\\\",\\n  \\\"s_loc_tiddler\\\": \\\"Tiddler\\\",\\n  \\\"s_loc_import\\\": \\\"Import\\\",\\n  \\\"s_loc_export\\\": \\\"Export\\\",\\n  \\\"s_loc_XclipboardX\\\": \\\"[Clipboard]\\\",\\n  \\\"s_clipboard_menu_title\\\": \\\"Import/Export<br>and Clipboard\\\",\\n  \\\"s_clipboard_export_error_tiddler_exists\\\": \\\"Tiddler exists\\\",\\n  \\\"s_clipboard_export_error_tiddler_overwrite\\\": \\\"Do you want to overwrite it ?\\\",\\n  \\\"s_clipboard_import_error_tiddler_format\\\": \\\"Format error: tiddler's format field have incorrect value.\\\",\\n\\n\\\"\\\":\\\"Save sheet to tiddler\\\",\\n  \\\"s_loc_save_changes\\\": \\\"Save changes\\\",\\n  \\\"s_notification_tiddler\\\": \\\"Saved ~SocialCalc sheet\\\",\\n\\n\\\"\\\":\\\"End\\\"\\n}\\n\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Languages/en-GB--save-notification\": {\n            \"title\": \"$:/plugins/rboue/SocialCalc/Languages/en-GB--save-notification\",\n            \"text\": \"Saved ~SocialCalc sheet\\n\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Languages/fr-FR\": {\n            \"type\": \"application/json\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Languages/fr-FR\",\n            \"text\": \"{\\n\\\"\\\":\\\"Origin of this translation : Framasoft (http://framacalc.org)\\\",\\n\\n\\\"\\\":\\\"Translation process :\\\",\\n\\\"\\\":\\\"  . Translate all messages.\\\",\\n\\\"\\\":\\\"  . Add tiddler to your TiddlyWiki with the title :\\\",\\n\\\"\\\":\\\"    $:/plugins/<not sure>/SocialCalc/Languages/<your language>\\\",\\n\\\"\\\":\\\"    <your language> must match with the $:/language tiddler.\\\",\\n\\\"\\\":\\\"    Exemple : fr-FR for French.\\\",\\n\\n\\\"\\\":\\\"Common error messages\\\",\\n  \\\"s_BrowserNotSupported\\\": \\\"Navigateur non supporté\\\",\\n  \\\"s_InternalError\\\": \\\"Erreur interne de SocialCalc (probablement un bug interne) : \\\",\\n\\n\\\"\\\":\\\"Errors thrown on unexpected value in save file\\\",\\n  \\\"s_pssUnknownColType\\\": \\\"Type de champ de colonne inconnu\\\",\\n  \\\"s_pssUnknownRowType\\\": \\\"Type de champ de ligne inconnu\\\",\\n  \\\"s_pssUnknownLineType\\\": \\\"Type de ligne inconnu\\\",\\n\\n\\\"\\\":\\\"Error thrown on unexpected cell type\\\",\\n  \\\"s_cfspUnknownCellType\\\": \\\"Type de champ de cellule inconnu\\\", \\n\\n\\\"\\\":\\\"ExecuteSheetCommand\\\",\\n  \\\"s_escUnknownSheetCmd\\\": \\\"Commande sur la feuille inconnue : \\\",\\n  \\\"s_escUnknownSetCoordCmd\\\": \\\"Commande de saisie des coordonnées inconnue : \\\",\\n  \\\"s_escUnknownCmd\\\": \\\"Commande inconnue : \\\",\\n\\n\\\"\\\":\\\"SocialCalc.CheckAndCalcCell\\\",\\n  \\\"s_caccCircRef\\\": \\\"Référence circulaire à \\\",\\n\\n\\\"\\\":\\\"SocialCalc.RenderContext\\\",\\n  \\\"s_rcMissingSheet\\\": \\\"Le contexte de rendu doit avoir un objet feuille de calcul\\\",\\n\\n\\\"\\\":\\\"SocialCalc.EditorGetStatuslineString -- strings shown on status line\\\",\\n  \\\"s_statusline_executing\\\": \\\"En cours d'exécution...\\\",\\n  \\\"s_statusline_displaying\\\": \\\"En cours d'affichage...\\\",\\n  \\\"s_statusline_ordering\\\": \\\"En cours de classement...\\\",\\n  \\\"s_statusline_calculating\\\": \\\"Calculs en cours...\\\",\\n  \\\"s_statusline_calculatingls\\\": \\\"Calculs en cours... Chargement de la feuille...\\\",\\n  \\\"s_statusline_doingserverfunc\\\": \\\"exécute la fonction du serveur \\\",\\n  \\\"s_statusline_incell\\\": \\\" en cellule \\\",\\n  \\\"s_statusline_calcstart\\\": \\\"Début des calculs...\\\",\\n  \\\"s_statusline_sum\\\": \\\"SOMME\\\",\\n  \\\"s_statusline_recalcneeded\\\": \\\"<span style=\\\\\\\"color:#999;\\\\\\\">(Recalcul nécessaire)</span>\\\",\\n  \\\"s_statusline_circref\\\": \\\"<span style=\\\\\\\"color:red;\\\\\\\">Référence circulaire : \\\",\\n\\n\\\"\\\":\\\"SocialCalc.InputBoxDisplayCellContents\\\",\\n  \\\"s_inputboxdisplaymultilinetext\\\": \\\"[Multi-ligne de texte: Cliquez sur la droite de l'icône pour éditer]\\\",\\n  \\\"ietUnknownFunction\\\": \\\"Fonction inconnue \\\", \\\"\\\":\\\"displayed when typing \\\\\\\"=unknown(\\\",\\n  \\\"s_CHfillAllTooltip\\\": \\\"Remplir les contenus et les formats bas/droite\\\", \\\"\\\":\\\"tooltip for fill all handle\\\",\\n  \\\"s_CHfillContentsTooltip\\\": \\\"Remplir les contenus seulement bas/droite\\\", \\\"\\\":\\\"tooltip for fill formulas handle\\\",\\n  \\\"s_CHmovePasteAllTooltip\\\": \\\"Déplacer les contenus et les formats\\\", \\\"\\\":\\\"etc.\\\",\\n  \\\"s_CHmovePasteContentsTooltip\\\": \\\"Déplacer les contenus seulement\\\",\\n  \\\"s_CHmoveInsertAllTooltip\\\": \\\"Déplacer les contenus et les formats en ligne/colonne\\\",\\n  \\\"s_CHmoveInsertContentsTooltip\\\": \\\"Déplacer les contenus en ligne/colonne\\\",\\n  \\\"s_CHindicatorOperationLookup\\\": {\\n        \\\"Fill\\\": \\\"Remplir\\\", \\\"FillC\\\": \\\"Remplir le contenu\\\",\\n        \\\"Move\\\": \\\"Déplacer\\\", \\\"MoveI\\\": \\\"Faire glisser\\\",\\n        \\\"MoveC\\\": \\\"Déplacer le contenu\\\", \\\"MoveIC\\\": \\\"Faire glisser le contenu\\\"\\n    },\\n  \\\"s_CHindicatorDirectionLookup\\\": {\\n        \\\"Down\\\": \\\" Bas\\\", \\\"Right\\\": \\\" Droite\\\",\\n        \\\"Horizontal\\\": \\\" Horizontal\\\", \\\"Vertical\\\": \\\" Vertical\\\"\\n    },\\n\\n\\\"\\\":\\\"Constants for default Format tab (settings)\\\",\\n\\\"\\\":\\\"\\\",\\n\\\"\\\":\\\"*** EVEN THOUGH THESE DON'T START WITH s_: ***\\\",\\n\\\"\\\":\\\"\\\",\\n\\\"\\\":\\\"These should be carefully checked for localization. Make sure you understand what they do and how they work!\\\",\\n\\\"\\\":\\\"The first part of \\\\\\\"first:second|first:second|...\\\\\\\" is what is displayed and the second is the value to be used.\\\",\\n\\\"\\\":\\\"The value is normally not translated -- only the displayed part. The [cancel], [break], etc., are not translated --\\\",\\n\\\"\\\":\\\"they are commands to SocialCalc.SettingsControls.PopupListInitialize\\\",\\n\\n  \\\"SCFormatNumberFormats\\\": \\\"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Auto w/ commas!:[,]General|[break]:|00:00|000:000|0000:0000|00000:00000|[break]:|%loc!Formula!:formula|%loc!Hidden!:hidden|[newcol]:1234:0|1,234:#,##0|1,234.5:#,##0.0|1,234.56:#,##0.00|1,234.567:#,##0.000|1,234.5678:#,##0.0000|[break]:|1,234%:#,##0%|1,234.5%:#,##0.0%|1,234.56%:#,##0.00%|[newcol]:|$1,234:$#,##0|$1,234.5:$#,##0.0|$1,234.56:$#,##0.00|[break]:|(1,234):#,##0_);(#,##0)|(1,234.5):#,##0.0_);(#,##0.0)|(1,234.56):#,##0.00_);(#,##0.00)|[break]:|($1,234):#,##0_);($#,##0)|($1,234.5):$#,##0.0_);($#,##0.0)|($1,234.56):$#,##0.00_);($#,##0.00)|[newcol]:|1/4/06:m/d/yy|01/04/2006:mm/dd/yyyy|2006-01-04:yyyy-mm-dd|4-Jan-06:d-mmm-yy|04-Jan-2006:dd-mmm-yyyy|Janvier 4, 2006:mmmm d, yyyy|[break]:|1\\\\\\\\c23:h:mm|1\\\\\\\\c23 PM:h:mm AM/PM|1\\\\\\\\c23\\\\\\\\c45:h:mm:ss|01\\\\\\\\c23\\\\\\\\c45:hh:mm:ss|26\\\\\\\\c23 (h\\\\\\\\cm):[hh]:mm|69\\\\\\\\c45 (m\\\\\\\\cs):[mm]:ss|69 (s):[ss]|[newcol]:|2006-01-04 01\\\\\\\\c23\\\\\\\\c45:yyyy-mm-dd hh:mm:ss|Janvier 4, 2006:mmmm d, yyyy hh:mm:ss|Mer:ddd|Mercredi:dddd|\\\",\\n  \\\"SCFormatTextFormats\\\": \\\"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Plain Text!:text-plain|HTML:text-html|%loc!Wikitext!:text-wiki|%loc!Link!:text-link|%loc!Formula!:formula|%loc!Hidden!:hidden|\\\",\\n  \\\"SCFormatPadsizes\\\": \\\"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!No padding!:0px|[newcol]:|1 pixel:1px|2 pixels:2px|3 pixels:3px|4 pixels:4px|5 pixels:5px|6 pixels:6px|7 pixels:7px|8 pixels:8px|[newcol]:|9 pixels:9px|10 pixels:10px|11 pixels:11px|12 pixels:12px|13 pixels:13px|14 pixels:14px|16 pixels:16px|18 pixels:18px|[newcol]:|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|\\\",\\n  \\\"SCFormatFontsizes\\\": \\\"[cancel]:|[break]:|%loc!Default!:|[custom]:|X-Small:x-small|Small:small|Medium:medium|Large:large|X-Large:x-large|[newcol]:|6pt:6pt|7pt:7pt|8pt:8pt|9pt:9pt|10pt:10pt|11pt:11pt|12pt:12pt|14pt:14pt|16pt:16pt|[newcol]:|18pt:18pt|20pt:20pt|22pt:22pt|24pt:24pt|28pt:28pt|36pt:36pt|48pt:48pt|72pt:72pt|[newcol]:|8 pixels:8px|9 pixels:9px|10 pixels:10px|11 pixels:11px|12 pixels:12px|13 pixels:13px|14 pixels:14px|[newcol]:|16 pixels:16px|18 pixels:18px|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|\\\",\\n  \\\"SCFormatFontfamilies\\\": \\\"[cancel]:|[break]:|%loc!Default!:|[custom]:|Verdana:Verdana,Arial,Helvetica,sans-serif|Arial:arial,helvetica,sans-serif|Courier:'Courier New',Courier,monospace|\\\",\\n  \\\"SCFormatFontlook\\\": \\\"[cancel]:|[break]:|%loc!Default!:|%loc!Normal!:normal normal|%loc!Bold!:normal bold|%loc!Italic!:italic normal|%loc!Bold Italic!:italic bold\\\",\\n  \\\"SCFormatTextAlignhoriz\\\":  \\\"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|\\\",\\n  \\\"SCFormatNumberAlignhoriz\\\":  \\\"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|\\\",\\n  \\\"SCFormatAlignVertical\\\": \\\"[cancel]:|[break]:|%loc!Default!:|%loc!Top!:top|%loc!Middle!:middle|%loc!Bottom!:bottom|\\\",\\n  \\\"SCFormatColwidth\\\": \\\"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|20 pixels:20|40:40|60:60|80:80|100:100|120:120|140:140|160:160|[newcol]:|180 pixels:180|200:200|220:220|240:240|260:260|280:280|300:300|\\\",\\n  \\\"SCFormatRecalc\\\": \\\"[cancel]:|[break]:|%loc!Auto!:|%loc!Manual!:off|\\\",\\n  \\\"SCFormatUserMaxCol\\\": \\\"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|Unlimited:0|10:10|20:20|30:30|40:40|50:50|60:60|80:80|100:100|\\\",\\n  \\\"SCFormatUserMaxRow\\\": \\\"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|Unlimited:0|10:10|20:20|30:30|40:40|50:50|60:60|80:80|100:100|\\\",\\n\\n\\\"\\\":\\\"SocialCalc.SettingsControls.PopupListInitialize\\\",\\n  \\\"s_PopupListCancel\\\": \\\"[Annuler]\\\",\\n  \\\"s_PopupListCustom\\\": \\\"Personnalisé\\\",\\n\\n\\\"\\\":\\\"***\\\",\\n\\\"\\\":\\\"\\\",\\n\\\"\\\":\\\"s_loc_ constants accessed by SocialCalc.LocalizeString and SocialCalc.LocalizeSubstrings\\\",\\n\\\"\\\":\\\"\\\",\\n\\\"\\\":\\\"Used extensively by socialcalcspreadsheetcontrol.js\\\",\\n\\\"\\\":\\\"\\\",\\n\\\"\\\":\\\"***\\\",\\n  \\\"s_PopupListCancel\\\": \\\"[Annuler]\\\",\\n  \\\"s_PopupListCustom\\\": \\\"Personnalisé\\\",\\n  \\\"s_loc_align_center\\\": \\\"Aligner au centre\\\",\\n  \\\"s_loc_align_left\\\": \\\"Aligner à gauche\\\",\\n  \\\"s_loc_align_right\\\": \\\"Aligner à droite\\\",\\n  \\\"s_loc_alignment\\\": \\\"Alignement\\\",\\n  \\\"s_loc_audit\\\": \\\"Historique\\\",\\n  \\\"s_loc_audit_trail_this_session\\\": \\\"Suivi des modifications de cette session \\\",\\n  \\\"s_loc_auto\\\": \\\"Automatique\\\",\\n  \\\"s_loc_auto_sum\\\": \\\"Somme automatique\\\",\\n  \\\"s_loc_auto_wX_commas\\\": \\\"Auto avec virgule\\\",\\n  \\\"s_loc_automatic\\\": \\\"Automatique\\\",\\n  \\\"s_loc_background\\\": \\\"Arrière-plan\\\",\\n  \\\"s_loc_bold\\\": \\\"Gras\\\",\\n  \\\"s_loc_bold_XampX_italics\\\": \\\"Gras &amp; Italique\\\",\\n  \\\"s_loc_bold_italic\\\": \\\"Gras Italique\\\",\\n  \\\"s_loc_borders\\\": \\\"Bordures\\\",\\n  \\\"s_loc_borders_off\\\": \\\"Désactiver les bordures\\\",\\n  \\\"s_loc_borders_on\\\": \\\"Activer les bordures\\\",\\n  \\\"s_loc_bottom\\\": \\\"Bas\\\",\\n  \\\"s_loc_bottom_border\\\": \\\"Bordure basse\\\",\\n  \\\"s_loc_cell_settings\\\": \\\"PARAMÈTRES DE LA CELLULE\\\",\\n  \\\"s_loc_csv_format\\\": \\\"Format CSV\\\",\\n  \\\"s_loc_cancel\\\": \\\"Annuler\\\",\\n  \\\"s_loc_category\\\": \\\"Catégorie\\\",\\n  \\\"s_loc_center\\\": \\\"Centrer\\\",\\n  \\\"s_loc_clear\\\": \\\"Nettoyer\\\",\\n  \\\"s_loc_clear_socialcalc_clipboard\\\": \\\"Nettoyer le presse-papier de SocialCalc \\\",\\n  \\\"s_loc_clipboard\\\": \\\"Presse-papier\\\",\\n  \\\"s_loc_color\\\": \\\"Couleur\\\",\\n  \\\"s_loc_column_\\\": \\\"Colonne \\\",\\n  \\\"s_loc_comment\\\": \\\"Commentaire\\\",\\n  \\\"s_loc_copy\\\": \\\"Copier\\\",\\n  \\\"s_loc_custom\\\": \\\"Personnalisé\\\",\\n  \\\"s_loc_cut\\\": \\\"Couper\\\",\\n  \\\"s_loc_default\\\": \\\"Défaut\\\",\\n  \\\"s_loc_default_alignment\\\": \\\"Alignement par défaut\\\",\\n  \\\"s_loc_default_column_width\\\": \\\"Largeur des colonnes par défaut\\\",\\n  \\\"s_loc_default_font\\\": \\\"Police par défaut\\\",\\n  \\\"s_loc_default_format\\\": \\\"Format par défaut\\\",\\n  \\\"s_loc_default_padding\\\": \\\"Remplissage par défaut\\\",\\n  \\\"s_loc_delete\\\": \\\"Effacer le contenu\\\",\\n  \\\"s_loc_delete_column\\\": \\\"Supprimer une colonne\\\",\\n  \\\"s_loc_delete_contents\\\": \\\"Supprimer le contenu\\\",\\n  \\\"s_loc_delete_row\\\": \\\"Supprimer une ligne\\\",\\n  \\\"s_loc_description\\\": \\\"Description\\\",\\n  \\\"s_loc_display_clipboard_in\\\": \\\"Afficher le presse-papier dans le \\\",\\n  \\\"s_loc_down\\\": \\\"Bas\\\",\\n  \\\"s_loc_edit\\\": \\\"Édition\\\",\\n  \\\"s_loc_existing_names\\\": \\\"Noms existants\\\",\\n  \\\"s_loc_family\\\": \\\"Famille\\\",\\n  \\\"s_loc_fill_down\\\": \\\"Dupliquer vers le bas\\\",\\n  \\\"s_loc_fill_right\\\": \\\"Dupliquer vers la droite\\\",\\n  \\\"s_loc_font\\\": \\\"Police\\\",\\n  \\\"s_loc_format\\\": \\\"Format\\\",\\n  \\\"s_loc_formula\\\": \\\"Formule\\\",\\n  \\\"s_loc_function_list\\\": \\\"Liste des fonctions\\\",\\n  \\\"s_loc_functions\\\": \\\"Fonctions\\\",\\n  \\\"s_loc_grid\\\": \\\"Grille\\\",\\n  \\\"s_loc_hidden\\\": \\\"Caché\\\",\\n  \\\"s_loc_hide_column\\\": \\\"Cacher une colonne\\\",\\n  \\\"s_loc_hide_row\\\": \\\"Cacher une ligne\\\",\\n  \\\"s_loc_horizontal\\\": \\\"Horizontal\\\",\\n  \\\"s_loc_insert_column\\\": \\\"Ajouter une colonne\\\",\\n  \\\"s_loc_insert_row\\\": \\\"Ajouter une ligne\\\",\\n  \\\"s_loc_italic\\\": \\\"Italique\\\",\\n  \\\"s_loc_last_sort\\\": \\\"Dernier tri\\\",\\n  \\\"s_loc_left\\\": \\\"Gauche\\\",\\n  \\\"s_loc_left_border\\\": \\\"Bordure gauche\\\",\\n  \\\"s_loc_link\\\": \\\"Lien\\\",\\n  \\\"s_loc_link_input_box\\\": \\\"Créer un lien externe\\\",\\n  \\\"s_loc_list\\\": \\\"Liste\\\",\\n  \\\"s_loc_load_socialcalc_clipboard_with_this\\\": \\\"Charger le presse-papier de Framacalc avec ceci\\\",\\n  \\\"s_loc_lock\\\": \\\"Verrouiller\\\",\\n  \\\"s_loc_major_sort\\\": \\\"Tri principal\\\",\\n  \\\"s_loc_manual\\\": \\\"Manuel\\\",\\n  \\\"s_loc_merge_cells\\\": \\\"Fusionner des cellules\\\",\\n  \\\"s_loc_middle\\\": \\\"Milieu\\\",\\n  \\\"s_loc_minor_sort\\\": \\\"Tri secondaire\\\",\\n  \\\"s_loc_move_insert\\\": \\\"Insérer les cellules à déplacer\\\",\\n  \\\"s_loc_move_paste\\\": \\\"Coller les cellules à déplacer\\\",\\n  \\\"s_loc_multiXline_input_box\\\": \\\"Case d'import multi-ligne\\\",\\n  \\\"s_loc_name\\\": \\\"Nom\\\",\\n  \\\"s_loc_names\\\": \\\"Noms\\\",\\n  \\\"s_loc_no_padding\\\": \\\"Pas de bordure\\\",\\n  \\\"s_loc_normal\\\": \\\"Normal\\\",\\n  \\\"s_loc_number\\\": \\\"Nombre\\\",\\n  \\\"s_loc_number_horizontal\\\": \\\"Nombre Horizontal\\\",\\n  \\\"s_loc_ok\\\": \\\"OK\\\",\\n  \\\"s_loc_padding\\\": \\\"Épaisseur\\\",\\n  \\\"s_loc_page_name\\\": \\\"Nom de page\\\",\\n  \\\"s_loc_paste\\\": \\\"Coller\\\",\\n  \\\"s_loc_paste_formats\\\": \\\"Coller le formatage\\\",\\n  \\\"s_loc_plain_text\\\": \\\"Texte brut\\\",\\n  \\\"s_loc_recalc\\\": \\\"Recalculer\\\",\\n  \\\"s_loc_recalculation\\\": \\\"Recalcul\\\",\\n  \\\"s_loc_redo\\\": \\\"Rétablir\\\",\\n  \\\"s_loc_right\\\": \\\"Droite\\\",\\n  \\\"s_loc_right_border\\\": \\\"Bordure droite\\\",\\n  \\\"s_loc_sheet_settings\\\": \\\"PARAMÈTRES DE LA FEUILLE\\\",\\n  \\\"s_loc_save\\\": \\\"Enregistrer\\\",\\n  \\\"s_loc_save_to\\\": \\\"Enregistrer les paramètres de \\\",\\n  \\\"s_loc_set_cell_contents\\\": \\\"Importer le contenu dans la cellule\\\",\\n  \\\"s_loc_set_cells_to_sort\\\": \\\"Définir les cellules à trier\\\",\\n  \\\"s_loc_set_value_to\\\": \\\"Définir la valeur à\\\",\\n  \\\"s_loc_set_to_link_format\\\": \\\"Définir le format comme lien\\\",\\n  \\\"s_loc_setXclear_move_from\\\": \\\"Sélectionner/Nettoyer la zone à déplacer\\\",\\n  \\\"s_loc_show_cell_settings\\\": \\\"Afficher les paramètres des cellules\\\",\\n  \\\"s_loc_show_sheet_settings\\\": \\\"Afficher les paramètres de la feuille\\\",\\n  \\\"s_loc_show_in_new_browser_window\\\": \\\"Afficher dans une nouvelle fenêtre de votre navigateur\\\",\\n  \\\"s_loc_size\\\": \\\"Taille\\\",\\n  \\\"s_loc_socialcalcXsave_format\\\": \\\"Format de sauvegarde de Framacalc\\\",\\n  \\\"s_loc_sort\\\": \\\"Trier\\\",\\n  \\\"s_loc_sort_\\\": \\\"Trier \\\",\\n  \\\"s_loc_sort_cells\\\": \\\"Trier les cellules\\\",\\n  \\\"s_loc_swap_colors\\\": \\\"Permuter les couleurs\\\",\\n  \\\"s_loc_tabXdelimited_format\\\": \\\"Format délimité par des tabulations\\\",\\n  \\\"s_loc_text\\\": \\\"Texte\\\",\\n  \\\"s_loc_text_horizontal\\\": \\\"Texte horizontal\\\",\\n  \\\"s_loc_this_is_aXbrXsample\\\": \\\"Visualiser<br>le rendu\\\",\\n  \\\"s_loc_top\\\": \\\"Haut\\\",\\n  \\\"s_loc_top_border\\\": \\\"Bordure haute\\\",\\n  \\\"s_loc_undone_steps\\\": \\\"ANNULER DES ÉTAPES\\\",\\n  \\\"s_loc_url\\\": \\\"URL\\\",\\n  \\\"s_loc_undo\\\": \\\"Annuler\\\",\\n  \\\"s_loc_unlock\\\": \\\"Déverrouiller\\\",\\n  \\\"s_loc_unmerge_cells\\\": \\\"Défaire des cellules\\\",\\n  \\\"s_loc_up\\\": \\\"Haut\\\",\\n  \\\"s_loc_value\\\": \\\"Valeur\\\",\\n  \\\"s_loc_vertical\\\": \\\"Vertical\\\",\\n  \\\"s_loc_wikitext\\\": \\\"Wiki-texte\\\",\\n  \\\"s_loc_workspace\\\": \\\"Espace de travail\\\",\\n  \\\"s_loc_XnewX\\\": \\\"[Nouveau]\\\",\\n  \\\"s_loc_XnoneX\\\": \\\"[Aucun]\\\",\\n  \\\"s_loc_Xselect_rangeX\\\": \\\"[faites une sélection]\\\",\\n\\n\\\"\\\":\\\"The following constants are arrays of strings with the short (3 character) and full names of days and months\\\",\\n  \\\"s_FormatNumber_daynames\\\": [\\\"Dimanche\\\", \\\"Lundi\\\", \\\"Mardi\\\", \\\"Mercredi\\\", \\\"Jeudi\\\", \\\"Vendredi\\\", \\\"Samedi\\\"],\\n  \\\"s_FormatNumber_daynames3\\\": [\\\"Dim\\\", \\\"Lun\\\", \\\"Mar\\\", \\\"Mer\\\", \\\"Jeu\\\", \\\"Ven\\\", \\\"Sam\\\"],\\n  \\\"s_FormatNumber_monthnames\\\": [\\\"Janvier\\\", \\\"Février\\\", \\\"Mars\\\", \\\"Avril\\\", \\\"Mai\\\", \\\"Juin\\\", \\\"Juillet\\\", \\\"Août\\\", \\\"Septembre\\\", \\\"Octobre\\\", \\\"Novembre\\\", \\\"Décembre\\\"],\\n  \\\"s_FormatNumber_monthnames3\\\": [\\\"Jan\\\", \\\"Fev\\\", \\\"Mar\\\", \\\"Avr\\\", \\\"Mai\\\", \\\"Jun\\\", \\\"Jul\\\", \\\"Aou\\\", \\\"Sep\\\", \\\"Oct\\\", \\\"Nov\\\", \\\"Dec\\\"],\\n  \\\"s_FormatNumber_am\\\": \\\"AM\\\",\\n  \\\"s_FormatNumber_am1\\\": \\\"A\\\",\\n  \\\"s_FormatNumber_pm\\\": \\\"PM\\\",\\n  \\\"s_FormatNumber_pm1\\\": \\\"P\\\",\\n\\n\\\"\\\":\\\"\\\",\\n\\\"\\\":\\\"SocialCalc Spreadsheet Formula module, formula1.js:\\\",\\n\\\"\\\":\\\"\\\",\\n  \\\"s_parseerrexponent\\\": \\\"Nombre en exposant incorrect\\\",\\n  \\\"s_parseerrchar\\\": \\\"Caractère inattendu dans la formule\\\",\\n  \\\"s_parseerrstring\\\": \\\"Chaîne incorrecte\\\",\\n  \\\"s_parseerrspecialvalue\\\": \\\"Valeur spéciale incorrecte\\\",\\n  \\\"s_parseerrtwoops\\\": \\\"Erreur dans la formule (deux opérateurs inopportuns dans la chaîne)\\\",\\n  \\\"s_parseerrmissingopenparen\\\": \\\"Parenthèse ouvrante manquante dans la liste à virgule(s). \\\",\\n  \\\"s_parseerrcloseparennoopen\\\": \\\"Parenthèse fermante sans parenthèse ouvrante. \\\",\\n  \\\"s_parseerrmissingcloseparen\\\": \\\"Parenthèse fermante manquante. \\\",\\n  \\\"s_parseerrmissingoperand\\\": \\\"Opérande manquant. \\\",\\n  \\\"s_parseerrerrorinformula\\\": \\\"Erreur dans la formule.\\\",\\n  \\\"s_calcerrerrorvalueinformula\\\": \\\"Valeur erronée dans la formule\\\",\\n  \\\"s_parseerrerrorinformulabadval\\\": \\\"Erreur dans la formule créant une mauvaise valeur\\\",\\n  \\\"s_formularangeresult\\\": \\\"Formule résultante de la valeur sélectionnée :\\\",\\n  \\\"s_calcerrnumericnan\\\": \\\"Formule causant une mauvaise valeur numérique\\\",\\n  \\\"s_calcerrnumericoverflow\\\": \\\"Overflow numérique\\\",\\n  \\\"s_sheetunavailable\\\": \\\"Feuille indisponible :\\\",\\n  \\\"s_calcerrcellrefmissing\\\": \\\"Référence nécessaire manquante à une cellule.\\\",\\n  \\\"s_calcerrsheetnamemissing\\\": \\\"Nom de la feuille nécessaire manquante.\\\",\\n  \\\"s_circularnameref\\\": \\\"Nom à référence circulaire\\\",\\n  \\\"s_calcerrunknownname\\\": \\\"Nom inconnu\\\",\\n  \\\"s_calcerrincorrectargstofunction\\\": \\\"Argument de la fonction incorrect\\\",\\n  \\\"s_sheetfuncunknownfunction\\\": \\\"Fonction inconnue\\\",\\n  \\\"s_sheetfunclnarg\\\": \\\"L'argument de LN doit être plus grand que 0\\\",\\n  \\\"s_sheetfunclog10arg\\\": \\\"L'argument de LOG10 doit être plus grand que 0\\\",\\n  \\\"s_sheetfunclogsecondarg\\\": \\\"Le deuxième argument de LOG doit être une valeur numérique plus quande que 0\\\",\\n  \\\"s_sheetfunclogfirstarg\\\": \\\"Le premier argument de LOG doit être plus grand que 0\\\",\\n  \\\"s_sheetfuncroundsecondarg\\\": \\\"Le deuxième argument de ROUND doit être une valeur numérique\\\",\\n  \\\"s_sheetfuncddblife\\\": \\\"La vie dans DDB doit être plus grande que 1\\\",\\n  \\\"s_sheetfuncslnlife\\\": \\\"La vie dans SLN doit être plus grande que 1\\\",\\n\\n\\\"\\\":\\\"Function definition text\\\",\\n  \\\"s_fdef_ABS\\\": \\\"Fonction valeur absolue. \\\",\\n  \\\"s_fdef_ACOS\\\": \\\"Fonction trigonometrique arccosinus. \\\",\\n  \\\"s_fdef_AND\\\": \\\"Vrai si tous les arguments sont vrais. \\\",\\n  \\\"s_fdef_ASIN\\\": \\\"Fonction trigonométrique arcsinus. \\\",\\n  \\\"s_fdef_ATAN\\\": \\\"Fonction trigonométrique arctangente. \\\",\\n  \\\"s_fdef_ATAN2\\\": \\\"Fonction trigonométrique arctangente (le résultat est en radians). \\\",\\n  \\\"s_fdef_AVERAGE\\\": \\\"Moyenne des valeurs. \\\",\\n  \\\"s_fdef_CHOOSE\\\": \\\"Retourne la valeur spécifiée par l'index. Les valeurs doivent être sélectionnées. \\\",\\n  \\\"s_fdef_COLUMNS\\\": \\\"Retourne le nombre de colonnes de la sélection. \\\",\\n  \\\"s_fdef_COS\\\": \\\"Fonction trigonométrique cosinus (la valeur est en radians). \\\",\\n  \\\"s_fdef_COUNT\\\": \\\"Compte le nombre de valeurs numériques, pas les blancs, ni les textes, ni les erreurs. \\\",\\n  \\\"s_fdef_COUNTA\\\": \\\"Compte le nombre de valeurs non-vides. \\\",\\n  \\\"s_fdef_COUNTBLANK\\\": \\\"Compte le nombre de blancs. (Note: \\\\\\\"\\\\\\\" n'est pas un blanc.) \\\",\\n  \\\"s_fdef_COUNTIF\\\": \\\"Compte le nombre de cellules dans la sélection qui vérifient la condition. Le critère doit être une valeur (\\\\\\\"x\\\\\\\", 15, 1+3) ou un test (>25). \\\",\\n  \\\"s_fdef_DATE\\\": \\\"Retourne la date appropriée étant donné les nombres de l'année du mois et du jour. Par exemple : DATE(2006,2,1) pour le 1er février 2006. Note : Dans ce programme, le jour \\\\\\\"1\\\\\\\" est le 31 décembre 1899 et l'année 1900 n'est pas une année sautée. Certains programmes utilisent le 1er janvier 1900, comme le jour \\\\\\\"1\\\\\\\" et sautent l'année 1900. Mais dans les deux cas, les dates après le 1er mars 1900 sont les mêmes. \\\",\\n  \\\"s_fdef_DAVERAGE\\\": \\\"Calcule la moyenne des champs spécifiés qui satisfont le critère. \\\",\\n  \\\"s_fdef_DAY\\\": \\\"Retourne le jour de la semaine d'une date donnée. \\\",\\n  \\\"s_fdef_DCOUNT\\\": \\\"Compte le nombre de valeurs numériques, pas les blancs, ni le texte, ni les erreurs, dans les champs spécifiés qui satisfont le critère. \\\",\\n  \\\"s_fdef_DCOUNTA\\\": \\\"Compte le nombre de valeurs non-vides dans les champs spécifiés qui satisfont le critère. \\\",\\n  \\\"s_fdef_DDB\\\": \\\"Retourne la valeur de la dépréciation sur la période donnée (le facteur par défaut est 2 pour un équilibre à double décroissance).   \\\",\\n  \\\"s_fdef_DEGREES\\\": \\\"Convertit une valeur de radians en degrés. \\\",\\n  \\\"s_fdef_DGET\\\": \\\"Retourne la valeur du champ spécifié dans une seule entrée qui satisfait le critère. \\\",\\n  \\\"s_fdef_DMAX\\\": \\\"Retourne le maximum des valeurs numériques dans les champs spécifiés qui satisfont le critère. \\\",\\n  \\\"s_fdef_DMIN\\\": \\\"Retourne le minimun des valeurs numériques dans les champs spécifiés qui satisfont le critère. \\\",\\n  \\\"s_fdef_DPRODUCT\\\": \\\"Retourne le résultat de la multiplication des valeurs numériques dans les champs spécifiés qui satisfont le critère. \\\",\\n  \\\"s_fdef_DSTDEV\\\": \\\"Retourne l'écart-type d'une population des valeurs numériques spécifiées qui satisfont le critère. \\\",\\n  \\\"s_fdef_DSTDEVP\\\": \\\"Retourne l'écart-type des valeurs numériques spécifiées qui satisfont le critère. \\\",\\n  \\\"s_fdef_DSUM\\\": \\\"Retourne la somme des valeurs numériques dans les champs spécifiés qui satisfont le critère. \\\",\\n  \\\"s_fdef_DVAR\\\": \\\"Retourne la variance d'une population des valeurs numériques dans les champs spécifiés qui satisfont le critère. \\\",\\n  \\\"s_fdef_DVARP\\\": \\\"Retourne la variance des valeurs numériques dans les champs spécifiés qui satisfont le critère. \\\",\\n  \\\"s_fdef_EVEN\\\": \\\"Arrondit supérieurement la valeur à l'entier le plus proche. \\\",\\n  \\\"s_fdef_EXACT\\\": \\\"Retourne \\\\\\\"true\\\\\\\" si les valeurs sont exactement les mêmes, incluant la case, le type, etc. \\\",\\n  \\\"s_fdef_EXP\\\": \\\"Retourne e élevé à la puissance spécifiée. \\\",\\n  \\\"s_fdef_FACT\\\": \\\"Retourne la factorielle de la valeur. \\\",\\n  \\\"s_fdef_FALSE\\\": \\\"Retourne la valeur logique \\\\\\\"false\\\\\\\". \\\",\\n  \\\"s_fdef_FIND\\\": \\\"Retourne la position de départ de la première occurence de chaîne1 dans la chaîne chaîne2, après la position \\\\\\\"start\\\\\\\". Si \\\\\\\"start\\\\\\\" est omis, sa valeur est 1. \\\",\\n  \\\"s_fdef_FV\\\": \\\"Retourne la valeur future des paiements itérés d'un montant investi à un taux donné pour un nombre spécifié de périodes, avec comme option facultative la valeur présente (0 par défaut) et le type de paiement (par défaut 0 = à la fin de la période, 1 = au début de la période). \\\",\\n  \\\"s_fdef_HLOOKUP\\\": \\\"Cherche la valeur assortie à la valeur donnée dans la sélection et retourne la valeur correpondante dans la cellule spécifiée par la ligne de compensation. Si l'option sélection-de-recherche est égale à 1 (par défaut) et non 0, cherche une correspondance dans une fourchette numérique (valeur associée<=valeur) au lieu d'une correspondance exacte. \\\",\\n  \\\"s_fdef_HOUR\\\": \\\"Retourne la partie des heures dans une valeur temporelle ou d'une date et d'un horaire. \\\",\\n  \\\"s_fdef_IF\\\": \\\"Effectue le résultat associé à vrai si l'expression logique est \\\\\\\"TRUE\\\\\\\" ou non-nulle, sinon effectue le résultat associé à la valeur fausse. \\\",\\n  \\\"s_fdef_INDEX\\\": \\\"Retourne une cellule ou une sélection de référence pour une ligne et une colonne dans cette plage. Si cette plage est de dimension 1, alors seul le numéro de colonne, ou de ligne, est nécessaire. Si elle est à 2 dimensions et que le numéro de ligne ou de colonne est égal à zéro, la référence retournée contient juste la colonne ou la ligne spécifiée. Vous pouvez utiliser la référence retournée dans la syntaxe d'une plage, comme par exemple dans sum(A1:INDEX(A2:A10,4)). \\\",\\n  \\\"s_fdef_INT\\\": \\\"Arrondit inférieurement la valeur à l'entier le plus proche (vers -infini). \\\",\\n  \\\"s_fdef_IRR\\\": \\\"Retourne le taux d'intérêt auquel le flux d'argent a une valeur nette nulle. Utilise un processus itératif qui retournera une erreur #NUM! si le résultat ne converge pas. Il peut y avoir plus d'une seule possibilité. Fournir une estimation optionnelle peut aider dans certaines situations où il n'y a pas de convergence ou s'il trouve une solution inadaptée (l'estimation par défaut est de 10%). \\\",\\n  \\\"s_fdef_ISBLANK\\\": \\\"Retourne \\\\\\\"true\\\\\\\" si la valeur est une référence à une cellule vide. \\\",\\n  \\\"s_fdef_ISERR\\\": \\\"Retourne \\\\\\\"true\\\\\\\" si la valeur est une référence à une cellule vide of type \\\\\\\"Error\\\\\\\" but not \\\\\\\"NA\\\\\\\". \\\",\\n  \\\"s_fdef_ISERROR\\\": \\\"Retourne \\\\\\\"true\\\\\\\" si la valeur est de type \\\\\\\"Erreur\\\\\\\". \\\",\\n  \\\"s_fdef_ISLOGICAL\\\": \\\"Retourne \\\\\\\"true\\\\\\\" si la valeur est de type logique (\\\\\\\"Logical\\\\\\\") (vrai/faux). \\\",\\n  \\\"s_fdef_ISNA\\\": \\\"Retourne \\\\\\\"true\\\\\\\" si la valeur est une erreur \\\\\\\"NA\\\\\\\". \\\",\\n  \\\"s_fdef_ISNONTEXT\\\": \\\"Retourne \\\\\\\"true\\\\\\\" si la valeur n'est pas de type \\\\\\\"Text\\\\\\\". \\\",\\n  \\\"s_fdef_ISNUMBER\\\": \\\"Retourne \\\\\\\"true\\\\\\\" si la valeur est de type \\\\\\\"nombre\\\\\\\" (incluant les valeurs logiques). \\\",\\n  \\\"s_fdef_ISTEXT\\\": \\\"Retourne \\\\\\\"true\\\\\\\" si la valeur est de type \\\\\\\"Texte\\\\\\\". \\\",\\n  \\\"s_fdef_LEFT\\\": \\\"Retourne le nombre spécifié de caractères d'une chaîne de texte. Si le nombre est omis, sa valeur est 1. \\\",\\n  \\\"s_fdef_LEN\\\": \\\"Retourne le nombre de caractères d'une chaîne de texte. \\\",\\n  \\\"s_fdef_LN\\\": \\\"Retourne le logarithme naturel d'une valeur spécifiée. \\\",\\n  \\\"s_fdef_LOG\\\": \\\"Retourne le logarithme d'une valeur en utilisant une base spécifiée. \\\",\\n  \\\"s_fdef_LOG10\\\": \\\"Retourne le logarithme en base 10 d'une valeur spécifiée. \\\",\\n  \\\"s_fdef_LOWER\\\": \\\"Retourne la chaîne de texte avec toutes les majuscules converties en minuscules. \\\",\\n  \\\"s_fdef_MATCH\\\": \\\"Cherche la valeur assortie à la valeur donnée dans la sélection et retourne la position (la première est 1) dans cette plage. Si l'option sélection-de-recherche est égale à 1 (par défaut) et non 0, cherche une correspondance dans une fouchette numérique (valeur associée<=valeur) au lieu d'une correspondance exacte. Si sélection-de-recherche est égal à -1, agit comme 1 mais avec la fourchette comme valeur associée>=valeur. \\\",\\n  \\\"s_fdef_MAX\\\": \\\"Retourne le maximum des valeurs numériques spécifiées. \\\",\\n  \\\"s_fdef_MID\\\": \\\"Retourne le nombre de caractère d'une chaîne de texte en commençant à la position spécifiée. \\\",\\n  \\\"s_fdef_MIN\\\": \\\"Retourne le minimum des valeurs numériques spécifiées. \\\",\\n  \\\"s_fdef_MINUTE\\\": \\\"Retourne la partie des minutes dans une valeur temporelle ou d'une date et d'un horaire. \\\",\\n  \\\"s_fdef_MOD\\\": \\\"Retourne le reste d'une division (euclidienne) d'une première valeur par une autre. \\\",\\n  \\\"s_fdef_MONTH\\\": \\\"Retourne la partie du mois d'une date. \\\",\\n  \\\"s_fdef_N\\\": \\\"Retourne la valeur si elle est numérique, sinon retourne une erreur. \\\",\\n  \\\"s_fdef_NA\\\": \\\"Retourne l'erreur #N/A qui se propage au travers de la plupart des opérations. \\\",\\n  \\\"s_fdef_NOT\\\": \\\"Retourne \\\\\\\"FALSE\\\\\\\" si la valeur est \\\\\\\"true\\\\\\\", et \\\\\\\"TRUE\\\\\\\" si la valeur est \\\\\\\"false\\\\\\\". \\\",\\n  \\\"s_fdef_NOW\\\": \\\"Retoune la date et l'heure actuelles. \\\",\\n  \\\"s_fdef_NPER\\\": \\\"Retourne le nombre de périodes nécessaire pour avoir la valeur actuelle, avec des paiements investis à chaque période à un taux d'intérêt donné. On peut spécifier la valeur future (0 par défaut) et le type de paiement (par défaut 0 = à la fin de la période, 1 = au début de la période). \\\",\\n  \\\"s_fdef_NPV\\\": \\\"Retourne la valeur nette actuelle d'un flux de paiements (qui peuvent être des valeurs individuelles et/ou des plages de données) à un taux d'intérêt donné. Les flux sont positifs dans le cas d'un revenu, négatif s'il s'agit d'une dépense, et pris en compte à la fin de chaque période. \\\",\\n  \\\"s_fdef_ODD\\\": \\\"Arrondit la valeur à l'entier impair le plus proche. \\\",\\n  \\\"s_fdef_OR\\\": \\\"Vrai si au moins un élément est vrai \\\",\\n  \\\"s_fdef_PI\\\": \\\"La valeur 3.1415926… \\\",\\n  \\\"s_fdef_PMT\\\": \\\"Retourne le montant de chaque paiement qui doit être investi à un taux donné pour un nombre spécifié de périodes afin d'avoir la valeur actuelle donnée, avec la valeur future optionnelle (0 par défaut) et le type de paiement (par défaut 0 = à la fin de la période, 1 = au début de la période). \\\",\\n  \\\"s_fdef_POWER\\\": \\\"Retourne la première valeur mise à la puissance de la seconde valeur. \\\",\\n  \\\"s_fdef_PRODUCT\\\": \\\"Retourne le résultat de la multiplication des valeurs numériques spécifiées. \\\",\\n  \\\"s_fdef_PROPER\\\": \\\"Retourne la chaîne de texte avec la première lettre de chaque mot convertie en majuscule, et les autres en minuscules. \\\",\\n  \\\"s_fdef_PV\\\": \\\"Retourne la valeur actuelle d'un nombre donné de paiements chacuns investis à un taux spécifié, avec la valeur future optionnelle (0 par défaut) et le type de paiement (par défaut 0 = à la fin de la période, 1 = au début de la période). \\\",\\n  \\\"s_fdef_RADIANS\\\": \\\"Convertit une valeur de degrès en radians. \\\",\\n  \\\"s_fdef_RATE\\\": \\\"Retourne le taux d'intérêt auquel un nombre donné de paiements, chacuns investis à un taux spécifié, ont les valeurs actuelles données, avec la valeur future optionnelle (0 par défaut) et le type de paiement (par défaut 0 = à la fin de la période, 1 = au début de la période). Utilise un processus itératif qui retournera une erreur #NUM! si le résultat ne converge pas. Il peut y avoir plus d'une seule possibilité. Fournir une estimation optionnelle peut aider dans certaines situations où il n'y a pas de convergence ou s'il trouve une solution inadaptée (l'estimation par défaut est de 10%). \\\",\\n  \\\"s_fdef_REPLACE\\\": \\\"Retourne texte1 avec le nombre de caractères spécifiés remplacés par texte2, à partir de la position de départ. \\\",\\n  \\\"s_fdef_REPT\\\": \\\"Retourne le texte répété le nombre de fois définis. \\\",\\n  \\\"s_fdef_RIGHT\\\": \\\"Retourne le nombre de caractères d'une chaîne de texte en partant de la fin. Si compte est omis, la valeur 1 est prise en compte. \\\",\\n  \\\"s_fdef_ROUND\\\": \\\"Arrondit au nombre de décimales spécifiées. Si la précision est négative, arrondit alors aux puissances de 10. La précision par défaut est 0 (arrondit à l'entier). \\\",\\n  \\\"s_fdef_ROWS\\\": \\\"Retourne le nombre de lignes de la sélection. \\\",\\n  \\\"s_fdef_SECOND\\\": \\\"Retourne la deuxième partie d'une heure ou d'une date et d'un horaire (tronquée à un entier). \\\",\\n  \\\"s_fdef_SIN\\\": \\\"Fonction trigonometrique sinus (la valeur est en radians) \\\",\\n  \\\"s_fdef_SLN\\\": \\\"Retourne le montant de l'amortissement à chaque période en utilisant la méthode constante. \\\",\\n  \\\"s_fdef_SQRT\\\": \\\"Racine carrée de la valeur \\\",\\n  \\\"s_fdef_STDEV\\\": \\\"Retourne l'écart-type d'une population des valeurs numériques spécifiées. \\\",\\n  \\\"s_fdef_STDEVP\\\": \\\"Retourne l'écart-type des valeurs numériques spécifiées. \\\",\\n  \\\"s_fdef_SUBSTITUTE\\\": \\\"Retourne \\\\\\\"texte1\\\\\\\" avec toutes les occurences de \\\\\\\"vieux-texte\\\\\\\" remplacées par \\\\\\\"nouveau-texte\\\\\\\". Si l'option \\\\\\\"occurrence\\\\\\\" est spécifiée, alors seulement cette occurrence est remplacée. \\\",\\n  \\\"s_fdef_SUM\\\": \\\"Additionne les valeurs numériques. Les valeurs à sommer doivent être de la forme A1:B5. \\\",\\n  \\\"s_fdef_SUMIF\\\": \\\"Additionne les valeurs numériques des cellules qui satisfont le critère. Le critère doit être une valeur (\\\\\\\"x\\\\\\\", 15, 1+3) ou un test (>25). Si sélection2 n'est pas vide, alors sélection1 sert de test et la valeur correspondante dans sélection2 est sommée. \\\",\\n  \\\"s_fdef_SYD\\\": \\\"Amortissement par la méthode de la somme des chiffres de chaque année. \\\",\\n  \\\"s_fdef_T\\\": \\\"Retourne la valeur si c'est une chaîne de texte, sinon retourne une chaîne nulle. \\\",\\n  \\\"s_fdef_TAN\\\": \\\"Fonction trigonometrique tangente (la valeur est en radians) \\\",\\n  \\\"s_fdef_TIME\\\": \\\"Retourne l'heure donnée par l'heure, la minute et la seconde spécifiées. \\\",\\n  \\\"s_fdef_TODAY\\\": \\\"Retourne la date actuelle (en tant qu'entier). Note : Dans ce programme, le jour \\\\\\\"1\\\\\\\" est le 31 décembre 1899 et l'année 1900 n'est pas une année sautée. Certains programmes utilisent le 1er janvier 1900, comme le jour \\\\\\\"1\\\\\\\" et sautent l'année 1900. Mais dans les deux cas, les dates après le 1er mars 1900 sont les mêmes. \\\",\\n  \\\"s_fdef_TRIM\\\": \\\"Retourne la chaîne de texte avec les espaces répétés, de début et de fin supprimés. \\\",\\n  \\\"s_fdef_TRUE\\\": \\\"Retourne la valeur logique \\\\\\\"true\\\\\\\". \\\",\\n  \\\"s_fdef_TRUNC\\\": \\\"Tronque la valeur du nombre spécifié decimal places. Si la precision est négative, tronque aux puissances de 10. \\\",\\n  \\\"s_fdef_UPPER\\\": \\\"Retourne la chaîne de texte avec toutes les minuscules converties en majuscules. \\\",\\n  \\\"s_fdef_VALUE\\\": \\\"Convertit la chaîne de texte donnée en valeur numérique. De nombreuses formes qui ressemblent à des nombres (incluant des chiffres suivis de %, formes ressemblant à des dates, etc.) sont supportées. Cette fonction peut ne pas supporter toutes les formes acceptées par d'autres tableurs et des syntaxes non-anglophones. \\\",\\n  \\\"s_fdef_VAR\\\": \\\"Retourne la variance d'une population des valeurs numériques spécifiées. \\\",\\n  \\\"s_fdef_VARP\\\": \\\"Retourne la variance des valeurs numériques spécifiées. \\\",\\n  \\\"s_fdef_VLOOKUP\\\": \\\"Cherche la valeur assortie à la valeur donnée dans la sélection et retourne la valeur correpondante dans la cellule spécifiée par la colonne de compensation. Si l'option sélection-de-recherche est égale à 1 (par défaut) et non 0, cherche une correspondance dans une fouchette numérique (valeur associée<=valeur) au lieu d'une correspondance exacte. \\\",\\n  \\\"s_fdef_WEEKDAY\\\": \\\"Retourne le jour de la semaine de la date spécifiée. Si le type est égal à 1 (par défaut), le jour 1 est le dimanche et le samedi est le jour 7. Si le type est égal à 2, le lundi est le jour 1 et le dimanche est le jour 7. Si le type est 3, le lundi est le jour 0 et le dimanche est le jour 6. \\\",\\n  \\\"s_fdef_YEAR\\\": \\\"Retourne l'année d'une date entière. \\\",\\n  \\\"s_fdef_SUMPRODUCT\\\": \\\"Additionne les produits en regards de 2 plages de données ou plus. Les plages de données doivent être de même taille.\\\",\\n  \\\"s_fdef_CEILING\\\": \\\"Arrondi le nombre fourni au plus proche entier ou magnitude supérieur. La magnitude est le multiple (ou sous-multiple) de 10 supérieur auquel le nombre doit être arrondi (.01, .1, 1, 10, etc.)\\\",\\n  \\\"s_fdef_FLOOR\\\": \\\"Arrondi le nombre fourni au plus proche entier ou magnitude. La magnitude est le multiple (ou sous-multiple) de 10 auquel le nombre doit être arrondie (.01, .1, 1, 10, etc.)\\\",\\n\\n  \\\"s_farg_v\\\": \\\"valeur\\\",\\n  \\\"s_farg_vn\\\": \\\"valeur1, valeur2, …\\\",\\n  \\\"s_farg_xy\\\": \\\"valeur, valeur\\\",\\n  \\\"s_farg_choose\\\": \\\"index, valeur1, valeur2, …\\\",\\n  \\\"s_farg_range\\\": \\\"sélection\\\",\\n  \\\"s_farg_rangec\\\": \\\"sélection, critère\\\",\\n  \\\"s_farg_date\\\": \\\"année, mois, jour\\\",\\n  \\\"s_farg_dfunc\\\": \\\"base-de-données-de-la-plage, nom-du-champ, critère-de-sélection\\\",\\n  \\\"s_farg_ddb\\\": \\\"coût, amortissement, durée-de-vie, période [, facteur]\\\",\\n  \\\"s_farg_find\\\": \\\"chaîne1, chaîne2 [, début]\\\",\\n  \\\"s_farg_fv\\\": \\\"taux, n, paiement, [pv, [type-de-paiement]]\\\",\\n  \\\"s_farg_hlookup\\\": \\\"valeur, sélection, ligne, [sélection-de-recherche]\\\",\\n  \\\"s_farg_iffunc\\\": \\\"expression-logique, vraie-valeur, fausse-valeur\\\",\\n  \\\"s_farg_index\\\": \\\"sélection, numéro-de-ligne, numéro-de-colonne\\\",\\n  \\\"s_farg_irr\\\": \\\"sélection, [estimation]\\\",\\n  \\\"s_farg_tc\\\": \\\"texte, compte\\\",\\n  \\\"s_farg_log\\\": \\\"valeur, base\\\",\\n  \\\"s_farg_match\\\": \\\"valeur, sélection, [sélection-de-recherche]\\\",\\n  \\\"s_farg_mid\\\": \\\"texte, début, longueur\\\",\\n  \\\"s_farg_nper\\\": \\\"taux, paiement, pv, [fv, [type-de-paiement]]\\\",\\n  \\\"s_farg_npv\\\": \\\"taux, valeur1, valeur2, …\\\",\\n  \\\"s_farg_pmt\\\": \\\"taux, n, pv, [fv, [type-de-paiement]]\\\",\\n  \\\"s_farg_pv\\\": \\\"taux, n, paiement, [fv, [type-de-paiement]]\\\",\\n  \\\"s_farg_rate\\\": \\\"n, paiement, pv, [fv, [type-de-paiement, [estimation]]]\\\",\\n  \\\"s_farg_replace\\\": \\\"texte1, début, longueur, texte2\\\",\\n  \\\"s_farg_vp\\\": \\\"valeur, [précision]\\\",\\n  \\\"s_farg_valpre\\\": \\\"valeur, precision\\\",\\n  \\\"s_farg_csl\\\": \\\"coût, récupération, durée-de-vie\\\",\\n  \\\"s_farg_cslp\\\": \\\"coût, récupération, durée-de-vie, periode\\\",\\n  \\\"s_farg_subs\\\": \\\"texte1, vieux-texte, nouveau-texte [, occurrence]\\\",\\n  \\\"s_farg_sumif\\\": \\\"sélection1, critère [, sélection2]\\\",\\n  \\\"s_farg_hms\\\": \\\"heure, minute, seconde\\\",\\n  \\\"s_farg_txt\\\": \\\"texte\\\",\\n  \\\"s_farg_vlookup\\\": \\\"valeur, sélection, colonne, [sélection-de-recherche]\\\",\\n  \\\"s_farg_weekday\\\": \\\"date, [type]\\\",\\n  \\\"s_farg_dt\\\": \\\"date\\\",\\n  \\\"s_farg_rangen\\\": \\\"sélection1, sélection2, ...\\\",\\n  \\\"s_farg_vsig\\\": \\\"valeur, [magnitude]\\\",\\n\\n  \\\"function_classlist\\\": [\\\"all\\\", \\\"stat\\\", \\\"lookup\\\", \\\"datetime\\\", \\\"financial\\\", \\\"test\\\", \\\"math\\\", \\\"text\\\"],\\n\\n  \\\"s_fclass_all\\\": \\\"Tout\\\",\\n  \\\"s_fclass_stat\\\": \\\"Statistiques\\\",\\n  \\\"s_fclass_lookup\\\": \\\"Recherche\\\",\\n  \\\"s_fclass_datetime\\\": \\\"Date et heure\\\",\\n  \\\"s_fclass_financial\\\": \\\"Financier\\\",\\n  \\\"s_fclass_test\\\": \\\"Test\\\",\\n  \\\"s_fclass_math\\\": \\\"Maths\\\",\\n  \\\"s_fclass_text\\\": \\\"Texte\\\",\\n\\n\\\"\\\":\\\"Graph tab\\\",\\n  \\\"s_loc_plain\\\": \\\"Plein\\\",\\n  \\\"s_loc_graph\\\": \\\"Graphique\\\",\\n  \\\"s_loc_cells_to_graph\\\": \\\"Cellules à tracer\\\",\\n  \\\"s_loc_set_cells_to_graph\\\": \\\"Paramétrer les cellules à tracer\\\",\\n  \\\"s_loc_graph_type\\\": \\\"Type de graphique\\\",\\n  \\\"s_loc_help\\\": \\\"Aide\\\",\\n  \\\"s_loc_horizontal_bar\\\": \\\"Histogramme horizontal\\\",\\n  \\\"s_loc_vertical_bar\\\": \\\"Histogramme vertical\\\",\\n  \\\"s_loc_pie_chart\\\": \\\"Diagramme circulaire (camenbert)\\\",\\n  \\\"s_loc_line_chart\\\": \\\"Ligne\\\",\\n  \\\"s_loc_scatter_chart\\\": \\\"Nuage de points\\\",\\n  \\\"s_loc_not_set\\\": \\\"Non défini\\\",\\n  \\\"s_loc_unknown_range_name\\\": \\\"Nom de sélection inconnu\\\",\\n  \\\"s_loc_hide_help\\\": \\\"Cacher l'aide\\\",\\n  \\\"s_loc_x\\\": \\\"X\\\",\\n  \\\"s_loc_y\\\": \\\"Y\\\",\\n  \\\"s_loc_max\\\": \\\"Max\\\",\\n  \\\"s_loc_min\\\": \\\"Min\\\",\\n  \\\"s_loc_Xselect_rangeX\\\": \\\"[Sélection]\\\",\\n  \\\"s_loc_graph_view\\\": \\\"Graph View\\\",\\n  \\\"s_GraphRangeNotSelected\\\": \\\"Choisissez une plage de cellules de valeurs numériques, puis utilisez le bouton OK ci-dessus pour sélectionner cette plage comme celle à tracer.\\\",\\n\\n  \\\"s_graph_error_selection\\\": \\\"<b>Erreur de sélection</b>.<br>Vous devez sélectionner des cellules au sein d'une même ligne ou colonne !\\\",\\n  \\\"s_graph_help_intro\\\": \\\"Ceci est l'aide pour le type de graphique: \\\",\\n  \\\"s_graph_VerticalBar_help\\\": \\\"L'onglet <b>Graphique</b> affiche un histogramme vertical des cellules sélectionnées (dans une seule ligne ou colonne). Si la ligne au-dessus (ou la colonne à gauche) de la sélection a des valeurs, celles-ci sont utilisées comme labels. Sinon ce sont les coordonnées de cellule qui sont utilisées (par exemple : B5).\\\",\\n  \\\"s_graph_HorizontalBar_help\\\": \\\"L'onglet <b>Graphique</b> affiche un histogramme horizontal des cellules sélectionnées (dans une seule ligne ou colonne). Si la ligne au-dessus (ou la colonne à gauche) de la sélection a des valeurs, celles-ci sont utilisées comme labels. Sinon ce sont les coordonnées de cellule qui sont utilisées (par exemple : B5).\\\",\\n  \\\"s_graph_PieChart_help\\\": \\\"L'onglet <b>Graphique</b> affiche un diagramme circulaire (camembert) des cellules sélectionnées (dans une seule ligne ou colonne). Si la ligne au-dessus (ou la colonne à gauche) de la sélection a des valeurs, celles-ci sont utilisées comme labels. Sinon ce sont les coordonnées de cellule qui sont utilisées (par exemple : B5).\\\",\\n  \\\"s_graph_PieChart_error_selection\\\": \\\"<b>Erreur de sélection</b>.<br>Vous ne devez sélectionner que des cellules ayant des valeurs positives !\\\",\\n  \\\"s_graph_LineChart_help\\\": \\\"L'onglet <b>Graphique</b> affiche une ligne ou profile XY des cellules sélectionnées (dans une seule ligne ou colonne). La ligne au-dessus (ou la colonne à gauche) de la sélection est utilisée comme coordonnée X.\\\",\\n  \\\"s_graph_ScatterChart_help\\\": \\\"L'onglet <b>Graphique</b> affiche un nuage de point ou profile discret XY des cellules sélectionnées (dans une seule ligne ou colonne). La ligne au-dessus (ou la colonne à gauche) de la sélection est utilisée comme coordonnée X. Si la ligne en-dessous (ou la colonne à droite) de la sélection a des valeurs, celles-ci sont interprétées comme une dimension appliquée aux points\\\",\\n\\n\\\"\\\":\\\"Clipboard tab\\\",\\n  \\\"s_loc_to\\\": \\\"vers\\\",\\n  \\\"s_loc_tiddler\\\": \\\"Tiddler\\\",\\n  \\\"s_loc_import\\\": \\\"Import\\\",\\n  \\\"s_loc_export\\\": \\\"Export\\\",\\n  \\\"s_loc_XclipboardX\\\": \\\"[Presse-papier]\\\",\\n  \\\"s_clipboard_menu_title\\\": \\\"Import/Export<br> et Presse-papier\\\",\\n  \\\"s_clipboard_export_error_tiddler_exists\\\": \\\"Le Tiddler existe déjà\\\",\\n  \\\"s_clipboard_export_error_tiddler_overwrite\\\": \\\"Voulez-vous le remplacer ?\\\",\\n  \\\"s_clipboard_import_error_tiddler_format\\\": \\\"Erreur de format: le champ \\\\\\\"format\\\\\\\" du Tiddler a une valeur incorrecte.\\\",\\n\\n\\\"\\\":\\\"Save sheet to tiddler\\\",\\n  \\\"s_loc_save_changes\\\": \\\"Sauvegarder\\\",\\n  \\\"s_notification_tiddler\\\": \\\"La feuille de calcul ~SocialCalc a été sauvegardée\\\",\\n\\n\\\"\\\":\\\"\\\"\\n}\\n\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Languages/fr-FR--save-notification\": {\n            \"title\": \"$:/plugins/rboue/SocialCalc/Languages/fr-FR--save-notification\",\n            \"text\": \"La feuille de calcul ~SocialCalc a été sauvegardée\\n\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/socialcalc-min.js\": {\n            \"type\": \"application/javascript\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/socialcalc-min.js\",\n            \"module-type\": \"library\",\n            \"text\": \"(function(){\\nvar SocialCalc;SocialCalc||(SocialCalc={});\\nSocialCalc.Constants={textdatadefaulttype:\\\"t\\\",s_BrowserNotSupported:\\\"Browser not supported.\\\",s_InternalError:\\\"Internal SocialCalc error (probably an internal bug): \\\",s_pssUnknownColType:\\\"Unknown col type item\\\",s_pssUnknownRowType:\\\"Unknown row type item\\\",s_pssUnknownLineType:\\\"Unknown line type\\\",s_cfspUnknownCellType:\\\"Unknown cell type item\\\",doCanonicalizeSheet:!0,s_escUnknownSheetCmd:\\\"Unknown sheet command: \\\",s_escUnknownSetCoordCmd:\\\"Unknown set coord command: \\\",s_escUnknownCmd:\\\"Unknown command: \\\",\\ns_caccCircRef:\\\"Circular reference to \\\",defaultRowNameWidth:\\\"30\\\",defaultAssumedRowHeight:15,defaultCellIDPrefix:\\\"cell_\\\",defaultCellLayout:\\\"padding:2px 2px 1px 2px;vertical-align:top;\\\",defaultCellFontStyle:\\\"normal normal\\\",defaultCellFontSize:\\\"small\\\",defaultCellFontFamily:\\\"Verdana,Arial,Helvetica,sans-serif\\\",defaultPaneDividerWidth:\\\"2\\\",defaultPaneDividerHeight:\\\"3\\\",defaultGridCSS:\\\"1px solid #C0C0C0;\\\",defaultCommentClass:\\\"\\\",defaultCommentStyle:\\\"background-repeat:no-repeat;background-position:top right;background-image:url(images/sc-commentbg.gif);\\\",\\ndefaultCommentNoGridClass:\\\"\\\",defaultCommentNoGridStyle:\\\"\\\",defaultReadonlyClass:\\\"\\\",defaultReadonlyStyle:\\\"background-repeat:no-repeat;background-position:top right;background-image:url(images/sc-lockbg.gif);\\\",defaultReadonlyNoGridClass:\\\"\\\",defaultReadonlyNoGridStyle:\\\"\\\",defaultReadonlyComment:\\\"Locked cell\\\",defaultColWidth:\\\"80\\\",defaultMinimumColWidth:10,defaultHighlightTypeCursorClass:\\\"\\\",defaultHighlightTypeCursorStyle:\\\"color:#FFF;backgroundColor:#A6A6A6;\\\",defaultHighlightTypeRangeClass:\\\"\\\",defaultHighlightTypeRangeStyle:\\\"color:#000;backgroundColor:#E5E5E5;\\\",\\ndefaultColnameClass:\\\"\\\",defaultColnameStyle:\\\"font-size:small;text-align:center;color:#FFFFFF;background-color:#808080;cursor:e-resize;\\\",defaultSelectedColnameClass:\\\"\\\",defaultSelectedColnameStyle:\\\"font-size:small;text-align:center;color:#FFFFFF;background-color:#404040;cursor:e-resize;\\\",defaultRownameClass:\\\"\\\",defaultRownameStyle:\\\"font-size:small;text-align:right;color:#FFFFFF;background-color:#808080;direction:rtl;\\\",defaultSelectedRownameClass:\\\"\\\",defaultSelectedRownameStyle:\\\"font-size:small;text-align:right;color:#FFFFFF;background-color:#404040;\\\",\\ndefaultUpperLeftClass:\\\"\\\",defaultUpperLeftStyle:\\\"font-size:small;\\\",defaultSkippedCellClass:\\\"\\\",defaultSkippedCellStyle:\\\"font-size:small;background-color:#CCC\\\",defaultPaneDividerClass:\\\"\\\",defaultPaneDividerStyle:\\\"font-size:small;background-color:#C0C0C0;padding:0px;\\\",defaultUnhideLeftClass:\\\"\\\",defaultUnhideLeftStyle:\\\"float:right;width:9px;height:12px;cursor:pointer;background-image:url(images/sc-unhideleft.gif);padding:0;\\\",defaultUnhideRightClass:\\\"\\\",defaultUnhideRightStyle:\\\"float:left;width:9px;height:12px;cursor:pointer;background-image:url(images/sc-unhideright.gif);padding:0;\\\",\\ndefaultUnhideTopClass:\\\"\\\",defaultUnhideTopStyle:\\\"float:left;position:absolute;bottom:-4px;width:12px;height:9px;cursor:pointer;background-image:url(images/sc-unhidetop.gif);padding:0;\\\",defaultUnhideBottomClass:\\\"\\\",defaultUnhideBottomStyle:\\\"float:left;width:12px;height:9px;cursor:pointer;background-image:url(images/sc-unhidebottom.gif);padding:0;\\\",s_rcMissingSheet:\\\"Render Context must have a sheet object\\\",defaultLinkFormatString:'<span style=\\\"font-size:smaller;text-decoration:none !important;background-color:#66B;color:#FFF;\\\">Link</span>',\\ndefaultPageLinkFormatString:'<span style=\\\"font-size:smaller;text-decoration:none !important;background-color:#66B;color:#FFF;\\\">Page</span>',defaultTiddlerLinkFormatString:'<span style=\\\"font-size:smaller;text-decoration:none !important;background-color:#66B;color:#FFF;\\\">Tiddler</span>',defaultFormatp:\\\"#,##0.0%\\\",defaultFormatc:\\\"[$$]#,##0.00\\\",defaultFormatdt:\\\"d-mmm-yyyy h:mm:ss\\\",defaultFormatd:\\\"d-mmm-yyyy\\\",defaultFormatt:\\\"[h]:mm:ss\\\",defaultDisplayTRUE:\\\"TRUE\\\",defaultDisplayFALSE:\\\"FALSE\\\",defaultImagePrefix:\\\"images/sc-\\\",\\ndefaultTableEditorIDPrefix:\\\"te_\\\",defaultPageUpDnAmount:15,AllowCtrlS:!0,defaultTableControlThickness:20,cteGriddivClass:\\\"\\\",s_statusline_executing:\\\"Executing...\\\",s_statusline_displaying:\\\"Displaying...\\\",s_statusline_ordering:\\\"Ordering...\\\",s_statusline_calculating:\\\"Calculating...\\\",s_statusline_calculatingls:\\\"Calculating... Loading Sheet...\\\",s_statusline_doingserverfunc:\\\"doing server function \\\",s_statusline_incell:\\\" in cell \\\",s_statusline_calcstart:\\\"Calculation start...\\\",s_statusline_sum:\\\"SUM\\\",s_statusline_recalcneeded:'<span style=\\\"color:#999;\\\">(Recalc needed)</span>',\\ns_statusline_circref:'<span style=\\\"color:red;\\\">Circular reference: ',s_inputboxdisplaymultilinetext:\\\"[Multi-line text: Click icon on right to edit]\\\",defaultInputEchoClass:\\\"\\\",defaultInputEchoStyle:\\\"filter:alpha(opacity=90);opacity:.9;backgroundColor:#FFD;border:1px solid #884;fontSize:small;padding:2px 10px 1px 2px;cursor:default;\\\",defaultInputEchoPromptClass:\\\"\\\",defaultInputEchoPromptStyle:\\\"filter:alpha(opacity=90);opacity:.9;backgroundColor:#FFD;borderLeft:1px solid #884;borderRight:1px solid #884;borderBottom:1px solid #884;fontSize:small;fontStyle:italic;padding:2px 10px 1px 2px;cursor:default;\\\",\\nietUnknownFunction:\\\"Unknown function \\\",CH_radius1:29,CH_radius2:41,s_CHfillAllTooltip:\\\"Fill Contents and Formats Down/Right\\\",s_CHfillContentsTooltip:\\\"Fill Contents Only Down/Right\\\",s_CHmovePasteAllTooltip:\\\"Move Contents and Formats\\\",s_CHmovePasteContentsTooltip:\\\"Move Contents Only\\\",s_CHmoveInsertAllTooltip:\\\"Slide Contents and Formats within Row/Col\\\",s_CHmoveInsertContentsTooltip:\\\"Slide Contents within Row/Col\\\",s_CHindicatorOperationLookup:{Fill:\\\"Fill\\\",FillC:\\\"Fill Contents\\\",Move:\\\"Move\\\",MoveI:\\\"Slide\\\",\\nMoveC:\\\"Move Contents\\\",MoveIC:\\\"Slide Contents\\\"},s_CHindicatorDirectionLookup:{Down:\\\" Down\\\",Right:\\\" Right\\\",Horizontal:\\\" Horizontal\\\",Vertical:\\\" Vertical\\\"},defaultTCSliderThickness:9,defaultTCButtonThickness:20,defaultTCThumbThickness:15,TCmainStyle:\\\"backgroundColor:#EEE;\\\",TCmainClass:\\\"\\\",TCendcapStyle:\\\"backgroundColor:#FFF;\\\",TCendcapClass:\\\"\\\",TCpanesliderStyle:\\\"backgroundColor:#CCC;\\\",TCpanesliderClass:\\\"\\\",s_panesliderTooltiph:\\\"Drag to lock pane vertically\\\",s_panesliderTooltipv:\\\"Drag to lock pane horizontally\\\",\\nTClessbuttonStyle:\\\"backgroundColor:#AAA;\\\",TClessbuttonClass:\\\"\\\",TClessbuttonRepeatWait:300,TClessbuttonRepeatInterval:20,TCmorebuttonStyle:\\\"backgroundColor:#AAA;\\\",TCmorebuttonClass:\\\"\\\",TCmorebuttonRepeatWait:300,TCmorebuttonRepeatInterval:20,TCscrollareaStyle:\\\"backgroundColor:#DDD;\\\",TCscrollareaClass:\\\"\\\",TCscrollareaRepeatWait:500,TCscrollareaRepeatInterval:100,TCthumbClass:\\\"\\\",TCthumbStyle:\\\"backgroundColor:#CCC;\\\",TCPStrackinglineClass:\\\"\\\",TCPStrackinglineStyle:\\\"overflow:hidden;position:absolute;zIndex:100;\\\",\\nTCPStrackinglineThickness:\\\"2px\\\",TCTDFSthumbstatusvClass:\\\"\\\",TCTDFSthumbstatusvStyle:\\\"height:20px;width:auto;border:3px solid #808080;overflow:hidden;backgroundColor:#FFF;fontSize:small;position:absolute;zIndex:100;\\\",TCTDFSthumbstatushClass:\\\"\\\",TCTDFSthumbstatushStyle:\\\"height:20px;width:auto;border:1px solid black;padding:2px;backgroundColor:#FFF;fontSize:small;position:absolute;zIndex:100;\\\",TCTDFSthumbstatusrownumClass:\\\"\\\",TCTDFSthumbstatusrownumStyle:\\\"color:#FFF;background-color:#808080;font-size:small;white-space:nowrap;padding:3px;\\\",\\nTCTDFStopOffsetv:0,TCTDFSleftOffsetv:-80,s_TCTDFthumbstatusPrefixv:\\\"Row \\\",TCTDFStopOffseth:-30,TCTDFSleftOffseth:0,s_TCTDFthumbstatusPrefixh:\\\"Col \\\",TooltipOffsetX:2,TooltipOffsetY:10,TDpopupElementClass:\\\"\\\",TDpopupElementStyle:\\\"border:1px solid black;padding:1px 2px 2px 2px;textAlign:center;backgroundColor:#FFF;fontSize:7pt;fontFamily:Verdana,Arial,Helvetica,sans-serif;position:absolute;width:auto;zIndex:110;\\\",SCToolbarbackground:\\\"background-color:#404040;\\\",SCTabbackground:\\\"background-color:#CCC;\\\",\\nSCTabselectedCSS:\\\"display:inline-block;font-size:small;padding:6px 16px 6px 8px;color:#FFF;background-color:#404040;cursor:default;border-right:1px solid #CCC;\\\",SCTabplainCSS:\\\"display:inline-block;font-size:small;padding:6px 16px 6px 8px;color:#FFF;background-color:#808080;cursor:default;border-right:1px solid #CCC;\\\",SCToolbartext:\\\"font-size:x-small;font-weight:bold;color:#FFF;padding-bottom:4px;\\\",SCFormulabarheight:30,SCStatuslineheight:20,SCStatuslineCSS:\\\"font-size:10px;padding:3px 0px;\\\",SCFormatNumberFormats:\\\"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Auto w/ commas!:[,]General|[break]:|00:00|000:000|0000:0000|00000:00000|[break]:|%loc!Formula!:formula|%loc!Hidden!:hidden|[newcol]:1234:0|1,234:#,##0|1,234.5:#,##0.0|1,234.56:#,##0.00|1,234.567:#,##0.000|1,234.5678:#,##0.0000|[break]:|1,234%:#,##0%|1,234.5%:#,##0.0%|1,234.56%:#,##0.00%|[newcol]:|$1,234:$#,##0|$1,234.5:$#,##0.0|$1,234.56:$#,##0.00|[break]:|(1,234):#,##0_);(#,##0)|(1,234.5):#,##0.0_);(#,##0.0)|(1,234.56):#,##0.00_);(#,##0.00)|[break]:|($1,234):#,##0_);($#,##0)|($1,234.5):$#,##0.0_);($#,##0.0)|($1,234.56):$#,##0.00_);($#,##0.00)|[newcol]:|1/4/06:m/d/yy|01/04/2006:mm/dd/yyyy|2006-01-04:yyyy-mm-dd|4-Jan-06:d-mmm-yy|04-Jan-2006:dd-mmm-yyyy|January 4, 2006:mmmm d, yyyy|[break]:|1\\\\\\\\c23:h:mm|1\\\\\\\\c23 PM:h:mm AM/PM|1\\\\\\\\c23\\\\\\\\c45:h:mm:ss|01\\\\\\\\c23\\\\\\\\c45:hh:mm:ss|26\\\\\\\\c23 (h\\\\\\\\cm):[hh]:mm|69\\\\\\\\c45 (m\\\\\\\\cs):[mm]:ss|69 (s):[ss]|[newcol]:|2006-01-04 01\\\\\\\\c23\\\\\\\\c45:yyyy-mm-dd hh:mm:ss|January 4, 2006:mmmm d, yyyy hh:mm:ss|Wed:ddd|Wednesday:dddd|\\\",\\nSCFormatTextFormats:\\\"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Plain Text!:text-plain|HTML:text-html|%loc!Wikitext!:text-wiki|%loc!Link!:text-link|%loc!Formula!:formula|%loc!Hidden!:hidden|\\\",SCFormatPadsizes:\\\"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!No padding!:0px|[newcol]:|1 pixel:1px|2 pixels:2px|3 pixels:3px|4 pixels:4px|5 pixels:5px|6 pixels:6px|7 pixels:7px|8 pixels:8px|[newcol]:|9 pixels:9px|10 pixels:10px|11 pixels:11px|12 pixels:12px|13 pixels:13px|14 pixels:14px|16 pixels:16px|18 pixels:18px|[newcol]:|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|\\\",\\nSCFormatFontsizes:\\\"[cancel]:|[break]:|%loc!Default!:|[custom]:|X-Small:x-small|Small:small|Medium:medium|Large:large|X-Large:x-large|[newcol]:|6pt:6pt|7pt:7pt|8pt:8pt|9pt:9pt|10pt:10pt|11pt:11pt|12pt:12pt|14pt:14pt|16pt:16pt|[newcol]:|18pt:18pt|20pt:20pt|22pt:22pt|24pt:24pt|28pt:28pt|36pt:36pt|48pt:48pt|72pt:72pt|[newcol]:|8 pixels:8px|9 pixels:9px|10 pixels:10px|11 pixels:11px|12 pixels:12px|13 pixels:13px|14 pixels:14px|[newcol]:|16 pixels:16px|18 pixels:18px|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|\\\",\\nSCFormatFontfamilies:\\\"[cancel]:|[break]:|%loc!Default!:|[custom]:|Verdana:Verdana,Arial,Helvetica,sans-serif|Arial:arial,helvetica,sans-serif|Courier:'Courier New',Courier,monospace|\\\",SCFormatFontlook:\\\"[cancel]:|[break]:|%loc!Default!:|%loc!Normal!:normal normal|%loc!Bold!:normal bold|%loc!Italic!:italic normal|%loc!Bold Italic!:italic bold\\\",SCFormatTextAlignhoriz:\\\"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|\\\",SCFormatNumberAlignhoriz:\\\"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|\\\",\\nSCFormatAlignVertical:\\\"[cancel]:|[break]:|%loc!Default!:|%loc!Top!:top|%loc!Middle!:middle|%loc!Bottom!:bottom|\\\",SCFormatColwidth:\\\"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|20 pixels:20|40:40|60:60|80:80|100:100|120:120|140:140|160:160|[newcol]:|180 pixels:180|200:200|220:220|240:240|260:260|280:280|300:300|\\\",SCFormatRecalc:\\\"[cancel]:|[break]:|%loc!Auto!:|%loc!Manual!:off|\\\",SCFormatUserMaxCol:\\\"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|Unlimited:0|10:10|20:20|30:30|40:40|50:50|60:60|80:80|100:100|\\\",\\nSCFormatUserMaxRow:\\\"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|Unlimited:0|10:10|20:20|30:30|40:40|50:50|60:60|80:80|100:100|\\\",ISCButtonBorderNormal:\\\"#404040\\\",ISCButtonBorderHover:\\\"#999\\\",ISCButtonBorderDown:\\\"#FFF\\\",ISCButtonDownBackground:\\\"#888\\\",s_PopupListCancel:\\\"[Cancel]\\\",s_PopupListCustom:\\\"Custom\\\",s_loc_align_center:\\\"Align Center\\\",s_loc_align_left:\\\"Align Left\\\",s_loc_align_right:\\\"Align Right\\\",s_loc_alignment:\\\"Alignment\\\",s_loc_audit:\\\"Audit\\\",s_loc_audit_trail_this_session:\\\"Audit Trail This Session\\\",\\ns_loc_auto:\\\"Auto\\\",s_loc_auto_sum:\\\"Auto Sum\\\",s_loc_auto_wX_commas:\\\"Auto w/ commas\\\",s_loc_automatic:\\\"Automatic\\\",s_loc_background:\\\"Background\\\",s_loc_bold:\\\"Bold\\\",s_loc_bold_XampX_italics:\\\"Bold &amp; Italics\\\",s_loc_bold_italic:\\\"Bold Italic\\\",s_loc_borders:\\\"Borders\\\",s_loc_borders_off:\\\"Borders Off\\\",s_loc_borders_on:\\\"Borders On\\\",s_loc_bottom:\\\"Bottom\\\",s_loc_bottom_border:\\\"Bottom Border\\\",s_loc_cell_settings:\\\"CELL SETTINGS\\\",s_loc_csv_format:\\\"CSV format\\\",s_loc_cancel:\\\"Cancel\\\",s_loc_category:\\\"Category\\\",s_loc_center:\\\"Center\\\",\\ns_loc_clear:\\\"Clear\\\",s_loc_clear_socialcalc_clipboard:\\\"Clear SocialCalc Clipboard\\\",s_loc_clipboard:\\\"Clipboard\\\",s_loc_color:\\\"Color\\\",s_loc_column_:\\\"Column \\\",s_loc_comment:\\\"Comment\\\",s_loc_copy:\\\"Copy\\\",s_loc_custom:\\\"Custom\\\",s_loc_cut:\\\"Cut\\\",s_loc_default:\\\"Default\\\",s_loc_default_alignment:\\\"Default Alignment\\\",s_loc_default_column_width:\\\"Default Column Width\\\",s_loc_default_font:\\\"Default Font\\\",s_loc_default_format:\\\"Default Format\\\",s_loc_default_padding:\\\"Default Padding\\\",s_loc_delete:\\\"Delete\\\",s_loc_delete_column:\\\"Delete Column\\\",\\ns_loc_delete_contents:\\\"Delete Contents\\\",s_loc_delete_row:\\\"Delete Row\\\",s_loc_description:\\\"Description\\\",s_loc_display_clipboard_in:\\\"Display Clipboard in\\\",s_loc_down:\\\"Down\\\",s_loc_edit:\\\"Edit\\\",s_loc_existing_names:\\\"Existing Names\\\",s_loc_family:\\\"Family\\\",s_loc_fill_down:\\\"Fill Down\\\",s_loc_fill_right:\\\"Fill Right\\\",s_loc_font:\\\"Font\\\",s_loc_format:\\\"Format\\\",s_loc_formula:\\\"Formula\\\",s_loc_function_list:\\\"Function List\\\",s_loc_functions:\\\"Functions\\\",s_loc_grid:\\\"Grid\\\",s_loc_hidden:\\\"Hidden\\\",s_loc_hide_column:\\\"Hide Column\\\",\\ns_loc_hide_row:\\\"Hide Row\\\",s_loc_horizontal:\\\"Horizontal\\\",s_loc_insert_column:\\\"Insert Column\\\",s_loc_insert_row:\\\"Insert Row\\\",s_loc_italic:\\\"Italic\\\",s_loc_last_sort:\\\"Last Sort\\\",s_loc_left:\\\"Left\\\",s_loc_left_border:\\\"Left Border\\\",s_loc_link:\\\"Link\\\",s_loc_link_input_box:\\\"Link Input Box\\\",s_loc_list:\\\"List\\\",s_loc_load_socialcalc_clipboard_with_this:\\\"Load SocialCalc Clipboard With This\\\",s_loc_lock:\\\"Lock\\\",s_loc_major_sort:\\\"Major Sort\\\",s_loc_manual:\\\"Manual\\\",s_loc_merge_cells:\\\"Merge Cells\\\",s_loc_middle:\\\"Middle\\\",s_loc_minor_sort:\\\"Minor Sort\\\",\\ns_loc_move_insert:\\\"Move Insert\\\",s_loc_move_paste:\\\"Move Paste\\\",s_loc_multiXline_input_box:\\\"Multi-line Input Box\\\",s_loc_name:\\\"Name\\\",s_loc_names:\\\"Names\\\",s_loc_no_padding:\\\"No padding\\\",s_loc_normal:\\\"Normal\\\",s_loc_number:\\\"Number\\\",s_loc_number_horizontal:\\\"Number Horizontal\\\",s_loc_ok:\\\"OK\\\",s_loc_padding:\\\"Padding\\\",s_loc_page_name:\\\"Page Name\\\",s_loc_paste:\\\"Paste\\\",s_loc_paste_formats:\\\"Paste Formats\\\",s_loc_plain_text:\\\"Plain Text\\\",s_loc_recalc:\\\"Recalc\\\",s_loc_recalculation:\\\"Recalculation\\\",s_loc_redo:\\\"Redo\\\",s_loc_right:\\\"Right\\\",\\ns_loc_right_border:\\\"Right Border\\\",s_loc_sheet_settings:\\\"SHEET SETTINGS\\\",s_loc_save:\\\"Save\\\",s_loc_save_to:\\\"Save to\\\",s_loc_set_cell_contents:\\\"Set Cell Contents\\\",s_loc_set_cells_to_sort:\\\"Set Cells To Sort\\\",s_loc_set_value_to:\\\"Set Value To\\\",s_loc_set_to_link_format:\\\"Set to Link format\\\",s_loc_setXclear_move_from:\\\"Set/Clear Move From\\\",s_loc_show_cell_settings:\\\"Show Cell Settings\\\",s_loc_show_sheet_settings:\\\"Show Sheet Settings\\\",s_loc_show_in_new_browser_window:\\\"Show in new browser window\\\",s_loc_size:\\\"Size\\\",\\ns_loc_socialcalcXsave_format:\\\"SocialCalc-save format\\\",s_loc_sort:\\\"Sort\\\",s_loc_sort_:\\\"Sort \\\",s_loc_sort_cells:\\\"Sort Cells\\\",s_loc_swap_colors:\\\"Swap Colors\\\",s_loc_tabXdelimited_format:\\\"Tab-delimited format\\\",s_loc_text:\\\"Text\\\",s_loc_text_horizontal:\\\"Text Horizontal\\\",s_loc_this_is_aXbrXsample:\\\"This is a<br>sample\\\",s_loc_top:\\\"Top\\\",s_loc_top_border:\\\"Top Border\\\",s_loc_undone_steps:\\\"UNDONE STEPS\\\",s_loc_url:\\\"URL\\\",s_loc_undo:\\\"Undo\\\",s_loc_unlock:\\\"Unlock\\\",s_loc_unmerge_cells:\\\"Unmerge Cells\\\",s_loc_up:\\\"Up\\\",s_loc_value:\\\"Value\\\",\\ns_loc_vertical:\\\"Vertical\\\",s_loc_wikitext:\\\"Wikitext\\\",s_loc_workspace:\\\"Workspace\\\",s_loc_XnewX:\\\"[New]\\\",s_loc_XnoneX:\\\"[None]\\\",s_loc_Xselect_rangeX:\\\"[select range]\\\",SVStatuslineheight:20,SVStatuslineCSS:\\\"font-size:10px;padding:3px 0px;\\\",FormatNumber_separatorchar:\\\",\\\",FormatNumber_decimalchar:\\\".\\\",FormatNumber_defaultCurrency:\\\"$\\\",s_FormatNumber_daynames:\\\"Sunday Monday Tuesday Wednesday Thursday Friday Saturday\\\".split(\\\" \\\"),s_FormatNumber_daynames3:\\\"Sun Mon Tue Wed Thu Fri Sat\\\".split(\\\" \\\"),s_FormatNumber_monthnames:\\\"January February March April May June July August September October November December\\\".split(\\\" \\\"),\\ns_FormatNumber_monthnames3:\\\"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec\\\".split(\\\" \\\"),s_FormatNumber_am:\\\"AM\\\",s_FormatNumber_am1:\\\"A\\\",s_FormatNumber_pm:\\\"PM\\\",s_FormatNumber_pm1:\\\"P\\\",s_parseerrexponent:\\\"Improperly formed number exponent\\\",s_parseerrchar:\\\"Unexpected character in formula\\\",s_parseerrstring:\\\"Improperly formed string\\\",s_parseerrspecialvalue:\\\"Improperly formed special value\\\",s_parseerrtwoops:\\\"Error in formula (two operators inappropriately in a row)\\\",s_parseerrmissingopenparen:\\\"Missing open parenthesis in list with comma(s). \\\",\\ns_parseerrcloseparennoopen:\\\"Closing parenthesis without open parenthesis. \\\",s_parseerrmissingcloseparen:\\\"Missing close parenthesis. \\\",s_parseerrmissingoperand:\\\"Missing operand. \\\",s_parseerrerrorinformula:\\\"Error in formula.\\\",s_calcerrerrorvalueinformula:\\\"Error value in formula\\\",s_parseerrerrorinformulabadval:\\\"Error in formula resulting in bad value\\\",s_formularangeresult:\\\"Formula results in range value:\\\",s_calcerrnumericnan:\\\"Formula results in an bad numeric value\\\",s_calcerrnumericoverflow:\\\"Numeric overflow\\\",\\ns_sheetunavailable:\\\"Sheet unavailable:\\\",s_calcerrcellrefmissing:\\\"Cell reference missing when expected.\\\",s_calcerrsheetnamemissing:\\\"Sheet name missing when expected.\\\",s_circularnameref:\\\"Circular name reference to name\\\",s_calcerrunknownname:\\\"Unknown name\\\",s_calcerrincorrectargstofunction:\\\"Incorrect arguments to function\\\",s_sheetfuncunknownfunction:\\\"Unknown function\\\",s_sheetfunclnarg:\\\"LN argument must be greater than 0\\\",s_sheetfunclog10arg:\\\"LOG10 argument must be greater than 0\\\",s_sheetfunclogsecondarg:\\\"LOG second argument must be numeric greater than 0\\\",\\ns_sheetfunclogfirstarg:\\\"LOG first argument must be greater than 0\\\",s_sheetfuncroundsecondarg:\\\"ROUND second argument must be numeric\\\",s_sheetfuncddblife:\\\"DDB life must be greater than 1\\\",s_sheetfuncslnlife:\\\"SLN life must be greater than 1\\\",s_fdef_ABS:\\\"Absolute value function. \\\",s_fdef_ACOS:\\\"Trigonometric arccosine function. \\\",s_fdef_AND:\\\"True if all arguments are true. \\\",s_fdef_ASIN:\\\"Trigonometric arcsine function. \\\",s_fdef_ATAN:\\\"Trigonometric arctan function. \\\",s_fdef_ATAN2:\\\"Trigonometric arc tangent function (result is in radians). \\\",\\ns_fdef_AVERAGE:\\\"Averages the values. \\\",s_fdef_CHOOSE:\\\"Returns the value specified by the index. The values may be ranges of cells. \\\",s_fdef_COLUMNS:\\\"Returns the number of columns in the range. \\\",s_fdef_COS:\\\"Trigonometric cosine function (value is in radians). \\\",s_fdef_COUNT:\\\"Counts the number of numeric values, not blank, text, or error. \\\",s_fdef_COUNTA:\\\"Counts the number of non-blank values. \\\",s_fdef_COUNTBLANK:'Counts the number of blank values. (Note: \\\"\\\" is not blank.) ',s_fdef_COUNTIF:'Counts the number of number of cells in the range that meet the criteria. The criteria may be a value (\\\"x\\\", 15, 1+3) or a test (>25). ',\\ns_fdef_DATE:'Returns the appropriate date value given numbers for year, month, and day. For example: DATE(2006,2,1) for February 1, 2006. Note: In this program, day \\\"1\\\" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day \\\"1\\\" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. ',s_fdef_DAVERAGE:\\\"Averages the values in the specified field in records that meet the criteria. \\\",s_fdef_DAY:\\\"Returns the day of month for a date value. \\\",\\ns_fdef_DCOUNT:\\\"Counts the number of numeric values, not blank, text, or error, in the specified field in records that meet the criteria. \\\",s_fdef_DCOUNTA:\\\"Counts the number of non-blank values in the specified field in records that meet the criteria. \\\",s_fdef_DDB:\\\"Returns the amount of depreciation at the given period of time (the default factor is 2 for double-declining balance).   \\\",s_fdef_DEGREES:\\\"Converts value in radians into degrees. \\\",s_fdef_DGET:\\\"Returns the value of the specified field in the single record that meets the criteria. \\\",\\ns_fdef_DMAX:\\\"Returns the maximum of the numeric values in the specified field in records that meet the criteria. \\\",s_fdef_DMIN:\\\"Returns the maximum of the numeric values in the specified field in records that meet the criteria. \\\",s_fdef_DPRODUCT:\\\"Returns the result of multiplying the numeric values in the specified field in records that meet the criteria. \\\",s_fdef_DSTDEV:\\\"Returns the sample standard deviation of the numeric values in the specified field in records that meet the criteria. \\\",s_fdef_DSTDEVP:\\\"Returns the standard deviation of the numeric values in the specified field in records that meet the criteria. \\\",\\ns_fdef_DSUM:\\\"Returns the sum of the numeric values in the specified field in records that meet the criteria. \\\",s_fdef_DVAR:\\\"Returns the sample variance of the numeric values in the specified field in records that meet the criteria. \\\",s_fdef_DVARP:\\\"Returns the variance of the numeric values in the specified field in records that meet the criteria. \\\",s_fdef_EVEN:\\\"Rounds the value up in magnitude to the nearest even integer. \\\",s_fdef_EXACT:'Returns \\\"true\\\" if the values are exactly the same, including case, type, etc. ',\\ns_fdef_EXP:\\\"Returns e raised to the value power. \\\",s_fdef_FACT:\\\"Returns factorial of the value. \\\",s_fdef_FALSE:'Returns the logical value \\\"false\\\". ',s_fdef_FIND:'Returns the starting position within string2 of the first occurrence of string1 at or after \\\"start\\\". If start is omitted, 1 is assumed. ',s_fdef_FV:\\\"Returns the future value of repeated payments of money invested at the given rate for the specified number of periods, with optional present value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). \\\",\\ns_fdef_HLOOKUP:\\\"Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the row offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. \\\",s_fdef_HOUR:\\\"Returns the hour portion of a time or date/time value. \\\",s_fdef_IF:\\\"Results in true-value if logical-expression is TRUE or non-zero, otherwise results in false-value. \\\",s_fdef_INDEX:\\\"Returns a cell or range reference for the specified row and column in the range. If range is 1-dimensional, then only one of rownum or colnum are needed. If range is 2-dimensional and rownum or colnum are zero, a reference to the range of just the specified column or row is returned. You can use the returned reference value in a range, e.g., sum(A1:INDEX(A2:A10,4)). \\\",\\ns_fdef_INT:\\\"Returns the value rounded down to the nearest integer (towards -infinity). \\\",s_fdef_IRR:\\\"Returns the interest rate at which the cash flows in the range have a net present value of zero. Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). \\\",s_fdef_ISBLANK:'Returns \\\"true\\\" if the value is a reference to a blank cell. ',\\ns_fdef_ISERR:'Returns \\\"true\\\" if the value is of type \\\"Error\\\" but not \\\"NA\\\". ',s_fdef_ISERROR:'Returns \\\"true\\\" if the value is of type \\\"Error\\\". ',s_fdef_ISLOGICAL:'Returns \\\"true\\\" if the value is of type \\\"Logical\\\" (true/false). ',s_fdef_ISNA:'Returns \\\"true\\\" if the value is the error type \\\"NA\\\". ',s_fdef_ISNONTEXT:'Returns \\\"true\\\" if the value is not of type \\\"Text\\\". ',s_fdef_ISNUMBER:'Returns \\\"true\\\" if the value is of type \\\"Number\\\" (including logical values). ',s_fdef_ISTEXT:'Returns \\\"true\\\" if the value is of type \\\"Text\\\". ',\\ns_fdef_LEFT:\\\"Returns the specified number of characters from the text value. If count is omitted, 1 is assumed. \\\",s_fdef_LEN:\\\"Returns the number of characters in the text value. \\\",s_fdef_LN:\\\"Returns the natural logarithm of the value. \\\",s_fdef_LOG:\\\"Returns the logarithm of the value using the specified base. \\\",s_fdef_LOG10:\\\"Returns the base 10 logarithm of the value. \\\",s_fdef_LOWER:\\\"Returns the text value with all uppercase characters converted to lowercase. \\\",s_fdef_MATCH:\\\"Look for the matching value for the given value in the range and return position (the first is 1) in that range. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. If rangelookup is -1, act like 1 but the bracket is match>=value. \\\",\\ns_fdef_MAX:\\\"Returns the maximum of the numeric values. \\\",s_fdef_MID:\\\"Returns the specified number of characters from the text value starting from the specified position. \\\",s_fdef_MIN:\\\"Returns the minimum of the numeric values. \\\",s_fdef_MINUTE:\\\"Returns the minute portion of a time or date/time value. \\\",s_fdef_MOD:\\\"Returns the remainder of the first value divided by the second. \\\",s_fdef_MONTH:\\\"Returns the month part of a date value. \\\",s_fdef_N:\\\"Returns the value if it is a numeric value otherwise an error. \\\",\\ns_fdef_NA:\\\"Returns the #N/A error value which propagates through most operations. \\\",s_fdef_NOT:\\\"Returns FALSE if value is true, and TRUE if it is false. \\\",s_fdef_NOW:\\\"Returns the current date/time. \\\",s_fdef_NPER:\\\"Returns the number of periods at which payments invested each period at the given rate with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period) has the given present value. \\\",s_fdef_NPV:\\\"Returns the net present value of cash flows (which may be individual values and/or ranges) at the given rate. The flows are positive if income, negative if paid out, and are assumed at the end of each period. \\\",\\ns_fdef_ODD:\\\"Rounds the value up in magnitude to the nearest odd integer. \\\",s_fdef_OR:\\\"True if any argument is true \\\",s_fdef_PI:\\\"The value 3.1415926... \\\",s_fdef_PMT:\\\"Returns the amount of each payment that must be invested at the given rate for the specified number of periods to have the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). \\\",s_fdef_POWER:\\\"Returns the first value raised to the second value power. \\\",\\ns_fdef_PRODUCT:\\\"Returns the result of multiplying the numeric values. \\\",s_fdef_PROPER:\\\"Returns the text value with the first letter of each word converted to uppercase and the others to lowercase. \\\",s_fdef_PV:\\\"Returns the present value of the given number of payments each invested at the given rate, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). \\\",s_fdef_RADIANS:\\\"Converts value in degrees into radians. \\\",s_fdef_RATE:\\\"Returns the rate at which the given number of payments each invested at the given rate has the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). \\\",\\ns_fdef_REPLACE:\\\"Returns text1 with the specified number of characters starting from the specified position replaced by text2. \\\",s_fdef_REPT:\\\"Returns the text repeated the specified number of times. \\\",s_fdef_RIGHT:\\\"Returns the specified number of characters from the text value starting from the end. If count is omitted, 1 is assumed. \\\",s_fdef_ROUND:\\\"Rounds the value to the specified number of decimal places. If precision is negative, then round to powers of 10. The default precision is 0 (round to integer). \\\",\\ns_fdef_ROWS:\\\"Returns the number of rows in the range. \\\",s_fdef_SECOND:\\\"Returns the second portion of a time or date/time value (truncated to an integer). \\\",s_fdef_SIN:\\\"Trigonometric sine function (value is in radians) \\\",s_fdef_SLN:\\\"Returns the amount of depreciation at each period of time using the straight-line method. \\\",s_fdef_SQRT:\\\"Square root of the value \\\",s_fdef_STDEV:\\\"Returns the sample standard deviation of the numeric values. \\\",s_fdef_STDEVP:\\\"Returns the standard deviation of the numeric values. \\\",\\ns_fdef_SUBSTITUTE:'Returns text1 with the all occurrences of oldtext replaced by newtext. If \\\"occurrence\\\" is present, then only that occurrence is replaced. ',s_fdef_SUM:\\\"Adds the numeric values. The values to the sum function may be ranges in the form similar to A1:B5. \\\",s_fdef_SUMIF:'Sums the numeric values of cells in the range that meet the criteria. The criteria may be a value (\\\"x\\\", 15, 1+3) or a test (>25). If range2 is present, then range1 is tested and the corresponding range2 value is summed. ',\\ns_fdef_SYD:\\\"Depreciation by Sum of Year's Digits method. \\\",s_fdef_T:\\\"Returns the text value or else a null string. \\\",s_fdef_TAN:\\\"Trigonometric tangent function (value is in radians) \\\",s_fdef_TIME:\\\"Returns the time value given the specified hour, minute, and second. \\\",s_fdef_TODAY:'Returns the current date (an integer). Note: In this program, day \\\"1\\\" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day \\\"1\\\" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. ',\\ns_fdef_TRIM:\\\"Returns the text value with leading, trailing, and repeated spaces removed. \\\",s_fdef_TRUE:'Returns the logical value \\\"true\\\". ',s_fdef_TRUNC:\\\"Truncates the value to the specified number of decimal places. If precision is negative, truncate to powers of 10. \\\",s_fdef_UPPER:\\\"Returns the text value with all lowercase characters converted to uppercase. \\\",s_fdef_VALUE:\\\"Converts the specified text value into a numeric value. Various forms that look like numbers (including digits followed by %, forms that look like dates, etc.) are handled. This may not handle all of the forms accepted by other spreadsheets and may be locale dependent. \\\",\\ns_fdef_VAR:\\\"Returns the sample variance of the numeric values. \\\",s_fdef_VARP:\\\"Returns the variance of the numeric values. \\\",s_fdef_VLOOKUP:\\\"Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the column offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match>=value) instead of exact match. \\\",s_fdef_WEEKDAY:\\\"Returns the day of week specified by the date value. If type is 1 (the default), Sunday is day and Saturday is day 7. If type is 2, Monday is day 1 and Sunday is day 7. If type is 3, Monday is day 0 and Sunday is day 6. \\\",\\ns_fdef_YEAR:\\\"Returns the year part of a date value. \\\",s_fdef_SUMPRODUCT:\\\"Sums the pairwise products of 2 or more ranges. The ranges must be of equal length.\\\",s_fdef_CEILING:\\\"Rounds the given number up to the nearest integer or multiple of significance. Significance is the value to whose multiple of ten the value is to be rounded up (.01, .1, 1, 10, etc.)\\\",s_fdef_FLOOR:\\\"Rounds the given number down to the nearest multiple of significance. Significance is the value to whose multiple of ten the number is to be rounded down (.01, .1, 1, 10, etc.)\\\",\\ns_farg_v:\\\"value\\\",s_farg_vn:\\\"value1, value2, ...\\\",s_farg_xy:\\\"valueX, valueY\\\",s_farg_choose:\\\"index, value1, value2, ...\\\",s_farg_range:\\\"range\\\",s_farg_rangec:\\\"range, criteria\\\",s_farg_date:\\\"year, month, day\\\",s_farg_dfunc:\\\"databaserange, fieldname, criteriarange\\\",s_farg_ddb:\\\"cost, salvage, lifetime, period, [factor]\\\",s_farg_find:\\\"string1, string2, [start]\\\",s_farg_fv:\\\"rate, n, payment, [pv, [paytype]]\\\",s_farg_hlookup:\\\"value, range, row, [rangelookup]\\\",s_farg_iffunc:\\\"logical-expression, true-value, [false-value]\\\",\\ns_farg_index:\\\"range, rownum, colnum\\\",s_farg_irr:\\\"range, [guess]\\\",s_farg_tc:\\\"text, count\\\",s_farg_log:\\\"value, base\\\",s_farg_match:\\\"value, range, [rangelookup]\\\",s_farg_mid:\\\"text, start, length\\\",s_farg_nper:\\\"rate, payment, pv, [fv, [paytype]]\\\",s_farg_npv:\\\"rate, value1, value2, ...\\\",s_farg_pmt:\\\"rate, n, pv, [fv, [paytype]]\\\",s_farg_pv:\\\"rate, n, payment, [fv, [paytype]]\\\",s_farg_rate:\\\"n, payment, pv, [fv, [paytype, [guess]]]\\\",s_farg_replace:\\\"text1, start, length, text2\\\",s_farg_vp:\\\"value, [precision]\\\",s_farg_valpre:\\\"value, precision\\\",\\ns_farg_csl:\\\"cost, salvage, lifetime\\\",s_farg_cslp:\\\"cost, salvage, lifetime, period\\\",s_farg_subs:\\\"text1, oldtext, newtext, [occurrence]\\\",s_farg_sumif:\\\"range1, criteria, [range2]\\\",s_farg_hms:\\\"hour, minute, second\\\",s_farg_txt:\\\"text\\\",s_farg_vlookup:\\\"value, range, col, [rangelookup]\\\",s_farg_weekday:\\\"date, [type]\\\",s_farg_dt:\\\"date\\\",s_farg_rangen:\\\"range1, range2, ...\\\",s_farg_vsig:\\\"value, [significance]\\\",function_classlist:\\\"all stat lookup datetime financial test math text\\\".split(\\\" \\\"),s_fclass_all:\\\"All\\\",s_fclass_stat:\\\"Statistics\\\",\\ns_fclass_lookup:\\\"Lookup\\\",s_fclass_datetime:\\\"Date & Time\\\",s_fclass_financial:\\\"Financial\\\",s_fclass_test:\\\"Test\\\",s_fclass_math:\\\"Math\\\",s_fclass_text:\\\"Text\\\",s_loc_to:\\\"to\\\",s_loc_tiddler:\\\"Tiddler\\\",s_loc_import:\\\"Import\\\",s_loc_export:\\\"Export\\\",s_loc_XclipboardX:\\\"[Clipboard]\\\",s_clipboard_menu_title:\\\"Import/Export<br>and Clipboard\\\",s_clipboard_export_error_tiddler_exists:\\\"Tiddler exists\\\",s_clipboard_export_error_tiddler_overwrite:\\\"Do you want to overwrite it ?\\\",s_clipboard_import_error_tiddler_format:\\\"Format error: tiddler's format field have incorrect value.\\\",\\ns_loc_save_changes:\\\"Save changes\\\",s_notification_tiddler:\\\"Saved ~SocialCalc sheet\\\",lastone:null};\\nSocialCalc.ConstantsDefaultClasses={defaultComment:\\\"\\\",defaultCommentNoGrid:\\\"\\\",defaultHighlightTypeCursor:\\\"\\\",defaultHighlightTypeRange:\\\"\\\",defaultColname:\\\"\\\",defaultSelectedColname:\\\"\\\",defaultRowname:\\\"\\\",defaultSelectedRowname:\\\"\\\",defaultUpperLeft:\\\"\\\",defaultSkippedCell:\\\"\\\",defaultPaneDivider:\\\"\\\",cteGriddiv:\\\"\\\",defaultInputEcho:{classname:\\\"\\\",style:\\\"filter:alpha(opacity=90);opacity:.9;\\\"},TCmain:\\\"\\\",TCendcap:\\\"\\\",TCpaneslider:\\\"\\\",TClessbutton:\\\"\\\",TCmorebutton:\\\"\\\",TCscrollarea:\\\"\\\",TCthumb:\\\"\\\",TCPStrackingline:\\\"\\\",TCTDFSthumbstatus:\\\"\\\",\\nTDpopupElement:\\\"\\\"};SocialCalc.ConstantsDefaultClasses.defaultComment={classname:\\\"\\\",style:\\\"background-image:url(images/sc-commentbg.gif);\\\"};SocialCalc.ConstantsDefaultClasses.defaultInputEcho=\\\"\\\";SocialCalc.ConstantsSetClasses=function(a){var c=SocialCalc.ConstantsDefaultClasses,b=SocialCalc.Constants,d;a=a||\\\"\\\";for(d in c)\\\"string\\\"==typeof c[d]?(b[d+\\\"Class\\\"]=a+(c[d]||d),void 0!==b[d+\\\"Style\\\"]&&(b[d+\\\"Style\\\"]=\\\"\\\")):\\\"object\\\"==typeof c[d]&&(b[d+\\\"Class\\\"]=a+(c[d].classname||d),b[d+\\\"Style\\\"]=c[d].style)};\\nSocialCalc.ConstantsSetImagePrefix=function(a){var c=SocialCalc.Constants,b;for(b in c)\\\"string\\\"==typeof c[b]&&(c[b]=c[b].replace(c.defaultImagePrefix,a));c.defaultImagePrefix=a};SocialCalc||(SocialCalc={});SocialCalc.Callbacks={expand_wiki:null,expand_markup:function(a,c,b){return SocialCalc.default_expand_markup(a,c,b)},MakePageLink:null,NormalizeSheetName:null};SocialCalc.Cell=function(a){this.coord=a;this.datavalue=\\\"\\\";this.datatype=null;this.formula=\\\"\\\";this.valuetype=\\\"b\\\";this.readonly=!1};\\nSocialCalc.CellProperties={coord:1,datavalue:1,datatype:1,formula:1,valuetype:1,errors:1,comment:1,readonly:1,bt:2,br:2,bb:2,bl:2,layout:2,font:2,color:2,bgcolor:2,cellformat:2,nontextvalueformat:2,textvalueformat:2,colspan:2,rowspan:2,cssc:2,csss:2,mod:2,displaystring:3,parseinfo:3,hcolspan:3,hrowspan:3};\\nSocialCalc.CellPropertiesTable={bt:\\\"borderstyle\\\",br:\\\"borderstyle\\\",bb:\\\"borderstyle\\\",bl:\\\"borderstyle\\\",layout:\\\"layout\\\",font:\\\"font\\\",color:\\\"color\\\",bgcolor:\\\"color\\\",cellformat:\\\"cellformat\\\",nontextvalueformat:\\\"valueformat\\\",textvalueformat:\\\"valueformat\\\"};SocialCalc.Sheet=function(){SocialCalc.ResetSheet(this);this.statuscallbackparams=this.statuscallback=null};\\nSocialCalc.ResetSheet=function(a,c){a.cells={};a.attribs={lastcol:1,lastrow:1,defaultlayout:0,usermaxcol:0,usermaxrow:0};a.rowattribs={hide:{},height:{}};a.colattribs={width:{},hide:{}};a.names={};a.layouts=[];a.layouthash={};a.fonts=[];a.fonthash={};a.colors=[];a.colorhash={};a.borderstyles=[];a.borderstylehash={};a.cellformats=[];a.cellformathash={};a.valueformats=[];a.valueformathash={};a.copiedfrom=\\\"\\\";a.changes=new SocialCalc.UndoStack;a.renderneeded=!1;a.changedrendervalues=!0;a.recalcchangedavalue=\\n!1;a.hiddencolrow=\\\"\\\";a.sci=new SocialCalc.SheetCommandInfo(a)};SocialCalc.Sheet.prototype.ResetSheet=function(){SocialCalc.ResetSheet(this)};SocialCalc.Sheet.prototype.AddCell=function(a){return this.cells[a.coord]=a};SocialCalc.Sheet.prototype.GetAssuredCell=function(a){return this.cells[a]||this.AddCell(new SocialCalc.Cell(a))};SocialCalc.Sheet.prototype.ParseSheetSave=function(a){SocialCalc.ParseSheetSave(a,this)};\\nSocialCalc.Sheet.prototype.CellFromStringParts=function(a,c,b){return SocialCalc.CellFromStringParts(this,a,c,b)};SocialCalc.Sheet.prototype.CreateSheetSave=function(a,c){return SocialCalc.CreateSheetSave(this,a,c)};SocialCalc.Sheet.prototype.CellToString=function(a){return SocialCalc.CellToString(this,a)};SocialCalc.Sheet.prototype.CanonicalizeSheet=function(a){return SocialCalc.CanonicalizeSheet(this,a)};\\nSocialCalc.Sheet.prototype.EncodeCellAttributes=function(a){return SocialCalc.EncodeCellAttributes(this,a)};SocialCalc.Sheet.prototype.EncodeSheetAttributes=function(){return SocialCalc.EncodeSheetAttributes(this)};SocialCalc.Sheet.prototype.DecodeCellAttributes=function(a,c,b){return SocialCalc.DecodeCellAttributes(this,a,c,b)};SocialCalc.Sheet.prototype.DecodeSheetAttributes=function(a){return SocialCalc.DecodeSheetAttributes(this,a)};\\nSocialCalc.Sheet.prototype.ScheduleSheetCommands=function(a,c){return SocialCalc.ScheduleSheetCommands(this,a,c)};SocialCalc.Sheet.prototype.SheetUndo=function(){return SocialCalc.SheetUndo(this)};SocialCalc.Sheet.prototype.SheetRedo=function(){return SocialCalc.SheetRedo(this)};SocialCalc.Sheet.prototype.CreateAuditString=function(){return SocialCalc.CreateAuditString(this)};SocialCalc.Sheet.prototype.GetStyleNum=function(a,c){return SocialCalc.GetStyleNum(this,a,c)};\\nSocialCalc.Sheet.prototype.GetStyleString=function(a,c){return SocialCalc.GetStyleString(this,a,c)};SocialCalc.Sheet.prototype.RecalcSheet=function(){return SocialCalc.RecalcSheet(this)};\\nSocialCalc.ParseSheetSave=function(a,c){var b=a.split(/\\\\r\\\\n|\\\\n/),d=[],e,f,g,l,h=SocialCalc.Constants;for(e=0;e<b.length;e++)switch(d=b[e],d=d.split(\\\":\\\"),d[0]){case \\\"cell\\\":g=c.GetAssuredCell(d[1]);f=2;c.CellFromStringParts(g,d,f);break;case \\\"col\\\":l=d[1];for(f=2;g=d[f++];)switch(g){case \\\"w\\\":c.colattribs.width[l]=d[f++];break;case \\\"hide\\\":c.colattribs.hide[l]=d[f++];break;default:throw h.s_pssUnknownColType+\\\" '\\\"+g+\\\"'\\\";}break;case \\\"row\\\":l=d[1]-0;for(f=2;g=d[f++];)switch(g){case \\\"h\\\":c.rowattribs.height[l]=\\nd[f++]-0;break;case \\\"hide\\\":c.rowattribs.hide[l]=d[f++];break;default:throw h.s_pssUnknownRowType+\\\" '\\\"+g+\\\"'\\\";}break;case \\\"sheet\\\":l=c.attribs;for(f=1;g=d[f++];)switch(g){case \\\"c\\\":l.lastcol=d[f++]-0;break;case \\\"r\\\":l.lastrow=d[f++]-0;break;case \\\"w\\\":l.defaultcolwidth=d[f++]+\\\"\\\";break;case \\\"h\\\":l.defaultrowheight=d[f++]-0;break;case \\\"tf\\\":l.defaulttextformat=d[f++]-0;break;case \\\"ntf\\\":l.defaultnontextformat=d[f++]-0;break;case \\\"layout\\\":l.defaultlayout=d[f++]-0;break;case \\\"font\\\":l.defaultfont=d[f++]-0;break;\\ncase \\\"tvf\\\":l.defaulttextvalueformat=d[f++]-0;break;case \\\"ntvf\\\":l.defaultnontextvalueformat=d[f++]-0;break;case \\\"color\\\":l.defaultcolor=d[f++]-0;break;case \\\"bgcolor\\\":l.defaultbgcolor=d[f++]-0;break;case \\\"circularreferencecell\\\":l.circularreferencecell=d[f++];break;case \\\"recalc\\\":l.recalc=d[f++];break;case \\\"needsrecalc\\\":l.needsrecalc=d[f++];break;case \\\"usermaxcol\\\":l.usermaxcol=d[f++]-0;break;case \\\"usermaxrow\\\":l.usermaxrow=d[f++]-0;break;default:f+=1}break;case \\\"name\\\":f=SocialCalc.decodeFromSave(d[1]).toUpperCase();\\nc.names[f]={desc:SocialCalc.decodeFromSave(d[2])};c.names[f].definition=SocialCalc.decodeFromSave(d[3]);break;case \\\"layout\\\":d=b[e].match(/^layout\\\\:(\\\\d+)\\\\:(.+)$/);c.layouts[d[1]-0]=d[2];c.layouthash[d[2]]=d[1]-0;break;case \\\"font\\\":c.fonts[d[1]-0]=d[2];c.fonthash[d[2]]=d[1]-0;break;case \\\"color\\\":c.colors[d[1]-0]=d[2];c.colorhash[d[2]]=d[1]-0;break;case \\\"border\\\":c.borderstyles[d[1]-0]=d[2];c.borderstylehash[d[2]]=d[1]-0;break;case \\\"cellformat\\\":f=SocialCalc.decodeFromSave(d[2]);c.cellformats[d[1]-0]=f;\\nc.cellformathash[f]=d[1]-0;break;case \\\"valueformat\\\":f=SocialCalc.decodeFromSave(d[2]);c.valueformats[d[1]-0]=f;c.valueformathash[f]=d[1]-0;break;case \\\"version\\\":break;case \\\"copiedfrom\\\":c.copiedfrom=d[1]+\\\":\\\"+d[2];break;case \\\"clipboardrange\\\":case \\\"clipboard\\\":break;case \\\"\\\":break;default:throw alert(h.s_pssUnknownLineType+\\\" '\\\"+d[0]+\\\"'\\\"),h.s_pssUnknownLineType+\\\" '\\\"+d[0]+\\\"'\\\";}};\\nSocialCalc.CellFromStringParts=function(a,c,b,d){for(;a=b[d++];)switch(a){case \\\"v\\\":c.datavalue=SocialCalc.decodeFromSave(b[d++])-0;c.datatype=\\\"v\\\";c.valuetype=\\\"n\\\";break;case \\\"t\\\":c.datavalue=SocialCalc.decodeFromSave(b[d++]);c.datatype=\\\"t\\\";c.valuetype=SocialCalc.Constants.textdatadefaulttype;break;case \\\"vt\\\":a=b[d++];c.valuetype=a;\\\"n\\\"==a.charAt(0)?(c.datatype=\\\"v\\\",c.datavalue=SocialCalc.decodeFromSave(b[d++])-0):(c.datatype=\\\"t\\\",c.datavalue=SocialCalc.decodeFromSave(b[d++]));break;case \\\"vtf\\\":a=b[d++];\\nc.valuetype=a;\\\"n\\\"==a.charAt(0)?c.datavalue=SocialCalc.decodeFromSave(b[d++])-0:c.datavalue=SocialCalc.decodeFromSave(b[d++]);c.formula=SocialCalc.decodeFromSave(b[d++]);c.datatype=\\\"f\\\";break;case \\\"vtc\\\":a=b[d++];c.valuetype=a;\\\"n\\\"==a.charAt(0)?c.datavalue=SocialCalc.decodeFromSave(b[d++])-0:c.datavalue=SocialCalc.decodeFromSave(b[d++]);c.formula=SocialCalc.decodeFromSave(b[d++]);c.datatype=\\\"c\\\";break;case \\\"ro\\\":ro=SocialCalc.decodeFromSave(b[d++]);c.readonly=\\\"yes\\\"==ro.toLowerCase();break;case \\\"e\\\":c.errors=\\nSocialCalc.decodeFromSave(b[d++]);break;case \\\"b\\\":c.bt=b[d++]-0;c.br=b[d++]-0;c.bb=b[d++]-0;c.bl=b[d++]-0;break;case \\\"l\\\":c.layout=b[d++]-0;break;case \\\"f\\\":c.font=b[d++]-0;break;case \\\"c\\\":c.color=b[d++]-0;break;case \\\"bg\\\":c.bgcolor=b[d++]-0;break;case \\\"cf\\\":c.cellformat=b[d++]-0;break;case \\\"ntvf\\\":c.nontextvalueformat=b[d++]-0;break;case \\\"tvf\\\":c.textvalueformat=b[d++]-0;break;case \\\"colspan\\\":c.colspan=b[d++]-0;break;case \\\"rowspan\\\":c.rowspan=b[d++]-0;break;case \\\"cssc\\\":c.cssc=b[d++];break;case \\\"csss\\\":c.csss=\\nSocialCalc.decodeFromSave(b[d++]);break;case \\\"mod\\\":d+=1;break;case \\\"comment\\\":c.comment=SocialCalc.decodeFromSave(b[d++]);break;default:throw SocialCalc.Constants.s_cfspUnknownCellType+\\\" '\\\"+a+\\\"'\\\";}};SocialCalc.sheetfields=\\\"defaultrowheight defaultcolwidth circularreferencecell recalc needsrecalc usermaxcol usermaxrow\\\".split(\\\" \\\");SocialCalc.sheetfieldsshort=\\\"h w circularreferencecell recalc needsrecalc usermaxcol usermaxrow\\\".split(\\\" \\\");SocialCalc.sheetfieldsxlat=\\\"defaulttextformat defaultnontextformat defaulttextvalueformat defaultnontextvalueformat defaultcolor defaultbgcolor defaultfont defaultlayout\\\".split(\\\" \\\");\\nSocialCalc.sheetfieldsxlatshort=\\\"tf ntf tvf ntvf color bgcolor font layout\\\".split(\\\" \\\");SocialCalc.sheetfieldsxlatxlt=\\\"cellformat cellformat valueformat valueformat color color font layout\\\".split(\\\" \\\");\\nSocialCalc.CreateSheetSave=function(a,c,b){var d,e,f,g,l,h=[];a.CanonicalizeSheet(b||SocialCalc.Constants.doCanonicalizeSheet);var m=a.xlt;e=c?SocialCalc.ParseRange(c):{cr1:{row:1,col:1},cr2:{row:m.maxrow,col:m.maxcol}};b=e.cr1;e=e.cr2;h.push(\\\"version:1.5\\\");for(f=b.row;f<=e.row;f++)for(g=b.col;g<=e.col;g++)if(l=SocialCalc.crToCoord(g,f),d=a.cells[l])d=a.CellToString(d),0!=d.length&&(d=\\\"cell:\\\"+l+d,h.push(d));for(g=1;g<=m.maxcol;g++)l=SocialCalc.rcColname(g),a.colattribs.width[l]&&h.push(\\\"col:\\\"+l+\\\":w:\\\"+\\na.colattribs.width[l]),a.colattribs.hide[l]&&h.push(\\\"col:\\\"+l+\\\":hide:\\\"+a.colattribs.hide[l]);for(f=1;f<=m.maxrow;f++)a.rowattribs.height[f]&&h.push(\\\"row:\\\"+f+\\\":h:\\\"+a.rowattribs.height[f]),a.rowattribs.hide[f]&&h.push(\\\"row:\\\"+f+\\\":hide:\\\"+a.rowattribs.hide[f]);d=\\\"sheet:c:\\\"+m.maxcol+\\\":r:\\\"+m.maxrow;for(f=0;f<SocialCalc.sheetfields.length;f++)(g=SocialCalc.encodeForSave(a.attribs[SocialCalc.sheetfields[f]]))&&(d+=\\\":\\\"+SocialCalc.sheetfieldsshort[f]+\\\":\\\"+g);for(f=0;f<SocialCalc.sheetfieldsxlat.length;f++)(g=\\na.attribs[SocialCalc.sheetfieldsxlat[f]])&&(d+=\\\":\\\"+SocialCalc.sheetfieldsxlatshort[f]+\\\":\\\"+m[SocialCalc.sheetfieldsxlatxlt[f]+\\\"sxlat\\\"][g]);h.push(d);for(f=1;f<m.newborderstyles.length;f++)h.push(\\\"border:\\\"+f+\\\":\\\"+m.newborderstyles[f]);for(f=1;f<m.newcellformats.length;f++)h.push(\\\"cellformat:\\\"+f+\\\":\\\"+SocialCalc.encodeForSave(m.newcellformats[f]));for(f=1;f<m.newcolors.length;f++)h.push(\\\"color:\\\"+f+\\\":\\\"+m.newcolors[f]);for(f=1;f<m.newfonts.length;f++)h.push(\\\"font:\\\"+f+\\\":\\\"+m.newfonts[f]);for(f=1;f<m.newlayouts.length;f++)h.push(\\\"layout:\\\"+\\nf+\\\":\\\"+m.newlayouts[f]);for(f=1;f<m.newvalueformats.length;f++)h.push(\\\"valueformat:\\\"+f+\\\":\\\"+SocialCalc.encodeForSave(m.newvalueformats[f]));for(f=0;f<m.namesorder.length;f++)d=m.namesorder[f],h.push(\\\"name:\\\"+SocialCalc.encodeForSave(d).toUpperCase()+\\\":\\\"+SocialCalc.encodeForSave(a.names[d].desc)+\\\":\\\"+SocialCalc.encodeForSave(a.names[d].definition));c&&h.push(\\\"copiedfrom:\\\"+SocialCalc.crToCoord(b.col,b.row)+\\\":\\\"+SocialCalc.crToCoord(e.col,e.row));h.push(\\\"\\\");delete a.xlt;return h.join(\\\"\\\\n\\\")};\\nSocialCalc.CellToString=function(a,c){var b,d,e,f,g,l;b=\\\"\\\";if(!c)return b;d=SocialCalc.encodeForSave(c.datavalue);\\\"v\\\"==c.datatype?b=\\\"n\\\"==c.valuetype?b+(\\\":v:\\\"+d):b+(\\\":vt:\\\"+c.valuetype+\\\":\\\"+d):\\\"t\\\"==c.datatype?b=c.valuetype==SocialCalc.Constants.textdatadefaulttype?b+(\\\":t:\\\"+d):b+(\\\":vt:\\\"+c.valuetype+\\\":\\\"+d):(e=SocialCalc.encodeForSave(c.formula),\\\"f\\\"==c.datatype?b+=\\\":vtf:\\\"+c.valuetype+\\\":\\\"+d+\\\":\\\"+e:\\\"c\\\"==c.datatype&&(b+=\\\":vtc:\\\"+c.valuetype+\\\":\\\"+d+\\\":\\\"+e));c.readonly&&(b+=\\\":ro:yes\\\");c.errors&&(b+=\\\":e:\\\"+SocialCalc.encodeForSave(c.errors));\\nd=c.bt||\\\"\\\";e=c.br||\\\"\\\";f=c.bb||\\\"\\\";g=c.bl||\\\"\\\";if(a.xlt){l=a.xlt;if(d||e||f||g)b+=\\\":b:\\\"+l.borderstylesxlat[d||0]+\\\":\\\"+l.borderstylesxlat[e||0]+\\\":\\\"+l.borderstylesxlat[f||0]+\\\":\\\"+l.borderstylesxlat[g||0];c.layout&&(b+=\\\":l:\\\"+l.layoutsxlat[c.layout]);c.font&&(b+=\\\":f:\\\"+l.fontsxlat[c.font]);c.color&&(b+=\\\":c:\\\"+l.colorsxlat[c.color]);c.bgcolor&&(b+=\\\":bg:\\\"+l.colorsxlat[c.bgcolor]);c.cellformat&&(b+=\\\":cf:\\\"+l.cellformatsxlat[c.cellformat]);c.textvalueformat&&(b+=\\\":tvf:\\\"+l.valueformatsxlat[c.textvalueformat]);c.nontextvalueformat&&\\n(b+=\\\":ntvf:\\\"+l.valueformatsxlat[c.nontextvalueformat])}else{if(d||e||f||g)b+=\\\":b:\\\"+d+\\\":\\\"+e+\\\":\\\"+f+\\\":\\\"+g;c.layout&&(b+=\\\":l:\\\"+c.layout);c.font&&(b+=\\\":f:\\\"+c.font);c.color&&(b+=\\\":c:\\\"+c.color);c.bgcolor&&(b+=\\\":bg:\\\"+c.bgcolor);c.cellformat&&(b+=\\\":cf:\\\"+c.cellformat);c.textvalueformat&&(b+=\\\":tvf:\\\"+c.textvalueformat);c.nontextvalueformat&&(b+=\\\":ntvf:\\\"+c.nontextvalueformat)}c.colspan&&(b+=\\\":colspan:\\\"+c.colspan);c.rowspan&&(b+=\\\":rowspan:\\\"+c.rowspan);c.cssc&&(b+=\\\":cssc:\\\"+c.cssc);c.csss&&(b+=\\\":csss:\\\"+SocialCalc.encodeForSave(c.csss));\\nc.mod&&(b+=\\\":mod:\\\"+c.mod);c.comment&&(b+=\\\":comment:\\\"+SocialCalc.encodeForSave(c.comment));return b};\\nSocialCalc.CanonicalizeSheet=function(a,c){var b,d,e,f,g,l,h,m=0,p=0,r=\\\"borderstyle cellformat color font layout valueformat\\\".split(\\\" \\\"),q={namesorder:[]};for(g in a.names)q.namesorder.push(g);q.namesorder.sort();if(SocialCalc.Constants.doCanonicalizeSheet&&c){for(f=0;f<r.length;f++)g=r[f],q[g+\\\"sUsed\\\"]={};h=q.colorsUsed;l=q.borderstylesUsed;var n=q.fontsUsed,s=q.layoutsUsed,t=q.cellformatsUsed,u=q.valueformatsUsed;for(d in a.cells)e=SocialCalc.coordToCr(d),f=a.cells[d],g=!1,f.valuetype&&\\\"b\\\"!=f.valuetype&&\\n(g=!0),f.color&&(h[f.color]=1,g=!0),f.bgcolor&&(h[f.bgcolor]=1,g=!0),f.bt&&(l[f.bt]=1,g=!0),f.br&&(l[f.br]=1,g=!0),f.bb&&(l[f.bb]=1,g=!0),f.bl&&(l[f.bl]=1,g=!0),f.layout&&(s[f.layout]=1,g=!0),f.font&&(n[f.font]=1,g=!0),f.cellformat&&(t[f.cellformat]=1,g=!0),f.textvalueformat&&(u[f.textvalueformat]=1,g=!0),f.nontextvalueformat&&(u[f.nontextvalueformat]=1,g=!0),g&&(e.row>m&&(m=e.row),e.col>p&&(p=e.col));for(h=0;h<SocialCalc.sheetfieldsxlat.length;h++)(b=a.attribs[SocialCalc.sheetfieldsxlat[h]])&&(q[SocialCalc.sheetfieldsxlatxlt[h]+\\n\\\"sUsed\\\"][b]=1);g={height:1,hide:1};for(b in g)for(e in a.rowattribs[b])e>m&&(m=e);g={hide:1,width:1};for(b in g)for(d in a.colattribs[b])e=SocialCalc.coordToCr(d+\\\"1\\\"),e.col>p&&(p=e.col);for(f=0;f<r.length;f++){g=r[f];d=[];e=q[g+\\\"sUsed\\\"];for(b in e)d.push(a[g+\\\"s\\\"][b]);d.sort();d.unshift(\\\"\\\");e=[\\\"\\\"];l=a[g+\\\"hash\\\"];for(h=1;h<d.length;h++)e[l[d[h]]]=h;q[g+\\\"sxlat\\\"]=e;q[\\\"new\\\"+g+\\\"s\\\"]=d}q.maxrow=m||1;q.maxcol=p||1}else{for(f=0;f<r.length;f++){g=r[f];q[\\\"new\\\"+g+\\\"s\\\"]=a[g+\\\"s\\\"];b=a[g+\\\"s\\\"].length;e=Array(b);e[0]=\\n\\\"\\\";for(h=1;h<b;h++)e[h]=h;q[g+\\\"sxlat\\\"]=e}q.maxrow=a.attribs.lastrow;q.maxcol=a.attribs.lastcol}a.xlt=q};\\nSocialCalc.EncodeCellAttributes=function(a,c){var b,d,e={},f=function(a){e[a]={def:!0,val:\\\"\\\"}},g=function(a){for(var b=0;b<a.length;b++)f(a[b])},l=function(a,b){e[a].def=!1;e[a].val=b||\\\"\\\"};b=function(a,b){\\\"*\\\"!=b&&(e[a].def=!1,e[a].val=b)};var h=a.GetAssuredCell(c);f(\\\"alignhoriz\\\");h.cellformat&&l(\\\"alignhoriz\\\",a.cellformats[h.cellformat]);g([\\\"alignvert\\\",\\\"padtop\\\",\\\"padright\\\",\\\"padbottom\\\",\\\"padleft\\\"]);h.layout&&(parts=a.layouts[h.layout].match(/^padding:\\\\s*(\\\\S+)\\\\s+(\\\\S+)\\\\s+(\\\\S+)\\\\s+(\\\\S+);vertical-align:\\\\s*(\\\\S+);/),\\nb(\\\"padtop\\\",parts[1]),b(\\\"padright\\\",parts[2]),b(\\\"padbottom\\\",parts[3]),b(\\\"padleft\\\",parts[4]),b(\\\"alignvert\\\",parts[5]));g([\\\"fontfamily\\\",\\\"fontlook\\\",\\\"fontsize\\\"]);h.font&&(parts=a.fonts[h.font].match(/^(\\\\*|\\\\S+? \\\\S+?) (\\\\S+?) (\\\\S.*)$/),b(\\\"fontfamily\\\",parts[3]),b(\\\"fontsize\\\",parts[2]),b(\\\"fontlook\\\",parts[1]));f(\\\"textcolor\\\");h.color&&l(\\\"textcolor\\\",a.colors[h.color]);f(\\\"bgcolor\\\");h.bgcolor&&l(\\\"bgcolor\\\",a.colors[h.bgcolor]);g([\\\"numberformat\\\",\\\"textformat\\\"]);h.nontextvalueformat&&l(\\\"numberformat\\\",a.valueformats[h.nontextvalueformat]);\\nh.textvalueformat&&l(\\\"textformat\\\",a.valueformats[h.textvalueformat]);g([\\\"colspan\\\",\\\"rowspan\\\"]);l(\\\"colspan\\\",h.colspan||1);l(\\\"rowspan\\\",h.rowspan||1);for(b=0;4>b;b++)d=\\\"trbl\\\".charAt(b),d=\\\"b\\\"+d,f(d),l(d,h[d]?a.borderstyles[h[d]]:\\\"\\\"),f(d+\\\"thickness\\\"),f(d+\\\"style\\\"),f(d+\\\"color\\\"),h[d]&&(parts=a.borderstyles[h[d]].match(/(\\\\S+)\\\\s+(\\\\S+)\\\\s+(\\\\S.+)/),l(d+\\\"thickness\\\",parts[1]),l(d+\\\"style\\\",parts[2]),l(d+\\\"color\\\",parts[3]));g([\\\"cssc\\\",\\\"csss\\\",\\\"mod\\\"]);l(\\\"cssc\\\",h.cssc||\\\"\\\");l(\\\"csss\\\",h.csss||\\\"\\\");l(\\\"mod\\\",h.mod||\\\"n\\\");return e};\\nSocialCalc.EncodeSheetAttributes=function(a){var c=a.attribs,b={},d=function(a){b[a]={def:!0,val:\\\"\\\"}},e=function(a){for(var b=0;b<a.length;b++)d(a[b])},f=function(a,c){b[a].def=!1;b[a].val=c||void 0},g=function(a,c){\\\"*\\\"!=c&&(b[a].def=!1,b[a].val=c)};d(\\\"colwidth\\\");c.defaultcolwidth&&f(\\\"colwidth\\\",c.defaultcolwidth);d(\\\"rowheight\\\");c.rowheight&&f(\\\"rowheight\\\",c.defaultrowheight);d(\\\"textalignhoriz\\\");c.defaulttextformat&&f(\\\"textalignhoriz\\\",a.cellformats[c.defaulttextformat]);d(\\\"numberalignhoriz\\\");c.defaultnontextformat&&\\nf(\\\"numberalignhoriz\\\",a.cellformats[c.defaultnontextformat]);e([\\\"alignvert\\\",\\\"padtop\\\",\\\"padright\\\",\\\"padbottom\\\",\\\"padleft\\\"]);c.defaultlayout&&(parts=a.layouts[c.defaultlayout].match(/^padding:\\\\s*(\\\\S+)\\\\s+(\\\\S+)\\\\s+(\\\\S+)\\\\s+(\\\\S+);vertical-align:\\\\s*(\\\\S+);/),g(\\\"padtop\\\",parts[1]),g(\\\"padright\\\",parts[2]),g(\\\"padbottom\\\",parts[3]),g(\\\"padleft\\\",parts[4]),g(\\\"alignvert\\\",parts[5]));e([\\\"fontfamily\\\",\\\"fontlook\\\",\\\"fontsize\\\"]);c.defaultfont&&(parts=a.fonts[c.defaultfont].match(/^(\\\\*|\\\\S+? \\\\S+?) (\\\\S+?) (\\\\S.*)$/),g(\\\"fontfamily\\\",\\nparts[3]),g(\\\"fontsize\\\",parts[2]),g(\\\"fontlook\\\",parts[1]));d(\\\"textcolor\\\");c.defaultcolor&&f(\\\"textcolor\\\",a.colors[c.defaultcolor]);d(\\\"bgcolor\\\");c.defaultbgcolor&&f(\\\"bgcolor\\\",a.colors[c.defaultbgcolor]);e([\\\"numberformat\\\",\\\"textformat\\\"]);c.defaultnontextvalueformat&&f(\\\"numberformat\\\",a.valueformats[c.defaultnontextvalueformat]);c.defaulttextvalueformat&&f(\\\"textformat\\\",a.valueformats[c.defaulttextvalueformat]);d(\\\"recalc\\\");c.recalc&&f(\\\"recalc\\\",c.recalc);d(\\\"usermaxcol\\\");c.usermaxcol&&f(\\\"usermaxcol\\\",c.usermaxcol);\\nd(\\\"usermaxrow\\\");c.usermaxrow&&f(\\\"usermaxrow\\\",c.usermaxrow);return b};\\nSocialCalc.DecodeCellAttributes=function(a,c,b,d){var e,f=a.GetAssuredCell(c),g=!1,l=function(a,c,d){b[a]&&(a=b[a].def?\\\"\\\":b[a].val,a!=(c||\\\"\\\")&&m(d+\\\" \\\"+a))},h=\\\"\\\",m=function(a){h&&(h+=\\\"\\\\n\\\");h+=\\\"set \\\"+(d||c)+\\\" \\\"+a;g=!0};l(\\\"alignhoriz\\\",a.cellformats[f.cellformat],\\\"cellformat\\\");e=b.alignvert.def&&b.padtop.def&&b.padright.def&&b.padbottom.def&&b.padleft.def?\\\"\\\":\\\"padding:\\\"+(b.padtop.def?\\\"* \\\":b.padtop.val+\\\" \\\")+(b.padright.def?\\\"* \\\":b.padright.val+\\\" \\\")+(b.padbottom.def?\\\"* \\\":b.padbottom.val+\\\" \\\")+(b.padleft.def?\\n\\\"*\\\":b.padleft.val)+\\\";vertical-align:\\\"+(b.alignvert.def?\\\"*;\\\":b.alignvert.val+\\\";\\\");e!=(a.layouts[f.layout]||\\\"\\\")&&m(\\\"layout \\\"+e);e=b.fontlook.def&&b.fontsize.def&&b.fontfamily.def?\\\"\\\":(b.fontlook.def?\\\"* \\\":b.fontlook.val+\\\" \\\")+(b.fontsize.def?\\\"* \\\":b.fontsize.val+\\\" \\\")+(b.fontfamily.def?\\\"*\\\":b.fontfamily.val);e!=(a.fonts[f.font]||\\\"\\\")&&m(\\\"font \\\"+e);l(\\\"textcolor\\\",a.colors[f.color],\\\"color\\\");l(\\\"bgcolor\\\",a.colors[f.bgcolor],\\\"bgcolor\\\");l(\\\"numberformat\\\",a.valueformats[f.nontextvalueformat],\\\"nontextvalueformat\\\");\\nl(\\\"textformat\\\",a.valueformats[f.textvalueformat],\\\"textvalueformat\\\");for(i=0;4>i;i++)e=\\\"trbl\\\".charAt(i),e=\\\"b\\\"+e,l(e,a.borderstyles[f[e]],e);l(\\\"cssc\\\",f.cssc,\\\"cssc\\\");l(\\\"csss\\\",f.csss,\\\"csss\\\");b.mod&&(e=b.mod.def?\\\"n\\\":b.mod.val,e!=(f.mod||\\\"n\\\")&&(\\\"n\\\"==e&&(e=\\\"\\\"),m(\\\"mod \\\"+e)));return g?h:null};\\nSocialCalc.DecodeSheetAttributes=function(a,c){var b,d=a.attribs,e=!1,f=function(a,b,d){c[a]&&(a=c[a].def?\\\"\\\":c[a].val,a!=(b||\\\"\\\")&&l(d+\\\" \\\"+a))},g=\\\"\\\",l=function(a){g&&(g+=\\\"\\\\n\\\");g+=\\\"set sheet \\\"+a;e=!0};f(\\\"colwidth\\\",d.defaultcolwidth,\\\"defaultcolwidth\\\");f(\\\"rowheight\\\",d.defaultrowheight,\\\"defaultrowheight\\\");f(\\\"textalignhoriz\\\",a.cellformats[d.defaulttextformat],\\\"defaulttextformat\\\");f(\\\"numberalignhoriz\\\",a.cellformats[d.defaultnontextformat],\\\"defaultnontextformat\\\");b=c.alignvert.def&&c.padtop.def&&c.padright.def&&\\nc.padbottom.def&&c.padleft.def?\\\"\\\":\\\"padding:\\\"+(c.padtop.def?\\\"* \\\":c.padtop.val+\\\" \\\")+(c.padright.def?\\\"* \\\":c.padright.val+\\\" \\\")+(c.padbottom.def?\\\"* \\\":c.padbottom.val+\\\" \\\")+(c.padleft.def?\\\"*\\\":c.padleft.val)+\\\";vertical-align:\\\"+(c.alignvert.def?\\\"*;\\\":c.alignvert.val+\\\";\\\");b!=(a.layouts[d.defaultlayout]||\\\"\\\")&&l(\\\"defaultlayout \\\"+b);b=c.fontlook.def&&c.fontsize.def&&c.fontfamily.def?\\\"\\\":(c.fontlook.def?\\\"* \\\":c.fontlook.val+\\\" \\\")+(c.fontsize.def?\\\"* \\\":c.fontsize.val+\\\" \\\")+(c.fontfamily.def?\\\"*\\\":c.fontfamily.val);b!=(a.fonts[d.defaultfont]||\\n\\\"\\\")&&l(\\\"defaultfont \\\"+b);f(\\\"textcolor\\\",a.colors[d.defaultcolor],\\\"defaultcolor\\\");f(\\\"bgcolor\\\",a.colors[d.defaultbgcolor],\\\"defaultbgcolor\\\");f(\\\"numberformat\\\",a.valueformats[d.defaultnontextvalueformat],\\\"defaultnontextvalueformat\\\");f(\\\"textformat\\\",a.valueformats[d.defaulttextvalueformat],\\\"defaulttextvalueformat\\\");f(\\\"recalc\\\",a.attribs.recalc,\\\"recalc\\\");f(\\\"usermaxcol\\\",a.attribs.usermaxcol,\\\"usermaxcol\\\");f(\\\"usermaxrow\\\",a.attribs.usermaxrow,\\\"usermaxrow\\\");return e?g:null};\\nSocialCalc.SheetCommandInfo=function(a){this.sheetobj=a;this.timerobj=this.parseobj=null;this.firsttimerdelay=50;this.timerdelay=1;this.maxtimeslice=100;this.saveundo=!1;this.CmdExtensionCallbacks={};this.cmdextensionbusy=\\\"\\\"};\\nSocialCalc.ScheduleSheetCommands=function(a,c,b){hack.log('\\\"'+c+'\\\"',hack.com,\\\"SocialCalc.ScheduleSheetCommands\\\");var d=a.sci;d.parseobj=new SocialCalc.Parse(c);d.saveundo=b;d.sheetobj.statuscallback&&a.statuscallback(d,\\\"cmdstart\\\",\\\"\\\",d.sheetobj.statuscallbackparams);d.saveundo&&d.sheetobj.changes.PushChange(\\\"\\\");d.timerobj=SocialCalc.Callbacks.broadcast?window.setTimeout(function(){var a=d.parseobj;d.parseobj=new SocialCalc.Parse(c);SocialCalc.SheetCommandsTimerRoutine(d);d.parseobj=a},d.firsttimerdelay):\\nwindow.setTimeout(function(){SocialCalc.SheetCommandsTimerRoutine(d)},d.firsttimerdelay)};\\nSocialCalc.SheetCommandsTimerRoutine=function(a){var c,b=new Date;for(a.timerobj=null;!a.parseobj.EOF();){(c=SocialCalc.ExecuteSheetCommand(a.sheetobj,a.parseobj,a.saveundo))&&alert(c);a.parseobj.NextLine();if(0<a.cmdextensionbusy.length){a.sheetobj.statuscallback&&a.sheetobj.statuscallback(a,\\\"cmdextension\\\",a.cmdextensionbusy,a.sheetobj.statuscallbackparams);return}if(new Date-b>=a.maxtimeslice){a.timerobj=window.setTimeout(function(){SocialCalc.SheetCommandsTimerRoutine(a)},a.timerdelay);return}}a.sheetobj.statuscallback&&\\na.sheetobj.statuscallback(a,\\\"cmdend\\\",\\\"\\\",a.sheetobj.statuscallbackparams)};SocialCalc.ResumeFromCmdExtension=function(a){a.cmdextensionbusy=\\\"\\\";SocialCalc.SheetCommandsTimerRoutine(a)};\\nSocialCalc.ExecuteSheetCommand=function(a,c,b){var d,e,f,g,l,h,m,p,r,q,n,s,t,u,w,v,x,y,z,C,D,G,I,E,H,B,A=a.attribs;B=a.changes;D=SocialCalc.CellProperties;w=SocialCalc.Constants;q=function(){var a=SocialCalc.ParseRange(g);p=a.cr1;r=a.cr2;r.col>A.lastcol&&(A.lastcol=r.col);r.row>A.lastrow&&(A.lastrow=r.row)};m=\\\"\\\";d=c.RestOfStringNoMove();b&&a.changes.AddDo(d);e=c.NextToken();TiddlyWiki&&(n=SocialCalc.GetSpreadsheetControlObject(),n.tiddlyWiki.monitorCallback&&n.tiddlyWiki.monitorCallback(d));switch(e){case \\\"set\\\":g=\\nc.NextToken();l=c.NextToken();f=c.RestOfString();c=\\\"set \\\"+g+\\\" \\\"+l;if(\\\"sheet\\\"==g)switch(a.renderneeded=!0,l){case \\\"defaultcolwidth\\\":b&&B.AddUndo(c,A[l]);A[l]=f;break;case \\\"defaultcolor\\\":case \\\"defaultbgcolor\\\":b&&B.AddUndo(c,a.GetStyleString(\\\"color\\\",A[l]));A[l]=a.GetStyleNum(\\\"color\\\",f);break;case \\\"defaultlayout\\\":b&&B.AddUndo(c,a.GetStyleString(\\\"layout\\\",A[l]));A[l]=a.GetStyleNum(\\\"layout\\\",f);break;case \\\"defaultfont\\\":b&&B.AddUndo(c,a.GetStyleString(\\\"font\\\",A[l]));\\\"* * *\\\"==f&&(f=\\\"\\\");A[l]=a.GetStyleNum(\\\"font\\\",\\nf);break;case \\\"defaulttextformat\\\":case \\\"defaultnontextformat\\\":b&&B.AddUndo(c,a.GetStyleString(\\\"cellformat\\\",A[l]));A[l]=a.GetStyleNum(\\\"cellformat\\\",f);break;case \\\"defaulttextvalueformat\\\":case \\\"defaultnontextvalueformat\\\":b&&B.AddUndo(c,a.GetStyleString(\\\"valueformat\\\",A[l]));A[l]=a.GetStyleNum(\\\"valueformat\\\",f);for(h in a.cells)delete a.cells[h].displaystring;break;case \\\"lastcol\\\":case \\\"lastrow\\\":b&&B.AddUndo(c,A[l]-0);a=f-0;\\\"number\\\"==typeof a&&(A[l]=0<a?a:1);break;case \\\"recalc\\\":b&&B.AddUndo(c,A[l]);\\\"off\\\"==\\nf?A.recalc=f:delete A.recalc;break;case \\\"usermaxcol\\\":case \\\"usermaxrow\\\":b&&B.AddUndo(c,A[l]-0);a=f-0;\\\"number\\\"==typeof a&&(A[l]=0<a?a:0);break;default:m=w.s_escUnknownSheetCmd+d}else if(/^[a-z]{1,2}(:[a-z]{1,2})?$/i.test(g))for(a.renderneeded=!0,g=g.toUpperCase(),h=g.indexOf(\\\":\\\"),0<=h?(p=SocialCalc.coordToCr(g.substring(0,h)+\\\"1\\\"),r=SocialCalc.coordToCr(g.substring(h+1)+\\\"1\\\")):r=p=SocialCalc.coordToCr(g+\\\"1\\\"),c=p.col;c<=r.col;c++)\\\"width\\\"==l?(h=SocialCalc.rcColname(c),b&&B.AddUndo(\\\"set \\\"+h+\\\" width\\\",a.colattribs.width[h]),\\n0<f.length?a.colattribs.width[h]=f:delete a.colattribs.width[h]):\\\"hide\\\"==l&&(a.hiddencolrow=\\\"col\\\",h=SocialCalc.rcColname(c),b&&B.AddUndo(\\\"set \\\"+h+\\\" hide\\\",a.colattribs.hide[h]),0<f.length?a.colattribs.hide[h]=f:delete a.colattribs.hide[h]);else if(/^\\\\d+(:\\\\d+)?$/i.test(g))for(a.renderneeded=!0,g=g.toUpperCase(),h=g.indexOf(\\\":\\\"),0<=h?(p=SocialCalc.coordToCr(\\\"A\\\"+g.substring(0,h)),r=SocialCalc.coordToCr(\\\"A\\\"+g.substring(h+1))):r=p=SocialCalc.coordToCr(\\\"A\\\"+g),q=p.row;q<=r.row;q++)\\\"height\\\"==l?(b&&B.AddUndo(\\\"set \\\"+\\nq+\\\" height\\\",a.rowattribs.height[q]),0<f.length?a.rowattribs.height[q]=f:delete a.rowattribs.height[q]):\\\"hide\\\"==l&&(a.hiddencolrow=\\\"row\\\",b&&B.AddUndo(\\\"set \\\"+q+\\\" hide\\\",a.rowattribs.hide[q]),0<f.length?a.rowattribs.hide[q]=f:delete a.rowattribs.hide[q]);else if(/^[a-z]{1,2}\\\\d+(:[a-z]{1,2}\\\\d+)?$/i.test(g))for(q(),p.row!=r.row||p.col!=r.col||a.celldisplayneeded||a.renderneeded?(a.renderneeded=!0,a.celldisplayneeded=\\\"\\\"):a.celldisplayneeded=SocialCalc.crToCoord(p.col,p.row),q=p.row;q<=r.row;q++)for(c=p.col;c<=\\nr.col;c++)h=SocialCalc.crToCoord(c,q),n=a.GetAssuredCell(h),n.readonly&&\\\"readonly\\\"!=l||(b&&B.AddUndo(\\\"set \\\"+h+\\\" all\\\",a.CellToString(n)),\\\"value\\\"==l?(h=f.indexOf(\\\" \\\"),n.datavalue=f.substring(h+1)-0,delete n.errors,n.datatype=\\\"v\\\",n.valuetype=f.substring(0,h),delete n.displaystring,delete n.parseinfo,A.needsrecalc=\\\"yes\\\"):\\\"text\\\"==l?(h=f.indexOf(\\\" \\\"),n.datavalue=SocialCalc.decodeFromSave(f.substring(h+1)),delete n.errors,n.datatype=\\\"t\\\",n.valuetype=f.substring(0,h),delete n.displaystring,delete n.parseinfo,\\nA.needsrecalc=\\\"yes\\\"):\\\"formula\\\"==l?(n.datavalue=0,delete n.errors,n.datatype=\\\"f\\\",n.valuetype=\\\"e#N/A\\\",n.formula=f,delete n.displaystring,delete n.parseinfo,A.needsrecalc=\\\"yes\\\"):\\\"constant\\\"==l?(h=f.indexOf(\\\" \\\"),e=f.substring(h+1).indexOf(\\\" \\\"),n.datavalue=f.substring(h+1,h+1+e)-0,n.valuetype=f.substring(0,h),\\\"e\\\"==n.valuetype.charAt(0)?n.errors=n.valuetype.substring(1):delete n.errors,n.datatype=\\\"c\\\",n.formula=f.substring(h+e+2),delete n.displaystring,delete n.parseinfo,A.needsrecalc=\\\"yes\\\"):\\\"empty\\\"==l?(n.datavalue=\\n\\\"\\\",delete n.errors,n.datatype=null,n.formula=\\\"\\\",n.valuetype=\\\"b\\\",delete n.displaystring,delete n.parseinfo,A.needsrecalc=\\\"yes\\\"):\\\"all\\\"==l?(0<f.length?(n=new SocialCalc.Cell(h),a.CellFromStringParts(n,f.split(\\\":\\\"),1),a.cells[h]=n):delete a.cells[h],A.needsrecalc=\\\"yes\\\"):/^b[trbl]$/.test(l)?(n[l]=a.GetStyleNum(\\\"borderstyle\\\",f),a.renderneeded=!0):\\\"color\\\"==l||\\\"bgcolor\\\"==l?n[l]=a.GetStyleNum(\\\"color\\\",f):\\\"layout\\\"==l||\\\"cellformat\\\"==l?n[l]=a.GetStyleNum(l,f):\\\"font\\\"==l?(\\\"* * *\\\"==f&&(f=\\\"\\\"),n[l]=a.GetStyleNum(\\\"font\\\",\\nf)):\\\"textvalueformat\\\"==l||\\\"nontextvalueformat\\\"==l?(n[l]=a.GetStyleNum(\\\"valueformat\\\",f),delete n.displaystring):\\\"cssc\\\"==l?(f=f.replace(/[^a-zA-Z0-9\\\\-]/g,\\\"\\\"),n.cssc=f):\\\"csss\\\"==l?(f=f.replace(/\\\\n/g,\\\"\\\"),n.csss=f):\\\"mod\\\"==l?(f=f.replace(/[^yY]/g,\\\"\\\").toLowerCase(),n.mod=f):\\\"comment\\\"==l?n.comment=SocialCalc.decodeFromSave(f):\\\"readonly\\\"==l?n.readonly=\\\"yes\\\"==f.toLowerCase():m=w.s_escUnknownSetCoordCmd+d);break;case \\\"merge\\\":a.renderneeded=!0;g=c.NextToken();f=c.RestOfString();q();n=a.GetAssuredCell(p.coord);\\nif(n.readonly)break;b&&B.AddUndo(\\\"unmerge \\\"+p.coord);r.col>p.col?n.colspan=r.col-p.col+1:delete n.colspan;r.row>p.row?n.rowspan=r.row-p.row+1:delete n.rowspan;a.changedrendervalues=!0;break;case \\\"unmerge\\\":a.renderneeded=!0;g=c.NextToken();f=c.RestOfString();q();n=a.GetAssuredCell(p.coord);if(n.readonly)break;b&&B.AddUndo(\\\"merge \\\"+p.coord+\\\":\\\"+SocialCalc.crToCoord(p.col+(n.colspan||1)-1,p.row+(n.rowspan||1)-1));delete n.colspan;delete n.rowspan;a.changedrendervalues=!0;break;case \\\"erase\\\":case \\\"cut\\\":a.renderneeded=\\n!0;a.changedrendervalues=!0;g=c.NextToken();f=c.RestOfString();q();b&&B.AddUndo(\\\"changedrendervalues\\\");\\\"cut\\\"==e&&(b&&B.AddUndo(\\\"loadclipboard\\\",SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard)),SocialCalc.Clipboard.clipboard=SocialCalc.CreateSheetSave(a,g));for(q=p.row;q<=r.row;q++)for(c=p.col;c<=r.col;c++)h=SocialCalc.crToCoord(c,q),n=a.GetAssuredCell(h),n.readonly||(b&&B.AddUndo(\\\"set \\\"+h+\\\" all\\\",a.CellToString(n)),\\\"all\\\"==f?delete a.cells[h]:\\\"formulas\\\"==f?(n.datavalue=\\\"\\\",n.datatype=null,n.formula=\\n\\\"\\\",n.valuetype=\\\"b\\\",delete n.errors,delete n.displaystring,delete n.parseinfo,n.comment&&delete n.comment):\\\"formats\\\"==f&&(l=new SocialCalc.Cell(h),l.datavalue=n.datavalue,l.datatype=n.datatype,l.formula=n.formula,l.valuetype=n.valuetype,n.comment&&(l.comment=n.comment),a.cells[h]=l));A.needsrecalc=\\\"yes\\\";break;case \\\"fillright\\\":case \\\"filldown\\\":a.renderneeded=!0;a.changedrendervalues=!0;b&&B.AddUndo(\\\"changedrendervalues\\\");g=c.NextToken();f=c.RestOfString();q();\\\"fillright\\\"==e?(e=!0,s=p.row,t=p.col+1):\\n(e=!1,s=p.row+1,t=p.col);for(q=s;q<=r.row;q++)for(c=t;c<=r.col;c++)if(h=SocialCalc.crToCoord(c,q),n=a.GetAssuredCell(h),!n.readonly){b&&B.AddUndo(\\\"set \\\"+h+\\\" all\\\",a.CellToString(n));e?(u=SocialCalc.crToCoord(p.col,q),w=c-t+1,d=0):(u=SocialCalc.crToCoord(c,p.row),w=0,d=q-s+1);v=a.GetAssuredCell(u);if(\\\"all\\\"==f||\\\"formats\\\"==f)for(l in D)1!=D[l]&&(void 0===typeof v[l]||3==D[l]?delete n[l]:n[l]=v[l]);if(\\\"all\\\"==f||\\\"formulas\\\"==f)n.datavalue=v.datavalue,n.datatype=v.datatype,n.valuetype=v.valuetype,n.formula=\\n\\\"f\\\"==n.datatype?SocialCalc.OffsetFormulaCoords(v.formula,w,d):v.formula,delete n.parseinfo,n.errors=v.errors;delete n.displaystring}A.needsrecalc=\\\"yes\\\";break;case \\\"copy\\\":g=c.NextToken();f=c.RestOfString();b&&B.AddUndo(\\\"loadclipboard\\\",SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));SocialCalc.Clipboard.clipboard=SocialCalc.CreateSheetSave(a,g);break;case \\\"loadclipboard\\\":f=c.RestOfString();b&&B.AddUndo(\\\"loadclipboard\\\",SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));TiddlyWiki&&f&&\\n(SocialCalc.Clipboard.clipboard=SocialCalc.decodeFromSave(f));break;case \\\"clearclipboard\\\":b&&B.AddUndo(\\\"loadclipboard\\\",SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));SocialCalc.Clipboard.clipboard=\\\"\\\";break;case \\\"paste\\\":a.renderneeded=!0;a.changedrendervalues=!0;b&&B.AddUndo(\\\"changedrendervalues\\\");g=c.NextToken();f=c.RestOfString();q();if(!SocialCalc.Clipboard.clipboard)break;e=new SocialCalc.Sheet;e.ParseSheetSave(SocialCalc.Clipboard.clipboard);x=SocialCalc.ParseRange(e.copiedfrom);w=\\np.col-x.cr1.col;d=p.row-x.cr1.row;y=Math.max(r.col-p.col+1,x.cr2.col-x.cr1.col+1);z=Math.max(r.row-p.row+1,x.cr2.row-x.cr1.row+1);p.col+y-1>A.lastcol&&(A.lastcol=p.col+y-1);p.row+z-1>A.lastrow&&(A.lastrow=p.row+z-1);for(q=p.row;q<p.row+z;q++)for(c=p.col;c<p.col+y;c++)if(h=SocialCalc.crToCoord(c,q),n=a.GetAssuredCell(h),!n.readonly){b&&B.AddUndo(\\\"set \\\"+h+\\\" all\\\",a.CellToString(n));u=SocialCalc.crToCoord(x.cr1.col+(c-p.col)%(x.cr2.col-x.cr1.col+1),x.cr1.row+(q-p.row)%(x.cr2.row-x.cr1.row+1));v=e.GetAssuredCell(u);\\nif(\\\"all\\\"==f||\\\"formats\\\"==f)for(l in D)1!=D[l]&&(void 0===typeof v[l]||3==D[l]?delete n[l]:(h=SocialCalc.CellPropertiesTable[l],n[l]=h&&v[l]?a.GetStyleNum(h,e.GetStyleString(h,v[l])):v[l]));if(\\\"all\\\"==f||\\\"formulas\\\"==f)n.datavalue=v.datavalue,n.datatype=v.datatype,n.valuetype=v.valuetype,n.formula=\\\"f\\\"==n.datatype?SocialCalc.OffsetFormulaCoords(v.formula,w,d):v.formula,delete n.parseinfo,n.errors=v.errors,v.comment?n.comment=v.comment:n.comment&&delete n.comment;delete n.displaystring}A.needsrecalc=\\\"yes\\\";\\nbreak;case \\\"sort\\\":a.renderneeded=!0;a.changedrendervalues=!0;b&&B.AddUndo(\\\"changedrendervalues\\\");g=c.NextToken();q();d=[];G=[];for(w=I=0;3>=w;w++)d[w]=c.NextToken(),G[w]=c.NextToken(),d[w]&&(I=w);e={};l=[];E=[];H=[];for(q=p.row;q<=r.row;q++){for(c=p.col;c<=r.col;c++)h=SocialCalc.crToCoord(c,q),(n=a.cells[h])?(e[h]=a.CellToString(n),b&&B.AddUndo(\\\"set \\\"+h+\\\" all\\\",e[h])):b&&B.AddUndo(\\\"set \\\"+h+\\\" all\\\");l.push(l.length);E.push([]);H.push([]);slast=H.length-1;for(w=0;w<=I;w++)h=d[w]+q,n=a.GetAssuredCell(h),\\nh=n.datavalue,c=n.valuetype.charAt(0)||\\\"b\\\",\\\"t\\\"==c&&(h=h.toLowerCase()),E[slast].push(h),H[slast].push(c)}b=function(a,b){var c,d,e,f,g;for(c=0;c<=I;c++)if(\\\"up\\\"==G[c]?(d=a,e=b):(d=b,e=a),f=H[d][c],tb=H[e][c],\\\"t\\\"==f?\\\"t\\\"==tb?(d=E[d][c],e=E[e][c],g=d>e?1:d<e?-1:0):\\\"n\\\"==tb?g=1:\\\"b\\\"==tb?g=\\\"up\\\"==G[c]?-1:1:\\\"e\\\"==tb&&(g=-1):\\\"n\\\"==f?\\\"t\\\"==tb?g=-1:\\\"n\\\"==tb?(d=E[d][c]-0,e=E[e][c]-0,g=d>e?1:d<e?-1:0):\\\"b\\\"==tb?g=\\\"up\\\"==G[c]?-1:1:\\\"e\\\"==tb&&(g=-1):\\\"e\\\"==f?\\\"e\\\"==tb?(d=E[d][c],e=E[e][c],g=d>e?1:d<e?-1:0):g=\\\"b\\\"==tb?\\\"up\\\"==G[c]?\\n-1:1:1:\\\"b\\\"==f&&(g=\\\"b\\\"==tb?0:\\\"up\\\"==G[c]?1:-1),g)return g;return a>b?1:a<b?-1:0};l.sort(b);for(q=p.row;q<=r.row;q++)for(b=l[q-p.row],c=p.col;c<=r.col;c++)h=SocialCalc.crToCoord(c,q),B=SocialCalc.crToCoord(c,b+p.row),e[B]?(n=new SocialCalc.Cell(h),a.CellFromStringParts(n,e[B].split(\\\":\\\"),1),\\\"f\\\"==n.datatype&&(n.formula=SocialCalc.OffsetFormulaCoords(n.formula,0,q-p.row-b)),a.cells[h]=n):delete a.cells[h];A.needsrecalc=\\\"yes\\\";break;case \\\"insertcol\\\":case \\\"insertrow\\\":a.renderneeded=!0;a.changedrendervalues=\\n!0;g=c.NextToken();f=c.RestOfString();q();\\\"insertcol\\\"==e?(w=1,f=p.col,d=0,t=1,C=s=p.col,n=1,y=A.lastrow,b&&B.AddUndo(\\\"deletecol \\\"+p.coord)):(w=0,d=f=1,t=p.row,s=1,C=A.lastcol,y=n=p.row,b&&B.AddUndo(\\\"deleterow \\\"+p.coord));for(q=A.lastrow;q>=t;q--)for(c=A.lastcol;c>=f;c--)u=SocialCalc.crToCoord(c,q),h=SocialCalc.crToCoord(c+w,q+d),a.cells[u]?a.cells[h]=a.cells[u]:delete a.cells[h];for(q=n;q<=y;q++)for(c=s;c<=C;c++)for(l in h=SocialCalc.crToCoord(c,q),n=new SocialCalc.Cell(h),a.cells[h]=n,u=SocialCalc.crToCoord(c-\\nw,q-d),v=a.GetAssuredCell(u),D)2==D[l]&&(n[l]=v[l]);for(h in a.cells)(n=a.cells[h])&&\\\"f\\\"==n.datatype&&(n.formula=SocialCalc.AdjustFormulaCoords(n.formula,p.col,w,p.row,d)),n&&delete n.parseinfo;for(x in a.names)a.names[x]&&(h=a.names[x].definition,c=\\\"\\\",\\\"=\\\"==h.charAt(0)&&(c=\\\"=\\\",h=h.substring(1)),a.names[x].definition=c+SocialCalc.AdjustFormulaCoords(h,p.col,w,p.row,d));for(q=A.lastrow;q>=t&&\\\"insertrow\\\"==e;q--)for(l in b=q+d,a.rowattribs)h=a.rowattribs[l][q],a.rowattribs[l][b]!=h&&(h?a.rowattribs[l][b]=\\nh:delete a.rowattribs[l][b]);for(c=A.lastcol;c>=f&&\\\"insertcol\\\"==e;c--)for(l in q=SocialCalc.rcColname(c),b=SocialCalc.rcColname(c+w),a.colattribs)h=a.colattribs[l][q],a.colattribs[l][b]!=h&&(h?a.colattribs[l][b]=h:delete a.colattribs[l][b]);A.lastcol+=w;A.lastrow+=d;A.needsrecalc=\\\"yes\\\";break;case \\\"deletecol\\\":case \\\"deleterow\\\":a.renderneeded=!0;a.changedrendervalues=!0;g=c.NextToken();f=c.RestOfString();f=A.lastcol;D=A.lastrow;q();\\\"deletecol\\\"==e?(w=p.col-r.col-1,d=0,t=r.col+1,s=1):(w=0,d=p.row-r.row-\\n1,t=1,s=r.row+1);for(q=s;q<=D-d;q++)for(c=t;c<=f-w;c++)if(h=SocialCalc.crToCoord(c+w,q+d),(n=a.cells[h])&&n.readonly)return m;for(q=s;q<=D-d;q++)for(c=t;c<=f-w;c++)h=SocialCalc.crToCoord(c+w,q+d),b&&(q<s-d||c<t-w)&&((n=a.cells[h])?B.AddUndo(\\\"set \\\"+h+\\\" all\\\",a.CellToString(n)):B.AddUndo(\\\"erase \\\"+h+\\\" all\\\")),u=SocialCalc.crToCoord(c,q),(n=a.cells[u])?a.cells[h]=n:delete a.cells[h];for(h in a.cells)if(n=a.cells[h])\\\"f\\\"==n.datatype?(q=n.formula,n.formula=SocialCalc.AdjustFormulaCoords(q,p.col,w,p.row,d),\\nn.formula!=q&&(delete n.parseinfo,b&&-1!=n.formula.indexOf(\\\"#REF!\\\")&&(c=SocialCalc.coordToCr(h),B.AddUndo(\\\"set \\\"+SocialCalc.rcColname(c.col-w)+(c.row-d)+\\\" formula \\\"+q)))):delete n.parseinfo;for(x in a.names)a.names[x]&&(h=a.names[x].definition,c=\\\"\\\",\\\"=\\\"==h.charAt(0)&&(c=\\\"=\\\",h=h.substring(1)),a.names[x].definition=c+SocialCalc.AdjustFormulaCoords(h,p.col,w,p.row,d));for(q=s;q<=D-d&&\\\"deleterow\\\"==e;q++)for(l in c=q+d,a.rowattribs)h=a.rowattribs[l][q],a.rowattribs[l][c]!=h&&(b&&B.AddUndo(\\\"set \\\"+c+\\\" \\\"+\\nl,a.rowattribs[l][c]),h?a.rowattribs[l][c]=h:delete a.rowattribs[l][c]);for(c=t;c<=f-w&&\\\"deletecol\\\"==e;c++)for(l in q=SocialCalc.rcColname(c),n=SocialCalc.rcColname(c+w),a.colattribs)h=a.colattribs[l][q],a.colattribs[l][n]!=h&&(b&&B.AddUndo(\\\"set \\\"+n+\\\" \\\"+l,a.colattribs[l][n]),h?a.colattribs[l][n]=h:delete a.colattribs[l][n]);if(b)if(\\\"deletecol\\\"==e)for(c=p.col;c<=r.col;c++)B.AddUndo(\\\"insertcol \\\"+SocialCalc.rcColname(c));else for(q=p.row;q<=r.row;q++)B.AddUndo(\\\"insertrow \\\"+q);\\\"deletecol\\\"==e?p.col<=f&&\\n(A.lastcol=r.col<=f?A.lastcol+w:p.col-1):p.row<=D&&(A.lastrow=r.row<=D?A.lastrow+d:p.row-1);A.needsrecalc=\\\"yes\\\";break;case \\\"movepaste\\\":case \\\"moveinsert\\\":var J,F;a.renderneeded=!0;a.changedrendervalues=!0;b&&B.AddUndo(\\\"changedrendervalues\\\");g=c.NextToken();n=c.NextToken();f=c.RestOfString();\\\"\\\"==f&&(f=\\\"all\\\");q();F=SocialCalc.coordToCr(n);w=F.col-p.col;d=F.row-p.row;y=r.col-p.col+1;z=r.row-p.row+1;J={};for(q=p.row;q<=r.row;q++)for(c=p.col;c<=r.col;c++)if(h=SocialCalc.crToCoord(c,q),n=a.GetAssuredCell(h),\\n!n.readonly&&(b&&B.AddUndo(\\\"set \\\"+h+\\\" all\\\",a.CellToString(n)),a.cells[h])){J[h]=new SocialCalc.Cell(h);for(l in D)void 0!==typeof n[l]&&(J[h][l]=n[l],\\\"all\\\"==f&&delete n[l],\\\"formulas\\\"==f&&(1!=D[l]&&3!=D[l]||delete n[l]),\\\"formats\\\"==f&&2==D[l]&&delete n[l]);\\\"formulas\\\"==f&&(n.datavalue=\\\"\\\",n.datatype=null,n.formula=\\\"\\\",n.valuetype=\\\"b\\\");\\\"all\\\"==f&&delete a.cells[h]}\\\"moveinsert\\\"==e&&(s=t=!1,0==d&&(F.col<p.col||F.col>r.col)?F.col<p.col?(C=p.col-F.col,t=-1):(--F.col,w=F.col-r.col,C=F.col-r.col,t=1):0==w&&(F.row<\\np.row||F.row>r.row)?F.row<p.row?(C=p.row-F.row,s=-1):(--F.row,d=F.row-r.row,C=F.row-r.row,s=1):e=\\\"movepaste\\\");e={};if(s)for(q=0;q<C;q++)for(c=p.col;c<=r.col;c++){0>s?(u=SocialCalc.crToCoord(c,F.row+C-q-1),h=SocialCalc.crToCoord(c,r.row-q)):(u=SocialCalc.crToCoord(c,F.row-C+q+1),h=SocialCalc.crToCoord(c,p.row+q));v=a.GetAssuredCell(u);b&&B.AddUndo(\\\"set \\\"+u+\\\" all\\\",a.CellToString(v));n=a.GetAssuredCell(h);if(\\\"all\\\"==f||\\\"formats\\\"==f)for(l in D)1!=D[l]&&(void 0===typeof v[l]||3==D[l]?delete n[l]:n[l]=v[l]);\\nif(\\\"all\\\"==f||\\\"formulas\\\"==f)n.datavalue=v.datavalue,n.datatype=v.datatype,n.valuetype=v.valuetype,n.formula=v.formula,delete n.parseinfo,n.errors=v.errors;delete n.displaystring;e[u]=h}if(t)for(c=0;c<C;c++)for(q=p.row;q<=r.row;q++){0>t?(u=SocialCalc.crToCoord(F.col+C-c-1,q),h=SocialCalc.crToCoord(r.col-c,q)):(u=SocialCalc.crToCoord(F.col-C+c+1,q),h=SocialCalc.crToCoord(p.col+c,q));v=a.GetAssuredCell(u);b&&B.AddUndo(\\\"set \\\"+u+\\\" all\\\",a.CellToString(v));n=a.GetAssuredCell(h);if(\\\"all\\\"==f||\\\"formats\\\"==f)for(l in D)1!=\\nD[l]&&(void 0===typeof v[l]||3==D[l]?delete n[l]:n[l]=v[l]);if(\\\"all\\\"==f||\\\"formulas\\\"==f)n.datavalue=v.datavalue,n.datatype=v.datatype,n.valuetype=v.valuetype,n.formula=v.formula,delete n.parseinfo,n.errors=v.errors;delete n.displaystring;e[u]=h}F.col+y-1>A.lastcol&&(A.lastcol=F.col+y-1);F.row+z-1>A.lastrow&&(A.lastrow=F.row+z-1);for(q=p.row;q<p.row+z;q++)for(c=p.col;c<p.col+y;c++)if(h=SocialCalc.crToCoord(c+w,q+d),n=a.GetAssuredCell(h),!n.readonly)if(b&&B.AddUndo(\\\"set \\\"+h+\\\" all\\\",a.CellToString(n)),\\nu=SocialCalc.crToCoord(c,q),e[u]=h,\\\"all\\\"!=f||J[u]){(v=J[u])||(v=a.GetAssuredCell(u));if(\\\"all\\\"==f||\\\"formats\\\"==f)for(l in D)1!=D[l]&&(void 0===typeof v[l]||3==D[l]?delete n[l]:n[l]=v[l]);if(\\\"all\\\"==f||\\\"formulas\\\"==f)n.datavalue=v.datavalue,n.datatype=v.datatype,n.valuetype=v.valuetype,n.formula=v.formula,delete n.parseinfo,n.errors=v.errors,v.comment?n.comment=v.comment:n.comment&&delete n.comment;delete n.displaystring}else delete a.cells[h];for(h in a.cells)if(n=a.cells[h])\\\"f\\\"==n.datatype?(q=n.formula,\\nn.formula=SocialCalc.ReplaceFormulaCoords(q,e),n.formula!=q&&(delete n.parseinfo,b&&!e[h]&&B.AddUndo(\\\"set \\\"+h+\\\" formula \\\"+q))):delete n.parseinfo;for(x in a.names)a.names[x]&&(q=h=a.names[x].definition,c=\\\"\\\",\\\"=\\\"==h.charAt(0)&&(c=\\\"=\\\",h=h.substring(1)),a.names[x].definition=c+SocialCalc.ReplaceFormulaCoords(h,e),b&&a.names[x].definition!=q&&B.AddUndo(\\\"name define \\\"+x+\\\" \\\"+q));A.needsrecalc=\\\"yes\\\";break;case \\\"name\\\":g=c.NextToken();x=c.NextToken();f=c.RestOfString();x=x.toUpperCase().replace(/[^A-Z0-9_\\\\.]/g,\\n\\\"\\\");if(\\\"\\\"==x)break;if(\\\"define\\\"==g){if(\\\"\\\"==f)break;a.names[x]?(b&&B.AddUndo(\\\"name define \\\"+x+\\\" \\\"+a.names[x].definition),a.names[x].definition=f):(b&&B.AddUndo(\\\"name delete \\\"+x),a.names[x]={definition:f,desc:\\\"\\\"})}else\\\"desc\\\"==g?a.names[x]&&(b&&B.AddUndo(\\\"name desc \\\"+x+\\\" \\\"+a.names[x].desc),a.names[x].desc=f):\\\"delete\\\"==g&&(b&&(a.names[x].desc&&B.AddUndo(\\\"name desc \\\"+x+\\\" \\\"+a.names[x].desc),B.AddUndo(\\\"name define \\\"+x+\\\" \\\"+a.names[x].definition)),delete a.names[x]);A.needsrecalc=\\\"yes\\\";break;case \\\"recalc\\\":A.needsrecalc=\\n\\\"yes\\\";a.recalconce=!0;break;case \\\"redisplay\\\":a.renderneeded=!0;break;case \\\"changedrendervalues\\\":a.changedrendervalues=!0;break;case \\\"startcmdextension\\\":x=c.NextToken();(B=a.sci.CmdExtensionCallbacks[x])&&B.func(x,B.data,a,c,b);break;default:m=w.s_escUnknownCmd+d}return m};SocialCalc.SheetUndo=function(a){var c,b=a.changes.TOS(),d=\\\"\\\";for(c=b?b.undo.length-1:-1;0<=c;c--)d&&(d+=\\\"\\\\n\\\"),d+=b.undo[c];a.changes.Undo();a.ScheduleSheetCommands(d,!1)};\\nSocialCalc.SheetRedo=function(a){var c,b;if(a.changes.Redo()){c=a.changes.TOS();var d=\\\"\\\";for(b=0;c&&b<c.command.length;b++)d&&(d+=\\\"\\\\n\\\"),d+=c.command[b];a.ScheduleSheetCommands(d,!1)}else a.ScheduleSheetCommands(\\\"\\\",!1)};SocialCalc.CreateAuditString=function(a){var c,b=\\\"\\\",d=a.changes.stack,e=a.changes.tos;for(a=0;a<=e;a++)for(c=0;c<d[a].command.length;c++)b+=d[a].command[c]+\\\"\\\\n\\\";return b};\\nSocialCalc.GetStyleNum=function(a,c,b){var d;if(0==b.length)return 0;d=a[c+\\\"hash\\\"][b];d||(1>a[c+\\\"s\\\"].length&&a[c+\\\"s\\\"].push(\\\"\\\"),d=a[c+\\\"s\\\"].push(b)-1,a[c+\\\"hash\\\"][b]=d,a.changedrendervalues=!0);return d};SocialCalc.GetStyleString=function(a,c,b){return b?a[c+\\\"s\\\"][b]:null};\\nSocialCalc.OffsetFormulaCoords=function(a,c,b){var d,e,f,g,l=\\\"\\\";d=SocialCalc.Formula;if(!d)return\\\"Need SocialCalc.Formula\\\";var h=d.TokenType,m=h.op,p=h.string,h=h.coord,r=d.TokenOpExpansion;a=d.ParseFormulaIntoTokens(a);for(f=0;f<a.length;f++)if(e=a[f].type,d=a[f].text,e==h){g=\\\"\\\";e=SocialCalc.coordToCr(d);\\\"$\\\"!=d.charAt(0)?e.col+=c:g+=\\\"$\\\";g+=SocialCalc.rcColname(e.col);-1==d.indexOf(\\\"$\\\",1)?e.row+=b:g+=\\\"$\\\";g+=e.row;if(1>e.row||1>e.col)g=\\\"#REF!\\\";l+=g}else l=e==p?0<=d.indexOf('\\\"')?l+('\\\"'+d.replace(/\\\"/,\\n'\\\"\\\"')+'\\\"'):l+('\\\"'+d+'\\\"'):e==m?l+(r[d]||d):l+d;return l};\\nSocialCalc.AdjustFormulaCoords=function(a,c,b,d,e){var f,g,l=\\\"\\\",h=!1,m=SocialCalc.Formula;if(!m)return\\\"Need SocialCalc.Formula\\\";var p=m.TokenType,r=p.op,q=p.string,p=p.coord,m=m.TokenOpExpansion;parseinfo=SocialCalc.Formula.ParseFormulaIntoTokens(a);for(g=0;g<parseinfo.length;g++){f=parseinfo[g].type;a=parseinfo[g].text;f==r&&(\\\"!\\\"==a?h=!0:\\\":\\\"!=a&&(h=!1),a=m[a]||a);if(f==p){cr=SocialCalc.coordToCr(a);(0>b&&cr.col>=c&&cr.col<c-b||0>e&&cr.row>=d&&cr.row<d-e)&&!h&&(cr.col=0,cr.row=0);h||(cr.col>=c&&(cr.col+=\\nb),cr.row>=d&&(cr.row+=e));f=\\\"$\\\"==a.charAt(0)?\\\"$\\\"+SocialCalc.rcColname(cr.col):SocialCalc.rcColname(cr.col);f=-1!=a.indexOf(\\\"$\\\",1)?f+(\\\"$\\\"+cr.row):f+cr.row;if(1>cr.row||1>cr.col)f=\\\"#REF!\\\";a=f}else f==q&&(a=0<=a.indexOf('\\\"')?'\\\"'+a.replace(/\\\"/,'\\\"\\\"')+'\\\"':'\\\"'+a+'\\\"');l+=a}return l};\\nSocialCalc.ReplaceFormulaCoords=function(a,c){var b,d,e,f=\\\"\\\",g=!1;d=SocialCalc.Formula;if(!d)return\\\"Need SocialCalc.Formula\\\";var l=d.TokenType,h=l.op,m=l.string,l=l.coord,p=d.TokenOpExpansion;parseinfo=SocialCalc.Formula.ParseFormulaIntoTokens(a);for(e=0;e<parseinfo.length;e++)b=parseinfo[e].type,d=parseinfo[e].text,b==h&&(\\\"!\\\"==d?g=!0:\\\":\\\"!=d&&(g=!1),d=p[d]||d),b==l?(cr=SocialCalc.coordToCr(d),b=SocialCalc.crToCoord(cr.col,cr.row),c[b]&&!g&&(cr=SocialCalc.coordToCr(c[b]),b=\\\"$\\\"==d.charAt(0)?\\\"$\\\"+SocialCalc.rcColname(cr.col):\\nSocialCalc.rcColname(cr.col),d=b=-1!=d.indexOf(\\\"$\\\",1)?b+(\\\"$\\\"+cr.row):b+cr.row)):b==m&&(d=0<=d.indexOf('\\\"')?'\\\"'+d.replace(/\\\"/,'\\\"\\\"')+'\\\"':'\\\"'+d+'\\\"'),f+=d;return f};SocialCalc.RecalcInfo={sheet:null,currentState:0,state:{idle:0,start_calc:1,order:2,calc:3,start_wait:4,done_wait:5},recalctimer:null,maxtimeslice:100,timeslicedelay:1,starttime:0,queue:[],LoadSheet:function(a){return!1}};\\nSocialCalc.RecalcData=function(){this.inrecalc=!0;this.celllist=[];this.celllistitem=0;this.calclist=null;this.calclistlength=0;this.nextcalc=this.lastcalc=this.firstcalc=null;this.count=0;this.checkinfo={}};SocialCalc.RecalcCheckInfo=function(){this.oldcoord=null;this.parsepos=0;this.inrangestart=this.inrange=!1;this.r=this.c=this.r2=this.r1=this.c2=this.c1=this.cr2=this.cr1=null};\\nSocialCalc.RecalcSheet=function(a){hack.log(\\\"\\\",hack.recalc,\\\"SocialCalc.RecalcSheet\\\");var c=SocialCalc.RecalcInfo;c.currentState!=c.state.idle?c.queue.push(a):(delete a.attribs.circularreferencecell,SocialCalc.Formula.FreshnessInfoReset(),SocialCalc.RecalcClearTimeout(),c.sheet=a,c.currentState=c.state.start_calc,c.starttime=new Date,a.statuscallback&&a.statuscallback(c,\\\"calcstart\\\",null,a.statuscallbackparams),SocialCalc.RecalcSetTimeout())};\\nSocialCalc.RecalcSetTimeout=function(){var a=SocialCalc.RecalcInfo;a.recalctimer=window.setTimeout(SocialCalc.RecalcTimerRoutine,a.timeslicedelay)};SocialCalc.RecalcClearTimeout=function(){var a=SocialCalc.RecalcInfo;a.recalctimer&&(window.clearTimeout(a.recalctimer),a.recalctimer=null)};\\nSocialCalc.RecalcLoadedSheet=function(a,c,b,d,e){var f=SocialCalc.RecalcInfo,g=SocialCalc.Formula;a=SocialCalc.Formula.AddSheetToCache(a||g.SheetCache.waitingForLoading,c,d,e);b&&a&&\\\"off\\\"!=a.attribs.recalc&&(a.previousrecalcsheet=f.sheet,f.sheet=a,f.currentState=f.state.start_calc);g.SheetCache.waitingForLoading=null;SocialCalc.RecalcSetTimeout()};\\nSocialCalc.RecalcTimerRoutine=function(){hack.log(\\\"\\\",hack.recalc,\\\"SocialCalc.RecalcTimerRoutine\\\");var a,c,b,d=new Date,e=0,f=SocialCalc.Formula;if(!f)return\\\"Need SocialCalc.Formula\\\";var g=SocialCalc.RecalcInfo,l=g.sheet;if(l){var h=l.recalcdata,m=function(a,b){l.statuscallback&&l.statuscallback(h,a,b,l.statuscallbackparams)};SocialCalc.RecalcClearTimeout();if(g.currentState==g.state.start_calc){h=new SocialCalc.RecalcData;l.recalcdata=h;for(b in l.cells)b&&h.celllist.push(b);h.calclist={};g.currentState=\\ng.state.order}if(g.currentState==g.state.order){for(;h.celllistitem<h.celllist.length;)if(b=h.celllist[h.celllistitem++],SocialCalc.RecalcCheckCell(l,b),new Date-d>=g.maxtimeslice){m(\\\"calcorder\\\",{coord:b,total:h.celllist.length,count:h.celllistitem});SocialCalc.RecalcSetTimeout();return}m(\\\"calccheckdone\\\",h.calclistlength);h.nextcalc=h.firstcalc;g.currentState=g.state.calc;SocialCalc.RecalcSetTimeout()}else if(g.currentState==g.state.start_wait){g.currentState=g.state.done_wait;if(g.LoadSheet&&(a=\\ng.LoadSheet(f.SheetCache.waitingForLoading)))return;SocialCalc.RecalcLoadedSheet(null,\\\"\\\",!1)}else if(g.currentState==g.state.done_wait)g.currentState=g.state.calc,SocialCalc.RecalcSetTimeout();else{g.currentState!=g.state.calc&&alert(\\\"Recalc state error: \\\"+g.currentState+\\\". Error in SocialCalc code.\\\");for(b=l.recalcdata.nextcalc;b;){c=l.cells[b];a=f.evaluate_parsed_formula(c.parseinfo,l,!1);if(f.SheetCache.waitingForLoading){h.nextcalc=b;h.count+=e;m(\\\"calcloading\\\",{sheetname:f.SheetCache.waitingForLoading});\\ng.currentState=g.state.start_wait;SocialCalc.RecalcSetTimeout();return}if(f.RemoteFunctionInfo.waitingForServer){h.nextcalc=b;h.count+=e;m(\\\"calcserverfunc\\\",{funcname:f.RemoteFunctionInfo.waitingForServer,coord:b,total:h.calclistlength,count:h.count});g.currentState=g.state.done_wait;return}if(c.datavalue!=a.value||c.valuetype!=a.type)c.datavalue=a.value,c.valuetype=a.type,delete c.displaystring,l.recalcchangedavalue=!0;a.error&&(c.errors=a.error);e++;b=l.recalcdata.calclist[b];if(new Date-d>=g.maxtimeslice){h.nextcalc=\\nb;h.count+=e;m(\\\"calcstep\\\",{coord:b,total:h.calclistlength,count:h.count});SocialCalc.RecalcSetTimeout();return}}h.inrecalc=!1;delete l.recalcdata;delete l.attribs.needsrecalc;g.sheet=l.previousrecalcsheet||null;g.sheet?(g.currentState=g.state.calc,SocialCalc.RecalcSetTimeout()):(f.FreshnessInfo.recalc_completed=!0,g.currentState=g.state.idle,m(\\\"calcfinished\\\",new Date-g.starttime),0<g.queue.length&&(l=g.queue.shift(),l.RecalcSheet()))}}};\\nSocialCalc.RecalcCheckCell=function(a,c){var b,d,e,f,g,l,h,m,p=SocialCalc.Formula;if(!p)return\\\"Need SocialCalc.Formula\\\";f=p.TokenType;var r=f.op,q=f.name,n=f.coord,s=a.recalcdata,t=s.checkinfo,u=!1,w=null,v=c;a:for(;v;)if(h=a.cells[v],m=t[v],!h||\\\"f\\\"!=h.datatype||m&&\\\"object\\\"!=typeof m)v=w,t[v]&&(w=t[v].oldcoord);else{m||(m=new SocialCalc.RecalcCheckInfo,t[v]=m);h.errors&&delete h.errors;h.parseinfo||(h.parseinfo=p.ParseFormulaIntoTokens(h.formula));b=h.parseinfo;for(f=m.parsepos;f<b.length;f++){if(m.inrange){m.inrangestart&&\\n(m.cr1.col>m.cr2.col?(m.c1=m.cr2.col,m.c2=m.cr1.col):(m.c1=m.cr1.col,m.c2=m.cr2.col),m.c=m.c1-1,m.cr1.row>m.cr2.row?(m.r1=m.cr2.row,m.r2=m.cr1.row):(m.r1=m.cr1.row,m.r2=m.cr2.row),m.r=m.r1,m.inrangestart=!1);m.c+=1;if(m.c>m.c2){m.r+=1;if(m.r>m.r2){m.inrange=!1;continue}m.c=m.c1}b=SocialCalc.crToCoord(m.c,m.r);m.parsepos=f;m.oldcoord=w;w=v;v=b;if(t[v]&&\\\"object\\\"==typeof t[v])return h.errors=SocialCalc.Constants.s_caccCircRef+c,t[c]=!0,s.firstcalc?s.calclist[s.lastcalc]=c:s.firstcalc=c,s.lastcalc=c,\\ns.calclistlength++,a.attribs.circularreferencecell=v+\\\"|\\\"+w,h.errors;continue a}e=b[f].type;d=b[f].text;e==r&&(\\\"!\\\"==d?u=!0:\\\":\\\"!=d&&(u=!1));if(e==q)if(g=p.LookupName(a,d),\\\"range\\\"==g.type){if(l=g.value.indexOf(\\\"|\\\"),-1!=l){m.cr1=SocialCalc.coordToCr(g.value.substring(0,l));d=g.value.indexOf(\\\"|\\\",l+1);m.cr2=SocialCalc.coordToCr(g.value.substring(l+1,d));m.inrange=!0;m.inrangestart=!0;--f;continue}}else\\\"coord\\\"==g.type&&(e=n,d=g.value);if(e==n)if(2<=f&&b[f-1].type==r&&\\\":\\\"==b[f-1].text&&b[f-2].type==n&&!u)m.cr1=\\nSocialCalc.coordToCr(b[f-2].text),m.cr2=SocialCalc.coordToCr(d),m.inrange=!0,m.inrangestart=!0,--f;else if(!u){-1!=d.indexOf(\\\"$\\\")&&(d=d.replace(/\\\\$/g,\\\"\\\"));m.parsepos=f+1;m.oldcoord=w;w=v;v=d;if(t[v]&&\\\"object\\\"==typeof t[v])return h.errors=SocialCalc.Constants.s_caccCircRef+c,t[c]=!0,s.firstcalc?s.calclist[s.lastcalc]=c:s.firstcalc=c,s.lastcalc=c,s.calclistlength++,a.attribs.circularreferencecell=v+\\\"|\\\"+w,h.errors;continue a}}u=!1;t[v]=!0;s.firstcalc?s.calclist[s.lastcalc]=v:s.firstcalc=v;s.lastcalc=\\nv;s.calclistlength++;v=w;w=t[v]?t[v].oldcoord:null}return\\\"\\\"};SocialCalc.Parse=function(a){this.str=a;this.pos=0;this.delimiter=\\\" \\\";this.lineEnd=a.indexOf(\\\"\\\\n\\\");0>this.lineEnd&&(this.lineEnd=a.length)};SocialCalc.Parse.prototype.NextToken=function(){if(0>this.pos)return\\\"\\\";var a=this.str.indexOf(this.delimiter,this.pos),c=this.pos;a>this.lineEnd&&(a=this.lineEnd);if(0<=a)return this.pos=a+1,this.str.substring(c,a);this.pos=this.lineEnd;return this.str.substring(c,this.lineEnd)};\\nSocialCalc.Parse.prototype.RestOfString=function(){var a=this.pos;if(0>this.pos||this.pos>=this.lineEnd)return\\\"\\\";this.pos=this.lineEnd;return this.str.substring(a,this.lineEnd)};SocialCalc.Parse.prototype.RestOfStringNoMove=function(){return 0>this.pos||this.pos>=this.lineEnd?\\\"\\\":this.str.substring(this.pos,this.lineEnd)};SocialCalc.Parse.prototype.NextLine=function(){this.pos=this.lineEnd+1;this.lineEnd=this.str.indexOf(\\\"\\\\n\\\",this.pos);0>this.lineEnd&&(this.lineEnd=this.str.length)};\\nSocialCalc.Parse.prototype.EOF=function(){return 0>this.pos||this.pos>=this.str.length?!0:!1};SocialCalc.UndoStack=function(){this.stack=[];this.tos=-1;this.maxRedo=0;this.maxUndo=50};\\nSocialCalc.UndoStack.prototype.PushChange=function(a){for(;0<this.stack.length&&this.stack.length-1>this.tos;)this.stack.pop();this.stack.push({command:[],type:a,undo:[]});this.maxRedo&&this.stack.length>this.maxRedo&&this.stack.shift();this.maxUndo&&this.stack.length>this.maxUndo&&(this.stack[this.stack.length-this.maxUndo-1].undo=[]);this.tos=this.stack.length-1};\\nSocialCalc.UndoStack.prototype.AddDo=function(){if(this.stack[this.stack.length-1]){for(var a=[],c=0;c<arguments.length;c++)null!=arguments[c]&&a.push(arguments[c]);a=a.join(\\\" \\\");this.stack[this.stack.length-1].command.push(a)}};SocialCalc.UndoStack.prototype.AddUndo=function(){if(this.stack[this.stack.length-1]){for(var a=[],c=0;c<arguments.length;c++)null!=arguments[c]&&a.push(arguments[c]);a=a.join(\\\" \\\");this.stack[this.stack.length-1].undo.push(a)}};\\nSocialCalc.UndoStack.prototype.TOS=function(){return 0<=this.tos?this.stack[this.tos]:null};SocialCalc.UndoStack.prototype.Undo=function(){return 0<=this.tos&&(!this.maxUndo||this.tos>this.stack.length-this.maxUndo-1)?(--this.tos,!0):!1};SocialCalc.UndoStack.prototype.Redo=function(){return this.tos<this.stack.length-1?(this.tos+=1,!0):!1};SocialCalc.Clipboard={clipboard:\\\"\\\"};\\nSocialCalc.RenderContext=function(a){var c=a.attribs,b=SocialCalc.Constants;this.sheetobj=a;this.showRCHeaders=this.showGrid=this.hideRowsCols=!1;this.rownamewidth=b.defaultRowNameWidth;this.pixelsPerRow=b.defaultAssumedRowHeight;this.cellskip={};this.coordToCR={};this.colwidth=[];this.totalwidth=0;this.rowpanes=[];this.colpanes=[];this.colunhideleft=[];this.colunhideright=[];this.rowunhidetop=[];this.rowunhidebottom=[];this.maxrow=this.maxcol=0;this.highlights={};this.cursorsuffix=\\\"\\\";this.highlightTypes=\\n{cursor:{style:b.defaultHighlightTypeCursorStyle,className:b.defaultHighlightTypeCursorClass},range:{style:b.defaultHighlightTypeRangeStyle,className:b.defaultHighlightTypeRangeClass},cursorinsertup:{style:TiddlyWiki.getModifiedCssImageStyle(\\\"color:#FFF;backgroundColor:#A6A6A6;backgroundRepeat:repeat-x;backgroundPosition:top left;backgroundImage:url(\\\"+b.defaultImagePrefix+\\\"cursorinsertup.gif);\\\"),className:b.defaultHighlightTypeCursorClass},cursorinsertleft:{style:TiddlyWiki.getModifiedCssImageStyle(\\\"color:#FFF;backgroundColor:#A6A6A6;backgroundRepeat:repeat-y;backgroundPosition:top left;backgroundImage:url(\\\"+\\nb.defaultImagePrefix+\\\"cursorinsertleft.gif);\\\"),className:b.defaultHighlightTypeCursorClass},range2:{style:TiddlyWiki.getModifiedCssImageStyle(\\\"color:#000;backgroundColor:#FFF;backgroundImage:url(\\\"+b.defaultImagePrefix+\\\"range2.gif);\\\"),className:\\\"\\\"}};this.cellIDprefix=b.defaultCellIDPrefix;this.defaultlinkstyle=null;this.defaultHTMLlinkstyle={type:\\\"html\\\"};this.defaultfontstyle=b.defaultCellFontStyle;this.defaultfontsize=b.defaultCellFontSize;this.defaultfontfamily=b.defaultCellFontFamily;this.defaultlayout=\\nb.defaultCellLayout;this.defaultpanedividerwidth=b.defaultPaneDividerWidth;this.defaultpanedividerheight=b.defaultPaneDividerHeight;this.gridCSS=b.defaultGridCSS;this.commentClassName=b.defaultCommentClass;this.commentCSS=b.defaultCommentStyle;this.commentNoGridClassName=b.defaultCommentNoGridClass;this.commentNoGridCSS=b.defaultCommentNoGridStyle;this.readonlyClassName=b.defaultReadonlyClass;this.readonlyCSS=b.defaultReadonlyStyle;this.readonlyNoGridClassName=b.defaultReadonlyNoGridClass;this.readonlyNoGridCSS=\\nb.defaultReadonlyNoGridStyle;this.readonlyComment=b.defaultReadonlyComment;this.classnames={colname:b.defaultColnameClass,rowname:b.defaultRownameClass,selectedcolname:b.defaultSelectedColnameClass,selectedrowname:b.defaultSelectedRownameClass,upperleft:b.defaultUpperLeftClass,skippedcell:b.defaultSkippedCellClass,panedivider:b.defaultPaneDividerClass,unhideleft:b.defaultUnhideLeftClass,unhideright:b.defaultUnhideRightClass,unhidetop:b.defaultUnhideTopClass,unhidebottom:b.defaultUnhideBottomClass};\\nthis.explicitStyles={colname:b.defaultColnameStyle,rowname:b.defaultRownameStyle,selectedcolname:b.defaultSelectedColnameStyle,selectedrowname:b.defaultSelectedRownameStyle,upperleft:b.defaultUpperLeftStyle,skippedcell:b.defaultSkippedCellStyle,panedivider:b.defaultPaneDividerStyle,unhideleft:b.defaultUnhideLeftStyle,unhideright:b.defaultUnhideRightStyle,unhidetop:b.defaultUnhideTopStyle,unhidebottom:b.defaultUnhideBottomStyle};this.cellskip=null;this.needcellskip=!0;this.fonts=[];this.layouts=[];\\nthis.needprecompute=!0;if(c)this.rowpanes[0]={first:1,last:c.lastrow},this.colpanes[0]={first:1,last:c.lastcol},this.usermaxcol=c.usermaxcol,this.usermaxrow=c.usermaxrow;else throw b.s_rcMissingSheet;};SocialCalc.RenderContext.prototype.PrecomputeSheetFontsAndLayouts=function(){SocialCalc.PrecomputeSheetFontsAndLayouts(this)};SocialCalc.RenderContext.prototype.CalculateCellSkipData=function(){SocialCalc.CalculateCellSkipData(this)};SocialCalc.RenderContext.prototype.CalculateColWidthData=function(){SocialCalc.CalculateColWidthData(this)};\\nSocialCalc.RenderContext.prototype.SetRowPaneFirstLast=function(a,c,b){this.rowpanes[a]={first:c,last:b}};SocialCalc.RenderContext.prototype.SetColPaneFirstLast=function(a,c,b){this.colpanes[a]={first:c,last:b}};SocialCalc.RenderContext.prototype.CoordInPane=function(a,c,b){return SocialCalc.CoordInPane(this,a,c,b)};SocialCalc.RenderContext.prototype.CellInPane=function(a,c,b,d){return SocialCalc.CellInPane(this,a,c,b,d)};\\nSocialCalc.RenderContext.prototype.InitializeTable=function(a){SocialCalc.InitializeTable(this,a)};SocialCalc.RenderContext.prototype.RenderSheet=function(a,c){return SocialCalc.RenderSheet(this,a,c)};SocialCalc.RenderContext.prototype.RenderColGroup=function(){return SocialCalc.RenderColGroup(this)};SocialCalc.RenderContext.prototype.RenderColHeaders=function(){return SocialCalc.RenderColHeaders(this)};SocialCalc.RenderContext.prototype.RenderSizingRow=function(){return SocialCalc.RenderSizingRow(this)};\\nSocialCalc.RenderContext.prototype.RenderRow=function(a,c,b){return SocialCalc.RenderRow(this,a,c,b)};SocialCalc.RenderContext.prototype.RenderSpacingRow=function(){return SocialCalc.RenderSpacingRow(this)};SocialCalc.RenderContext.prototype.RenderCell=function(a,c,b,d,e,f){return SocialCalc.RenderCell(this,a,c,b,d,e,f)};\\nSocialCalc.PrecomputeSheetFontsAndLayouts=function(a){var c,b,d,e,f,g,l=a.sheetobj;e=l.attribs;e.defaultfont&&(c=l.fonts[e.defaultfont],c=c.replace(/^\\\\*/,SocialCalc.Constants.defaultCellFontStyle),c=c.replace(/(.+)\\\\*(.+)/,\\\"$1\\\"+SocialCalc.Constants.defaultCellFontSize+\\\"$2\\\"),c=c.replace(/\\\\*$/,SocialCalc.Constants.defaultCellFontFamily),b=c.match(/^(\\\\S+? \\\\S+?) (\\\\S+?) (\\\\S.*)$/),a.defaultfontstyle=b[1],a.defaultfontsize=b[2],a.defaultfontfamily=b[3]);for(f=1;f<l.fonts.length;f++)b=l.fonts[f],b=b.replace(/^\\\\*/,\\na.defaultfontstyle),b=b.replace(/(.+)\\\\*(.+)/,\\\"$1\\\"+a.defaultfontsize+\\\"$2\\\"),b=b.replace(/\\\\*$/,a.defaultfontfamily),b=b.match(/^(\\\\S+?) (\\\\S+?) (\\\\S+?) (\\\\S.*)$/),a.fonts[f]={style:b[1],weight:b[2],size:b[3],family:b[4]};c=/^padding:\\\\s*(\\\\S+)\\\\s+(\\\\S+)\\\\s+(\\\\S+)\\\\s+(\\\\S+);vertical-align:\\\\s*(\\\\S+);/;d=SocialCalc.Constants.defaultCellLayout.match(c);e=e.defaultlayout?l.layouts[e.defaultlayout].match(c):\\\" * * * * *\\\".split(\\\" \\\");for(f=1;f<l.layouts.length;f++){b=l.layouts[f];b=b.match(c);for(g=1;5>=g;g++)\\\"*\\\"==b[g]&&\\n(b[g]=\\\"*\\\"!=e[g]?e[g]:d[g]);a.layouts[f]=\\\"padding:\\\"+b[1]+\\\" \\\"+b[2]+\\\" \\\"+b[3]+\\\" \\\"+b[4]+\\\";vertical-align:\\\"+b[5]+\\\";\\\"}a.needprecompute=!1};\\nSocialCalc.CalculateCellSkipData=function(a){var c,b,d,e,f,g,l,h,m=a.sheetobj;a.maxrow=0;a.maxcol=0;a.cellskip={};for(c=1;c<=m.attribs.lastrow;c++)for(b=1;b<=m.attribs.lastcol;b++)if(d=SocialCalc.crToCoord(b,c),e=m.cells[d],void 0!==e&&!a.cellskip[d]&&(f=e.colspan||1,e=e.rowspan||1,1<f||1<e))for(g=c;g<c+e;g++)for(l=b;l<b+f;l++)h=SocialCalc.crToCoord(l,g),h==d?a.coordToCR[d]={row:c,col:b}:a.cellskip[h]=d,g>a.maxrow&&(maxrow=g),l>a.maxcol&&(maxcol=l);a.needcellskip=!1};\\nSocialCalc.CalculateColWidthData=function(a){var c,b,d,e=a.sheetobj;d=a.showRCHeaders?a.rownamewidth-0:0;for(colpane=0;colpane<a.colpanes.length;colpane++)for(c=a.colpanes[colpane].first;c<=a.colpanes[colpane].last;c++)if(b=SocialCalc.rcColname(c),\\\"yes\\\"==e.colattribs.hide[b])a.colwidth[c]=0;else{b=e.colattribs.width[b]||e.attribs.defaultcolwidth||SocialCalc.Constants.defaultColWidth;if(\\\"blank\\\"==b||\\\"auto\\\"==b)b=\\\"\\\";a.colwidth[c]=b+\\\"\\\";d+=b&&0<b-0?b-0:10}a.totalwidth=d};\\nSocialCalc.InitializeTable=function(a,c){c.style.borderCollapse=\\\"collapse\\\";c.cellSpacing=\\\"0\\\";c.cellPadding=\\\"0\\\";c.style.width=a.totalwidth+\\\"px\\\"};\\nSocialCalc.RenderSheet=function(a,c,b){var d,e,f,g;a.sheetobj.changedrendervalues&&(a.needcellskip=!0,a.needprecompute=!0,a.sheetobj.changedrendervalues=!1);a.needcellskip&&a.CalculateCellSkipData();a.needprecompute&&a.PrecomputeSheetFontsAndLayouts();a.CalculateColWidthData();f=document.createElement(\\\"table\\\");a.InitializeTable(f);d=a.RenderColGroup();f.appendChild(d);g=document.createElement(\\\"tbody\\\");g.appendChild(a.RenderSizingRow());a.showRCHeaders&&(d=a.RenderColHeaders())&&g.appendChild(d);for(e=\\n0;e<a.rowpanes.length;e++){for(rownum=a.rowpanes[e].first;rownum<=a.rowpanes[e].last;rownum++)d=a.RenderRow(rownum,e,b),g.appendChild(d);e<a.rowpanes.length-1&&(d=a.RenderSpacingRow(),g.appendChild(d))}f.appendChild(g);c&&(a=c.parentNode)&&a.replaceChild(f,c);return f};\\nSocialCalc.RenderRow=function(a,c,b,d){var e=a.sheetobj,f=document.createElement(\\\"tr\\\"),g,l,h;a.showRCHeaders&&(l=document.createElement(\\\"td\\\"),a.classnames&&(l.className=a.classnames.rowname),a.explicitStyles&&(l.style.cssText=a.explicitStyles.rowname),l.width=a.rownamewidth,l.style.verticalAlign=\\\"top\\\",l.innerHTML=c+\\\"\\\",c<a.rowpanes[a.rowpanes.length-1].last&&\\\"yes\\\"==e.rowattribs.hide[c+1]&&(h=document.createElement(\\\"div\\\"),h.style.position=\\\"relative\\\",g=document.createElement(\\\"div\\\"),a.classnames&&(g.className=\\na.classnames.unhidetop),a.explicitStyles&&(g.style.cssText=a.explicitStyles.unhidetop),a.rowunhidetop[c]=g,h.appendChild(g),l.appendChild(h)),1<c&&\\\"yes\\\"==e.rowattribs.hide[c-1]&&(g=document.createElement(\\\"div\\\"),a.classnames&&(g.className=a.classnames.unhidebottom),a.explicitStyles&&(g.style.cssText=a.explicitStyles.unhidebottom),a.rowunhidebottom[c]=g,l.appendChild(g)),f.appendChild(l));for(h=0;h<a.colpanes.length;h++){for(g=a.colpanes[h].first;g<=a.colpanes[h].last;g++)(l=a.RenderCell(c,g,b,h,null,\\nd))&&f.appendChild(l);h<a.colpanes.length-1&&(l=document.createElement(\\\"td\\\"),l.width=a.defaultpanedividerwidth,a.classnames.panedivider&&(l.className=a.classnames.panedivider),a.explicitStyles.panedivider&&(l.style.cssText=a.explicitStyles.panedivider),g=document.createElement(\\\"div\\\"),g.style.width=a.defaultpanedividerwidth+\\\"px\\\",g.style.overflow=\\\"hidden\\\",l.appendChild(g),f.appendChild(l))}\\\"yes\\\"==e.rowattribs.hide[c]&&(f.style.cssText+=\\\";display:none\\\");return f};\\nSocialCalc.RenderSpacingRow=function(a){var c,b,d,e,f=document.createElement(\\\"tr\\\");a.showRCHeaders&&(b=document.createElement(\\\"td\\\"),b.width=a.rownamewidth,b.height=a.defaultpanedividerheight,a.classnames.panedivider&&(b.className=a.classnames.panedivider),a.explicitStyles.panedivider&&(b.style.cssText=a.explicitStyles.panedivider),f.appendChild(b));for(d=0;d<a.colpanes.length;d++){for(c=a.colpanes[d].first;c<=a.colpanes[d].last;c++){b=document.createElement(\\\"td\\\");if(e=a.colwidth[c])b.width=e;b.height=\\na.defaultpanedividerheight;a.classnames.panedivider&&(b.className=a.classnames.panedivider);a.explicitStyles.panedivider&&(b.style.cssText=a.explicitStyles.panedivider);b&&f.appendChild(b)}d<a.colpanes.length-1&&(b=document.createElement(\\\"td\\\"),b.width=a.defaultpanedividerwidth,b.height=a.defaultpanedividerheight,a.classnames.panedivider&&(b.className=a.classnames.panedivider),a.explicitStyles.panedivider&&(b.style.cssText=a.explicitStyles.panedivider),f.appendChild(b))}return f};\\nSocialCalc.RenderColHeaders=function(a){var c=a.sheetobj,b=document.createElement(\\\"tr\\\"),d,e;if(!a.showRCHeaders)return null;e=document.createElement(\\\"td\\\");a.classnames&&(e.className=a.classnames.upperleft);a.explicitStyles&&(e.style.cssText=a.explicitStyles.upperleft);e.width=a.rownamewidth;b.appendChild(e);for(colpane=0;colpane<a.colpanes.length;colpane++){for(d=a.colpanes[colpane].first;d<=a.colpanes[colpane].last;d++){e=document.createElement(\\\"td\\\");a.classnames&&(e.className=a.classnames.colname);\\na.explicitStyles&&(e.style.cssText=a.explicitStyles.colname);\\\"yes\\\"==c.colattribs.hide[SocialCalc.rcColname(d)]&&(e.style.cssText+=\\\";display:none\\\");e.innerHTML=SocialCalc.rcColname(d);if(d<a.colpanes[a.colpanes.length-1].last&&\\\"yes\\\"==c.colattribs.hide[SocialCalc.rcColname(d+1)]){var f=document.createElement(\\\"div\\\");a.classnames&&(f.className=a.classnames.unhideleft);a.explicitStyles&&(f.style.cssText=a.explicitStyles.unhideleft);a.colunhideleft[d]=f;e.appendChild(f)}1<d&&\\\"yes\\\"==c.colattribs.hide[SocialCalc.rcColname(d-\\n1)]&&(f=document.createElement(\\\"div\\\"),a.classnames&&(f.className=a.classnames.unhideright),a.explicitStyles&&(f.style.cssText=a.explicitStyles.unhideright),a.colunhideright[d]=f,e.appendChild(f));b.appendChild(e)}colpane<a.colpanes.length-1&&(e=document.createElement(\\\"td\\\"),e.width=a.defaultpanedividerwidth,a.classnames.panedivider&&(e.className=a.classnames.panedivider),a.explicitStyles.panedivider&&(e.style.cssText=a.explicitStyles.panedivider),b.appendChild(e))}return b};\\nSocialCalc.RenderColGroup=function(a){var c,b,d,e,f=a.sheetobj,g=document.createElement(\\\"colgroup\\\");a.showRCHeaders&&(d=document.createElement(\\\"col\\\"),d.width=a.rownamewidth,g.appendChild(d));for(c=0;c<a.colpanes.length;c++){for(b=a.colpanes[c].first;b<=a.colpanes[c].last;b++)if(d=document.createElement(\\\"col\\\"),\\\"yes\\\"==f.colattribs.hide[SocialCalc.rcColname(b)])d.width=\\\"1\\\";else{if(e=a.colwidth[b])d.width=e;g.appendChild(d)}c<a.colpanes.length-1&&(d=document.createElement(\\\"col\\\"),d.width=a.defaultpanedividerwidth,\\ng.appendChild(d))}return g};\\nSocialCalc.RenderSizingRow=function(a){var c,b,d,e,f=a.sheetobj,g=document.createElement(\\\"tr\\\");a.showRCHeaders&&(d=document.createElement(\\\"td\\\"),d.style.width=a.rownamewidth+\\\"px\\\",d.height=\\\"1\\\",g.appendChild(d));for(c=0;c<a.colpanes.length;c++){for(b=a.colpanes[c].first;b<=a.colpanes[c].last;b++){d=document.createElement(\\\"td\\\");if(\\\"yes\\\"==f.colattribs.hide[SocialCalc.rcColname(b)])d.width=\\\"1\\\";else if(e=a.colwidth[b])d.width=e;d.height=\\\"1\\\";g.appendChild(d)}c<a.colpanes.length-1&&(d=document.createElement(\\\"td\\\"),\\nd.width=a.defaultpanedividerwidth,d.height=\\\"1\\\",g.appendChild(d))}return g};\\nSocialCalc.RenderCell=function(a,c,b,d,e,f,g){var l=a.sheetobj,h,m,p,r,q,n=\\\"\\\";c-=0;b-=0;var s=SocialCalc.crToCoord(b,c);if(a.cellskip[s]){if(a.CoordInPane(a.cellskip[s],d,e))return null;f=f?SocialCalc.CreatePseudoElement():document.createElement(\\\"td\\\");a.classnames.skippedcell&&(f.className=a.classnames.skippedcell);a.explicitStyles.skippedcell&&(f.style.cssText=a.explicitStyles.skippedcell);f.innerHTML=\\\"&nbsp;\\\";return f}f=f?SocialCalc.CreatePseudoElement():document.createElement(\\\"td\\\");a.cellIDprefix&&\\n(f.id=a.cellIDprefix+s);(p=l.cells[s])||(p=new SocialCalc.Cell(s));q=l.attribs;scc=SocialCalc.Constants;if(1<p.colspan){for(h=m=1;h<p.colspan;h++)\\\"yes\\\"!=l.colattribs.hide[SocialCalc.rcColname(b+h)]&&a.CellInPane(c,b+h,d,e)&&m++;f.colSpan=m}if(1<p.rowspan){for(h=m=1;h<p.rowspan;h++)\\\"yes\\\"!=l.rowattribs.hide[c+h+\\\"\\\"]&&a.CellInPane(c+h,b,d,e)&&m++;f.rowSpan=m}void 0==p.displaystring&&(p.displaystring=SocialCalc.FormatValueForDisplay(l,p.datavalue,s,g||a.defaultlinkstyle));f.innerHTML=p.displaystring;n=\\n(h=p.layout||q.defaultlayout)&&\\\"undefined\\\"!==typeof a.layouts[h]?n+a.layouts[h]:n+scc.defaultCellLayout;(h=p.font||q.defaultfont)&&\\\"undefined\\\"!==typeof a.fonts[h]?(g=a.fonts[h],n+=\\\"font-style:\\\"+g.style+\\\";font-weight:\\\"+g.weight+\\\";font-size:\\\"+g.size+\\\";font-family:\\\"+g.family+\\\";\\\"):(scc.defaultCellFontSize&&(n+=\\\"font-size:\\\"+scc.defaultCellFontSize+\\\";\\\"),scc.defaultCellFontFamily&&(n+=\\\"font-family:\\\"+scc.defaultCellFontFamily+\\\";\\\"));(h=p.color||q.defaultcolor)&&\\\"undefined\\\"!==typeof l.colors[h]&&(n+=\\\"color:\\\"+\\nl.colors[h]+\\\";\\\");(h=p.bgcolor||q.defaultbgcolor)&&\\\"undefined\\\"!==typeof l.colors[h]&&(n+=\\\"background-color:\\\"+l.colors[h]+\\\";\\\");(h=p.cellformat)&&\\\"undefined\\\"!==typeof l.cellformats[h]?n+=\\\"text-align:\\\"+l.cellformats[h]+\\\";\\\":(g=p.valuetype.charAt(0),\\\"t\\\"==g?(h=q.defaulttextformat)&&\\\"undefined\\\"!==typeof l.cellformats[h]&&(n+=\\\"text-align:\\\"+l.cellformats[h]+\\\";\\\"):\\\"n\\\"==g?n=(h=q.defaultnontextformat)&&\\\"undefined\\\"!==typeof l.cellformats[h]?n+(\\\"text-align:\\\"+l.cellformats[h]+\\\";\\\"):n+\\\"text-align:right;\\\":n+=\\\"text-align:left;\\\");\\nif(1<p.colspan||1<p.rowspan)r=l.cells[SocialCalc.crToCoord(b+(p.colspan||1)-1,c+(p.rowspan||1)-1)];(h=p.bt)&&\\\"undefined\\\"!==typeof l.borderstyles[h]&&(n+=\\\"border-top:\\\"+l.borderstyles[h]+\\\";\\\");(h=\\\"undefined\\\"!=typeof r?r.br:p.br)&&\\\"undefined\\\"!==typeof l.borderstyles[h]?n+=\\\"border-right:\\\"+l.borderstyles[h]+\\\";\\\":a.showGrid&&(g=a.CellInPane(c,b+(p.colspan||1),d,e)?SocialCalc.crToCoord(b+(p.colspan||1),c):\\\"nomatch\\\",a.cellskip[g]&&(g=a.cellskip[g]),l.cells[g]&&l.cells[g].bl||(n+=\\\"border-right:\\\"+a.gridCSS));\\n(h=\\\"undefined\\\"!=typeof r?r.bb:p.bb)&&\\\"undefined\\\"!==typeof l.borderstyles[h]?n+=\\\"border-bottom:\\\"+l.borderstyles[h]+\\\";\\\":a.showGrid&&(g=a.CellInPane(c+(p.rowspan||1),b,d,e)?SocialCalc.crToCoord(b,c+(p.rowspan||1)):\\\"nomatch\\\",a.cellskip[g]&&(g=a.cellskip[g]),l.cells[g]&&l.cells[g].bt||(n+=\\\"border-bottom:\\\"+a.gridCSS));(h=p.bl)&&\\\"undefined\\\"!==typeof l.borderstyles[h]&&(n+=\\\"border-left:\\\"+l.borderstyles[h]+\\\";\\\");p.comment&&(f.title=p.comment,a.showGrid?(a.commentClassName&&(f.className=(f.className?f.className+\\n\\\" \\\":\\\"\\\")+a.commentClassName),n+=a.commentCSS):(a.commentNoGridClassName&&(f.className=(f.className?f.className+\\\" \\\":\\\"\\\")+a.commentNoGridClassName),n+=a.commentNoGridCSS));p.readonly&&(p.comment||(f.title=a.readonlyComment),a.showGrid?(a.readonlyClassName&&(f.className=(f.className?f.className+\\\" \\\":\\\"\\\")+a.readonlyClassName),n+=a.readonlyCSS):(a.readonlyNoGridClassName&&(f.className=(f.className?f.className+\\\" \\\":\\\"\\\")+a.readonlyNoGridClassName),n+=a.readonlyNoGridCSS));f.style.cssText=n;if(g=a.highlights[s])\\\"cursor\\\"==\\ng&&(g+=a.cursorsuffix),a.highlightTypes[g].className&&(f.className=(f.className?f.className+\\\" \\\":\\\"\\\")+a.highlightTypes[g].className),SocialCalc.setStyles(f,a.highlightTypes[g].style);\\\"yes\\\"==l.colattribs.hide[SocialCalc.rcColname(b)]&&(f.style.cssText+=\\\";display:none\\\");\\\"yes\\\"==l.rowattribs.hide[c]&&(f.style.cssText+=\\\";display:none\\\");return f};SocialCalc.CoordInPane=function(a,c,b,d){var e=a.coordToCR[c];if(!e||!e.row||!e.col)throw\\\"Bad coordToCR for \\\"+c;return a.CellInPane(e.row,e.col,b,d)};\\nSocialCalc.CellInPane=function(a,c,b,d,e){var f=a.rowpanes[d];a=a.colpanes[e];if(!f||!a)throw\\\"CellInPane called with unknown panes \\\"+d+\\\"/\\\"+e;return c<f.first||c>f.last||b<a.first||b>a.last?!1:!0};SocialCalc.CreatePseudoElement=function(){return{style:{cssText:\\\"\\\"},innerHTML:\\\"\\\",className:\\\"\\\"}};SocialCalc.rcColname=function(a){702<a&&(a=702);1>a&&(a=1);var c=(a-1)%26+65;return(a=Math.floor((a-1)/26))?String.fromCharCode(a+64)+String.fromCharCode(c):String.fromCharCode(c)};SocialCalc.letters=\\\"ABCDEFGHIJKLMNOPQRSTUVWXYZ\\\".split(\\\"\\\");\\nSocialCalc.crToCoord=function(a,c){1>a&&(a=1);702<a&&(a=702);1>c&&(c=1);var b=(a-1)%26,d=Math.floor((a-1)/26);return d?SocialCalc.letters[d-1]+SocialCalc.letters[b]+c:SocialCalc.letters[b]+c};SocialCalc.coordToCol={};SocialCalc.coordToRow={};\\nSocialCalc.coordToCr=function(a){var c,b,d,e=SocialCalc.coordToRow[a];if(e)return{row:e,col:SocialCalc.coordToCol[a]};for(b=e=c=0;b<a.length;b++)d=a.charCodeAt(b),36!=d&&(57>=d?e=10*e+d-48:97<=d?c=26*c+d-96:65<=d&&(c=26*c+d-64));SocialCalc.coordToCol[a]=c;SocialCalc.coordToRow[a]=e;return{row:e,col:c}};\\nSocialCalc.ParseRange=function(a){var c,b,d;a||(a=\\\"A1:A1\\\");a=a.toUpperCase();c=a.indexOf(\\\":\\\");0<=c?(b=a.substring(0,c),d=SocialCalc.coordToCr(b),d.coord=b,b=a.substring(c+1),c=SocialCalc.coordToCr(b),c.coord=b):(d=SocialCalc.coordToCr(a),d.coord=a,c=SocialCalc.coordToCr(a),c.coord=a);return{cr1:d,cr2:c}};SocialCalc.decodeFromSave=function(a){if(\\\"string\\\"!=typeof a||-1==a.indexOf(\\\"\\\\\\\\\\\"))return a;a=a.replace(/\\\\\\\\c/g,\\\":\\\");a=a.replace(/\\\\\\\\n/g,\\\"\\\\n\\\");return a.replace(/\\\\\\\\b/g,\\\"\\\\\\\\\\\")};\\nSocialCalc.decodeFromAjax=function(a){if(\\\"string\\\"!=typeof a||-1==a.indexOf(\\\"\\\\\\\\\\\"))return a;a=a.replace(/\\\\\\\\c/g,\\\":\\\");a=a.replace(/\\\\\\\\n/g,\\\"\\\\n\\\");a=a.replace(/\\\\\\\\e/g,\\\"]]\\\");return a.replace(/\\\\\\\\b/g,\\\"\\\\\\\\\\\")};SocialCalc.encodeForSave=function(a){if(\\\"string\\\"!=typeof a)return a;-1!=a.indexOf(\\\"\\\\\\\\\\\")&&(a=a.replace(/\\\\\\\\/g,\\\"\\\\\\\\b\\\"));-1!=a.indexOf(\\\":\\\")&&(a=a.replace(/:/g,\\\"\\\\\\\\c\\\"));-1!=a.indexOf(\\\"\\\\n\\\")&&(a=a.replace(/\\\\n/g,\\\"\\\\\\\\n\\\"));return a};\\nSocialCalc.special_chars=function(a){/[&<>\\\"]/.test(a)&&(a=a.replace(/&/g,\\\"&amp;\\\"),a=a.replace(/</g,\\\"&lt;\\\"),a=a.replace(/>/g,\\\"&gt;\\\"),a=a.replace(/\\\"/g,\\\"&quot;\\\"));return a};SocialCalc.Lookup=function(a,c){for(i=0;i<c.length;i++)if(c[i]>a)return 0<i?i-1:null;return c.length-1};\\nSocialCalc.setStyles=function(a,c){var b,d,e,f;if(c)for(b=c.split(\\\";\\\"),d=0;d<b.length;d++)if(e=b[d].indexOf(\\\":\\\"),-1!=e&&(f=b[d].substring(0,e),e=b[d].substring(e+1),f&&e)){if(TiddlyWiki&&\\\"backgroundImage\\\"==f){var g=TiddlyWiki.pathImages;if(e.match(\\\".*?url(.+).*\\\")){var l=/.*?url[(][\\\"]?.*?images\\\\/(.+?)[\\\"]?[)].*$/.exec(e);!l||2>l.length||(e=(g=TiddlyWiki.getRawTiddlerImage(g+\\\"/\\\"+l[1]))?e.replace(/url[(].+?[)]/,\\\"url(\\\"+g+\\\")\\\"):e)}}a.style[f]=e}};\\nSocialCalc.GetViewportInfo=function(){var a={};window.innerWidth?(a.width=window.innerWidth,a.height=window.innerHeight,a.horizontalScroll=window.pageXOffset,a.verticalScroll=window.pageYOffset):document.documentElement&&document.documentElement.clientWidth?(a.width=document.documentElement.clientWidth,a.height=document.documentElement.clientHeight,a.horizontalScroll=document.documentElement.scrollLeft,a.verticalScroll=document.documentElement.scrollTop):document.body.clientWidth&&(a.width=document.body.clientWidth,\\na.height=document.body.clientHeight,a.horizontalScroll=document.body.scrollLeft,a.verticalScroll=document.body.scrollTop);return a};SocialCalc.GetElementPosition=function(a){for(var c=0,b=0;a&&\\\"relative\\\"!=SocialCalc.GetComputedStyle(a,\\\"position\\\");)c+=a.offsetLeft,b+=a.offsetTop,a=a.offsetParent;return{left:c,top:b}};\\nSocialCalc.GetElementPositionWithScroll=function(a){a=a.getBoundingClientRect();return{left:a.left,right:a.right,top:a.top,bottom:a.bottom,width:a.width?a.width:a.right-a.left,height:a.height?a.height:a.bottom-a.top}};SocialCalc.GetElementFixedParent=function(a){for(;a&&\\\"HTML\\\"!=a.tagName;){if(\\\"fixed\\\"==SocialCalc.GetComputedStyle(a,\\\"position\\\"))return a;a=a.parentNode}return!1};\\nSocialCalc.GetComputedStyle=function(a,c){return(\\\"undefined\\\"!=typeof a.currentStyle?a.currentStyle:document.defaultView.getComputedStyle(a,null))[c]};SocialCalc.LookupElement=function(a,c){var b;for(b=0;b<c.length;b++)if(c[b].element==a)return c[b];return null};SocialCalc.AssignID=function(a,c,b){a.idPrefix&&(c.id=a.idPrefix+b)};\\nSocialCalc.GetCellContents=function(a,c){var b=\\\"\\\",d=a.cells[c];if(d)switch(d.datatype){case \\\"v\\\":b=d.datavalue+\\\"\\\";break;case \\\"t\\\":b=\\\"'\\\"+d.datavalue;break;case \\\"f\\\":b=\\\"=\\\"+d.formula;break;case \\\"c\\\":b=d.formula}return b};\\nSocialCalc.FormatValueForDisplay=function(a,c,b,d){var e,f=a.attribs,g=a.cells[b];g||(g=new SocialCalc.Cell(b));b=g.valuetype||\\\"\\\";e=b.substring(1);b=b.charAt(0);if(g.errors||\\\"e\\\"==b)return c=g.errors||e||\\\"Error in cell\\\";if(\\\"t\\\"==b){b=a.valueformats[g.textvalueformat-0]||a.valueformats[f.defaulttextvalueformat-0]||\\\"\\\";if(\\\"formula\\\"==b)return c=\\\"f\\\"==g.datatype?SocialCalc.special_chars(\\\"=\\\"+g.formula)||\\\"&nbsp;\\\":\\\"c\\\"==g.datatype?SocialCalc.special_chars(\\\"'\\\"+g.formula)||\\\"&nbsp;\\\":SocialCalc.special_chars(\\\"'\\\"+\\nc)||\\\"&nbsp;\\\";c=SocialCalc.format_text_for_display(c,g.valuetype,b,a,d,g.nontextvalueformat)}else if(\\\"n\\\"==b){b=g.nontextvalueformat;if(null==b||\\\"\\\"==b)b=f.defaultnontextvalueformat;b=a.valueformats[b-0];if(null==b||\\\"none\\\"==b)b=\\\"\\\";if(\\\"formula\\\"==b)return c=\\\"f\\\"==g.datatype?SocialCalc.special_chars(\\\"=\\\"+g.formula)||\\\"&nbsp;\\\":\\\"c\\\"==g.datatype?SocialCalc.special_chars(\\\"'\\\"+g.formula)||\\\"&nbsp;\\\":SocialCalc.special_chars(\\\"'\\\"+c)||\\\"&nbsp;\\\";if(\\\"forcetext\\\"==b)return c=\\\"f\\\"==g.datatype?SocialCalc.special_chars(\\\"=\\\"+g.formula)||\\n\\\"&nbsp;\\\":\\\"c\\\"==g.datatype?SocialCalc.special_chars(g.formula)||\\\"&nbsp;\\\":SocialCalc.special_chars(c)||\\\"&nbsp;\\\";c=SocialCalc.format_number_for_display(c,g.valuetype,b)}else c=\\\"&nbsp;\\\";return c};\\nSocialCalc.format_text_for_display=function(a,c,b,d,e,f){var g,l,h;g=c.substring(1);h=a;if(\\\"none\\\"==b||null==b)b=\\\"\\\";/^(text-|custom|hidden)/.test(b)||(b=\\\"\\\");if(\\\"\\\"==b||\\\"General\\\"==b){\\\"h\\\"==g&&(b=\\\"text-html\\\");if(\\\"w\\\"==g||\\\"r\\\"==g)b=\\\"text-wiki\\\";\\\"l\\\"==g&&(b=\\\"text-link\\\");g||(b=\\\"text-plain\\\")}\\\"text-html\\\"!=b&&(SocialCalc.Callbacks.expand_wiki&&/^text-wiki/.test(b)?h=SocialCalc.Callbacks.expand_wiki(h,d,e,b):\\\"text-wiki\\\"==b?h=SocialCalc.Callbacks.expand_markup&&SocialCalc.Callbacks.expand_markup(h,d,e)||SocialCalc.special_chars(\\\"wiki-text:\\\"+\\nh):\\\"text-url\\\"==b?(a=SocialCalc.special_chars(h),c=encodeURI(h),h='<a href=\\\"'+c+'\\\">'+a+\\\"</a>\\\"):\\\"text-link\\\"==b?h=SocialCalc.expand_text_link(h,d,e,b):\\\"text-image\\\"==b?(c=encodeURI(h),h='<img src=\\\"'+c+'\\\">'):\\\"text-custom:\\\"==b.substring(0,12)?(a=SocialCalc.special_chars(h),a=a.replace(/  /g,\\\"&nbsp; \\\"),a=a.replace(/\\\\n/g,\\\"<br>\\\"),c=encodeURI(h),l={},l.r=h,l.s=a,l.u=c,h=b.substring(12),h=h.replace(/@(r|s|u)/g,function(a,b){return l[b]})):\\\"custom\\\"==b.substring(0,6)?(h=SocialCalc.special_chars(h),h=h.replace(/  /g,\\n\\\"&nbsp; \\\"),h=h.replace(/\\\\n/g,\\\"<br>\\\"),h+=\\\" (custom format)\\\"):\\\"hidden\\\"==b?h=\\\"&nbsp;\\\":null!=f&&\\\"\\\"!=f&&\\\"none\\\"!=d.valueformats[f-0]&&\\\"\\\"!=d.valueformats[f-0]?(b=d.valueformats[f],h=SocialCalc.format_number_for_display(a,c,b)):(h=SocialCalc.special_chars(h),h=h.replace(/  /g,\\\"&nbsp; \\\"),h=h.replace(/\\\\n/g,\\\"<br>\\\")));return h};\\nSocialCalc.format_number_for_display=function(a,c,b){var d,e=SocialCalc.Constants;d=a-0;c=c.substring(1);if(\\\"Auto\\\"==b||\\\"\\\"==b)b=\\\"%\\\"==c?e.defaultFormatp:\\\"$\\\"==c?e.defaultFormatc:\\\"dt\\\"==c?e.defaultFormatdt:\\\"d\\\"==c?e.defaultFormatd:\\\"t\\\"==c?e.defaultFormatt:\\\"l\\\"==c?\\\"logical\\\":\\\"General\\\";return\\\"logical\\\"==b?d?e.defaultDisplayTRUE:e.defaultDisplayFALSE:\\\"hidden\\\"==b?\\\"&nbsp;\\\":SocialCalc.FormatNumber.formatNumberWithFormat(a,b,\\\"\\\")};\\nSocialCalc.DetermineValueType=function(a){var c=a+\\\"\\\",b=\\\"t\\\",d,e;d=c.replace(/^\\\\s+/,\\\"\\\");d=d.replace(/\\\\s+$/,\\\"\\\");0==c.length?b=\\\"\\\":c.match(/^\\\\s+$/)||(d.match(/^[-+]?\\\\d*(?:\\\\.)?\\\\d*(?:[eE][-+]?\\\\d+)?$/)?(c=d-0,isNaN(c)?c=a+\\\"\\\":b=\\\"n\\\"):d.match(/^[-+]?\\\\d*(?:\\\\.)?\\\\d*\\\\s*%$/)?(c=(d.slice(0,-1)-0)/100,b=\\\"n%\\\"):d.match(/^[-+]?\\\\$\\\\s*\\\\d*(?:\\\\.)?\\\\d*\\\\s*$/)&&d.match(/\\\\d/)?(c=d.replace(/\\\\$/,\\\"\\\")-0,b=\\\"n$\\\"):d.match(/^[-+]?(\\\\d*,\\\\d*)+(?:\\\\.)?\\\\d*$/)?(c=d.replace(/,/g,\\\"\\\")-0,b=\\\"n\\\"):d.match(/^[-+]?(\\\\d*,\\\\d*)+(?:\\\\.)?\\\\d*\\\\s*%$/)?(c=(d.replace(/[%,]/g,\\n\\\"\\\")-0)/100,b=\\\"n%\\\"):d.match(/^[-+]?\\\\$\\\\s*(\\\\d*,\\\\d*)+(?:\\\\.)?\\\\d*$/)&&d.match(/\\\\d/)?(c=d.replace(/[\\\\$,]/g,\\\"\\\")-0,b=\\\"n$\\\"):(a=c.match(/^(\\\\d{1,2})[\\\\/\\\\-](\\\\d{1,2})[\\\\/\\\\-](\\\\d{1,4})\\\\s*$/))?(c=a[3]-0,c=SocialCalc.FormatNumber.convert_date_gregorian_to_julian(1E3>c?c+2E3:c,a[1]-0,a[2]-0)-2415019,b=\\\"nd\\\"):(a=c.match(/^(\\\\d{4})[\\\\/\\\\-](\\\\d{1,2})[\\\\/\\\\-](\\\\d{1,2})\\\\s*$/))?(c=a[1]-0,c=1E3>c?c+2E3:c,c=SocialCalc.FormatNumber.convert_date_gregorian_to_julian(c,a[2]-0,a[3]-0)-2415019,b=\\\"nd\\\"):(a=c.match(/^(\\\\d{1,2}):(\\\\d{1,2})\\\\s*$/))?\\n(d=a[1]-0,e=a[2]-0,24>d&&60>e&&(c=d/24+e/1440,b=\\\"nt\\\")):(a=c.match(/^(\\\\d{1,2}):(\\\\d{1,2}):(\\\\d{1,2})\\\\s*$/))?(d=a[1]-0,e=a[2]-0,a=a[3]-0,24>d&&60>e&&60>a&&(c=d/24+e/1440+a/86400,b=\\\"nt\\\")):(a=c.match(/^\\\\s*([-+]?\\\\d+) (\\\\d+)\\\\/(\\\\d+)\\\\s*$/))?(e=a[1]-0,d=a[2]-0,(a=a[3]-0)&&0<a&&(c=e+(0>e?-d/a:d/a),b=\\\"n\\\")):(a=SocialCalc.InputConstants[c.toUpperCase()])?(d=a.indexOf(\\\",\\\"),c=a.substring(0,d)-0,b=a.substring(d+1)):7<d.length&&\\\"http://\\\"==d.substring(0,7).toLowerCase()?(c=d,b=\\\"tl\\\"):d.match(/<([A-Z][A-Z0-9]*)\\\\b[^>]*>[\\\\s\\\\S]*?<\\\\/\\\\1>/i)&&\\n(c=d,b=\\\"th\\\"));return{value:c,type:b}};SocialCalc.InputConstants={TRUE:\\\"1,nl\\\",FALSE:\\\"0,nl\\\",\\\"#N/A\\\":\\\"0,e#N/A\\\",\\\"#NULL!\\\":\\\"0,e#NULL!\\\",\\\"#NUM!\\\":\\\"0,e#NUM!\\\",\\\"#DIV/0!\\\":\\\"0,e#DIV/0!\\\",\\\"#VALUE!\\\":\\\"0,e#VALUE!\\\",\\\"#REF!\\\":\\\"0,e#REF!\\\",\\\"#NAME?\\\":\\\"0,e#NAME?\\\"};SocialCalc.default_expand_markup=function(a,c,b){a=SocialCalc.special_chars(a);a=a.replace(/  /g,\\\"&nbsp; \\\");return a=a.replace(/\\\\n/g,\\\"<br>\\\")};\\nSocialCalc.expand_text_link=function(a,c,b,d){var e;e=SocialCalc.Constants;var f=\\\"\\\";c=SocialCalc.ParseCellLinkText(a+\\\"\\\");hack.log(\\\"desc=\\\"+c.desc+\\\", url=\\\"+c.url+\\\", pagename=\\\"+c.pagename,hack.url,\\\"SocialCalc.expand_text_link\\\");e=c.desc?SocialCalc.special_chars(c.desc):c.pagename?e.defaultPageLinkFormatString:e.defaultLinkFormatString;7<a.length&&\\\"http://\\\"==a.substring(0,7).toLowerCase()&&\\\">\\\"!=a.charAt(a.length-1)&&(e=e.substring(7));a=c.newwin||!b?' target=\\\"_blank\\\"':\\\"\\\";c.pagename?SocialCalc.Callbacks.MakePageLink&&\\n(f=SocialCalc.Callbacks.MakePageLink(c.pagename,c.workspacename,b,d)):f=encodeURI(c.url);b='<a href=\\\"'+f+'\\\"'+a+\\\">\\\"+e+\\\"</a>\\\";TiddlyWiki&&(d=SocialCalc.GetSpreadsheetControlObject(),a=null,c.pagename||c.url.match(/^tw:/))&&(c.desc&&(e=SocialCalc.special_chars(c.desc)),c.pagename?(a=c.pagename,c.desc||(e=c.pagename)):(a=c.url.replace(/^tw:/,\\\"\\\"),c.desc||(e=a)),a=d.tiddlyWiki.resolvePath(a),b='<a href=\\\"javascript:void(0);\\\" title=\\\"'+a+'\\\" onclick=\\\"TiddlyWiki.navigateToTiddler(\\\\''+a+\\\"');\\\\\\\">\\\"+e+\\\"</a>\\\");hack.log(\\\"html = \\\"+\\nb,hack.url,\\\"SocialCalc.expand_text_link\\\");return b};\\nSocialCalc.ParseCellLinkText=function(a){var c={url:\\\"\\\",desc:\\\"\\\",newwin:!1,pagename:\\\"\\\",workspace:\\\"\\\"},b=!1,d=a.length-1,e=0,f=a.lastIndexOf(\\\"<\\\"),g=a.lastIndexOf(\\\"[\\\"),l=a.lastIndexOf(\\\"{\\\"),h=-1;\\\">\\\"==a.charAt(d)&&-1!=f||\\\"]\\\"==a.charAt(d)&&-1!=g||!(\\\"}\\\"!=a.charAt(d)||\\\"]\\\"!=a.charAt(d-1)||-1==l||-1==g||g<l)?(\\\">\\\"==a.charAt(d)?(h=f-1,0<f&&\\\"<\\\"==a.charAt(h)&&\\\">\\\"==a.charAt(d-1)&&(h--,d--,c.newwin=!0)):\\\"]\\\"==a.charAt(d)?(h=g-1,b=!0,0<g&&\\\"[\\\"==a.charAt(h)&&\\\"]\\\"==a.charAt(d-1)&&(h--,d--,c.newwin=!0)):\\\"}\\\"==a.charAt(d)&&\\n(h=l-1,b=!0,wsend=g,d--,0<g&&\\\"[\\\"==a.charAt(g-1)&&\\\"]\\\"==a.charAt(d-1)&&(wsend=g-1,d--,c.newwin=!0),\\\" \\\"==a.charAt(wsend-1)&&wsend--,c.workspace=a.substring(l+1,wsend)||\\\"\\\"),\\\" \\\"==a.charAt(h)&&h--,'\\\"'==a.charAt(e)&&'\\\"'==a.charAt(h)&&(e++,h--)):(d++,h=d);b?c.pagename=a.substring(g+1,d)||\\\"\\\":c.url=a.substring(f+1,d)||\\\"\\\";h>=e&&(c.desc=a.substring(e,h+1));return c};\\nSocialCalc.ConvertSaveToOtherFormat=function(a,c,b){var d,e,f,g;e=\\\"\\\";if(\\\"scsave\\\"==c)return a;if(\\\"\\\"==a)return\\\"\\\";d=new SocialCalc.Sheet;d.ParseSheetSave(a);if(b)throw\\\"SocialCalc.ConvertSaveToOtherFormat: Not doing recalc.\\\";a=d.copiedfrom?SocialCalc.ParseRange(d.copiedfrom):{cr1:{row:1,col:1},cr2:{row:d.attribs.lastrow,col:d.attribs.lastcol}};if(\\\"html\\\"==c)return e=new SocialCalc.RenderContext(d),d.copiedfrom&&(e.rowpanes[0]={first:a.cr1.row,last:a.cr2.row},e.colpanes[0]={first:a.cr1.col,last:a.cr2.col}),\\nc=document.createElement(\\\"div\\\"),a=e.RenderSheet(null,e.defaultHTMLlinkstyle),c.appendChild(a),delete e,delete d,e=c.innerHTML,delete a,delete c,e;for(b=a.cr1.row;b<=a.cr2.row;b++){for(f=a.cr1.col;f<=a.cr2.col;f++)g=SocialCalc.crToCoord(f,b),g=d.GetAssuredCell(g),g=g.errors?g.errors:g.datavalue+\\\"\\\",\\\"csv\\\"==c?(-1!=g.indexOf('\\\"')&&(g=g.replace(/\\\"/g,'\\\"\\\"')),/[, \\\\n\\\"]/.test(g)&&(g='\\\"'+g+'\\\"'),f>a.cr1.col&&(g=\\\",\\\"+g)):\\\"tab\\\"==c&&(-1!=g.indexOf(\\\"\\\\n\\\")&&(-1!=g.indexOf('\\\"')&&(g=g.replace(/\\\"/g,'\\\"\\\"')),g='\\\"'+g+'\\\"'),\\nf>a.cr1.col&&(g=\\\"\\\\t\\\"+g)),e+=g;e+=\\\"\\\\n\\\"}return e};\\nSocialCalc.ConvertOtherFormatToSave=function(a,c){var b,d,e,f,g,l,h,m,p,r,q,n,s=\\\"\\\",t=function(){r++;r>n&&(n=r);q=SocialCalc.crToCoord(r,p);SocialCalc.SetConvertedCell(b,q,g);g=\\\"\\\"};if(\\\"scsave\\\"==c)return a;b=new SocialCalc.Sheet;d=a.split(/\\\\r\\\\n|\\\\n/);n=0;if(\\\"csv\\\"==c){p=0;l=!1;for(e=0;e<d.length&&(e!=d.length-1||\\\"\\\"!=d[e]);e++)for(l?g+=\\\"\\\\n\\\":(g=\\\"\\\",p++,r=0),f=d[e],h=0;h<f.length;h++)m=f.charAt(h),'\\\"'==m?l?h<f.length-1&&'\\\"'==f.charAt(h+1)?(h++,g+='\\\"'):(l=!1,h==f.length-1&&t()):l=!0:(\\\",\\\"!=m||l?g+=m:t(),h!=\\nf.length-1||l||t());0<n&&(b.attribs.lastrow=p,b.attribs.lastcol=n,s=b.CreateSheetSave(\\\"A1:\\\"+SocialCalc.crToCoord(n,p)))}if(\\\"tab\\\"==c){p=0;l=!1;for(e=0;e<d.length&&(e!=d.length-1||\\\"\\\"!=d[e]);e++)for(l?g+=\\\"\\\\n\\\":(g=\\\"\\\",p++,r=0),f=d[e],h=0;h<f.length;h++){m=f.charAt(h);if('\\\"'==m){if(l){h<f.length-1?'\\\"'==f.charAt(h+1)?(h++,g+='\\\"'):\\\"\\\\t\\\"==f.charAt(h+1)&&(h++,l=!1,t()):(l=!1,t());continue}if(\\\"\\\"==g){l=!0;continue}}\\\"\\\\t\\\"!=m||l?g+=m:t();h!=f.length-1||l||t()}0<n&&(b.attribs.lastrow=p,b.attribs.lastcol=n,s=b.CreateSheetSave(\\\"A1:\\\"+\\nSocialCalc.crToCoord(n,p)))}return s};SocialCalc.SetConvertedCell=function(a,c,b){a=a.GetAssuredCell(c);c=SocialCalc.DetermineValueType(b);\\\"n\\\"==c.type&&c.value==b?(a.datatype=\\\"v\\\",a.valuetype=\\\"n\\\",a.datavalue=c.value):\\\"t\\\"==c.type.charAt(0)?(a.datatype=\\\"t\\\",a.valuetype=c.type,a.datavalue=c.value):(a.datatype=\\\"c\\\",a.valuetype=c.type,a.datavalue=c.value,a.formula=b)};SocialCalc||(SocialCalc={});\\nSocialCalc.TableEditor=function(a){var c=SocialCalc.Constants;this.context=a;this.fullgrid=this.toplevel=null;this.noEdit=!1;this.timeout=this.cellhandles=this.logo=this.horizontaltablecontrol=this.verticaltablecontrol=this.inputEcho=this.inputBox=this.tableheight=this.height=this.tablewidth=this.width=null;this.ensureecell=this.busy=!1;this.deferredCommands=[];this.lastvisiblecol=this.lastnonscrollingcol=this.firstscrollingcolleft=this.firstscrollingcol=this.lastvisiblerow=this.lastnonscrollingrow=\\nthis.firstscrollingrowtop=this.firstscrollingrow=this.headposition=this.gridposition=null;this.rowpositions=[];this.colpositions=[];this.rowheight=[];this.colwidth=[];this.ecell=null;this.state=\\\"start\\\";this.workingvalues={};this.imageprefix=c.defaultImagePrefix;this.idPrefix=c.defaultTableEditorIDPrefix;this.pageUpDnAmount=c.defaultPageUpDnAmount;this.recalcFunction=function(a){if(a.context.sheetobj.RecalcSheet)a.context.sheetobj.RecalcSheet(SocialCalc.EditorSheetStatusCallback,a);else return null};\\nthis.ctrlkeyFunction=function(a,c){var e,f,g,l;switch(c){case \\\"[ctrl-c]\\\":case \\\"[ctrl-x]\\\":e=a.pasteTextarea;e.value=\\\"\\\";if(f=SocialCalc.GetEditorCellElement(a,a.ecell.row,a.ecell.col))f=SocialCalc.GetElementPosition(f.element),e.style.left=f.left-1+\\\"px\\\",e.style.top=f.top-1+\\\"px\\\";l=a.range.hasrange?SocialCalc.crToCoord(a.range.left,a.range.top)+\\\":\\\"+SocialCalc.crToCoord(a.range.right,a.range.bottom):a.ecell.coord;f=SocialCalc.ConvertSaveToOtherFormat(SocialCalc.CreateSheetSave(a.context.sheetobj,l),\\\"tab\\\");\\ng=\\\"[ctrl-c]\\\"==c||a.noEdit||a.ECellReadonly()?\\\"copy \\\"+l+\\\" formulas\\\":\\\"cut \\\"+l+\\\" formulas\\\";a.EditorScheduleSheetCommands(g,!0,!1);e.style.display=\\\"block\\\";e.value=f;e.focus();e.select();window.setTimeout(function(){var c=a.pasteTextarea;c.blur();c.style.display=\\\"none\\\";SocialCalc.KeyboardFocus()},200);break;case \\\"[ctrl-v]\\\":if(a.noEdit||a.ECellReadonly())break;e=a.pasteTextarea;e.value=\\\"\\\";if(f=SocialCalc.GetEditorCellElement(a,a.ecell.row,a.ecell.col))f=SocialCalc.GetElementPosition(f.element),e.style.left=\\nf.left-1+\\\"px\\\",e.style.top=f.top-1+\\\"px\\\";e.style.display=\\\"block\\\";e.value=\\\"\\\";e.focus();window.setTimeout(function(){var c=a.pasteTextarea,d=c.value;c.blur();c.style.display=\\\"none\\\";var c=\\\"\\\",e=SocialCalc.ConvertSaveToOtherFormat(SocialCalc.Clipboard.clipboard,\\\"tab\\\"),d=d.replace(/\\\\r\\\\n/g,\\\"\\\\n\\\");d==e||1==d.length-e.length&&d.substring(0,d.length-1)==e||(c=\\\"loadclipboard \\\"+SocialCalc.encodeForSave(SocialCalc.ConvertOtherFormatToSave(d,\\\"tab\\\"))+\\\"\\\\n\\\");d=a.range.hasrange?SocialCalc.crToCoord(a.range.left,a.range.top):\\na.ecell.coord;a.EditorScheduleSheetCommands(c+(\\\"paste \\\"+d+\\\" formulas\\\"),!0,!1);SocialCalc.KeyboardFocus()},200);break;case \\\"[ctrl-z]\\\":return a.EditorScheduleSheetCommands(\\\"undo\\\",!0,!1),!1;case \\\"[ctrl-s]\\\":if(!SocialCalc.Constants.AllowCtrlS)break;TiddlyWiki&&(e=SocialCalc.GetSpreadsheetControlObject(),TiddlyWiki.executeExtensionCmd(e,\\\"tiddlywiki-save\\\"),SocialCalc.KeyboardFocus());return!1;case \\\"[ctrl-j]\\\":if(!SocialCalc.Constants.AllowCtrlJ)break;window.setTimeout(function(){var c=a.context.sheetobj,\\nd=c.GetAssuredCell(a.ecell.coord),c=window.prompt(\\\"Advanced Feature:\\\\n\\\\nCustom Numeric Format or Command\\\",d.nontextvalueformat?c.valueformats[d.nontextvalueformat-0]||\\\"\\\":\\\"\\\");if(null!=c){if(c.match(/^cmd:/))g=c.substring(4);else{if(c.match(/^edit:/)){g=c.substring(5);SocialCalc.CtrlSEditor&&SocialCalc.CtrlSEditor(g);return}l=a.range.hasrange?SocialCalc.crToCoord(a.range.left,a.range.top)+\\\":\\\"+SocialCalc.crToCoord(a.range.right,a.range.bottom):a.ecell.coord;g=\\\"set \\\"+l+\\\" nontextvalueformat \\\"+c}a.EditorScheduleSheetCommands(g,\\n!0,!1)}},200);return!1}return!0};a.sheetobj.statuscallback=SocialCalc.EditorSheetStatusCallback;a.sheetobj.statuscallbackparams=this;this.StatusCallback={};this.MoveECellCallback={};this.RangeChangeCallback={};this.SettingsCallbacks={};this.ecell={coord:\\\"A1\\\",row:1,col:1};a.highlights[this.ecell.coord]=\\\"cursor\\\";this.range={hasrange:!1};this.range2={hasrange:!1}};SocialCalc.TableEditor.prototype.CreateTableEditor=function(a,c){return SocialCalc.CreateTableEditor(this,a,c)};\\nSocialCalc.TableEditor.prototype.ResizeTableEditor=function(a,c){return SocialCalc.ResizeTableEditor(this,a,c)};SocialCalc.TableEditor.prototype.SaveEditorSettings=function(){return SocialCalc.SaveEditorSettings(this)};SocialCalc.TableEditor.prototype.LoadEditorSettings=function(a,c){return SocialCalc.LoadEditorSettings(this,a,c)};SocialCalc.TableEditor.prototype.EditorRenderSheet=function(){SocialCalc.EditorRenderSheet(this)};\\nSocialCalc.TableEditor.prototype.EditorScheduleSheetCommands=function(a,c,b){SocialCalc.EditorScheduleSheetCommands(this,a,c,b)};SocialCalc.TableEditor.prototype.ScheduleSheetCommands=function(a,c){this.context.sheetobj.ScheduleSheetCommands(a,c)};SocialCalc.TableEditor.prototype.SheetUndo=function(){this.context.sheetobj.SheetUndo()};SocialCalc.TableEditor.prototype.SheetRedo=function(){this.context.sheetobj.SheetRedo()};\\nSocialCalc.TableEditor.prototype.EditorStepSet=function(a,c){SocialCalc.EditorStepSet(this,a,c)};SocialCalc.TableEditor.prototype.GetStatuslineString=function(a,c,b){return SocialCalc.EditorGetStatuslineString(this,a,c,b)};SocialCalc.TableEditor.prototype.EditorMouseRegister=function(){return SocialCalc.EditorMouseRegister(this)};SocialCalc.TableEditor.prototype.EditorMouseUnregister=function(){return SocialCalc.EditorMouseUnregister(this)};\\nSocialCalc.TableEditor.prototype.EditorMouseRange=function(a){return SocialCalc.EditorMouseRange(this,a)};SocialCalc.TableEditor.prototype.EditorProcessKey=function(a,c){return SocialCalc.EditorProcessKey(this,a,c)};SocialCalc.TableEditor.prototype.EditorAddToInput=function(a,c){return SocialCalc.EditorAddToInput(this,a,c)};SocialCalc.TableEditor.prototype.DisplayCellContents=function(){return SocialCalc.EditorDisplayCellContents(this)};\\nSocialCalc.TableEditor.prototype.EditorSaveEdit=function(a){return SocialCalc.EditorSaveEdit(this,a)};SocialCalc.TableEditor.prototype.EditorApplySetCommandsToRange=function(a,c){return SocialCalc.EditorApplySetCommandsToRange(this,a,c)};SocialCalc.TableEditor.prototype.MoveECellWithKey=function(a){return SocialCalc.MoveECellWithKey(this,a)};SocialCalc.TableEditor.prototype.MoveECell=function(a){return SocialCalc.MoveECell(this,a)};\\nSocialCalc.TableEditor.prototype.ReplaceCell=function(a,c,b){SocialCalc.ReplaceCell(this,a,c,b)};SocialCalc.TableEditor.prototype.UpdateCellCSS=function(a,c,b){SocialCalc.UpdateCellCSS(this,a,c,b)};SocialCalc.TableEditor.prototype.SetECellHeaders=function(a){SocialCalc.SetECellHeaders(this,a)};SocialCalc.TableEditor.prototype.EnsureECellVisible=function(){SocialCalc.EnsureECellVisible(this)};SocialCalc.TableEditor.prototype.ECellReadonly=function(a){return SocialCalc.ECellReadonly(this,a)};\\nSocialCalc.TableEditor.prototype.RangeAnchor=function(a){SocialCalc.RangeAnchor(this,a)};SocialCalc.TableEditor.prototype.RangeExtend=function(a){SocialCalc.RangeExtend(this,a)};SocialCalc.TableEditor.prototype.RangeRemove=function(){SocialCalc.RangeRemove(this)};SocialCalc.TableEditor.prototype.Range2Remove=function(){SocialCalc.Range2Remove(this)};SocialCalc.TableEditor.prototype.FitToEditTable=function(){SocialCalc.FitToEditTable(this)};\\nSocialCalc.TableEditor.prototype.CalculateEditorPositions=function(){SocialCalc.CalculateEditorPositions(this)};SocialCalc.TableEditor.prototype.ScheduleRender=function(){SocialCalc.ScheduleRender(this)};SocialCalc.TableEditor.prototype.DoRenderStep=function(){SocialCalc.DoRenderStep(this)};SocialCalc.TableEditor.prototype.SchedulePositionCalculations=function(){SocialCalc.SchedulePositionCalculations(this)};SocialCalc.TableEditor.prototype.DoPositionCalculations=function(){SocialCalc.DoPositionCalculations(this)};\\nSocialCalc.TableEditor.prototype.CalculateRowPositions=function(a,c,b){return SocialCalc.CalculateRowPositions(this,a,c,b)};SocialCalc.TableEditor.prototype.CalculateColPositions=function(a,c,b){return SocialCalc.CalculateColPositions(this,a,c,b)};SocialCalc.TableEditor.prototype.ScrollRelative=function(a,c){SocialCalc.ScrollRelative(this,a,c)};SocialCalc.TableEditor.prototype.ScrollRelativeBoth=function(a,c){SocialCalc.ScrollRelativeBoth(this,a,c)};\\nSocialCalc.TableEditor.prototype.PageRelative=function(a,c){SocialCalc.PageRelative(this,a,c)};SocialCalc.TableEditor.prototype.LimitLastPanes=function(){SocialCalc.LimitLastPanes(this)};SocialCalc.TableEditor.prototype.ScrollTableUpOneRow=function(){return SocialCalc.ScrollTableUpOneRow(this)};SocialCalc.TableEditor.prototype.ScrollTableDownOneRow=function(){return SocialCalc.ScrollTableDownOneRow(this)};SocialCalc.TableEditor.prototype.ScrollTableLeftOneCol=function(){return SocialCalc.ScrollTableLeftOneCol(this)};\\nSocialCalc.TableEditor.prototype.ScrollTableRightOneCol=function(){return SocialCalc.ScrollTableRightOneCol(this)};\\nSocialCalc.CreateTableEditor=function(a,c,b){var d=SocialCalc.Constants,e=SocialCalc.AssignID;a.toplevel=document.createElement(\\\"div\\\");a.toplevel.style.position=\\\"relative\\\";e(a,a.toplevel,\\\"toplevel\\\");a.width=c;a.height=b;a.griddiv=document.createElement(\\\"div\\\");a.tablewidth=Math.max(0,c-d.defaultTableControlThickness);a.tableheight=Math.max(0,b-d.defaultTableControlThickness);a.griddiv.style.width=a.tablewidth+\\\"px\\\";a.griddiv.style.height=a.tableheight+\\\"px\\\";a.griddiv.style.overflow=\\\"hidden\\\";a.griddiv.style.cursor=\\n\\\"default\\\";d.cteGriddivClass&&(a.griddiv.className=d.cteGriddivClass);e(a,a.griddiv,\\\"griddiv\\\");a.FitToEditTable();a.EditorRenderSheet();a.griddiv.appendChild(a.fullgrid);a.verticaltablecontrol=new SocialCalc.TableControl(a,!0,a.tableheight);a.verticaltablecontrol.CreateTableControl();e(a,a.verticaltablecontrol.main,\\\"tablecontrolv\\\");a.horizontaltablecontrol=new SocialCalc.TableControl(a,!1,a.tablewidth);a.horizontaltablecontrol.CreateTableControl();e(a,a.horizontaltablecontrol.main,\\\"tablecontrolh\\\");\\nc=document.createElement(\\\"table\\\");a.layouttable=c;c.cellSpacing=0;c.cellPadding=0;e(a,c,\\\"layouttable\\\");d=document.createElement(\\\"tbody\\\");c.appendChild(d);c=document.createElement(\\\"tr\\\");d.appendChild(c);b=document.createElement(\\\"td\\\");b.appendChild(a.griddiv);c.appendChild(b);b=document.createElement(\\\"td\\\");b.appendChild(a.verticaltablecontrol.main);c.appendChild(b);c=document.createElement(\\\"tr\\\");d.appendChild(c);b=document.createElement(\\\"td\\\");b.appendChild(a.horizontaltablecontrol.main);c.appendChild(b);\\nb=document.createElement(\\\"td\\\");d=\\\"url(\\\"+a.imageprefix+\\\"logo.gif) no-repeat center center\\\";TiddlyWiki&&(d=TiddlyWiki.getModifiedCssImageStyle(d));b.style.background=d;d=\\\"<div style='cursor:pointer;font-size:1px;'><img src='\\\"+a.imageprefix+\\\"1x1.gif' border='0' width='18' height='18'></div>\\\";if(TiddlyWiki)for(var f=/['][.]?[/]?images\\\\/(.+?)[']/g,g;g=f.exec(d);){var l=TiddlyWiki.getModifiedImgSrc(g[0].replace(/\\\\'/g,\\\"\\\"));l&&(d=d.replace(g[0],'\\\"'+l+'\\\"'))}b.innerHTML=d;c.appendChild(b);a.logo=b;e(a,a.logo,\\n\\\"logo\\\");SocialCalc.TooltipRegister(b.firstChild.firstChild,\\\"SocialCalc\\\",null,a.toplevel);a.toplevel.appendChild(a.layouttable);a.noEdit||(a.inputEcho=new SocialCalc.InputEcho(a),e(a,a.inputEcho.main,\\\"inputecho\\\"));a.cellhandles=new SocialCalc.CellHandles(a);c=document.createElement(\\\"textarea\\\");SocialCalc.setStyles(c,\\\"display:none;position:absolute;height:1px;width:1px;opacity:0;filter:alpha(opacity=0);\\\");c.value=\\\"\\\";a.pasteTextarea=c;e(a,a.pasteTextarea,\\\"pastetextarea\\\");navigator.userAgent.match(/Safari\\\\//)&&\\n!navigator.userAgent.match(/Chrome\\\\//)&&(window.removeEventListener(\\\"beforepaste\\\",SocialCalc.SafariPasteFunction,!1),window.addEventListener(\\\"beforepaste\\\",SocialCalc.SafariPasteFunction,!1),window.removeEventListener(\\\"beforecopy\\\",SocialCalc.SafariPasteFunction,!1),window.addEventListener(\\\"beforecopy\\\",SocialCalc.SafariPasteFunction,!1),window.removeEventListener(\\\"beforecut\\\",SocialCalc.SafariPasteFunction,!1),window.addEventListener(\\\"beforecut\\\",SocialCalc.SafariPasteFunction,!1));a.toplevel.appendChild(a.pasteTextarea);\\nSocialCalc.MouseWheelRegister(a.toplevel,{WheelMove:SocialCalc.EditorProcessMouseWheel,editor:a});SocialCalc.KeyboardSetFocus(a);SocialCalc.EditorSheetStatusCallback(null,\\\"startup\\\",null,a);return a.toplevel};SocialCalc.SafariPasteFunction=function(a){a.preventDefault()};\\nSocialCalc.ResizeTableEditor=function(a,c,b){var d=SocialCalc.Constants;a.width=c;a.height=b;a.toplevel.style.width=c+\\\"px\\\";a.toplevel.style.height=b+\\\"px\\\";a.tablewidth=Math.max(0,c-d.defaultTableControlThickness);a.tableheight=Math.max(0,b-d.defaultTableControlThickness);a.griddiv.style.width=a.tablewidth+\\\"px\\\";a.griddiv.style.height=a.tableheight+\\\"px\\\";a.verticaltablecontrol.main.style.height=a.tableheight+\\\"px\\\";a.horizontaltablecontrol.main.style.width=a.tablewidth+\\\"px\\\";a.FitToEditTable();a.ScheduleRender()};\\nSocialCalc.SaveEditorSettings=function(a){var c,b,d=a.context,e=a.range,f;f=\\\"version:1.0\\\\n\\\";for(c=0;c<d.rowpanes.length;c++)f+=\\\"rowpane:\\\"+c+\\\":\\\"+d.rowpanes[c].first+\\\":\\\"+d.rowpanes[c].last+\\\"\\\\n\\\";for(c=0;c<d.colpanes.length;c++)f+=\\\"colpane:\\\"+c+\\\":\\\"+d.colpanes[c].first+\\\":\\\"+d.colpanes[c].last+\\\"\\\\n\\\";a.ecell&&(f+=\\\"ecell:\\\"+a.ecell.coord+\\\"\\\\n\\\");e.hasrange&&(f+=\\\"range:\\\"+e.anchorcoord+\\\":\\\"+e.top+\\\":\\\"+e.bottom+\\\":\\\"+e.left+\\\":\\\"+e.right+\\\"\\\\n\\\");for(b in a.SettingsCallbacks)f+=a.SettingsCallbacks[b].save(a,b);return f};\\nSocialCalc.LoadEditorSettings=function(a,c,b){c=c.split(/\\\\r\\\\n|\\\\n/);var d=[],e,f,g,l=a.context,h,m;l.rowpanes=[{first:1,last:1}];l.colpanes=[{first:1,last:1}];a.ecell=null;a.range={hasrange:!1};a.range2={hasrange:!1};m=a.range;l.highlights={};h=l.highlights;for(f=0;f<c.length;f++)switch(e=c[f],d=e.split(\\\":\\\"),g=d[0],g){case \\\"version\\\":break;case \\\"rowpane\\\":l.rowpanes[d[1]-0]={first:d[2]-0,last:d[3]-0};break;case \\\"colpane\\\":l.colpanes[d[1]-0]={first:d[2]-0,last:d[3]-0};break;case \\\"ecell\\\":a.ecell=SocialCalc.coordToCr(d[1]);\\na.ecell.coord=d[1];h[d[1]]=\\\"cursor\\\";break;case \\\"range\\\":m.hasrange=!0;m.anchorcoord=d[1];e=SocialCalc.coordToCr(m.anchorcoord);m.anchorrow=e.row;m.anchorcol=e.col;m.top=d[2]-0;m.bottom=d[3]-0;m.left=d[4]-0;m.right=d[5]-0;for(d=m.top;d<=m.bottom;d++)for(e=m.left;e<=m.right;e++)g=SocialCalc.crToCoord(e,d),\\\"cursor\\\"!=h[g]&&(h[g]=\\\"range\\\");break;default:a.SettingsCallbacks[g]&&a.SettingsCallbacks[g].load(a,g,e,b)}};\\nSocialCalc.EditorRenderSheet=function(a){a.EditorMouseUnregister();a.fullgrid=a.context.RenderSheet(a.fullgrid);a.ecell&&a.SetECellHeaders(\\\"selected\\\");SocialCalc.AssignID(a,a.fullgrid,\\\"fullgrid\\\");a.EditorMouseRegister()};\\nSocialCalc.EditorScheduleSheetCommands=function(a,c,b,d){if(\\\"start\\\"==a.state||d)if(a.busy&&!d)a.deferredCommands.push({cmdstr:c,saveundo:b});else switch(c){case \\\"recalc\\\":case \\\"redisplay\\\":a.context.sheetobj.ScheduleSheetCommands(c,!1);break;case \\\"undo\\\":a.SheetUndo();break;case \\\"redo\\\":a.SheetRedo();break;default:a.context.sheetobj.ScheduleSheetCommands(c,b)}};\\nSocialCalc.EditorSheetStatusCallback=function(a,c,b,d){var e;a=d.context.sheetobj;var f=function(a){for(e in d.StatusCallback)d.StatusCallback[e].func&&d.StatusCallback[e].func(d,a,b,d.StatusCallback[e].params)};switch(c){case \\\"startup\\\":break;case \\\"cmdstart\\\":d.busy=!0;a.celldisplayneeded=\\\"\\\";break;case \\\"cmdextension\\\":break;case \\\"cmdend\\\":f(c);a.changedrendervalues&&(d.context.PrecomputeSheetFontsAndLayouts(),d.context.CalculateCellSkipData(),a.changedrendervalues=!1);a.celldisplayneeded&&!a.renderneeded&&\\n(cr=SocialCalc.coordToCr(a.celldisplayneeded),c=SocialCalc.GetEditorCellElement(d,cr.row,cr.col),d.ReplaceCell(c,cr.row,cr.col));if(d.deferredCommands.length){a=d.deferredCommands.shift();d.EditorScheduleSheetCommands(a.cmdstr,a.saveundo,!0);return}a.attribs.needsrecalc&&(\\\"off\\\"!=a.attribs.recalc||a.recalconce)&&d.recalcFunction?(d.FitToEditTable(),a.renderneeded=!1,a.recalconce&&delete a.recalconce,d.recalcFunction(d)):a.renderneeded?(d.FitToEditTable(),a.renderneeded=!1,d.ScheduleRender()):d.SchedulePositionCalculations();\\nif(\\\"col\\\"==a.hiddencolrow){for(c=d.ecell.col;\\\"yes\\\"==a.colattribs.hide[SocialCalc.rcColname(c)];)c++;c=SocialCalc.crToCoord(c,d.ecell.row);d.MoveECell(c);a.hiddencolrow=\\\"\\\"}if(\\\"row\\\"==a.hiddencolrow){for(c=d.ecell.row;\\\"yes\\\"==a.rowattribs.hide[c];)c++;c=SocialCalc.crToCoord(d.ecell.col,c);d.MoveECell(c);a.hiddencolrow=\\\"\\\"}return;case \\\"calcstart\\\":d.busy=!0;break;case \\\"calccheckdone\\\":case \\\"calcorder\\\":case \\\"calcstep\\\":case \\\"calcloading\\\":case \\\"calcserverfunc\\\":break;case \\\"calcfinished\\\":f(c);d.ScheduleRender();\\nreturn;case \\\"schedrender\\\":d.busy=!0;break;case \\\"renderdone\\\":break;case \\\"schedposcalc\\\":d.busy=!0;break;case \\\"doneposcalc\\\":d.deferredCommands.length?(f(c),a=d.deferredCommands.shift(),d.EditorScheduleSheetCommands(a.cmdstr,a.saveundo,!0)):(d.busy=!1,f(c),\\\"start\\\"==d.state&&d.DisplayCellContents());return;default:addmsg(\\\"Unknown status: \\\"+c)}f(c)};\\nSocialCalc.EditorGetStatuslineString=function(a,c,b,d){var e=SocialCalc.Constants,f,g,l;f=\\\"\\\";switch(c){case \\\"moveecell\\\":case \\\"rangechange\\\":case \\\"startup\\\":break;case \\\"cmdstart\\\":d.command=!0;document.body.style.cursor=\\\"progress\\\";a.griddiv.style.cursor=\\\"progress\\\";f=e.s_statusline_executing;break;case \\\"cmdextension\\\":f=\\\"Command Extension: \\\"+b;break;case \\\"cmdend\\\":d.command=!1;break;case \\\"schedrender\\\":f=e.s_statusline_displaying;break;case \\\"renderdone\\\":f=\\\" \\\";break;case \\\"schedposcalc\\\":f=e.s_statusline_displaying;\\nbreak;case \\\"cmdendnorender\\\":case \\\"doneposcalc\\\":document.body.style.cursor=\\\"default\\\";a.griddiv.style.cursor=\\\"default\\\";break;case \\\"calcorder\\\":f=e.s_statusline_ordering+Math.floor(100*b.count/(b.total||1))+\\\"%\\\";break;case \\\"calcstep\\\":f=e.s_statusline_calculating+Math.floor(100*b.count/(b.total||1))+\\\"%\\\";break;case \\\"calcloading\\\":f=e.s_statusline_calculatingls+\\\": \\\"+b.sheetname;break;case \\\"calcserverfunc\\\":f=e.s_statusline_calculating+Math.floor(100*b.count/(b.total||1))+\\\"%, \\\"+e.s_statusline_doingserverfunc+\\nb.funcname+e.s_statusline_incell+b.coord;break;case \\\"calcstart\\\":d.calculating=!0;document.body.style.cursor=\\\"progress\\\";a.griddiv.style.cursor=\\\"progress\\\";f=e.s_statusline_calcstart;break;case \\\"calccheckdone\\\":break;case \\\"calcfinished\\\":d.calculating=!1;break;default:f=c}!f&&d.calculating&&(f=e.s_statusline_calculating);if(!(d.calculating||d.command||f||!a.range.hasrange||a.range.left==a.range.right&&a.range.top==a.range.bottom)){c=0;for(b=a.range.top;b<=a.range.bottom;b++)for(g=a.range.left;g<=a.range.right;g++)(l=\\na.context.sheetobj.cells[SocialCalc.crToCoord(g,b)])&&l.valuetype&&\\\"n\\\"==l.valuetype.charAt(0)&&(c+=l.datavalue-0);c=SocialCalc.FormatNumber.formatNumberWithFormat(c,\\\"[,]General\\\",\\\"\\\");b=SocialCalc.crToCoord(a.range.left,a.range.top)+\\\":\\\"+SocialCalc.crToCoord(a.range.right,a.range.bottom);f=b+\\\" (\\\"+(a.range.right-a.range.left+1)+\\\"x\\\"+(a.range.bottom-a.range.top+1)+\\\") \\\"+e.s_statusline_sum+\\\"=\\\"+c+\\\" \\\"+f}f=a.ecell.coord+\\\" &nbsp; \\\"+f;d.calculating||\\\"yes\\\"!=a.context.sheetobj.attribs.needsrecalc||(f+=\\\" &nbsp; \\\"+\\ne.s_statusline_recalcneeded);if(a=a.context.sheetobj.attribs.circularreferencecell)a=a.replace(/\\\\|/,\\\" referenced by \\\"),f+=\\\" &nbsp; \\\"+e.s_statusline_circref+a+\\\"</span>\\\";return f};SocialCalc.EditorMouseInfo={registeredElements:[],editor:null,element:null,ignore:!1,mousedowncoord:\\\"\\\",mouselastcoord:\\\"\\\",mouseresizecol:\\\"\\\",mouseresizeclientx:null,mouseresizedisplay:null};\\nSocialCalc.EditorMouseRegister=function(a){var c=SocialCalc.EditorMouseInfo,b=a.fullgrid,d;for(d=0;d<c.registeredElements.length;d++)if(c.registeredElements[d].editor==a){if(c.registeredElements[d].element==b)return;break}d<c.registeredElements.length?c.registeredElements[d].element=b:c.registeredElements.push({element:b,editor:a});if(b.addEventListener)b.addEventListener(\\\"mousedown\\\",SocialCalc.ProcessEditorMouseDown,!1),b.addEventListener(\\\"dblclick\\\",SocialCalc.ProcessEditorDblClick,!1);else if(b.attachEvent)b.attachEvent(\\\"onmousedown\\\",\\nSocialCalc.ProcessEditorMouseDown),b.attachEvent(\\\"ondblclick\\\",SocialCalc.ProcessEditorDblClick);else throw\\\"Browser not supported\\\";c.ignore=!1};\\nSocialCalc.EditorMouseUnregister=function(a){var c=SocialCalc.EditorMouseInfo,b;for(b=0;b<c.registeredElements.length&&c.registeredElements[b].editor!=a;b++);b<c.registeredElements.length&&(a=c.registeredElements[b].element,a.removeEventListener?(a.removeEventListener(\\\"mousedown\\\",SocialCalc.ProcessEditorMouseDown,!1),a.removeEventListener(\\\"dblclick\\\",SocialCalc.ProcessEditorDblClick,!1)):a.detachEvent&&(a.detachEvent(\\\"onmousedown\\\",SocialCalc.ProcessEditorMouseDown),a.detachEvent(\\\"ondblclick\\\",SocialCalc.ProcessEditorDblClick)),\\nc.registeredElements.splice(b,1))};\\nSocialCalc.ProcessEditorMouseDown=function(a){var c,b,d,e=a||window.event,f=SocialCalc.EditorMouseInfo,g=e.target||e.srcElement;if(!f.ignore){for(c=null;!c&&g;g=g.parentNode)c=SocialCalc.LookupElement(g,f.registeredElements);if(c){if(c=c.editor,f.element=g,d=c.range,b=SocialCalc.GetElementPositionWithScroll(c.toplevel),b=SocialCalc.GridMousePosition(c,e.clientX-b.left,e.clientY-b.top))f.editor=c,b.rowheader&&b.rowtounhide?SocialCalc.ProcessEditorRowsizeMouseDown(a,g,b):b.colheader&&b.coltoresize?\\nSocialCalc.ProcessEditorColsizeMouseDown(a,g,b):b.coord&&(d.hasrange||a.shiftKey&&c.RangeAnchor(),b=c.MoveECell(b.coord),d.hasrange&&(a.shiftKey?c.RangeExtend():c.RangeRemove()),f.mousedowncoord=b,f.mouselastcoord=b,c.EditorMouseRange(b),SocialCalc.KeyboardSetFocus(c),\\\"start\\\"!=c.state&&c.inputBox&&c.inputBox.element.focus(),TiddlyWiki&&(a=SocialCalc.GetSpreadsheetControlObject(),a.inputView&&a.inputView.focus()),document.addEventListener?(document.addEventListener(\\\"mousemove\\\",SocialCalc.ProcessEditorMouseMove,\\n!0),document.addEventListener(\\\"mouseup\\\",SocialCalc.ProcessEditorMouseUp,!0)):g.attachEvent&&(g.setCapture(),g.attachEvent(\\\"onmousemove\\\",SocialCalc.ProcessEditorMouseMove),g.attachEvent(\\\"onmouseup\\\",SocialCalc.ProcessEditorMouseUp),g.attachEvent(\\\"onlosecapture\\\",SocialCalc.ProcessEditorMouseUp)),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1)}else f.editor=null}};\\nSocialCalc.EditorMouseRange=function(a,c){var b,d,e=a.range;switch(a.state){case \\\"input\\\":b=a.inputBox.GetText();d=a.workingvalues;if(0<=\\\"(+-*/,:!&<>=^\\\".indexOf(b.slice(-1))&&\\\"=\\\"==b.slice(0,1)||\\\"=\\\"==b)d.partialexpr=b;d.partialexpr?c&&(e.hasrange?a.inputBox.SetText(d.partialexpr+SocialCalc.crToCoord(e.left,e.top)+\\\":\\\"+SocialCalc.crToCoord(e.right,e.bottom)):a.inputBox.SetText(d.partialexpr+c)):(a.inputBox.Blur(),a.inputBox.ShowInputBox(!1),a.state=\\\"start\\\",a.cellhandles.ShowCellHandles(!0),a.EditorSaveEdit(),\\na.inputBox.DisplayCellContents(null));break;case \\\"inputboxdirect\\\":a.inputBox.Blur(),a.inputBox.ShowInputBox(!1),a.state=\\\"start\\\",a.cellhandles.ShowCellHandles(!0),a.EditorSaveEdit(),a.inputBox.DisplayCellContents(null)}};\\nSocialCalc.ProcessEditorMouseMove=function(a){var c,b,d=a||window.event,e=SocialCalc.EditorMouseInfo;(c=e.editor)&&!e.ignore&&(b=SocialCalc.GetElementPositionWithScroll(c.toplevel),b=SocialCalc.GridMousePosition(c,d.clientX-b.left,d.clientY-b.top))&&(b&&!b.coord?SocialCalc.SetDragAutoRepeat(c,b):(SocialCalc.SetDragAutoRepeat(c,null),b.coord&&(b.coord!=e.mouselastcoord&&(a.shiftKey||c.range.hasrange||c.RangeAnchor(e.mousedowncoord),c.MoveECell(b.coord),c.RangeExtend()),e.mouselastcoord=b.coord,c.EditorMouseRange(b.coord),\\nd.stopPropagation?d.stopPropagation():d.cancelBubble=!0,d.preventDefault?d.preventDefault():d.returnValue=!1)))};\\nSocialCalc.ProcessEditorMouseUp=function(a){var c,b,d=a||window.event,e=SocialCalc.EditorMouseInfo;if((a=e.editor)&&!e.ignore&&(c=e.element,b=SocialCalc.GetElementPositionWithScroll(a.toplevel),b=SocialCalc.GridMousePosition(a,d.clientX-b.left,d.clientY-b.top),SocialCalc.SetDragAutoRepeat(a,null),b))return b.coord||(b.coord=a.ecell.coord),a.range.hasrange?(a.MoveECell(b.coord),a.RangeExtend()):b.coord&&b.coord!=e.mousedowncoord&&(a.RangeAnchor(e.mousedowncoord),a.MoveECell(b.coord),a.RangeExtend()),\\na.EditorMouseRange(b.coord),d.stopPropagation?d.stopPropagation():d.cancelBubble=!0,d.preventDefault?d.preventDefault():d.returnValue=!1,document.removeEventListener?(document.removeEventListener(\\\"mousemove\\\",SocialCalc.ProcessEditorMouseMove,!0),document.removeEventListener(\\\"mouseup\\\",SocialCalc.ProcessEditorMouseUp,!0)):c.detachEvent&&(c.detachEvent(\\\"onlosecapture\\\",SocialCalc.ProcessEditorMouseUp),c.detachEvent(\\\"onmouseup\\\",SocialCalc.ProcessEditorMouseUp),c.detachEvent(\\\"onmousemove\\\",SocialCalc.ProcessEditorMouseMove),\\nc.releaseCapture()),e.editor=null,!1};\\nSocialCalc.ProcessEditorColsizeMouseDown=function(a,c,b){a=a||window.event;c=SocialCalc.EditorMouseInfo;var d=c.editor,e=SocialCalc.GetElementPositionWithScroll(d.toplevel),e=a.clientX-e.left;c.mouseresizecolnum=b.coltoresize;c.mouseresizecol=SocialCalc.rcColname(b.coltoresize);c.mousedownclientx=e;c.mousecoltounhide=b.coltounhide;c.mousecoltounhide||(e=document.createElement(\\\"div\\\"),c.mouseresizedisplay=e,e.style.width=\\\"auto\\\",e.style.position=\\\"absolute\\\",e.style.zIndex=100,e.style.top=d.headposition.top+\\n\\\"px\\\",e.style.left=d.colpositions[b.coltoresize]+\\\"px\\\",e.innerHTML='<table cellpadding=\\\"0\\\" cellspacing=\\\"0\\\"><tr><td style=\\\"height:100px;border:1px dashed black;background-color:white;width:'+(d.context.colwidth[c.mouseresizecolnum]-2)+'px;\\\">&nbsp;</td><td><div style=\\\"font-size:small;color:white;background-color:gray;padding:4px;\\\">'+d.context.colwidth[c.mouseresizecolnum]+\\\"</div></td></tr></table>\\\",SocialCalc.setStyles(e.firstChild.lastChild.firstChild.childNodes[0],\\\"filter:alpha(opacity=85);opacity:.85;\\\"),\\nd.toplevel.appendChild(e));document.addEventListener?(document.addEventListener(\\\"mousemove\\\",SocialCalc.ProcessEditorColsizeMouseMove,!0),document.addEventListener(\\\"mouseup\\\",SocialCalc.ProcessEditorColsizeMouseUp,!0)):d.toplevel.attachEvent&&(d.toplevel.setCapture(),d.toplevel.attachEvent(\\\"onmousemove\\\",SocialCalc.ProcessEditorColsizeMouseMove),d.toplevel.attachEvent(\\\"onmouseup\\\",SocialCalc.ProcessEditorColsizeMouseUp),d.toplevel.attachEvent(\\\"onlosecapture\\\",SocialCalc.ProcessEditorColsizeMouseUp));a.stopPropagation?\\na.stopPropagation():a.cancelBubble=!0;a.preventDefault?a.preventDefault():a.returnValue=!1};\\nSocialCalc.ProcessEditorColsizeMouseMove=function(a){a=a||window.event;var c=SocialCalc.EditorMouseInfo,b=c.editor;if(b){if(!c.mousecoltounhide){var d=SocialCalc.GetElementPositionWithScroll(b.toplevel),b=b.context.colwidth[c.mouseresizecolnum]-0+(a.clientX-d.left-c.mousedownclientx);b<SocialCalc.Constants.defaultMinimumColWidth&&(b=SocialCalc.Constants.defaultMinimumColWidth);c=c.mouseresizedisplay;c.innerHTML='<table cellpadding=\\\"0\\\" cellspacing=\\\"0\\\"><tr><td style=\\\"height:100px;border:1px dashed black;background-color:white;width:'+\\n(b-2)+'px;\\\">&nbsp;</td><td><div style=\\\"font-size:small;color:white;background-color:gray;padding:4px;\\\">'+b+\\\"</div></td></tr></table>\\\";SocialCalc.setStyles(c.firstChild.lastChild.firstChild.childNodes[0],\\\"filter:alpha(opacity=85);opacity:.85;\\\")}a.stopPropagation?a.stopPropagation():a.cancelBubble=!0;a.preventDefault?a.preventDefault():a.returnValue=!1}};\\nSocialCalc.ProcessEditorColsizeMouseUp=function(a){var c=a||window.event;a=SocialCalc.EditorMouseInfo;var b=a.editor;if(b){element=a.element;var d=SocialCalc.GetElementPositionWithScroll(b.toplevel),d=c.clientX-d.left;c.stopPropagation?c.stopPropagation():c.cancelBubble=!0;c.preventDefault?c.preventDefault():c.returnValue=!1;document.removeEventListener?(document.removeEventListener(\\\"mousemove\\\",SocialCalc.ProcessEditorColsizeMouseMove,!0),document.removeEventListener(\\\"mouseup\\\",SocialCalc.ProcessEditorColsizeMouseUp,\\n!0)):b.toplevel.detachEvent&&(b.toplevel.detachEvent(\\\"onlosecapture\\\",SocialCalc.ProcessEditorColsizeMouseUp),b.toplevel.detachEvent(\\\"onmouseup\\\",SocialCalc.ProcessEditorColsizeMouseUp),b.toplevel.detachEvent(\\\"onmousemove\\\",SocialCalc.ProcessEditorColsizeMouseMove),b.toplevel.releaseCapture());a.mousecoltounhide?b.EditorScheduleSheetCommands(\\\"set \\\"+SocialCalc.rcColname(a.mousecoltounhide)+\\\" hide\\\",!0,!1):(c=b.context.colwidth[a.mouseresizecolnum]-0+(d-a.mousedownclientx),c<SocialCalc.Constants.defaultMinimumColWidth&&\\n(c=SocialCalc.Constants.defaultMinimumColWidth),b.EditorScheduleSheetCommands(\\\"set \\\"+a.mouseresizecol+\\\" width \\\"+c,!0,!1),b.timeout&&window.clearTimeout(b.timeout),b.timeout=window.setTimeout(SocialCalc.FinishColsize,1));return!1}};SocialCalc.FinishColsize=function(){var a=SocialCalc.EditorMouseInfo,c=a.editor;c&&(c.toplevel.removeChild(a.mouseresizedisplay),a.mouseresizedisplay=null,a.editor=null)};\\nSocialCalc.ProcessEditorRowsizeMouseDown=function(a,c,b){a=a||window.event;c=SocialCalc.EditorMouseInfo;var d=c.editor;SocialCalc.GetElementPositionWithScroll(d.toplevel);c.mouserowtounhide=b.rowtounhide;document.addEventListener?(document.addEventListener(\\\"mousemove\\\",SocialCalc.ProcessEditorRowsizeMouseMove,!0),document.addEventListener(\\\"mouseup\\\",SocialCalc.ProcessEditorRowsizeMouseUp,!0)):d.toplevel.attachEvent&&(d.toplevel.setCapture(),d.toplevel.attachEvent(\\\"onmousemove\\\",SocialCalc.ProcessEditorRowsizeMouseMove),\\nd.toplevel.attachEvent(\\\"onmouseup\\\",SocialCalc.ProcessEditorRowsizeMouseUp),d.toplevel.attachEvent(\\\"onlosecapture\\\",SocialCalc.ProcessEditorRowsizeMouseUp));a.stopPropagation?a.stopPropagation():a.cancelBubble=!0;a.preventDefault?a.preventDefault():a.returnValue=!1};SocialCalc.ProcessEditorRowsizeMouseMove=function(a){a=a||window.event;SocialCalc.EditorMouseInfo.editor&&(a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,a.preventDefault?a.preventDefault():a.returnValue=!1)};\\nSocialCalc.ProcessEditorRowsizeMouseUp=function(a){a=a||window.event;var c=SocialCalc.EditorMouseInfo,b=c.editor;if(b)return element=c.element,SocialCalc.GetElementPositionWithScroll(b.toplevel),a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,a.preventDefault?a.preventDefault():a.returnValue=!1,document.removeEventListener?(document.removeEventListener(\\\"mousemove\\\",SocialCalc.ProcessEditorRowsizeMouseMove,!0),document.removeEventListener(\\\"mouseup\\\",SocialCalc.ProcessEditorRowsizeMouseUp,!0)):\\nb.toplevel.detachEvent&&(b.toplevel.detachEvent(\\\"onlosecapture\\\",SocialCalc.ProcessEditorRowsizeMouseUp),b.toplevel.detachEvent(\\\"onmouseup\\\",SocialCalc.ProcessEditorRowsizeMouseUp),b.toplevel.detachEvent(\\\"onmousemove\\\",SocialCalc.ProcessEditorRowsizeMouseMove),b.toplevel.releaseCapture()),c.mouserowtounhide&&b.EditorScheduleSheetCommands(\\\"set \\\"+c.mouserowtounhide+\\\" hide\\\",!0,!1),!1};SocialCalc.AutoRepeatInfo={timer:null,mouseinfo:null,repeatinterval:1E3,editor:null,repeatcallback:null};\\nSocialCalc.SetDragAutoRepeat=function(a,c,b){var d=SocialCalc.AutoRepeatInfo;d.repeatcallback=b;if(c){d.editor=a;d.mouseinfo&&(c.rowheader||c.rowfooter?c.row!=d.mouseinfo.row&&(b=SocialCalc.crToCoord(a.ecell.col,c.row),d.repeatcallback?(a=c.row<d.mouseinfo.row?\\\"left\\\":c.row>d.mouseinfo.row?\\\"right\\\":\\\"\\\",d.repeatcallback(b,a)):(a.MoveECell(b),a.MoveECell(b),a.RangeExtend(),a.EditorMouseRange(b))):(c.colheader||c.colfooter)&&c.col!=d.mouseinfo.col&&(b=SocialCalc.crToCoord(c.col,a.ecell.row),d.repeatcallback?\\n(a=c.row<d.mouseinfo.row?\\\"left\\\":c.row>d.mouseinfo.row?\\\"right\\\":\\\"\\\",d.repeatcallback(b,a)):(a.MoveECell(b),a.RangeExtend(),a.EditorMouseRange(b))));d.mouseinfo=c;if(5>c.distance)d.repeatinterval=333;else if(10>c.distance)d.repeatinterval=250;else if(25>c.distance)d.repeatinterval=100;else if(35>c.distance)d.repeatinterval=75;else{d.timer&&(window.clearTimeout(d.timer),d.timer=null);return}d.timer||(d.timer=window.setTimeout(SocialCalc.DragAutoRepeat,d.repeatinterval))}else d.timer&&(window.clearTimeout(d.timer),\\nd.timer=null),d.mouseinfo=null};\\nSocialCalc.DragAutoRepeat=function(){var a=SocialCalc.AutoRepeatInfo,c=a.mouseinfo,b;c.rowheader?b=\\\"left\\\":c.rowfooter?b=\\\"right\\\":c.colheader?b=\\\"up\\\":c.colfooter&&(b=\\\"down\\\");a.repeatcallback?(c=SocialCalc.coordToCr(a.editor.ecell.coord),\\\"left\\\"==b&&1<c.col?c.col--:\\\"right\\\"==b?c.col++:\\\"up\\\"==b&&1<c.row?c.row--:\\\"down\\\"==b&&c.row++,c=SocialCalc.crToCoord(c.col,c.row),a.repeatcallback(c,b)):(c=a.editor.MoveECellWithKey(\\\"[a\\\"+b+\\\"]shifted\\\"))&&a.editor.EditorMouseRange(c);a.timer=window.setTimeout(SocialCalc.DragAutoRepeat,\\na.repeatinterval)};\\nSocialCalc.ProcessEditorDblClick=function(a){var c,b;a=a||window.event;var d=SocialCalc.EditorMouseInfo,e=a.target||a.srcElement;if(!d.ignore){for(c=null;!c&&e;e=e.parentNode)c=SocialCalc.LookupElement(e,d.registeredElements);if(c){if(c=c.editor,b=SocialCalc.GetElementPositionWithScroll(c.toplevel),(b=SocialCalc.GridMousePosition(c,a.clientX-b.left,a.clientY-b.top))&&b.coord){d.editor=c;d.element=e;sheetobj=c.context.sheetobj;switch(c.state){case \\\"start\\\":SocialCalc.EditorOpenCellEdit(c)}a.stopPropagation?a.stopPropagation():\\na.cancelBubble=!0;a.preventDefault?a.preventDefault():a.returnValue=!1}}else d.editor=null}};SocialCalc.EditorOpenCellEdit=function(a){var c;if(!a.ecell||!a.inputBox||a.inputBox.element.disabled)return!0;a.inputBox.ShowInputBox(!0);a.inputBox.Focus();a.state=\\\"inputboxdirect\\\";a.inputBox.SetText(\\\"\\\");a.inputBox.DisplayCellContents();a.inputBox.Select(\\\"end\\\");c=a.workingvalues;c.partialexpr=\\\"\\\";c.ecoord=a.ecell.coord;c.erow=a.ecell.row;c.ecol=a.ecell.col};\\nSocialCalc.EditorProcessKey=function(a,c,b){hack.log(\\\"editor.state = \\\"+a.state+\\\", ch = \\\"+c,hack.keyboard,\\\"SocialCalc.EditorProcessKey\\\");var d=SocialCalc.GetSpreadsheetControlObject();TiddlyWiki&&(d.tiddlyWiki.saveTodo.flagStart=!0);var e,f=a.workingvalues,g=a.range;\\\"string\\\"!=typeof c&&(c=\\\"\\\");switch(a.state){case \\\"start\\\":b.shiftKey&&\\\"[a\\\"==c.substr(0,2)&&(c+=\\\"shifted\\\");\\\"[enter]\\\"==c&&(c=\\\"[adown]\\\");\\\"[tab]\\\"==c&&(c=b.shiftKey?\\\"[aleft]\\\":\\\"[aright]\\\");if(\\\"[a\\\"==c.substr(0,2)||\\\"[pg\\\"==c.substr(0,3)||\\\"[home]\\\"==\\nc)return a=a.MoveECellWithKey(c),!a;if(TiddlyWiki&&d.tiddlyWiki.flagView)break;if(\\\"[del]\\\"==c||\\\"[backspace]\\\"==c){a.noEdit||a.ECellReadonly()||a.EditorApplySetCommandsToRange(\\\"empty\\\",\\\"\\\");break}if(\\\"[esc]\\\"==c){if(g.hasrange)for(e in a.RangeRemove(),a.MoveECell(g.anchorcoord),a.StatusCallback)a.StatusCallback[e].func(a,\\\"specialkey\\\",c,a.StatusCallback[e].params);break}if(\\\"[f2]\\\"==c){if(a.noEdit||a.ECellReadonly())return!0;SocialCalc.EditorOpenCellEdit(a);break}if(1<c.length&&\\\"[\\\"==c.substr(0,1)||0==c.length)return a.ctrlkeyFunction&&\\n0<c.length?a.ctrlkeyFunction(a,c):!0;if(!a.ecell||!a.inputBox||a.ECellReadonly())return!0;a.inputBox.element.disabled=!1;a.state=\\\"input\\\";a.inputBox.ShowInputBox(!0);a.inputBox.Focus();a.inputBox.SetText(c);a.inputBox.Select(\\\"end\\\");f.partialexpr=\\\"\\\";f.ecoord=a.ecell.coord;f.erow=a.ecell.row;f.ecol=a.ecell.col;a.RangeRemove();break;case \\\"input\\\":d=a.inputBox.GetText();if(a.inputBox.skipOne)break;if(\\\"[esc]\\\"==c||\\\"[enter]\\\"==c||\\\"[tab]\\\"==c||c&&\\\"[a\\\"==c.substr(0,2)){if(0<=\\\"(+-*/,:!&<>=^\\\".indexOf(d.slice(-1))&&\\n\\\"=\\\"==d.slice(0,1)||\\\"=\\\"==d)f.partialexpr=d;if(f.partialexpr&&(b.shiftKey&&\\\"[a\\\"==c.substr(0,2)&&(c+=\\\"shifted\\\"),d=a.MoveECellWithKey(c))){g.hasrange?a.inputBox.SetText(f.partialexpr+SocialCalc.crToCoord(g.left,g.top)+\\\":\\\"+SocialCalc.crToCoord(g.right,g.bottom)):a.inputBox.SetText(f.partialexpr+d);break}a.inputBox.Blur();a.inputBox.ShowInputBox(!1);a.state=\\\"start\\\";a.cellhandles.ShowCellHandles(!0);\\\"[esc]\\\"!=c?(a.EditorSaveEdit(),a.ecell.coord!=f.ecoord&&a.MoveECell(f.ecoord),\\\"[enter]\\\"==c&&(c=\\\"[adown]\\\"),\\n\\\"[tab]\\\"==c&&(c=b.shiftKey?\\\"[aleft]\\\":\\\"[aright]\\\"),\\\"[a\\\"==c.substr(0,2)&&a.MoveECellWithKey(c)):(a.inputBox.DisplayCellContents(),a.RangeRemove(),a.MoveECell(f.ecoord));break}if(f.partialexpr&&\\\"[backspace]\\\"==c){a.inputBox.SetText(f.partialexpr);f.partialexpr=\\\"\\\";a.RangeRemove();a.MoveECell(f.ecoord);a.inputBox.ShowInputBox(!0);break}if(\\\"[f2]\\\"==c)break;g.hasrange&&a.RangeRemove();a.MoveECell(f.ecoord);f.partialexpr&&(a.inputBox.ShowInputBox(!0),f.partialexpr=\\\"\\\");return!0;case \\\"inputboxdirect\\\":a.inputBox.GetText();\\nif(\\\"[esc]\\\"==c||\\\"[enter]\\\"==c||\\\"[tab]\\\"==c){a.inputBox.Blur();a.inputBox.ShowInputBox(!1);a.state=\\\"start\\\";a.cellhandles.ShowCellHandles(!0);\\\"[esc]\\\"==c?a.inputBox.DisplayCellContents():(a.EditorSaveEdit(),a.ecell.coord!=f.ecoord&&a.MoveECell(f.ecoord),\\\"[enter]\\\"==c&&(c=\\\"[adown]\\\"),\\\"[tab]\\\"==c&&(c=b.shiftKey?\\\"[aleft]\\\":\\\"[aright]\\\"),\\\"[a\\\"==c.substr(0,2)&&a.MoveECellWithKey(c));break}if(\\\"[f2]\\\"==c)break;return!0;case \\\"skip-and-start\\\":a.state=\\\"start\\\";a.cellhandles.ShowCellHandles(!0);break;default:return!0}return!1};\\nSocialCalc.EditorAddToInput=function(a,c,b){var d=a.workingvalues;if(!a.noEdit&&!a.ECellReadonly())switch(a.state){case \\\"start\\\":a.state=\\\"input\\\";a.inputBox.ShowInputBox(!0);a.inputBox.element.disabled=!1;a.inputBox.Focus();a.inputBox.SetText((b||\\\"\\\")+c);a.inputBox.Select(\\\"end\\\");d.partialexpr=\\\"\\\";d.ecoord=a.ecell.coord;d.erow=a.ecell.row;d.ecol=a.ecell.col;a.RangeRemove();break;case \\\"input\\\":case \\\"inputboxdirect\\\":a.inputBox.element.focus(),d.partialexpr&&(a.inputBox.SetText(d.partialexpr),d.partialexpr=\\n\\\"\\\",a.RangeRemove(),a.MoveECell(d.ecoord)),a.inputBox.SetText(a.inputBox.GetText()+c)}};SocialCalc.EditorDisplayCellContents=function(a){a.inputBox&&a.inputBox.DisplayCellContents()};\\nSocialCalc.EditorSaveEdit=function(a,c){var b,d,e;b=a.context.sheetobj;var f=a.workingvalues;e=\\\"string\\\"==typeof c?c:a.inputBox.GetText();b=SocialCalc.GetCellContents(b,f.ecoord)+\\\"\\\";e!=b&&(b=e.charAt(0),\\\"=\\\"==b&&-1==e.indexOf(\\\"\\\\n\\\")?(d=\\\"formula\\\",e=e.substring(1)):\\\"'\\\"==b?(d=\\\"text t\\\",e=e.substring(1),b=SocialCalc.DetermineValueType(e),\\\"t\\\"==b.type.charAt(0)&&(d=\\\"text \\\"+b.type)):0==e.length?d=\\\"empty\\\":(b=SocialCalc.DetermineValueType(e),d=\\\"n\\\"==b.type&&e==b.value+\\\"\\\"?\\\"value n\\\":\\\"t\\\"==b.type.charAt(0)?\\\"text \\\"+\\nb.type:\\\"\\\"==b.type?\\\"text t\\\":\\\"constant \\\"+b.type+\\\" \\\"+b.value),\\\"t\\\"==d.charAt(0)&&(e=SocialCalc.encodeForSave(e)),e=\\\"set \\\"+f.ecoord+\\\" \\\"+d+\\\" \\\"+e,a.EditorScheduleSheetCommands(e,!0,!1))};SocialCalc.EditorApplySetCommandsToRange=function(a,c){var b;b=a.ecell;var d=a.range;d.hasrange?(coord=SocialCalc.crToCoord(d.left,d.top)+\\\":\\\"+SocialCalc.crToCoord(d.right,d.bottom),b=\\\"set \\\"+coord+\\\" \\\"+c):b=\\\"set \\\"+b.coord+\\\" \\\"+c;a.EditorScheduleSheetCommands(b,!0,!1);a.DisplayCellContents()};\\nSocialCalc.EditorProcessMouseWheel=function(a,c,b,d){d.functionobj.editor.busy||(0<c&&d.functionobj.editor.ScrollRelative(!0,Math.floor(1.5*-c)),0>c&&d.functionobj.editor.ScrollRelative(!0,Math.ceil(1.5*-c)))};\\nSocialCalc.GridMousePosition=function(a,c,b){var d,e,f={};for(d=1;d<a.rowpositions.length&&!(a.rowheight[d]&&a.rowpositions[d]+a.rowheight[d]>b);d++);for(e=1;e<a.colpositions.length&&!(a.colwidth[e]&&a.colpositions[e]+a.colwidth[e]>c);e++);f.row=d;f.col=e;if(a.headposition){if(c<a.headposition.left&&c>=a.gridposition.left){f.rowheader=!0;f.distance=a.headposition.left-c;f.rowtounhide=\\\"\\\";if(unhide=a.context.rowunhidetop[d])pos=SocialCalc.GetElementPosition(unhide),c>=pos.left&&c<pos.left+unhide.offsetWidth&&\\nb>=pos.top&&b<pos.top+unhide.offsetHeight&&(f.rowtounhide=d+1);if(unhide=a.context.rowunhidebottom[d])pos=SocialCalc.GetElementPosition(unhide),c>=pos.left&&c<pos.left+unhide.offsetWidth&&b>=pos.top&&b<pos.top+unhide.offsetHeight&&(f.rowtounhide=d-1)}else if(b<a.headposition.top&&b>a.gridposition.top){f.colheader=!0;f.distance=a.headposition.top-b;f.coltoresize=e-(a.colpositions[e]+a.colwidth[e]/2>c?1:0)||1;if(unhide=a.context.colunhideleft[e])pos=SocialCalc.GetElementPosition(unhide),c>=pos.left&&\\nc<pos.left+unhide.offsetWidth&&b>=pos.top&&b<pos.top+unhide.offsetHeight&&(f.coltounhide=e+1);if(unhide=a.context.colunhideright[e])pos=SocialCalc.GetElementPosition(unhide),c>=pos.left&&c<pos.left+unhide.offsetWidth&&b>=pos.top&&b<pos.top+unhide.offsetHeight&&(f.coltounhide=e-1);for(c=0;c<a.context.colpanes.length;c++)if(f.coltoresize>=a.context.colpanes[c].first&&f.coltoresize<=a.context.colpanes[c].last)return f;delete f.coltoresize}else c>=a.verticaltablecontrol.controlborder?(f.rowfooter=!0,\\nf.distance=c-a.verticaltablecontrol.controlborder):b>=a.horizontaltablecontrol.controlborder?(f.colfooter=!0,f.distance=b-a.horizontaltablecontrol.controlborder):c<a.gridposition.left?(f.rowheader=!0,f.distance=a.headposition.left-c):b<=a.gridposition.top?(f.colheader=!0,f.distance=a.headposition.top-b):(f.coord=SocialCalc.crToCoord(f.col,f.row),a.context.cellskip[f.coord]&&(f.coord=a.context.cellskip[f.coord]));return f}return null};\\nSocialCalc.GetEditorCellElement=function(a,c,b){var d,e,f,g,l=0,h=0;for(d=0;d<a.context.rowpanes.length;d++){if(c>=a.context.rowpanes[d].first&&c<=a.context.rowpanes[d].last)for(e=0;e<a.context.colpanes.length;e++){if(b>=a.context.colpanes[e].first&&b<=a.context.colpanes[e].last){l+=c-a.context.rowpanes[d].first+2;for(f=a.context.colpanes[e].first;f<=b;f++)(g=a.context.cellskip[SocialCalc.crToCoord(f,c)])&&a.context.CoordInPane(g,d,e)||h++;return{element:a.griddiv.firstChild.lastChild.childNodes[l].childNodes[h],\\nrowpane:d,colpane:e}}for(f=a.context.colpanes[e].first;f<=a.context.colpanes[e].last;f++)(g=a.context.cellskip[SocialCalc.crToCoord(f,c)])&&a.context.CoordInPane(g,d,e)||h++;h+=1}l+=a.context.rowpanes[d].last-a.context.rowpanes[d].first+2}return null};\\nSocialCalc.MoveECellWithKey=function(a,c){var b,d,e,f=!1,g=1;if(!a.ecell)return null;\\\"shifted\\\"==c.slice(-7)&&(c=c.slice(0,-7),f=!0);b=a.ecell.row;d=a.ecell.col;e=a.context.sheetobj.cells[a.ecell.coord];switch(c){case \\\"[adown]\\\":b+=e&&e.rowspan||1;break;case \\\"[aup]\\\":b--;g=-1;break;case \\\"[pgdn]\\\":b+=a.pageUpDnAmount-1+(e&&e.rowspan||1);break;case \\\"[pgup]\\\":b-=a.pageUpDnAmount;g=-1;break;case \\\"[aright]\\\":d+=e&&e.colspan||1;break;case \\\"[aleft]\\\":d--;g=-1;break;case \\\"[home]\\\":d=b=1;break;default:return null}a.context.sheetobj.attribs.usermaxcol&&\\n(d=Math.min(a.context.sheetobj.attribs.usermaxcol,d));for(a.context.sheetobj.attribs.usermaxrow&&(b=Math.min(a.context.sheetobj.attribs.usermaxrow,b));\\\"yes\\\"==a.context.sheetobj.colattribs.hide[SocialCalc.rcColname(d)];)d+=g,1>d&&(g=-g,d=1);for(;\\\"yes\\\"==a.context.sheetobj.rowattribs.hide[b];)b+=g,1>b&&(g=-g,b=1);a.range.hasrange||f&&a.RangeAnchor();b=a.MoveECell(SocialCalc.crToCoord(d,b));a.range.hasrange&&(f?a.RangeExtend():a.RangeRemove());return b};\\nSocialCalc.MoveECell=function(a,c){var b,d,e=a.context.highlights;b=SocialCalc.coordToCr(c);a.context.sheetobj.attribs.usermaxcol&&b.col>a.context.sheetobj.attribs.usermaxcol&&(b.col=a.context.sheetobj.attribs.usermaxcol);a.context.sheetobj.attribs.usermaxrow&&b.row>a.context.sheetobj.attribs.usermaxrow&&(b.row=a.context.sheetobj.attribs.usermaxrow);c=SocialCalc.crToCoord(b.col,b.row);if(a.ecell){if(a.ecell.coord==c)return c;b=SocialCalc.GetEditorCellElement(a,a.ecell.row,a.ecell.col);delete e[a.ecell.coord];\\na.range2.hasrange&&a.ecell.row>=a.range2.top&&a.ecell.row<=a.range2.bottom&&a.ecell.col>=a.range2.left&&a.ecell.col<=a.range2.right&&(e[a.ecell.coord]=\\\"range2\\\");a.UpdateCellCSS(b,a.ecell.row,a.ecell.col);a.SetECellHeaders(\\\"\\\");a.cellhandles.ShowCellHandles(!1)}c=a.context.cellskip[c]||c;a.ecell=SocialCalc.coordToCr(c);a.ecell.coord=c;b=SocialCalc.GetEditorCellElement(a,a.ecell.row,a.ecell.col);e[c]=\\\"cursor\\\";for(d in a.MoveECellCallback)a.MoveECellCallback[d](a);a.UpdateCellCSS(b,a.ecell.row,a.ecell.col);\\na.SetECellHeaders(\\\"selected\\\");for(d in a.StatusCallback)a.StatusCallback[d].func(a,\\\"moveecell\\\",c,a.StatusCallback[d].params);a.busy?a.ensureecell=!0:(a.ensureecell=!1,a.EnsureECellVisible());return c};\\nSocialCalc.EnsureECellVisible=function(a){var c=0,b=0;a.ecell.row>a.lastnonscrollingrow&&(a.ecell.row<a.firstscrollingrow?c=a.ecell.row-a.firstscrollingrow:a.ecell.row>a.lastvisiblerow&&(c=a.ecell.row-a.lastvisiblerow));a.ecell.col>a.lastnonscrollingcol&&(a.ecell.col<a.firstscrollingcol?b=a.ecell.col-a.firstscrollingcol:a.ecell.col>a.lastvisiblecol&&(b=a.ecell.col-a.lastvisiblecol));0!=c||0!=b?a.ScrollRelativeBoth(c,b):a.cellhandles.ShowCellHandles(!0)};\\nSocialCalc.ReplaceCell=function(a,c,b,d){var e;if(c&&(a=a.context.RenderCell(b,d,c.rowpane,c.colpane,!0,null)))for(e in c.element.innerHTML=a.innerHTML,c.element.style.cssText=\\\"\\\",c.element.className=a.className,a.style)\\\"cssText\\\"!=a.style[e]&&(c.element.style[e]=a.style[e])};\\nSocialCalc.UpdateCellCSS=function(a,c,b,d){var e;if(c&&(a=a.context.RenderCell(b,d,c.rowpane,c.colpane,!0,null)))for(e in c.element.style.cssText=\\\"\\\",c.element.className=a.className,a.style)\\\"cssText\\\"!=a.style[e]&&(c.element.style[e]=a.style[e])};\\nSocialCalc.SetECellHeaders=function(a,c){var b=a.ecell,d=a.context,e,f,g,l=0,h=0,m;if(b){for(;\\\"yes\\\"==d.sheetobj.colattribs.hide[SocialCalc.rcColname(b.col)];)b.col++;for(;\\\"yes\\\"==d.sheetobj.rowattribs.hide[b.row];)b.row++;b.coord=SocialCalc.crToCoord(b.col,b.row);for(e=0;e<d.rowpanes.length;e++)f=d.rowpanes[e].first,g=d.rowpanes[e].last,b.row>=f&&b.row<=g&&(m=a.fullgrid.childNodes[1].childNodes[2+l+b.row-f].childNodes[0])&&(d.classnames&&(m.className=d.classnames[c+\\\"rowname\\\"]),d.explicitStyles&&(m.style.cssText=\\nd.explicitStyles[c+\\\"rowname\\\"]),m.style.verticalAlign=\\\"top\\\"),l+=g-f+2;for(e=0;e<d.colpanes.length;e++)f=d.colpanes[e].first,g=d.colpanes[e].last,b.col>=f&&b.col<=g&&(m=a.fullgrid.childNodes[1].childNodes[1].childNodes[1+h+b.col-f])&&(d.classnames&&(m.className=d.classnames[c+\\\"colname\\\"]),d.explicitStyles&&(m.style.cssText=d.explicitStyles[c+\\\"colname\\\"])),h+=g-f+2}};SocialCalc.ECellReadonly=function(a,c){!c&&a.ecell&&(c=a.ecell.coord);if(!c)return!1;var b=a.context.sheetobj.cells[c];return b&&b.readonly};\\nSocialCalc.RangeAnchor=function(a,c){a.range.hasrange&&a.RangeRemove();a.RangeExtend(c)};\\nSocialCalc.RangeExtend=function(a,c){var b,d,e,f,g,l,h=a.context.highlights;b=a.range;d=a.range2;c?(f=SocialCalc.coordToCr(c),f.coord=c):f=a.ecell;if(f){b.hasrange||(b.anchorcoord=f.coord,b.anchorrow=f.row,b.top=f.row,b.bottom=f.row,b.anchorcol=f.col,b.left=f.col,b.right=f.col,b.hasrange=!0);b.anchorrow<f.row?(b.top=b.anchorrow,b.bottom=f.row):(b.top=f.row,b.bottom=b.anchorrow);b.anchorcol<f.col?(b.left=b.anchorcol,b.right=f.col):(b.left=f.col,b.right=b.anchorcol);for(e in h)switch(h[e]){case \\\"range\\\":h[e]=\\n\\\"unrange\\\";break;case \\\"range2\\\":h[e]=\\\"unrange2\\\"}for(f=b.top;f<=b.bottom;f++)for(g=b.left;g<=b.right;g++)switch(e=SocialCalc.crToCoord(g,f),h[e]){case \\\"unrange\\\":h[e]=\\\"range\\\";break;case \\\"cursor\\\":break;default:h[e]=\\\"newrange\\\"}for(f=d.top;d.hasrange&&f<=d.bottom;f++)for(g=d.left;g<=d.right;g++)switch(e=SocialCalc.crToCoord(g,f),h[e]){case \\\"unrange2\\\":h[e]=\\\"range2\\\";break;case \\\"range\\\":case \\\"newrange\\\":case \\\"cursor\\\":break;default:h[e]=\\\"newrange2\\\"}for(e in h){switch(h[e]){case \\\"unrange\\\":delete h[e];break;case \\\"newrange\\\":h[e]=\\n\\\"range\\\";break;case \\\"newrange2\\\":h[e]=\\\"range2\\\";break;case \\\"range\\\":case \\\"range2\\\":case \\\"cursor\\\":continue}d=SocialCalc.coordToCr(e);b=SocialCalc.GetEditorCellElement(a,d.row,d.col);a.UpdateCellCSS(b,d.row,d.col)}for(l in a.RangeChangeCallback)a.RangeChangeCallback[l](a);e=SocialCalc.crToCoord(a.range.left,a.range.top);if(a.range.left!=a.range.right||a.range.top!=a.range.bottom)e+=\\\":\\\"+SocialCalc.crToCoord(a.range.right,a.range.bottom);for(l in a.StatusCallback)a.StatusCallback[l].func(a,\\\"rangechange\\\",e,\\na.StatusCallback[l].params)}};\\nSocialCalc.RangeRemove=function(a){var c,b,d,e,f=a.context.highlights,g=a.range,l=a.range2;if(g.hasrange||l.hasrange){for(c=l.top;l.hasrange&&c<=l.bottom;c++)for(b=l.left;b<=l.right;b++)switch(d=SocialCalc.crToCoord(b,c),f[d]){case \\\"range\\\":f[d]=\\\"newrange2\\\";break;case \\\"range2\\\":case \\\"cursor\\\":break;default:f[d]=\\\"newrange2\\\"}for(d in f){switch(f[d]){case \\\"range\\\":delete f[d];break;case \\\"newrange2\\\":f[d]=\\\"range2\\\";break;case \\\"cursor\\\":continue}b=SocialCalc.coordToCr(d);c=SocialCalc.GetEditorCellElement(a,b.row,\\nb.col);a.UpdateCellCSS(c,b.row,b.col)}g.hasrange=!1;for(e in a.RangeChangeCallback)a.RangeChangeCallback[e](a);for(e in a.StatusCallback)a.StatusCallback[e].func(a,\\\"rangechange\\\",\\\"\\\",a.StatusCallback[e].params)}};\\nSocialCalc.Range2Remove=function(a){var c,b,d,e=a.context.highlights,f=a.range2;if(f.hasrange){for(d in e){switch(e[d]){case \\\"range2\\\":delete e[d];break;case \\\"range\\\":case \\\"cursor\\\":continue}b=SocialCalc.coordToCr(d);c=SocialCalc.GetEditorCellElement(a,b.row,b.col);a.UpdateCellCSS(c,b.row,b.col)}f.hasrange=!1}};\\nSocialCalc.FitToEditTable=function(a){var c,b,d,e=a.context,f=e.sheetobj;d=e.showRCHeaders?e.rownamewidth-0:0;for(colpane=0;colpane<e.colpanes.length-1;colpane++)for(c=e.colpanes[colpane].first;c<=e.colpanes[colpane].last;c++)if(b=SocialCalc.rcColname(c),\\\"yes\\\"!=f.colattribs.hide[b]){b=f.colattribs.width[b]||f.attribs.defaultcolwidth||SocialCalc.Constants.defaultColWidth;if(\\\"blank\\\"==b||\\\"auto\\\"==b)b=\\\"\\\";d+=b&&0<b-0?b-0:10}for(c=e.colpanes[colpane].first;1E4>=c;c++){b=SocialCalc.rcColname(c);if(\\\"yes\\\"!=\\nf.colattribs.hide[b]){b=f.colattribs.width[b]||f.attribs.defaultcolwidth||SocialCalc.Constants.defaultColWidth;if(\\\"blank\\\"==b||\\\"auto\\\"==b)b=\\\"\\\";d+=b&&0<b-0?b-0:10}if(d>a.tablewidth)break}e.colpanes[colpane].last=e.sheetobj.attribs.usermaxcol||c;d=e.showRCHeaders?1:0;for(c=0;c<e.rowpanes.length-1;c++)for(d+=e.rowpanes[c].last-e.rowpanes[c].first+1,b=e.rowpanes[c].first;b<=e.rowpanes[c].last;b++)\\\"yes\\\"==f.rowattribs.hide[b]&&d--;a=a.tableheight-d*e.pixelsPerRow;e.rowpanes[c].last=e.sheetobj.attribs.usermaxrow||\\ne.rowpanes[c].first+Math.floor(a/e.pixelsPerRow)+1};\\nSocialCalc.CalculateEditorPositions=function(a){var c;a.gridposition=SocialCalc.GetElementPosition(a.griddiv);c=a.griddiv.firstChild.lastChild.childNodes[1].childNodes[0];a.headposition=SocialCalc.GetElementPosition(c);a.headposition.left+=c.offsetWidth;a.headposition.top+=c.offsetHeight;a.rowpositions=[];for(c=0;c<a.context.rowpanes.length;c++)a.CalculateRowPositions(c,a.rowpositions,a.rowheight);for(c=0;c<a.rowpositions.length&&!(a.rowpositions[c]>a.gridposition.top+a.tableheight);c++);a.lastvisiblerow=\\nc-1;a.colpositions=[];for(c=0;c<a.context.colpanes.length;c++)a.CalculateColPositions(c,a.colpositions,a.colwidth);for(c=0;c<a.colpositions.length&&!(a.colpositions[c]>a.gridposition.left+a.tablewidth);c++);a.lastvisiblecol=c-1;for(a.firstscrollingrow=a.context.rowpanes[a.context.rowpanes.length-1].first;\\\"yes\\\"==a.context.sheetobj.rowattribs.hide[a.firstscrollingrow];)a.firstscrollingrow++;a.firstscrollingrowtop=a.rowpositions[a.firstscrollingrow]||a.headposition.top;a.lastnonscrollingrow=0<a.context.rowpanes.length-\\n1?a.context.rowpanes[a.context.rowpanes.length-2].last:0;for(a.firstscrollingcol=a.context.colpanes[a.context.colpanes.length-1].first;\\\"yes\\\"==a.context.sheetobj.colattribs.hide[SocialCalc.rcColname(a.firstscrollingcol)];)a.firstscrollingcol++;a.firstscrollingcolleft=a.colpositions[a.firstscrollingcol]||a.headposition.left;a.lastnonscrollingcol=0<a.context.colpanes.length-1?a.context.colpanes[a.context.colpanes.length-2].last:0;a.verticaltablecontrol.ComputeTableControlPositions();a.horizontaltablecontrol.ComputeTableControlPositions()};\\nSocialCalc.ScheduleRender=function(a){a.timeout&&window.clearTimeout(a.timeout);SocialCalc.EditorSheetStatusCallback(null,\\\"schedrender\\\",null,a);a.timeout=window.setTimeout(function(){SocialCalc.DoRenderStep(a)},1)};SocialCalc.DoRenderStep=function(a){a.timeout=null;a.EditorRenderSheet();SocialCalc.EditorSheetStatusCallback(null,\\\"renderdone\\\",null,a);SocialCalc.EditorSheetStatusCallback(null,\\\"schedposcalc\\\",null,a);a.timeout=window.setTimeout(function(){SocialCalc.DoPositionCalculations(a)},1)};\\nSocialCalc.SchedulePositionCalculations=function(a){SocialCalc.EditorSheetStatusCallback(null,\\\"schedposcalc\\\",null,a);a.timeout=window.setTimeout(function(){SocialCalc.DoPositionCalculations(a)},1)};\\nSocialCalc.DoPositionCalculations=function(a){a.timeout=null;a.CalculateEditorPositions();a.verticaltablecontrol.PositionTableControlElements();a.horizontaltablecontrol.PositionTableControlElements();SocialCalc.EditorSheetStatusCallback(null,\\\"doneposcalc\\\",null,a);a.ensureecell&&a.ecell&&!a.deferredCommands.length&&(a.ensureecell=!1,a.EnsureECellVisible());a.cellhandles.ShowCellHandles(!0)};\\nSocialCalc.CalculateRowPositions=function(a,c,b,d){var e,f,g,l,h=a.context,m;if(!h.showRCHeaders)throw\\\"Needs showRCHeaders=true\\\";m=a.fullgrid.lastChild;a=2;for(e=0;e<c;e++)a+=h.rowpanes[e].last-h.rowpanes[e].first+2;f=0;for(c=h.rowpanes[e].first;c<=h.rowpanes[e].last;c++)g=m.childNodes[a+f],f++,l=SocialCalc.GetElementPosition(g.firstChild),b[c]||(b[c]=l.top,d[c]=g.firstChild.offsetHeight)};\\nSocialCalc.CalculateColPositions=function(a,c,b,d){var e,f,g,l,h=a.context;if(!h.showRCHeaders)throw\\\"Needs showRCHeaders=true\\\";f=a.fullgrid.lastChild;a=1;for(e=0;e<c;e++)a+=h.colpanes[e].last-h.colpanes[e].first+2;g=f.childNodes[1];f=0;for(c=h.colpanes[e].first;c<=h.colpanes[e].last;c++)l=SocialCalc.GetElementPosition(g.childNodes[a+f]),b[c]||(b[c]=l.left,g.childNodes[a+f]&&(d[c]=g.childNodes[a+f].offsetWidth)),f++};\\nSocialCalc.ScrollRelative=function(a,c,b){c?a.ScrollRelativeBoth(b,0):a.ScrollRelativeBoth(0,b)};\\nSocialCalc.ScrollRelativeBoth=function(a,c,b){var d=a.context,e=0<c?1:-1,f=0<b?1:-1,g=d.rowpanes.length,l=1<g?d.rowpanes[g-2].last+1:1;d.rowpanes[g-1].first+c<l&&(c=-d.rowpanes[g-1].first+l);var l=d.colpanes.length,h=1<l?d.colpanes[l-2].last+1:1;for(d.colpanes[l-1].first+b<h&&(b=-d.colpanes[l-1].first+h);\\\"yes\\\"==d.sheetobj.colattribs.hide[SocialCalc.rcColname(d.colpanes[l-1].first+b)];)if(b+=f,1>b){b=0;break}for(;\\\"yes\\\"==d.sheetobj.rowattribs.hide[d.rowpanes[g-1].first+c];)if(c+=e,1>c){c=0;break}if((1==\\nc||-1==c)&&0==b)1==c?a.ScrollTableUpOneRow():a.ScrollTableDownOneRow(),a.ecell&&a.SetECellHeaders(\\\"selected\\\"),a.SchedulePositionCalculations();else if(0!=c||0!=b)d.rowpanes[g-1].first+=c,d.rowpanes[g-1].last+=c,d.colpanes[l-1].first+=b,d.colpanes[l-1].last+=b,a.LimitLastPanes(),a.FitToEditTable(),a.ScheduleRender()};\\nSocialCalc.PageRelative=function(a,c,b){var d=a.context,e=c?\\\"rowpanes\\\":\\\"colpanes\\\",d=d[e][d[e].length-1],f=c?\\\"lastvisiblerow\\\":\\\"lastvisiblecol\\\",e=c?a.rowheight:a.colwidth,g=c?SocialCalc.Constants.defaultAssumedRowHeight:SocialCalc.Constants.defaultColWidth;if(0<b)c=a[f],c==d.first&&(c+=1);else{b=c?a.tableheight-(a.firstscrollingrowtop-a.gridposition.top):a.tablewidth-(a.firstscrollingcolleft-a.gridposition.left);b-=0<e[a[f]]?e[a[f]]:g;for(c=d.first-1;0<c;c--){f=0<e[c]?e[c]:g;if(b<f)break;b-=f}e=d.first;\\nc>=e&&(c=e-1);1>c&&(c=1)}d.first=c;d.last=c+1;a.LimitLastPanes();a.FitToEditTable();a.ScheduleRender()};\\nSocialCalc.LimitLastPanes=function(a){a=a.context;var c;c=a.rowpanes.length;1<c&&a.rowpanes[c-1].first<=a.rowpanes[c-2].last&&(a.rowpanes[c-1].first=a.rowpanes[c-2].last+1);a.sheetobj.attribs.usermaxrow&&a.rowpanes[c-1].first>a.sheetobj.attribs.usermaxrow&&(a.rowpanes[c-1].first=a.sheetobj.attribs.usermaxrow);c=a.colpanes.length;1<c&&a.colpanes[c-1].first<=a.colpanes[c-2].last&&(a.colpanes[c-1].first=a.colpanes[c-2].last+1);a.sheetobj.attribs.usermaxcol&&a.colpanes[c-1].first>a.sheetobj.attribs.usermaxcol&&\\n(a.colpanes[c-1].first=a.sheetobj.attribs.usermaxcol)};\\nSocialCalc.ScrollTableUpOneRow=function(a){var c,b,d,e,f,g,l={},h=a.context,m=h.sheetobj,p=a.fullgrid,r;r=p.lastChild;c=h.showRCHeaders?2:1;for(b=0;b<h.rowpanes.length-1;b++)c+=h.rowpanes[b].last-h.rowpanes[b].first+2;if(h.sheetobj.attribs.usermaxrow&&1>h.sheetobj.attribs.usermaxrow-h.rowpanes[b].first)return p;r.removeChild(r.childNodes[c]);h.rowpanes[b].first++;h.rowpanes[b].last++;a.FitToEditTable();h.CalculateColWidthData();h.sheetobj.attribs.usermaxrow&&h.rowpanes[b].last==h.sheetobj.attribs.usermaxrow||\\n(a=h.RenderRow(h.rowpanes[b].last,b),r.appendChild(a));maxrowspan=1;a=h.rowpanes[b].first-1;for(f=0;f<h.colpanes.length;f++)for(e=h.colpanes[f].first;e<=h.colpanes[f].last;e++)coord=SocialCalc.crToCoord(e,a),h.cellskip[coord]||(g=m.cells[coord])&&g.rowspan>maxrowspan&&(maxrowspan=g.rowspan);if(1<maxrowspan)for(d=1;d<maxrowspan&&!(d+a>=h.rowpanes[b].last);d++)e=h.RenderRow(d+a,b),f=r.childNodes[c+d-1],r.replaceChild(e,f);a=h.rowpanes[b].last;for(f=0;f<h.colpanes.length;f++)for(e=h.colpanes[f].first;e<=\\nh.colpanes[f].last;e++)if(coord=h.cellskip[SocialCalc.crToCoord(e,a)])d=h.coordToCR[coord].row-0,d==h.rowpanes[b].last||d<h.rowpanes[b].first||(g=m.cells[coord])&&1<g.rowspan&&(l[d]=!0);for(d in l)e=h.RenderRow(d,b),f=r.childNodes[c+(d-h.rowpanes[b].first)],r.replaceChild(e,f);return p};\\nSocialCalc.ScrollTableDownOneRow=function(a){var c,b,d,e,f,g,l={},h=a.context,m=h.sheetobj,p=a.fullgrid,r;r=p.lastChild;c=h.showRCHeaders?2:1;for(b=0;b<h.rowpanes.length-1;b++)c+=h.rowpanes[b].last-h.rowpanes[b].first+2;h.sheetobj.attribs.usermaxrow||r.removeChild(r.childNodes[c+(h.rowpanes[b].last-h.rowpanes[b].first)]);h.rowpanes[b].first--;h.rowpanes[b].last--;a.FitToEditTable();h.CalculateColWidthData();e=h.RenderRow(h.rowpanes[b].first,b);r.insertBefore(e,r.childNodes[c]);maxrowspan=1;a=h.rowpanes[b].first;\\nfor(f=0;f<h.colpanes.length;f++)for(e=h.colpanes[f].first;e<=h.colpanes[f].last;e++)coord=SocialCalc.crToCoord(e,a),h.cellskip[coord]||(g=m.cells[coord])&&g.rowspan>maxrowspan&&(maxrowspan=g.rowspan);if(1<maxrowspan)for(d=1;d<maxrowspan&&!(d+a>h.rowpanes[b].last);d++)e=h.RenderRow(d+a,b),f=r.childNodes[c+d],r.replaceChild(e,f);a=h.rowpanes[b].last;for(f=0;f<h.colpanes.length;f++)for(e=h.colpanes[f].first;e<=h.colpanes[f].last;e++)if(coord=SocialCalc.crToCoord(e,a),(g=m.cells[coord])&&1<g.rowspan)l[a]=\\n!0;else if(coord=h.cellskip[SocialCalc.crToCoord(e,a)])d=h.coordToCR[coord].row-0,d==a||d<h.rowpanes[b].first||(g=m.cells[coord])&&1<g.rowspan&&(l[d]=!0);for(d in l)e=h.RenderRow(d,b),f=r.childNodes[c+(d-h.rowpanes[b].first)],r.replaceChild(e,f);return p};SocialCalc.InputBox=function(a,c){a&&(this.element=a,this.editor=c,this.inputEcho=null,c.inputBox=this,a.onmousedown=SocialCalc.InputBoxOnMouseDown,c.MoveECellCallback.formulabar=function(a){\\\"start\\\"==a.state&&c.inputBox.DisplayCellContents(a.ecell.coord)})};\\nSocialCalc.InputBox.prototype.DisplayCellContents=function(a){SocialCalc.InputBoxDisplayCellContents(this,a)};SocialCalc.InputBox.prototype.ShowInputBox=function(a){this.editor.inputEcho.ShowInputEcho(a)};SocialCalc.InputBox.prototype.GetText=function(){return this.element.value};SocialCalc.InputBox.prototype.SetText=function(a){this.element&&(this.element.value=a,this.editor.inputEcho.SetText(a+\\\"_\\\"))};SocialCalc.InputBox.prototype.Focus=function(){SocialCalc.InputBoxFocus(this)};\\nSocialCalc.InputBox.prototype.Blur=function(){return this.element.blur()};\\nSocialCalc.InputBox.prototype.Select=function(a){if(this.element)switch(a){case \\\"end\\\":if(document.selection&&document.selection.createRange)try{var c=document.selection.createRange().duplicate();c.moveToElementText(this.element);c.collapse(!1);c.select()}catch(b){void 0!=this.element.selectionStart&&(this.element.selectionStart=this.element.value.length,this.element.selectionEnd=this.element.value.length)}else void 0!=this.element.selectionStart&&(this.element.selectionStart=this.element.value.length,\\nthis.element.selectionEnd=this.element.value.length)}};SocialCalc.InputBoxDisplayCellContents=function(a,c){var b=SocialCalc.Constants;if(a){c||(c=a.editor.ecell.coord);var d=SocialCalc.GetCellContents(a.editor.context.sheetobj,c);-1!=d.indexOf(\\\"\\\\n\\\")?(d=b.s_inputboxdisplaymultilinetext,a.element.disabled=!0):a.editor.ECellReadonly()?a.element.disabled=!0:a.element.disabled=!1;a.SetText(d)}};\\nSocialCalc.InputBoxFocus=function(a){if(a){a.element.focus();a=a.editor;a.state=\\\"input\\\";var c=a.workingvalues;c.partialexpr=\\\"\\\";c.ecoord=a.ecell.coord;c.erow=a.ecell.row;c.ecol=a.ecell.col}};\\nSocialCalc.InputBoxOnMouseDown=function(a){a=SocialCalc.GetSpreadsheetControlObject().keyboard.focusTable;if(!a)return!0;var c=a.workingvalues;switch(a.state){case \\\"start\\\":a.state=\\\"inputboxdirect\\\";c.partialexpr=\\\"\\\";c.ecoord=a.ecell.coord;c.erow=a.ecell.row;c.ecol=a.ecell.col;a.inputEcho.ShowInputEcho(!0);break;case \\\"input\\\":c.partialexpr=\\\"\\\",a.MoveECell(c.ecoord),a.state=\\\"inputboxdirect\\\",SocialCalc.KeyboardFocus()}};\\nSocialCalc.InputEcho=function(a){var c=SocialCalc.Constants;this.editor=a;this.text=\\\"\\\";this.functionbox=this.prompt=this.main=this.container=this.interval=null;this.container=document.createElement(\\\"div\\\");SocialCalc.setStyles(this.container,\\\"display:none;position:absolute;zIndex:10;\\\");this.main=document.createElement(\\\"div\\\");c.defaultInputEchoClass&&(this.main.className=c.defaultInputEchoClass);c.defaultInputEchoStyle&&SocialCalc.setStyles(this.main,c.defaultInputEchoStyle);this.main.innerHTML=\\\"&nbsp;\\\";\\nthis.container.appendChild(this.main);this.prompt=document.createElement(\\\"div\\\");c.defaultInputEchoPromptClass&&(this.prompt.className=c.defaultInputEchoPromptClass);c.defaultInputEchoPromptStyle&&SocialCalc.setStyles(this.prompt,c.defaultInputEchoPromptStyle);this.prompt.innerHTML=\\\"\\\";this.container.appendChild(this.prompt);SocialCalc.DragRegister(this.main,!0,!0,{MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null,\\npositionobj:this.container},this.editor.toplevel);a.toplevel.appendChild(this.container)};SocialCalc.InputEcho.prototype.ShowInputEcho=function(a){return SocialCalc.ShowInputEcho(this,a)};SocialCalc.InputEcho.prototype.SetText=function(a){return SocialCalc.SetInputEchoText(this,a)};\\nSocialCalc.ShowInputEcho=function(a,c){var b;if(b=a.editor)if(c){b.cellhandles.ShowCellHandles(!1);if(b=SocialCalc.GetEditorCellElement(b,b.ecell.row,b.ecell.col))b=SocialCalc.GetElementPosition(b.element),a.container.style.left=b.left-1+\\\"px\\\",a.container.style.top=b.top-1+\\\"px\\\";a.container.style.display=\\\"block\\\";a.interval&&window.clearInterval(a.interval);a.interval=window.setInterval(SocialCalc.InputEchoHeartbeat,50)}else a.interval&&window.clearInterval(a.interval),a.container.style.display=\\\"none\\\"};\\nSocialCalc.SetInputEchoText=function(a,c){var b=SocialCalc.Constants,d;d=SocialCalc.special_chars(c);d=d.replace(/\\\\n/g,\\\"<br>\\\");a.text!=d&&(a.main.innerHTML=d,a.text=d);d=c.match(/.*[\\\\+\\\\-\\\\*\\\\/\\\\&\\\\^\\\\<\\\\>\\\\=\\\\,\\\\(]([A-Za-z][A-Za-z][\\\\w\\\\.]*?)\\\\([^\\\\)]*$/);\\\"=\\\"==c.charAt(0)&&d?(d=d[1].toUpperCase(),SocialCalc.Formula.FunctionList[d]?(SocialCalc.Formula.FillFunctionInfo(),b=SocialCalc.special_chars(d+\\\"(\\\"+SocialCalc.Formula.FunctionArgString(d)+\\\")\\\")):b=b.ietUnknownFunction+d,a.prompt.innerHTML!=b&&(a.prompt.innerHTML=\\nb,a.prompt.style.display=\\\"block\\\")):\\\"none\\\"!=a.prompt.style.display&&(a.prompt.innerHTML=\\\"\\\",a.prompt.style.display=\\\"none\\\")};SocialCalc.InputEchoHeartbeat=function(){var a=SocialCalc.GetSpreadsheetControlObject().keyboard.focusTable;if(!a)return!0;a.inputEcho.SetText(a.inputBox.GetText()+\\\"_\\\")};SocialCalc.InputEchoMouseDown=function(a){a=SocialCalc.GetSpreadsheetControlObject().keyboard.focusTable;if(!a)return!0;a.inputBox.element.focus()};\\nSocialCalc.CellHandles=function(a){if(!a.noEdit){this.editor=a;this.movedmouse=this.noCursorSuffix=!1;this.draghandle=document.createElement(\\\"div\\\");SocialCalc.setStyles(this.draghandle,\\\"display:none;position:absolute;zIndex:8;border:1px solid white;width:4px;height:4px;fontSize:1px;backgroundColor:#0E93D8;cursor:default;\\\");TiddlyWiki&&(this.draghandle.style.width=\\\"6px\\\",this.draghandle.style.height=\\\"6px\\\");this.draghandle.innerHTML=\\\"&nbsp;\\\";a.toplevel.appendChild(this.draghandle);SocialCalc.AssignID(a,\\nthis.draghandle,\\\"draghandle\\\");var c=\\\"png\\\";navigator.userAgent.match(/MSIE 6\\\\.0/)&&(c=\\\"gif\\\");this.dragpalette=document.createElement(\\\"div\\\");SocialCalc.setStyles(this.dragpalette,\\\"display:none;position:absolute;zIndex:8;width:90px;height:90px;fontSize:1px;textAlign:center;cursor:default;backgroundImage:url(\\\"+SocialCalc.Constants.defaultImagePrefix+\\\"drag-handles.\\\"+c+\\\");\\\");this.dragpalette.innerHTML=\\\"&nbsp;\\\";a.toplevel.appendChild(this.dragpalette);SocialCalc.AssignID(a,this.dragpalette,\\\"dragpalette\\\");\\nthis.dragtooltip=document.createElement(\\\"div\\\");SocialCalc.setStyles(this.dragtooltip,\\\"display:none;position:absolute;zIndex:9;border:1px solid black;width:100px;height:auto;fontSize:10px;backgroundColor:#FFFFFF;\\\");this.dragtooltip.innerHTML=\\\"&nbsp;\\\";a.toplevel.appendChild(this.dragtooltip);SocialCalc.AssignID(a,this.dragtooltip,\\\"dragtooltip\\\");this.fillinghandle=document.createElement(\\\"div\\\");SocialCalc.setStyles(this.fillinghandle,\\\"display:none;position:absolute;zIndex:9;border:1px solid black;width:auto;height:14px;fontSize:10px;backgroundColor:#FFFFFF;\\\");\\nthis.fillinghandle.innerHTML=\\\"&nbsp;\\\";a.toplevel.appendChild(this.fillinghandle);SocialCalc.AssignID(a,this.fillinghandle,\\\"fillinghandle\\\");if(this.draghandle.addEventListener)this.draghandle.addEventListener(\\\"mousemove\\\",SocialCalc.CellHandlesMouseMoveOnHandle,!1),this.dragpalette.addEventListener(\\\"mousedown\\\",SocialCalc.CellHandlesMouseDown,!1),this.dragpalette.addEventListener(\\\"mousemove\\\",SocialCalc.CellHandlesMouseMoveOnHandle,!1);else if(this.draghandle.attachEvent)this.draghandle.attachEvent(\\\"onmousemove\\\",\\nSocialCalc.CellHandlesMouseMoveOnHandle),this.dragpalette.attachEvent(\\\"onmousedown\\\",SocialCalc.CellHandlesMouseDown),this.dragpalette.attachEvent(\\\"onmousemove\\\",SocialCalc.CellHandlesMouseMoveOnHandle);else throw\\\"Browser not supported\\\";}};SocialCalc.CellHandles.prototype.ShowCellHandles=function(a,c){return SocialCalc.ShowCellHandles(this,a,c)};\\nSocialCalc.ShowCellHandles=function(a,c,b){var d=a.editor,e=!1,f,g,l=1,h=1;if(d){if(c&&(f=d.ecell.row,g=d.ecell.col,\\\"start\\\"==d.state&&!(f>=d.lastvisiblerow||g>=d.lastvisiblecol||f<d.firstscrollingrow||g<d.firstscrollingcol))){for(;\\\"yes\\\"==d.context.sheetobj.colattribs.hide[SocialCalc.rcColname(g+l)];)l++;for(;\\\"yes\\\"==d.context.sheetobj.rowattribs.hide[f+h];)h++;c=d.context.sheetobj.cells[SocialCalc.crToCoord(g+l-1,f+h-1)];\\\"undefined\\\"!=typeof c&&(l+=(c.colspan||1)-1,h+=(c.rowspan||1)-1);d.rowpositions[f+\\nh]+20>d.horizontaltablecontrol.controlborder||d.rowpositions[f+h]-10<d.headposition.top||d.colpositions[g+l]+20>d.verticaltablecontrol.controlborder||d.colpositions[g+l]-30<d.headposition.left||(a.draghandle.style.left=d.colpositions[g+l]-1+\\\"px\\\",a.draghandle.style.top=d.rowpositions[f+h]-1+\\\"px\\\",a.draghandle.style.display=\\\"block\\\",b&&(a.draghandle.style.display=\\\"none\\\",a.dragpalette.style.left=d.colpositions[g+l]-45+\\\"px\\\",a.dragpalette.style.top=d.rowpositions[f+h]-45+\\\"px\\\",a.dragpalette.style.display=\\n\\\"block\\\",a.dragtooltip.style.left=d.colpositions[g+l]-45+\\\"px\\\",a.dragtooltip.style.top=d.rowpositions[f+h]+45+\\\"px\\\",a.dragtooltip.style.display=\\\"none\\\"),e=!0)}e||(a.draghandle.style.display=\\\"none\\\");b||(a.dragpalette.style.display=\\\"none\\\",a.dragtooltip.style.display=\\\"none\\\")}};\\nSocialCalc.CellHandlesMouseMoveOnHandle=function(a){var c=SocialCalc.Constants,b=a||window.event,d=b.target||b.srcElement,e=SocialCalc.GetSpreadsheetControlObject().keyboard.focusTable;if(!e)return!0;a=e.cellhandles;if(!a.editor)return!0;var f=SocialCalc.GetElementPositionWithScroll(e.toplevel),g=b.clientX-f.left,b=b.clientY-f.top;if(!e.cellhandles.mouseDown){e.cellhandles.ShowCellHandles(!0,!0);if(d==a.dragpalette){c=SocialCalc.SegmentDivHit([c.CH_radius1,c.CH_radius2],e.cellhandles.dragpalette,\\ng,b);if(0==c){SocialCalc.CellHandlesHoverTimeout();return}a.tooltipstimer&&(window.clearTimeout(a.tooltipstimer),a.tooltipstimer=null);a.tooltipswhichhandle=c;a.tooltipstimer=window.setTimeout(SocialCalc.CellHandlesTooltipsTimeout,700)}a.timer&&(window.clearTimeout(a.timer),a.timer=null);a.timer=window.setTimeout(SocialCalc.CellHandlesHoverTimeout,3E3)}};\\nSocialCalc.SegmentDivHit=function(a,c,b,d){var e=c.offsetWidth,f=c.offsetHeight,g=c.offsetLeft;c=c.offsetTop;var l=0,h=a,m=Math.sqrt(Math.pow(b-g-(e/2-.5),2)+Math.pow(d-c-(f/2-.5),2));if(2==h.length)return b>=g&&b<g+e/2&&d>=c&&d<c+f/2&&(m<=a[0]?l=-1:m<=a[1]&&(l=1)),b>=g+e/2&&b<g+e&&d>=c&&d<c+f/2&&(m<=a[0]?l=-2:m<=a[1]&&(l=2)),b>=g+e/2&&b<g+e&&d>=c+f/2&&d<c+f&&(m<=a[0]?l=-3:m<=a[1]&&(l=3)),b>=g&&b<g+e/2&&d>=c+f/2&&d<c+f&&(m<=a[0]?l=-4:m<=a[1]&&(l=4)),l;for(;;)if(b>=g&&b<g+e/2&&d>=c&&d<c+f/2){quadrant+=\\n\\\"1\\\";l=h[0];if(\\\"number\\\"==typeof l)break;h=l;e/=2;f/=2}else if(b>=g+e/2&&b<g+e&&d>=c&&d<c+f/2){quadrant+=\\\"2\\\";l=h[1];if(\\\"number\\\"==typeof l)break;h=l;e/=2;g+=e;f/=2}else if(b>=g+e/2&&b<g+e&&d>=c+f/2&&d<c+f){quadrant+=\\\"3\\\";l=h[2];if(\\\"number\\\"==typeof l)break;h=l;e/=2;g+=e;f/=2;c+=f}else if(b>=g&&b<g+e/2&&d>=c+f/2&&d<c+f){quadrant+=\\\"4\\\";l=h[3];if(\\\"number\\\"==typeof l)break;h=l;e/=2;f/=2;c+=f}else return 0;return l};\\nSocialCalc.CellHandlesHoverTimeout=function(){editor=SocialCalc.GetSpreadsheetControlObject().keyboard.focusTable;if(!editor)return!0;var a=editor.cellhandles;a.timer&&(window.clearTimeout(a.timer),a.timer=null);a.tooltipstimer&&(window.clearTimeout(a.tooltipstimer),a.tooltipstimer=null);editor.cellhandles.ShowCellHandles(!0,!1)};\\nSocialCalc.CellHandlesTooltipsTimeout=function(){editor=SocialCalc.GetSpreadsheetControlObject().keyboard.focusTable;if(!editor)return!0;var a=editor.cellhandles;a.tooltipstimer&&(window.clearTimeout(a.tooltipstimer),a.tooltipstimer=null);var c=a.tooltipswhichhandle;if(0==c)SocialCalc.CellHandlesHoverTimeout();else{if(-3==c)a.dragtooltip.innerHTML=scc.s_CHfillAllTooltip;else if(3==c)a.dragtooltip.innerHTML=scc.s_CHfillContentsTooltip;else if(-2==c)a.dragtooltip.innerHTML=scc.s_CHmovePasteAllTooltip;\\nelse if(-4==c)a.dragtooltip.innerHTML=scc.s_CHmoveInsertAllTooltip;else if(2==c)a.dragtooltip.innerHTML=scc.s_CHmovePasteContentsTooltip;else if(4==c)a.dragtooltip.innerHTML=scc.s_CHmoveInsertContentsTooltip;else{a.dragtooltip.innerHTML=\\\"&nbsp;\\\";a.dragtooltip.style.display=\\\"none\\\";return}a.dragtooltip.style.display=\\\"block\\\"}};\\nSocialCalc.CellHandlesMouseDown=function(a){var c=SocialCalc.Constants,b,d=a||window.event,e=SocialCalc.EditorMouseInfo;a=SocialCalc.GetSpreadsheetControlObject().keyboard.focusTable;if(!a)return!0;if(!a.busy){var f=a.cellhandles;f.movedmouse=!1;var g=SocialCalc.GetElementPositionWithScroll(a.toplevel),l=d.clientX-g.left,g=d.clientY-g.top;f.timer&&(window.clearTimeout(f.timer),f.timer=null);f.tooltipstimer&&(window.clearTimeout(f.tooltipstimer),f.tooltipstimer=null);f.dragtooltip.innerHTML=\\\"&nbsp;\\\";\\nf.dragtooltip.style.display=\\\"none\\\";b=a.range;var h=SocialCalc.SegmentDivHit([c.CH_radius1,c.CH_radius2],a.cellhandles.dragpalette,l,g);if(1==h||-1==h||0==h)f.ShowCellHandles(!0,!1);else{e.ignore=!0;-3==h?(f.dragtype=\\\"Fill\\\",f.noCursorSuffix=!1):3==h?(f.dragtype=\\\"FillC\\\",f.noCursorSuffix=!1):-2==h?(f.dragtype=\\\"Move\\\",f.noCursorSuffix=!0):-4==h?(f.dragtype=\\\"MoveI\\\",f.noCursorSuffix=!1):2==h?(f.dragtype=\\\"MoveC\\\",f.noCursorSuffix=!0):4==h&&(f.dragtype=\\\"MoveIC\\\",f.noCursorSuffix=!1);f.filltype=null;switch(f.dragtype){case \\\"Fill\\\":case \\\"FillC\\\":b.hasrange||\\na.RangeAnchor();break;case \\\"Move\\\":case \\\"MoveI\\\":case \\\"MoveC\\\":case \\\"MoveIC\\\":b.hasrange||a.RangeAnchor();a.range2.top=a.range.top;a.range2.right=a.range.right;a.range2.bottom=a.range.bottom;a.range2.left=a.range.left;a.range2.hasrange=!0;a.RangeRemove();break;default:return}f.fillinghandle.style.left=l+\\\"px\\\";f.fillinghandle.style.top=g-17+\\\"px\\\";f.fillinghandle.innerHTML=c.s_CHindicatorOperationLookup[f.dragtype]+(c.s_CHindicatorDirectionLookup[a.cellhandles.filltype]||\\\"\\\");f.fillinghandle.style.display=\\n\\\"block\\\";f.ShowCellHandles(!0,!1);f.mouseDown=!0;e.editor=a;c=a.ecell.coord;f.startingcoord=c;f.startingX=l;f.startingY=g;e.mouselastcoord=c;SocialCalc.KeyboardSetFocus(a);document.addEventListener?(document.addEventListener(\\\"mousemove\\\",SocialCalc.CellHandlesMouseMove,!0),document.addEventListener(\\\"mouseup\\\",SocialCalc.CellHandlesMouseUp,!0)):f.draghandle.attachEvent&&(f.draghandle.setCapture(),f.draghandle.attachEvent(\\\"onmousemove\\\",SocialCalc.CellHandlesMouseMove),f.draghandle.attachEvent(\\\"onmouseup\\\",\\nSocialCalc.CellHandlesMouseUp),f.draghandle.attachEvent(\\\"onlosecapture\\\",SocialCalc.CellHandlesMouseUp));d.stopPropagation?d.stopPropagation():d.cancelBubble=!0;d.preventDefault?d.preventDefault():d.returnValue=!1}}};\\nSocialCalc.CellHandlesMouseMove=function(a){var c=SocialCalc.Constants,b,d,e,f=a||window.event,g=SocialCalc.EditorMouseInfo;if(a=g.editor){var l=a.cellhandles;b=SocialCalc.GetElementPositionWithScroll(a.toplevel);var h=f.clientX-b.left,m=f.clientY-b.top;if(b=SocialCalc.GridMousePosition(a,h,m))if(b&&!b.coord)SocialCalc.SetDragAutoRepeat(a,b,SocialCalc.CellHandlesDragAutoRepeat);else if(SocialCalc.SetDragAutoRepeat(a,null),b.coord){d=SocialCalc.coordToCr(a.cellhandles.startingcoord);e=SocialCalc.coordToCr(b.coord);\\nl.movedmouse=!0;switch(l.dragtype){case \\\"Fill\\\":case \\\"FillC\\\":b.coord==l.startingcoord?(l.filltype=null,l.startingX=h,l.startingY=m):l.filltype?\\\"Down\\\"==l.filltype?(e.col=d.col,e.row<d.row&&(e.row=d.row)):(e.row=d.row,e.col<d.col&&(e.col=d.col)):(10<Math.abs(m-l.startingY)?l.filltype=\\\"Down\\\":10<Math.abs(h-l.startingX)&&(l.filltype=\\\"Right\\\"),e.col=d.col,e.row=d.row);b.coord=SocialCalc.crToCoord(e.col,e.row);b.coord!=g.mouselastcoord&&(a.MoveECell(b.coord),a.RangeExtend());break;case \\\"Move\\\":case \\\"MoveC\\\":b.coord!=\\ng.mouselastcoord&&(a.MoveECell(b.coord),d=a.range2.right-a.range2.left+b.col,e=a.range2.bottom-a.range2.top+b.row,a.RangeAnchor(SocialCalc.crToCoord(d,e)),a.RangeExtend());break;case \\\"MoveI\\\":case \\\"MoveIC\\\":b.coord==l.startingcoord?(l.filltype=null,l.startingX=h,l.startingY=m):l.filltype?\\\"Vertical\\\"==l.filltype?(e.col=a.range2.left,e.row>=a.range2.top&&e.row<=a.range2.bottom+1&&(e.row=a.range2.bottom+2)):(e.row=a.range2.top,e.col>=a.range2.left&&e.col<=a.range2.right+1&&(e.col=a.range2.right+2)):(10<\\nMath.abs(m-l.startingY)?l.filltype=\\\"Vertical\\\":10<Math.abs(h-l.startingX)&&(l.filltype=\\\"Horizontal\\\"),e.col=d.col,e.row=d.row),b.coord=SocialCalc.crToCoord(e.col,e.row),b.coord!=g.mouselastcoord&&(a.MoveECell(b.coord),l.filltype?(d=a.range2.right-a.range2.left+e.col,e=a.range2.bottom-a.range2.top+e.row,a.RangeAnchor(SocialCalc.crToCoord(d,e)),a.RangeExtend()):a.RangeRemove())}l.fillinghandle.style.left=h+\\\"px\\\";l.fillinghandle.style.top=m-17+\\\"px\\\";l.fillinghandle.innerHTML=c.s_CHindicatorOperationLookup[l.dragtype]+\\n(c.s_CHindicatorDirectionLookup[a.cellhandles.filltype]||\\\"\\\");l.fillinghandle.style.display=\\\"block\\\";g.mouselastcoord=b.coord;f.stopPropagation?f.stopPropagation():f.cancelBubble=!0;f.preventDefault?f.preventDefault():f.returnValue=!1}}};\\nSocialCalc.CellHandlesDragAutoRepeat=function(a,c){var b=SocialCalc.EditorMouseInfo,d=b.editor;if(d){var e=d.cellhandles,f=SocialCalc.coordToCr(d.cellhandles.startingcoord),g=SocialCalc.coordToCr(a),l,h=0,m=0;\\\"left\\\"==c?m=-1:\\\"right\\\"==c?m=1:\\\"up\\\"==c?h=-1:\\\"down\\\"==c&&(h=1);d.ScrollRelativeBoth(h,m);switch(e.dragtype){case \\\"Fill\\\":case \\\"FillC\\\":e.filltype?\\\"Down\\\"==e.filltype?(g.col=f.col,g.row<f.row&&(g.row=f.row)):(g.row=f.row,g.col<f.col&&(g.col=f.col)):(g.col=f.col,g.row=f.row);l=SocialCalc.crToCoord(g.col,\\ng.row);l!=b.mouselastcoord&&(d.MoveECell(a),d.RangeExtend());break;case \\\"Move\\\":case \\\"MoveC\\\":a!=b.mouselastcoord&&(d.MoveECell(a),e=d.range2.right-d.range2.left+d.ecell.col,g=d.range2.bottom-d.range2.top+d.ecell.row,d.RangeAnchor(SocialCalc.crToCoord(e,g)),d.RangeExtend());break;case \\\"MoveI\\\":case \\\"MoveIC\\\":e.filltype?\\\"Vertical\\\"==e.filltype?(g.col=d.range2.left,g.row>=d.range2.top&&g.row<=d.range2.bottom+1&&(g.row=d.range2.bottom+2)):(g.row=d.range2.top,g.col>=d.range2.left&&g.col<=d.range2.right+1&&\\n(g.col=d.range2.right+2)):(g.col=f.col,g.row=f.row),l=SocialCalc.crToCoord(g.col,g.row),l!=b.mouselastcoord&&(d.MoveECell(l),e=d.range2.right-d.range2.left+g.col,g=d.range2.bottom-d.range2.top+g.row,d.RangeAnchor(SocialCalc.crToCoord(e,g)),d.RangeExtend())}b.mouselastcoord=l}};\\nSocialCalc.CellHandlesMouseUp=function(a){var c,b,d,e,f,g=a||window.event,l=SocialCalc.EditorMouseInfo;if(a=l.editor){var h=a.cellhandles;l.ignore=!1;c=SocialCalc.GetElementPositionWithScroll(a.toplevel);c=SocialCalc.GridMousePosition(a,g.clientX-c.left,g.clientY-c.top);SocialCalc.SetDragAutoRepeat(a,null);h.mouseDown=!1;h.noCursorSuffix=!1;h.fillinghandle.style.display=\\\"none\\\";c||(c={});c.coord||(c.coord=a.ecell.coord);switch(h.dragtype){case \\\"Fill\\\":case \\\"Move\\\":case \\\"MoveI\\\":b=\\\" all\\\";break;case \\\"FillC\\\":case \\\"MoveC\\\":case \\\"MoveIC\\\":b=\\n\\\" formulas\\\"}h.movedmouse||(h.dragtype=\\\"Nothing\\\");switch(h.dragtype){case \\\"Nothing\\\":a.Range2Remove();a.RangeRemove();break;case \\\"Fill\\\":case \\\"FillC\\\":d=SocialCalc.coordToCr(h.startingcoord);e=SocialCalc.coordToCr(c.coord);h.filltype&&(\\\"Down\\\"==h.filltype?e.col=d.col:e.row=d.row);c.coord=SocialCalc.crToCoord(e.col,e.row);a.MoveECell(c.coord);a.RangeExtend();c=\\\"Right\\\"==a.cellhandles.filltype?\\\"right\\\":\\\"down\\\";b=\\\"fill\\\"+c+\\\" \\\"+SocialCalc.crToCoord(a.range.left,a.range.top)+\\\":\\\"+SocialCalc.crToCoord(a.range.right,\\na.range.bottom)+b;a.EditorScheduleSheetCommands(b,!0,!1);break;case \\\"Move\\\":case \\\"MoveC\\\":a.context.cursorsuffix=\\\"\\\";b=\\\"movepaste \\\"+SocialCalc.crToCoord(a.range2.left,a.range2.top)+\\\":\\\"+SocialCalc.crToCoord(a.range2.right,a.range2.bottom)+\\\" \\\"+a.ecell.coord+b;a.EditorScheduleSheetCommands(b,!0,!1);a.Range2Remove();break;case \\\"MoveI\\\":case \\\"MoveIC\\\":a.context.cursorsuffix=\\\"\\\",c=a.range2.right-a.range2.left,d=a.range2.bottom-a.range2.top,e=a.ecell.col-a.range2.left,f=a.ecell.row-a.range2.top,b=\\\"moveinsert \\\"+\\nSocialCalc.crToCoord(a.range2.left,a.range2.top)+\\\":\\\"+SocialCalc.crToCoord(a.range2.right,a.range2.bottom)+\\\" \\\"+a.ecell.coord+b,a.EditorScheduleSheetCommands(b,!0,!1),a.Range2Remove(),a.RangeRemove(),\\\" Horizontal\\\"==a.cellhandles.filltype&&0<e?a.MoveECell(SocialCalc.crToCoord(a.ecell.col-c-1,a.ecell.row)):\\\" Vertical\\\"==a.cellhandles.filltype&&0<f&&a.MoveECell(SocialCalc.crToCoord(a.ecell.col,a.ecell.row-d-1)),a.RangeAnchor(SocialCalc.crToCoord(a.ecell.col+c,a.ecell.row+d)),a.RangeExtend()}g.stopPropagation?\\ng.stopPropagation():g.cancelBubble=!0;g.preventDefault?g.preventDefault():g.returnValue=!1;document.removeEventListener?(document.removeEventListener(\\\"mousemove\\\",SocialCalc.CellHandlesMouseMove,!0),document.removeEventListener(\\\"mouseup\\\",SocialCalc.CellHandlesMouseUp,!0)):h.draghandle.detachEvent&&(h.draghandle.detachEvent(\\\"onlosecapture\\\",SocialCalc.CellHandlesMouseUp),h.draghandle.detachEvent(\\\"onmouseup\\\",SocialCalc.CellHandlesMouseUp),h.draghandle.detachEvent(\\\"onmousemove\\\",SocialCalc.CellHandlesMouseMove),\\nh.draghandle.releaseCapture());l.editor=null;return!1}};\\nSocialCalc.TableControl=function(a,c,b){var d=SocialCalc.Constants;this.editor=a;this.vertical=c;this.size=b;this.thumbpos=this.scrollareasize=this.scrollareaend=this.scrollareastart=this.morebuttonstart=this.lessbuttonstart=this.panesliderstart=this.endcapstart=this.controlborder=this.thumb=this.scrollarea=this.morebutton=this.lessbutton=this.paneslider=this.endcap=this.main=null;this.controlthickness=d.defaultTableControlThickness;this.sliderthickness=d.defaultTCSliderThickness;this.buttonthickness=\\nd.defaultTCButtonThickness;this.thumbthickness=d.defaultTCThumbThickness;this.minscrollingpanesize=this.buttonthickness+this.buttonthickness+this.thumbthickness+20};SocialCalc.TableControl.prototype.CreateTableControl=function(){return SocialCalc.CreateTableControl(this)};SocialCalc.TableControl.prototype.PositionTableControlElements=function(){SocialCalc.PositionTableControlElements(this)};SocialCalc.TableControl.prototype.ComputeTableControlPositions=function(){SocialCalc.ComputeTableControlPositions(this)};\\nSocialCalc.CreateTableControl=function(a){var c,b,d=SocialCalc.AssignID,e=SocialCalc.setStyles,f=SocialCalc.Constants,g=a.editor.imageprefix,l=a.vertical?\\\"v\\\":\\\"h\\\";a.main=document.createElement(\\\"div\\\");c=a.main.style;c.height=(a.vertical?a.size:a.controlthickness)+\\\"px\\\";c.width=(a.vertical?a.controlthickness:a.size)+\\\"px\\\";c.zIndex=0;e(a.main,f.TCmainStyle);c.backgroundImage=TiddlyWiki.getModifiedCssImageStyle(\\\"url(\\\"+g+\\\"main-\\\"+l+\\\".gif)\\\");f.TCmainClass&&(a.main.className=f.TCmainClass);a.main.style.display=\\n\\\"none\\\";a.endcap=document.createElement(\\\"div\\\");c=a.endcap.style;c.height=a.controlthickness+\\\"px\\\";c.width=a.controlthickness+\\\"px\\\";c.zIndex=1;c.overflow=\\\"hidden\\\";c.position=\\\"absolute\\\";e(a.endcap,f.TCendcapStyle);c.backgroundImage=TiddlyWiki.getModifiedCssImageStyle(\\\"url(\\\"+g+\\\"endcap-\\\"+l+\\\".gif)\\\");f.TCendcapClass&&(a.endcap.className=f.TCendcapClass);d(a.editor,a.endcap,\\\"endcap\\\"+l);a.main.appendChild(a.endcap);a.paneslider=document.createElement(\\\"div\\\");c=a.paneslider.style;c.height=(a.vertical?a.sliderthickness:\\na.controlthickness)+\\\"px\\\";c.overflow=\\\"hidden\\\";c.width=(a.vertical?a.controlthickness:a.sliderthickness)+\\\"px\\\";c.position=\\\"absolute\\\";c[a.vertical?\\\"top\\\":\\\"left\\\"]=\\\"4px\\\";c.zIndex=3;e(a.paneslider,f.TCpanesliderStyle);c.backgroundImage=TiddlyWiki.getModifiedCssImageStyle(\\\"url(\\\"+g+\\\"paneslider-\\\"+l+\\\".gif)\\\");f.TCpanesliderClass&&(a.paneslider.className=f.TCpanesliderClass);d(a.editor,a.paneslider,\\\"paneslider\\\"+l);(function(c,b,d){f[\\\"s_\\\"+b+\\\"Tooltip\\\"+d]&&SocialCalc.TooltipRegister(c,f[\\\"s_\\\"+b+\\\"Tooltip\\\"+d],null,a.editor.toplevel)})(a.paneslider,\\n\\\"paneslider\\\",l);c={MouseDown:SocialCalc.TCPSDragFunctionStart,MouseMove:SocialCalc.TCPSDragFunctionMove,MouseUp:SocialCalc.TCPSDragFunctionStop,Disabled:function(){return a.editor.busy}};c.control=a;SocialCalc.DragRegister(a.paneslider,a.vertical,!a.vertical,c,a.editor.toplevel);a.main.appendChild(a.paneslider);a.lessbutton=document.createElement(\\\"div\\\");c=a.lessbutton.style;c.height=(a.vertical?a.buttonthickness:a.controlthickness)+\\\"px\\\";c.width=(a.vertical?a.controlthickness:a.buttonthickness)+\\\"px\\\";\\nc.zIndex=2;c.overflow=\\\"hidden\\\";c.position=\\\"absolute\\\";e(a.lessbutton,f.TClessbuttonStyle);c.backgroundImage=TiddlyWiki.getModifiedCssImageStyle(\\\"url(\\\"+g+\\\"less-\\\"+l+\\\"n.gif)\\\");f.TClessbuttonClass&&(a.lessbutton.className=f.TClessbuttonClass);d(a.editor,a.lessbutton,\\\"lessbutton\\\"+l);b={repeatwait:f.TClessbuttonRepeatWait,repeatinterval:f.TClessbuttonRepeatInterval,normalstyle:\\\"backgroundImage:url(\\\"+g+\\\"less-\\\"+l+\\\"n.gif);\\\",downstyle:\\\"backgroundImage:url(\\\"+g+\\\"less-\\\"+l+\\\"d.gif);\\\",hoverstyle:\\\"backgroundImage:url(\\\"+\\ng+\\\"less-\\\"+l+\\\"h.gif);\\\"};c={MouseDown:function(){a.editor.busy||a.editor.ScrollRelative(a.vertical,-1)},Repeat:function(){a.editor.busy||a.editor.ScrollRelative(a.vertical,-1)},Disabled:function(){return a.editor.busy}};SocialCalc.ButtonRegister(a.editor,a.lessbutton,b,c);a.main.appendChild(a.lessbutton);a.morebutton=document.createElement(\\\"div\\\");c=a.morebutton.style;c.height=(a.vertical?a.buttonthickness:a.controlthickness)+\\\"px\\\";c.width=(a.vertical?a.controlthickness:a.buttonthickness)+\\\"px\\\";c.zIndex=\\n2;c.overflow=\\\"hidden\\\";c.position=\\\"absolute\\\";e(a.morebutton,f.TCmorebuttonStyle);c.backgroundImage=TiddlyWiki.getModifiedCssImageStyle(\\\"url(\\\"+g+\\\"more-\\\"+l+\\\"n.gif)\\\");f.TCmorebuttonClass&&(a.morebutton.className=f.TCmorebuttonClass);d(a.editor,a.morebutton,\\\"morebutton\\\"+l);b={repeatwait:f.TCmorebuttonRepeatWait,repeatinterval:f.TCmorebuttonRepeatInterval,normalstyle:\\\"backgroundImage:url(\\\"+g+\\\"more-\\\"+l+\\\"n.gif);\\\",downstyle:\\\"backgroundImage:url(\\\"+g+\\\"more-\\\"+l+\\\"d.gif);\\\",hoverstyle:\\\"backgroundImage:url(\\\"+g+\\\"more-\\\"+\\nl+\\\"h.gif);\\\"};c={MouseDown:function(){a.editor.busy||a.editor.ScrollRelative(a.vertical,1)},Repeat:function(){a.editor.busy||a.editor.ScrollRelative(a.vertical,1)},Disabled:function(){return a.editor.busy}};SocialCalc.ButtonRegister(a.editor,a.morebutton,b,c);a.main.appendChild(a.morebutton);a.scrollarea=document.createElement(\\\"div\\\");c=a.scrollarea.style;c.height=a.controlthickness+\\\"px\\\";c.width=a.controlthickness+\\\"px\\\";c.zIndex=1;c.overflow=\\\"hidden\\\";c.position=\\\"absolute\\\";e(a.scrollarea,f.TCscrollareaStyle);\\nc.backgroundImage=TiddlyWiki.getModifiedCssImageStyle(\\\"url(\\\"+g+\\\"scrollarea-\\\"+l+\\\".gif)\\\");f.TCscrollareaClass&&(a.scrollarea.className=f.TCscrollareaClass);d(a.editor,a.scrollarea,\\\"scrollarea\\\"+l);b={repeatwait:f.TCscrollareaRepeatWait,repeatinterval:f.TCscrollareaRepeatWait};c={MouseDown:SocialCalc.ScrollAreaClick,Repeat:SocialCalc.ScrollAreaClick,Disabled:function(){return a.editor.busy}};c.control=a;SocialCalc.ButtonRegister(a.editor,a.scrollarea,b,c);a.main.appendChild(a.scrollarea);a.thumb=document.createElement(\\\"div\\\");\\nc=a.thumb.style;c.height=(a.vertical?a.thumbthickness:a.controlthickness)+\\\"px\\\";c.width=(a.vertical?a.controlthickness:a.thumbthickness)+\\\"px\\\";c.zIndex=2;c.overflow=\\\"hidden\\\";c.position=\\\"absolute\\\";e(a.thumb,f.TCthumbStyle);a.thumb.style.backgroundImage=TiddlyWiki.getModifiedCssImageStyle(\\\"url(\\\"+g+\\\"thumb-\\\"+l+\\\"n.gif)\\\");f.TCthumbClass&&(a.thumb.className=f.TCthumbClass);d(a.editor,a.thumb,\\\"thumb\\\"+l);c={MouseDown:SocialCalc.TCTDragFunctionStart,MouseMove:SocialCalc.TCTDragFunctionMove,MouseUp:SocialCalc.TCTDragFunctionStop,\\nDisabled:function(){return a.editor.busy}};c.control=a;SocialCalc.DragRegister(a.thumb,a.vertical,!a.vertical,c,a.editor.toplevel);b={normalstyle:\\\"backgroundImage:url(\\\"+g+\\\"thumb-\\\"+l+\\\"n.gif)\\\",name:\\\"Thumb\\\",downstyle:\\\"backgroundImage:url(\\\"+g+\\\"thumb-\\\"+l+\\\"d.gif)\\\",hoverstyle:\\\"backgroundImage:url(\\\"+g+\\\"thumb-\\\"+l+\\\"h.gif)\\\"};SocialCalc.ButtonRegister(a.editor,a.thumb,b,null);a.main.appendChild(a.thumb);return a.main};\\nSocialCalc.ScrollAreaClick=function(a,c,b){a=b.functionobj.control;b=SocialCalc.GetElementPositionWithScroll(a.editor.toplevel);c=a.vertical?c.clientY-b.top:c.clientX-b.left;a.editor.busy||a.editor.PageRelative(a.vertical,c>a.thumbpos?1:-1)};\\nSocialCalc.PositionTableControlElements=function(a){var c,b,d=a.editor;a.vertical?(c=a.controlborder+\\\"px\\\",a.endcap.style.top=a.endcapstart+\\\"px\\\",a.endcap.style.left=c,a.paneslider.style.top=a.panesliderstart+\\\"px\\\",a.paneslider.style.left=c,a.lessbutton.style.top=a.lessbuttonstart+\\\"px\\\",a.lessbutton.style.left=c,a.morebutton.style.top=a.morebuttonstart+\\\"px\\\",a.morebutton.style.left=c,a.scrollarea.style.top=a.scrollareastart+\\\"px\\\",a.scrollarea.style.left=c,a.scrollarea.style.height=a.scrollareasize+\\\"px\\\",\\nb=Math.max(d.context.sheetobj.attribs.lastrow,d.firstscrollingrow+1),b=(d.firstscrollingrow-(d.lastnonscrollingrow+1))*(a.scrollareasize-3*a.thumbthickness)/(b-(d.lastnonscrollingrow+1))+a.scrollareastart-1,b=Math.floor(b),a.thumb.style.top=b+\\\"px\\\",a.thumb.style.left=c):(c=a.controlborder+\\\"px\\\",a.endcap.style.left=a.endcapstart+\\\"px\\\",a.endcap.style.top=c,a.paneslider.style.left=a.panesliderstart+\\\"px\\\",a.paneslider.style.top=c,a.lessbutton.style.left=a.lessbuttonstart+\\\"px\\\",a.lessbutton.style.top=c,a.morebutton.style.left=\\na.morebuttonstart+\\\"px\\\",a.morebutton.style.top=c,a.scrollarea.style.left=a.scrollareastart+\\\"px\\\",a.scrollarea.style.top=c,a.scrollarea.style.width=a.scrollareasize+\\\"px\\\",b=Math.max(d.context.sheetobj.attribs.lastcol,d.firstscrollingcol+1),b=(d.firstscrollingcol-(d.lastnonscrollingcol+1))*(a.scrollareasize-a.thumbthickness)/(b-d.lastnonscrollingcol)+a.scrollareastart-1,b=Math.floor(b),a.thumb.style.left=b+\\\"px\\\",a.thumb.style.top=c);a.thumbpos=b;a.main.style.display=\\\"block\\\"};\\nSocialCalc.ComputeTableControlPositions=function(a){var c=a.editor;if(!c.gridposition||!c.headposition)throw\\\"Can't compute table control positions before editor positions\\\";a.vertical?(a.controlborder=c.gridposition.left+c.tablewidth,a.endcapstart=c.gridposition.top,a.panesliderstart=c.firstscrollingrowtop-a.sliderthickness,a.lessbuttonstart=c.firstscrollingrowtop-1,a.morebuttonstart=c.gridposition.top+c.tableheight-a.buttonthickness,a.scrollareastart=c.firstscrollingrowtop-1+a.buttonthickness):(a.controlborder=\\nc.gridposition.top+c.tableheight,a.endcapstart=c.gridposition.left,a.panesliderstart=c.firstscrollingcolleft-a.sliderthickness,a.lessbuttonstart=c.firstscrollingcolleft-1,a.morebuttonstart=c.gridposition.left+c.tablewidth-a.buttonthickness,a.scrollareastart=c.firstscrollingcolleft-1+a.buttonthickness);a.scrollareaend=a.morebuttonstart-1;a.scrollareasize=a.scrollareaend-a.scrollareastart+1};\\nSocialCalc.TCPSDragFunctionStart=function(a,c,b){var d=b.functionobj.control.editor,e=SocialCalc.Constants;SocialCalc.DragFunctionStart(a,c,b);c.trackingline=document.createElement(\\\"div\\\");c.trackingline.style.height=b.vertical?e.TCPStrackinglineThickness:d.tableheight-(d.headposition.top-d.gridposition.top)+\\\"px\\\";c.trackingline.style.width=b.vertical?d.tablewidth-(d.headposition.left-d.gridposition.left)+\\\"px\\\":e.TCPStrackinglineThickness;c.trackingline.style.backgroundImage=TiddlyWiki.getModifiedCssImageStyle(\\\"url(\\\"+\\nd.imageprefix+\\\"trackingline-\\\"+(b.vertical?\\\"v\\\":\\\"h\\\")+\\\".gif)\\\");e.TCPStrackinglineClass&&(c.trackingline.className=e.TCPStrackinglineClass);SocialCalc.setStyles(c.trackingline,e.TCPStrackinglineStyle);b.vertical?(row=SocialCalc.Lookup(c.clientY+b.functionobj.control.sliderthickness,d.rowpositions),c.trackingline.style.top=(d.rowpositions[row]||d.headposition.top)+\\\"px\\\",c.trackingline.style.left=d.headposition.left+\\\"px\\\",d.context.rowpanes.length-1&&(d.context.SetRowPaneFirstLast(1,d.context.rowpanes[0].last+\\n1,d.context.rowpanes[0].last+1),d.FitToEditTable(),d.ScheduleRender())):(col=SocialCalc.Lookup(c.clientX+b.functionobj.control.sliderthickness,d.colpositions),c.trackingline.style.top=d.headposition.top+\\\"px\\\",c.trackingline.style.left=(d.colpositions[col]||d.headposition.left)+\\\"px\\\",d.context.colpanes.length-1&&(d.context.SetColPaneFirstLast(1,d.context.colpanes[0].last+1,d.context.colpanes[0].last+1),d.FitToEditTable(),d.ScheduleRender()));d.griddiv.appendChild(c.trackingline)};\\nSocialCalc.TCPSDragFunctionMove=function(a,c,b){var d,e;e=b.functionobj.control;d=e.sliderthickness;var f=e.editor;if(b.vertical){e=e.morebuttonstart-e.minscrollingpanesize-c.offsetY;c.clientY>e&&(c.clientY=e);e=f.headposition.top-d-c.offsetY;c.clientY<e&&(c.clientY=e);for(d=SocialCalc.Lookup(c.clientY+d,f.rowpositions);\\\"yes\\\"==f.context.sheetobj.rowattribs.hide[d];)d++;c.trackingline.style.top=(f.rowpositions[d]||f.headposition.top)+\\\"px\\\"}else{e=e.morebuttonstart-e.minscrollingpanesize-c.offsetX;c.clientX>\\ne&&(c.clientX=e);e=f.headposition.left-d-c.offsetX;c.clientX<e&&(c.clientX=e);for(d=SocialCalc.Lookup(c.clientX+d,f.colpositions);\\\"yes\\\"==f.context.sheetobj.colattribs.hide[SocialCalc.rcColname(d)];)d++;c.trackingline.style.left=(f.colpositions[d]||f.headposition.left)+\\\"px\\\"}SocialCalc.DragFunctionPosition(a,c,b)};\\nSocialCalc.TCPSDragFunctionStop=function(a,c,b){var d,e=b.functionobj.control;d=e.sliderthickness;a=e.editor;if(b.vertical){b=e.morebuttonstart-e.minscrollingpanesize-c.offsetY;c.clientY>b&&(c.clientY=b);b=a.headposition.top-d-c.offsetY;c.clientY<b&&(c.clientY=b);d=SocialCalc.Lookup(c.clientY+d,a.rowpositions);d>a.context.sheetobj.attribs.lastrow&&(d=a.context.sheetobj.attribs.lastrow);for(;\\\"yes\\\"==a.context.sheetobj.rowattribs.hide[d];)d++;!d||d<=a.context.rowpanes[0].first?1<a.context.rowpanes.length&&\\n(a.context.rowpanes.length=1):a.context.rowpanes.length-1?a.timeout||(a.context.SetRowPaneFirstLast(0,a.context.rowpanes[0].first,d-1),a.context.SetRowPaneFirstLast(1,d,d)):(a.context.SetRowPaneFirstLast(0,a.context.rowpanes[0].first,d-1),a.context.SetRowPaneFirstLast(1,d,d))}else{b=e.morebuttonstart-e.minscrollingpanesize-c.offsetX;c.clientX>b&&(c.clientX=b);b=a.headposition.left-d-c.offsetX;c.clientX<b&&(c.clientX=b);d=SocialCalc.Lookup(c.clientX+d,a.colpositions);d>a.context.sheetobj.attribs.lastcol&&\\n(d=a.context.sheetobj.attribs.lastcol);for(;\\\"yes\\\"==a.context.sheetobj.colattribs.hide[SocialCalc.rcColname(d)];)d++;!d||d<=a.context.colpanes[0].first?1<a.context.colpanes.length&&(a.context.colpanes.length=1):a.context.colpanes.length-1?a.timeout||(a.context.SetColPaneFirstLast(0,a.context.colpanes[0].first,d-1),a.context.SetColPaneFirstLast(1,d,d)):(a.context.SetColPaneFirstLast(0,a.context.colpanes[0].first,d-1),a.context.SetColPaneFirstLast(1,d,d))}a.FitToEditTable();a.griddiv.removeChild(c.trackingline);\\na.ScheduleRender()};\\nSocialCalc.TCTDragFunctionStart=function(a,c,b){var d=b.functionobj.control,e=d.editor,f=SocialCalc.Constants;SocialCalc.DragFunctionStart(a,c,b);c.thumbstatus&&(c.thumbstatus.rowmsgele&&(c.thumbstatus.rowmsgele=null),c.thumbstatus.rowpreviewele&&(c.thumbstatus.rowpreviewele=null),e.toplevel.removeChild(c.thumbstatus),c.thumbstatus=null);c.thumbstatus=document.createElement(\\\"div\\\");b.vertical?(f.TCTDFSthumbstatusvClass&&(c.thumbstatus.className=f.TCTDFSthumbstatusvClass),SocialCalc.setStyles(c.thumbstatus,f.TCTDFSthumbstatusvStyle),\\nc.thumbstatus.style.top=c.clientY+f.TCTDFStopOffsetv+\\\"px\\\",c.thumbstatus.style.left=d.controlborder-10-e.tablewidth/2+\\\"px\\\",c.thumbstatus.style.width=e.tablewidth/2+\\\"px\\\",c.thumbcontext=new SocialCalc.RenderContext(e.context.sheetobj),c.thumbcontext.showGrid=!0,c.thumbcontext.rowpanes=[{first:1,last:1}],a=e.context.colpanes[e.context.colpanes.length-1],c.thumbcontext.colpanes=[{first:a.first,last:a.last}],c.thumbstatus.innerHTML='<table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"><tr><td valign=\\\"top\\\" style=\\\"'+f.TCTDFSthumbstatusrownumStyle+\\n'\\\" class=\\\"'+f.TCTDFSthumbstatusrownumClass+'\\\"><div>msg</div></td><td valign=\\\"top\\\"><div style=\\\"overflow:hidden;\\\">preview</div></td></tr></table>',c.thumbstatus.rowmsgele=c.thumbstatus.firstChild.firstChild.firstChild.firstChild.firstChild,c.thumbstatus.rowpreviewele=c.thumbstatus.firstChild.firstChild.firstChild.childNodes[1].firstChild,e.toplevel.appendChild(c.thumbstatus),SocialCalc.TCTDragFunctionRowSetStatus(c,e,e.firstscrollingrow||1)):(f.TCTDFSthumbstatushClass&&(c.thumbstatus.className=f.TCTDFSthumbstatushClass),\\nSocialCalc.setStyles(c.thumbstatus,f.TCTDFSthumbstatushStyle),c.thumbstatus.style.top=d.controlborder+f.TCTDFStopOffseth+\\\"px\\\",c.thumbstatus.style.left=c.clientX+f.TCTDFSleftOffseth+\\\"px\\\",e.toplevel.appendChild(c.thumbstatus),c.thumbstatus.innerHTML=f.s_TCTDFthumbstatusPrefixh+SocialCalc.rcColname(e.firstscrollingcol))};\\nSocialCalc.TCTDragFunctionRowSetStatus=function(a,c,b){a.thumbstatus.rowmsgele.innerHTML=SocialCalc.Constants.s_TCTDFthumbstatusPrefixv+b+\\\" \\\";a.thumbcontext.rowpanes=[{first:b,last:b}];a.thumbrowshown=b;a.thumbcontext.RenderSheet(a.thumbstatus.rowpreviewele.firstChild,{type:\\\"html\\\"})};\\nSocialCalc.TCTDragFunctionMove=function(a,c,b){var d,e;d=b.functionobj.control;e=d.editor;var f=SocialCalc.Constants;b.vertical?(c.clientY>d.scrollareaend-c.offsetY-d.thumbthickness+2&&(c.clientY=d.scrollareaend-c.offsetY-d.thumbthickness+2),c.clientY<d.scrollareastart-c.offsetY-1&&(c.clientY=d.scrollareastart-c.offsetY-1),c.thumbstatus.style.top=c.clientY+\\\"px\\\",d=(c.clientY+c.offsetY-d.scrollareastart+1)/(d.scrollareasize-d.thumbthickness)*(e.context.sheetobj.attribs.lastrow-e.lastnonscrollingrow)+\\ne.lastnonscrollingrow+1,d=Math.floor(d),d<=e.lastnonscrollingrow&&(d=e.lastnonscrollingrow+1),d>e.context.sheetobj.attribs.lastrow&&(d=e.context.sheetobj.attribs.lastrow),d!=c.thumbrowshown&&SocialCalc.TCTDragFunctionRowSetStatus(c,e,d)):(c.clientX>d.scrollareaend-c.offsetX-d.thumbthickness+2&&(c.clientX=d.scrollareaend-c.offsetX-d.thumbthickness+2),c.clientX<d.scrollareastart-c.offsetX-1&&(c.clientX=d.scrollareastart-c.offsetX-1),c.thumbstatus.style.left=c.clientX+\\\"px\\\",d=(c.clientX+c.offsetX-d.scrollareastart+\\n1)/(d.scrollareasize-d.thumbthickness)*(e.context.sheetobj.attribs.lastcol-e.lastnonscrollingcol)+e.lastnonscrollingcol+1,d=Math.floor(d),d<=e.lastnonscrollingcol&&(d=e.lastnonscrollingcol+1),d>e.context.sheetobj.attribs.lastcol&&(d=e.context.sheetobj.attribs.lastcol),e=f.s_TCTDFthumbstatusPrefixh+SocialCalc.rcColname(d),c.thumbstatus.innerHTML=e);SocialCalc.DragFunctionPosition(a,c,b)};\\nSocialCalc.TCTDragFunctionStop=function(a,c,b){var d=b.functionobj.control;a=d.editor;b.vertical?(b=(c.clientY+c.offsetY-d.scrollareastart+1)/(d.scrollareasize-d.thumbthickness)*(a.context.sheetobj.attribs.lastrow-a.lastnonscrollingrow)+a.lastnonscrollingrow+1,b=Math.floor(b),b<=a.lastnonscrollingrow&&(b=a.lastnonscrollingrow+1),b>a.context.sheetobj.attribs.lastrow&&(b=a.context.sheetobj.attribs.lastrow),a.context.SetRowPaneFirstLast(a.context.rowpanes.length-1,b,b+1)):(b=(c.clientX+c.offsetX-d.scrollareastart+\\n1)/(d.scrollareasize-d.thumbthickness)*(a.context.sheetobj.attribs.lastcol-a.lastnonscrollingcol)+a.lastnonscrollingcol+1,b=Math.floor(b),b<=a.lastnonscrollingcol&&(b=a.lastnonscrollingcol+1),b>a.context.sheetobj.attribs.lastcol&&(b=a.context.sheetobj.attribs.lastcol),a.context.SetColPaneFirstLast(a.context.colpanes.length-1,b,b+1));a.FitToEditTable();c.thumbstatus.rowmsgele&&(c.thumbstatus.rowmsgele=null);c.thumbstatus.rowpreviewele&&(c.thumbstatus.rowpreviewele=null);a.toplevel.removeChild(c.thumbstatus);\\nc.thumbstatus=null;a.ScheduleRender()};SocialCalc.DragInfo={registeredElements:[],draggingElement:null,startX:0,startY:0,startZ:0,clientX:0,clientY:0,offsetX:0,offsetY:0,relativeOffset:{left:0,top:0}};\\nSocialCalc.DragRegister=function(a,c,b,d,e){var f=SocialCalc.DragInfo;d||(d={MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null});f.registeredElements.push({element:a,vertical:c,horizontal:b,functionobj:d,parent:e});if(a.addEventListener)a.addEventListener(\\\"mousedown\\\",SocialCalc.DragMouseDown,!1);else if(a.attachEvent)a.attachEvent(\\\"onmousedown\\\",SocialCalc.DragMouseDown);else throw SocialCalc.Constants.s_BrowserNotSupported;\\n};SocialCalc.DragUnregister=function(a){var c=SocialCalc.DragInfo,b;if(a)for(b=0;b<c.registeredElements.length;b++)if(c.registeredElements[b].element==a){c.registeredElements.splice(b,1);a.removeEventListener?a.removeEventListener(\\\"mousedown\\\",SocialCalc.DragMouseDown,!1):a.detachEvent(\\\"onmousedown\\\",SocialCalc.DragMouseDown);break}};\\nSocialCalc.DragMouseDown=function(a){a=a||window.event;var c=SocialCalc.DragInfo,b=SocialCalc.LookupElement(a.target||a.srcElement,c.registeredElements);if(b&&!(b&&b.functionobj&&b.functionobj.Disabled&&b.functionobj.Disabled(a,c,b)))return c.draggingElement=b,b.parent&&(c.relativeOffset=SocialCalc.GetElementPositionWithScroll(b.parent)),c.clientX=a.clientX-c.relativeOffset.left,c.clientY=a.clientY-c.relativeOffset.top,c.startX=c.clientX,c.startY=c.clientY,c.startZ=b.element.style.zIndex,c.offsetX=\\n0,c.offsetY=0,b.element.style.zIndex=\\\"100\\\",document.addEventListener?(document.addEventListener(\\\"mousemove\\\",SocialCalc.DragMouseMove,!0),document.addEventListener(\\\"mouseup\\\",SocialCalc.DragMouseUp,!0)):b.element.attachEvent&&(b.element.setCapture(),b.element.attachEvent(\\\"onmousemove\\\",SocialCalc.DragMouseMove),b.element.attachEvent(\\\"onmouseup\\\",SocialCalc.DragMouseUp),b.element.attachEvent(\\\"onlosecapture\\\",SocialCalc.DragMouseUp)),a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,a.preventDefault?\\na.preventDefault():a.returnValue=!1,b&&b.functionobj&&b.functionobj.MouseDown&&b.functionobj.MouseDown(a,c,b),!1};SocialCalc.DragMouseMove=function(a){a=a||window.event;var c=SocialCalc.DragInfo,b=c.draggingElement;c.clientX=a.clientX-c.relativeOffset.left;c.clientY=a.clientY-c.relativeOffset.top;a.stopPropagation?a.stopPropagation():a.cancelBubble=!0;b&&b.functionobj&&b.functionobj.MouseMove&&b.functionobj.MouseMove(a,c,b);return!1};\\nSocialCalc.DragMouseUp=function(a){a=a||window.event;var c=SocialCalc.DragInfo,b=c.draggingElement;c.clientX=a.clientX-c.relativeOffset.left;c.clientY=a.clientY-c.relativeOffset.top;b.element.style.zIndex=c.startZ;b&&b.functionobj&&b.functionobj.MouseUp&&b.functionobj.MouseUp(a,c,b);a.stopPropagation?a.stopPropagation():a.cancelBubble=!0;document.removeEventListener?(document.removeEventListener(\\\"mousemove\\\",SocialCalc.DragMouseMove,!0),document.removeEventListener(\\\"mouseup\\\",SocialCalc.DragMouseUp,\\n!0)):b.element.detachEvent&&(b.element.detachEvent(\\\"onlosecapture\\\",SocialCalc.DragMouseUp),b.element.detachEvent(\\\"onmouseup\\\",SocialCalc.DragMouseUp),b.element.detachEvent(\\\"onmousemove\\\",SocialCalc.DragMouseMove),b.element.releaseCapture());c.draggingElement=null;return!1};SocialCalc.DragFunctionStart=function(a,c,b){a=b.functionobj.positionobj||b.element;c.offsetY=parseInt(a.style.top)-c.clientY;c.offsetX=parseInt(a.style.left)-c.clientX};\\nSocialCalc.DragFunctionPosition=function(a,c,b){a=b.functionobj.positionobj||b.element;b.vertical&&(a.style.top=c.clientY+c.offsetY+\\\"px\\\");b.horizontal&&(a.style.left=c.clientX+c.offsetX+\\\"px\\\")};SocialCalc.TooltipInfo={registeredElements:[],registered:!1,tooltipElement:null,timer:null,popupElement:null,clientX:0,clientY:0,offsetX:SocialCalc.Constants.TooltipOffsetX,offsetY:SocialCalc.Constants.TooltipOffsetY};\\nSocialCalc.TooltipRegister=function(a,c,b,d){var e=SocialCalc.TooltipInfo;e.registeredElements.push({element:a,tiptext:c,functionobj:b,parent:d});if(!e.registered){if(document.addEventListener)document.addEventListener(\\\"mousemove\\\",SocialCalc.TooltipMouseMove,!1);else if(document.attachEvent)document.attachEvent(\\\"onmousemove\\\",SocialCalc.TooltipMouseMove);else throw SocialCalc.Constants.s_BrowserNotSupported;e.registered=!0}};\\nSocialCalc.TooltipMouseMove=function(a){var c=a||window.event;a=SocialCalc.TooltipInfo;a.clientX=c.clientX;a.clientY=c.clientY;c=SocialCalc.LookupElement(c.target||c.srcElement,a.registeredElements);a.timer&&(window.clearTimeout(a.timer),a.timer=null);a.popupElement&&SocialCalc.TooltipHide();a.tooltipElement=c||null;c&&!SocialCalc.ButtonInfo.buttonDown&&(a.timer=window.setTimeout(SocialCalc.TooltipWaitDone,700),a.tooltipElement.element.addEventListener?a.tooltipElement.element.addEventListener(\\\"mousedown\\\",\\nSocialCalc.TooltipMouseDown,!1):a.tooltipElement.element.attachEvent&&a.tooltipElement.element.attachEvent(\\\"onmousedown\\\",SocialCalc.TooltipMouseDown))};\\nSocialCalc.TooltipMouseDown=function(a){a=SocialCalc.TooltipInfo;a.timer&&(window.clearTimeout(a.timer),a.timer=null);a.popupElement&&SocialCalc.TooltipHide();a.tooltipElement&&(a.tooltipElement.element.removeEventListener?a.tooltipElement.element.removeEventListener(\\\"mousedown\\\",SocialCalc.TooltipMouseDown,!1):a.tooltipElement.element.attachEvent&&a.tooltipElement.element.detachEvent(\\\"onmousedown\\\",SocialCalc.TooltipMouseDown),a.tooltipElement=null)};\\nSocialCalc.TooltipDisplay=function(a){var c=SocialCalc.TooltipInfo,b=SocialCalc.Constants,d=a.functionobj&&\\\"number\\\"==typeof a.functionobj.offsetx?a.functionobj.offsetx:c.offsetX,e=a.functionobj&&\\\"number\\\"==typeof a.functionobj.offsety?a.functionobj.offsety:c.offsetY,f=SocialCalc.GetViewportInfo(),g=SocialCalc.GetElementPositionWithScroll(a.parent);c.popupElement=document.createElement(\\\"div\\\");b.TDpopupElementClass&&(c.popupElement.className=b.TDpopupElementClass);SocialCalc.setStyles(c.popupElement,\\nb.TDpopupElementStyle);c.popupElement.innerHTML=a.tiptext;c.clientX>f.width/2?(c.popupElement.style.bottom=g.height-c.clientY+e+g.top+\\\"px\\\",c.popupElement.style.right=g.width-c.clientX+d+g.left+\\\"px\\\"):(c.popupElement.style.bottom=g.height-c.clientY+e+g.top+\\\"px\\\",c.popupElement.style.left=c.clientX+d-g.left+\\\"px\\\");50>c.clientY&&(c.popupElement.style.bottom=g.height-c.clientY+e-50+g.top+\\\"px\\\");a.parent.appendChild(c.popupElement)};\\nSocialCalc.TooltipHide=function(){var a=SocialCalc.TooltipInfo;a.popupElement&&(a.popupElement.parentNode.removeChild(a.popupElement),a.popupElement=null)};SocialCalc.TooltipWaitDone=function(){var a=SocialCalc.TooltipInfo;a.timer=null;SocialCalc.TooltipDisplay(a.tooltipElement)};SocialCalc.ButtonInfo={registeredElements:[],buttonElement:null,doingHover:!1,buttonDown:!1,timer:null,relativeOffset:null,clientX:0,clientY:0};\\nSocialCalc.ButtonRegister=function(a,c,b,d){var e=SocialCalc.ButtonInfo;b||(b={});e.registeredElements.push({name:b.name,element:c,editor:a,normalstyle:b.normalstyle,hoverstyle:b.hoverstyle,downstyle:b.downstyle,repeatwait:b.repeatwait,repeatinterval:b.repeatinterval,functionobj:d});if(c.addEventListener)c.addEventListener(\\\"mousedown\\\",SocialCalc.ButtonMouseDown,!1),c.addEventListener(\\\"mouseover\\\",SocialCalc.ButtonMouseOver,!1),c.addEventListener(\\\"mouseout\\\",SocialCalc.ButtonMouseOut,!1);else if(c.attachEvent)c.attachEvent(\\\"onmousedown\\\",\\nSocialCalc.ButtonMouseDown),c.attachEvent(\\\"onmouseover\\\",SocialCalc.ButtonMouseOver),c.attachEvent(\\\"onmouseout\\\",SocialCalc.ButtonMouseOut);else throw SocialCalc.Constants.s_BrowserNotSupported;};\\nSocialCalc.ButtonMouseOver=function(a){a=a||window.event;var c=SocialCalc.ButtonInfo,b=SocialCalc.LookupElement(a.target||a.srcElement,c.registeredElements);b&&(c.buttonDown?c.buttonElement==b&&(c.doingHover=!0):(c.buttonElement&&c.buttonElement!=b&&c.doingHover&&SocialCalc.setStyles(c.buttonElement.element,c.buttonElement.normalstyle),c.buttonElement=b,c.doingHover=!0,SocialCalc.setStyles(b.element,b.hoverstyle),b&&b.functionobj&&b.functionobj.MouseOver&&b.functionobj.MouseOver(a,c,b)))};\\nSocialCalc.ButtonMouseOut=function(a){a=a||window.event;var c=SocialCalc.ButtonInfo;if(c.buttonDown)c.doingHover=!1;else{var b=SocialCalc.LookupElement(a.target||a.srcElement,c.registeredElements);c.doingHover&&(c.buttonElement&&SocialCalc.setStyles(c.buttonElement.element,c.buttonElement.normalstyle),c.buttonElement=null,c.doingHover=!1);b&&b.functionobj&&b.functionobj.MouseOut&&b.functionobj.MouseOut(a,c,b)}};\\nSocialCalc.ButtonMouseDown=function(a){a=a||window.event;var c=SocialCalc.ButtonInfo;SocialCalc.GetViewportInfo();var b=SocialCalc.LookupElement(a.target||a.srcElement,c.registeredElements);!b||b&&b.functionobj&&b.functionobj.Disabled&&b.functionobj.Disabled(a,c,b)||(c.buttonElement=b,c.buttonDown=!0,SocialCalc.setStyles(b.element,c.buttonElement.downstyle),document.addEventListener?document.addEventListener(\\\"mouseup\\\",SocialCalc.ButtonMouseUp,!0):b.element.attachEvent&&(b.element.setCapture(),b.element.attachEvent(\\\"onmouseup\\\",\\nSocialCalc.ButtonMouseUp),b.element.attachEvent(\\\"onlosecapture\\\",SocialCalc.ButtonMouseUp)),a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,a.preventDefault?a.preventDefault():a.returnValue=!1,c.relativeOffset=SocialCalc.GetElementPositionWithScroll(b.editor.toplevel),c.clientX=a.clientX-c.relativeOffset.left,c.clientY=a.clientY-c.relativeOffset.top,b&&b.functionobj&&b.functionobj.MouseDown&&b.functionobj.MouseDown(a,c,b),b.repeatwait&&(c.timer=window.setTimeout(SocialCalc.ButtonRepeat,b.repeatwait)))};\\nSocialCalc.ButtonMouseUp=function(a){a=a||window.event;var c=SocialCalc.ButtonInfo,b=c.buttonElement;c.timer&&(window.clearTimeout(c.timer),c.timer=null);c.buttonDown&&(a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,a.preventDefault?a.preventDefault():a.returnValue=!1,document.removeEventListener?document.removeEventListener(\\\"mouseup\\\",SocialCalc.ButtonMouseUp,!0):document.detachEvent&&(b.element.detachEvent(\\\"onlosecapture\\\",SocialCalc.ButtonMouseUp),b.element.detachEvent(\\\"onmouseup\\\",SocialCalc.ButtonMouseUp),\\nb.element.releaseCapture()),c.buttonElement.downstyle&&(c.doingHover?SocialCalc.setStyles(b.element,c.buttonElement.hoverstyle):SocialCalc.setStyles(b.element,c.buttonElement.normalstyle)),c.buttonDown=!1,b&&b.functionobj&&b.functionobj.MouseUp&&b.functionobj.MouseUp(a,c,b))};\\nSocialCalc.ButtonRepeat=function(){var a=SocialCalc.ButtonInfo,c=a.buttonElement;c&&(c&&c.functionobj&&c.functionobj.Repeat&&c.functionobj.Repeat(null,a,c),a.timer=window.setTimeout(SocialCalc.ButtonRepeat,c.repeatinterval||100))};SocialCalc.MouseWheelInfo={registeredElements:[]};\\nSocialCalc.MouseWheelRegister=function(a,c){SocialCalc.MouseWheelInfo.registeredElements.push({element:a,functionobj:c});if(a.addEventListener)a.addEventListener(\\\"DOMMouseScroll\\\",SocialCalc.ProcessMouseWheel,!1),a.addEventListener(\\\"mousewheel\\\",SocialCalc.ProcessMouseWheel,!1);else if(a.attachEvent)a.attachEvent(\\\"onmousewheel\\\",SocialCalc.ProcessMouseWheel);else throw SocialCalc.Constants.s_BrowserNotSupported;};\\nSocialCalc.ProcessMouseWheel=function(a){a=a||window.event;var c;if(!SocialCalc.GetSpreadsheetControlObject().keyboard.passThru){var b=SocialCalc.MouseWheelInfo;c=a.target||a.srcElement;var d;for(d=null;!d&&c;c=c.parentNode)d=SocialCalc.LookupElement(c,b.registeredElements);d&&((c=a.wheelDelta?a.wheelDelta/120:-a.detail/3)||(c=0),d.functionobj&&d.functionobj.WheelMove&&d.functionobj.WheelMove(a,c,b,d),a.preventDefault&&a.preventDefault(),a.returnValue=!1)}};\\nSocialCalc.keyboardTables={specialKeysCommon:{8:\\\"[backspace]\\\",9:\\\"[tab]\\\",13:\\\"[enter]\\\",25:\\\"[tab]\\\",27:\\\"[esc]\\\",33:\\\"[pgup]\\\",34:\\\"[pgdn]\\\",35:\\\"[end]\\\",36:\\\"[home]\\\",37:\\\"[aleft]\\\",38:\\\"[aup]\\\",39:\\\"[aright]\\\",40:\\\"[adown]\\\",45:\\\"[ins]\\\",46:\\\"[del]\\\",113:\\\"[f2]\\\"},specialKeysIE:{8:\\\"[backspace]\\\",9:\\\"[tab]\\\",13:\\\"[enter]\\\",25:\\\"[tab]\\\",27:\\\"[esc]\\\",33:\\\"[pgup]\\\",34:\\\"[pgdn]\\\",35:\\\"[end]\\\",36:\\\"[home]\\\",37:\\\"[aleft]\\\",38:\\\"[aup]\\\",39:\\\"[aright]\\\",40:\\\"[adown]\\\",45:\\\"[ins]\\\",46:\\\"[del]\\\",113:\\\"[f2]\\\"},controlKeysIE:{67:\\\"[ctrl-c]\\\",83:\\\"[ctrl-s]\\\",86:\\\"[ctrl-v]\\\",\\n88:\\\"[ctrl-x]\\\",90:\\\"[ctrl-z]\\\"},specialKeysOpera:{8:\\\"[backspace]\\\",9:\\\"[tab]\\\",13:\\\"[enter]\\\",25:\\\"[tab]\\\",27:\\\"[esc]\\\",33:\\\"[pgup]\\\",34:\\\"[pgdn]\\\",35:\\\"[end]\\\",36:\\\"[home]\\\",37:\\\"[aleft]\\\",38:\\\"[aup]\\\",39:\\\"[aright]\\\",40:\\\"[adown]\\\",45:\\\"[ins]\\\",46:\\\"[del]\\\",113:\\\"[f2]\\\"},controlKeysOpera:{67:\\\"[ctrl-c]\\\",83:\\\"[ctrl-s]\\\",86:\\\"[ctrl-v]\\\",88:\\\"[ctrl-x]\\\",90:\\\"[ctrl-z]\\\"},specialKeysSafari:{8:\\\"[backspace]\\\",9:\\\"[tab]\\\",13:\\\"[enter]\\\",25:\\\"[tab]\\\",27:\\\"[esc]\\\",63232:\\\"[aup]\\\",63233:\\\"[adown]\\\",63234:\\\"[aleft]\\\",63235:\\\"[aright]\\\",63272:\\\"[del]\\\",63273:\\\"[home]\\\",\\n63275:\\\"[end]\\\",63276:\\\"[pgup]\\\",63277:\\\"[pgdn]\\\",63237:\\\"[f2]\\\"},controlKeysSafari:{99:\\\"[ctrl-c]\\\",115:\\\"[ctrl-s]\\\",118:\\\"[ctrl-v]\\\",120:\\\"[ctrl-x]\\\",122:\\\"[ctrl-z]\\\"},ignoreKeysSafari:{63236:\\\"[f1]\\\",63238:\\\"[f3]\\\",63239:\\\"[f4]\\\",63240:\\\"[f5]\\\",63241:\\\"[f6]\\\",63242:\\\"[f7]\\\",63243:\\\"[f8]\\\",63244:\\\"[f9]\\\",63245:\\\"[f10]\\\",63246:\\\"[f11]\\\",63247:\\\"[f12]\\\",63289:\\\"[numlock]\\\"},specialKeysFirefox:{8:\\\"[backspace]\\\",9:\\\"[tab]\\\",13:\\\"[enter]\\\",25:\\\"[tab]\\\",27:\\\"[esc]\\\",33:\\\"[pgup]\\\",34:\\\"[pgdn]\\\",35:\\\"[end]\\\",36:\\\"[home]\\\",37:\\\"[aleft]\\\",38:\\\"[aup]\\\",39:\\\"[aright]\\\",\\n40:\\\"[adown]\\\",45:\\\"[ins]\\\",46:\\\"[del]\\\",113:\\\"[f2]\\\"},controlKeysFirefox:{99:\\\"[ctrl-c]\\\",115:\\\"[ctrl-s]\\\",118:\\\"[ctrl-v]\\\",120:\\\"[ctrl-x]\\\",122:\\\"[ctrl-z]\\\"},ignoreKeysFirefox:{16:\\\"[shift]\\\",17:\\\"[ctrl]\\\",18:\\\"[alt]\\\",20:\\\"[capslock]\\\",19:\\\"[pause]\\\",44:\\\"[printscreen]\\\",91:\\\"[windows]\\\",92:\\\"[windows]\\\",112:\\\"[f1]\\\",114:\\\"[f3]\\\",115:\\\"[f4]\\\",116:\\\"[f5]\\\",117:\\\"[f6]\\\",118:\\\"[f7]\\\",119:\\\"[f8]\\\",120:\\\"[f9]\\\",121:\\\"[f10]\\\",122:\\\"[f11]\\\",123:\\\"[f12]\\\",144:\\\"[numlock]\\\",145:\\\"[scrolllock]\\\",224:\\\"[cmd]\\\"}};SocialCalc.Constants.AllowCtrlS=!0;\\nSocialCalc.Constants.AllowCtrlJ=!0;SocialCalc.keyboardTables.controlKeysIE[74]=\\\"[ctrl-j]\\\";SocialCalc.keyboardTables.controlKeysOpera[74]=\\\"[ctrl-j]\\\";SocialCalc.keyboardTables.controlKeysSafari[106]=\\\"[ctrl-j]\\\";SocialCalc.keyboardTables.controlKeysFirefox[106]=\\\"[ctrl-j]\\\";\\nSocialCalc.KeyboardSetFocus=function(a){hack.log(\\\"\\\",hack.keyboard,\\\"SocialCalc.KeyboardSetFocus\\\");var c=SocialCalc.GetSpreadsheetControlObject();c.keyboard.focusTable=a;c.keyboard.areListener||(TiddlyWiki?(hack.log(\\\"add event listener: keydown, keypress, focus\\\",hack.keyboard,\\\"SocialCalc.KeyboardSetFocus\\\"),c.spreadsheetDiv.addEventListener(\\\"keydown\\\",SocialCalc.ProcessKeyDown,!1),c.spreadsheetDiv.addEventListener(\\\"keypress\\\",SocialCalc.ProcessKeyPress,!1),c.spreadsheetDiv.addEventListener(\\\"focus\\\",function(a){c.tiddlyWiki.inputboxHasKeyboard=\\n!1},!1),c.tiddlyWiki.flagView||(c.editor.inputBox.element.addEventListener(\\\"focus\\\",function(a){c.tiddlyWiki.inputboxHasKeyboard=!0},!1),c.editor.inputBox.element.addEventListener(\\\"blur\\\",function(a){c.spreadsheetDiv.focus()},!1))):(document.onkeydown=SocialCalc.ProcessKeyDown,document.onkeypress=SocialCalc.ProcessKeyPress),c.keyboard.areListener=!0);c.keyboard.passThru&&(c.keyboard.passThru.blur&&c.keyboard.passThru.blur(),c.keyboard.passThru=null);TiddlyWiki?(hack.log(\\\"spreadsheet.spreadsheetDiv: take focus\\\",\\nhack.keyboard,\\\"SocialCalc.KeyboardSetFocus\\\"),c.spreadsheetDiv.focus()):window.focus()};SocialCalc.KeyboardFocus=function(){hack.log(\\\"\\\",hack.keyboard,\\\"SocialCalc.KeyboardFocus\\\");var a=SocialCalc.GetSpreadsheetControlObject();a.keyboard.passThru=null;TiddlyWiki?a.spreadsheetDiv.focus():window.focus()};\\nSocialCalc.ProcessKeyDown=function(a){hack.log(\\\"\\\",hack.keyboard,\\\"SocialCalc.ProcessKeyDown\\\");var c=SocialCalc.GetSpreadsheetControlObject(),b=SocialCalc.keyboardTables;b.didProcessKey=!1;b.statusFromProcessKey=!1;b.repeatingKeyPress=!1;var d=\\\"\\\",e=!0;if(!c.keyboard.passThru){a=a||window.event;if(void 0==a.which){d=b.specialKeysCommon[a.keyCode];if(!d&&(a.ctrlKey&&(d=b.controlKeysIE[a.keyCode]),!d))return!0;e=SocialCalc.ProcessKey(d,a);e||(a.preventDefault?a.preventDefault():a.returnValue=!1)}else{d=\\nb.specialKeysCommon[a.keyCode];if(!d){if(a.ctrlKey||a.metaKey)d=b.controlKeysIE[a.keyCode];if(!d)return!0}e=SocialCalc.ProcessKey(d,a);b.didProcessKey=!0;b.statusFromProcessKey=e;b.chForProcessKey=d}TiddlyWiki&&!c.tiddlyWiki.inputboxHasKeyboard&&(a.preventDefault?a.preventDefault():a.returnValue=!1);return e}};\\nSocialCalc.ProcessKeyPress=function(a){var c=SocialCalc.GetSpreadsheetControlObject(),b=SocialCalc.keyboardTables,d=\\\"\\\";a=a||window.event;if(!c.keyboard.passThru){if(b.didProcessKey){if(b.repeatingKeyPress)return SocialCalc.ProcessKey(b.chForProcessKey,a);b.repeatingKeyPress=!0;return b.statusFromProcessKey}if(void 0==a.which)d=String.fromCharCode(a.keyCode);else{if(!a.which)return!1;if(void 0==a.charCode)if(0!=a.which)if(32>a.which||144==a.which){if(d=b.specialKeysOpera[a.which])return!0}else d=a.ctrlKey?\\nb.controlKeysOpera[a.keyCode]:String.fromCharCode(a.which);else return!0;else{if(0==a.keyCode&&0==a.charCode)return;if(a.keyCode==a.charCode){if(d=b.specialKeysSafari[a.keyCode],!d){if(b.ignoreKeysSafari[a.keyCode])return!0;d=a.metaKey?b.controlKeysSafari[a.keyCode]:String.fromCharCode(a.which)}}else{if(b.specialKeysFirefox[a.keyCode])return!0;d=String.fromCharCode(a.which);if(a.ctrlKey||a.metaKey)d=b.controlKeysFirefox[a.which]}}}c=SocialCalc.ProcessKey(d,a);c||(a.preventDefault?a.preventDefault():\\na.returnValue=!1);return c}};SocialCalc.ProcessKey=function(a,c){var b=SocialCalc.GetSpreadsheetControlObject().keyboard.focusTable;return b?b.EditorProcessKey(a,c):!0};SocialCalc||(SocialCalc={});SocialCalc.FormatNumber={};SocialCalc.FormatNumber.format_definitions={};SocialCalc.FormatNumber.separatorchar=\\\",\\\";SocialCalc.FormatNumber.decimalchar=\\\".\\\";SocialCalc.FormatNumber.daynames=\\\"Sunday Monday Tuesday Wednesday Thursday Friday Saturday\\\".split(\\\" \\\");SocialCalc.FormatNumber.daynames3=\\\"Sun Mon Tue Wed Thu Fri Sat\\\".split(\\\" \\\");SocialCalc.FormatNumber.monthnames3=\\\"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec\\\".split(\\\" \\\");SocialCalc.FormatNumber.monthnames=\\\"January February March April May June July August September October November December\\\".split(\\\" \\\");\\nSocialCalc.FormatNumber.allowedcolors={BLACK:\\\"#000000\\\",BLUE:\\\"#0000FF\\\",CYAN:\\\"#00FFFF\\\",GREEN:\\\"#00FF00\\\",MAGENTA:\\\"#FF00FF\\\",RED:\\\"#FF0000\\\",WHITE:\\\"#FFFFFF\\\",YELLOW:\\\"#FFFF00\\\"};SocialCalc.FormatNumber.alloweddates={H:\\\"h]\\\",M:\\\"m]\\\",MM:\\\"mm]\\\",S:\\\"s]\\\",SS:\\\"ss]\\\"};SocialCalc.FormatNumber.commands={copy:1,color:2,integer_placeholder:3,fraction_placeholder:4,decimal:5,currency:6,general:7,separator:8,date:9,comparison:10,section:11,style:12};\\nSocialCalc.FormatNumber.datevalues={julian_offset:2415019,seconds_in_a_day:86400,seconds_in_an_hour:3600};\\nSocialCalc.FormatNumber.formatNumberWithFormat=function(a,c,b){b=SocialCalc.Constants;var d=SocialCalc.FormatNumber,e,f,g,l,h,m,p,r,q,n,s,t=\\\"\\\",u,w,v,x,y,z,C,D,G,I,E;if(\\\"string\\\"==typeof a&&!a.length)return\\\"\\\";E=a-0;if(!isFinite(E))return\\\"string\\\"==typeof a?d.formatTextWithFormat(a,c):\\\"NaN\\\";a=E;var H=0>E?1:0;H&&(E=-E);v=0==E?1:0;d.parse_format_string(d.format_definitions,c);c=d.format_definitions[c];if(!c)throw\\\"Format not parsed error!\\\";u=c.sectioninfo.length-1;if(c.hascomparison)for(v=s=u=0;;v++){e=\\nc.operators[v];f=c.operands[v];if(!e){s&&(c=\\\"General\\\",d.parse_format_string(d.format_definitions,c),c=d.format_definitions[c],u=0);break}if(e==d.commands.section){if(!s)break;s=0;u++}else if(e==d.commands.comparison){s=f.indexOf(\\\":\\\");w=f.substring(0,s);f=f.substring(s+1)-0;if(\\\"<\\\"==w&&a<f||\\\"<=\\\"==w&&a<=f||\\\"=\\\"==w&&a==f||\\\"<>\\\"==w&&a!=f||\\\">=\\\"==w&&a>=f||\\\">\\\"==w&&a>f)break;s=1}}else if(0<u)if(1==u)H?(H=0,u=1):u=0;else if(2==u||3==u)H?(H=0,u=1):u=v?2:0;u=c.sectioninfo[u];if(0<u.commas)for(s=0;s<u.commas;s++)E/=\\n1E3;if(0<u.percent)for(s=0;s<u.percent;s++)E*=100;f=1;for(s=0;s<u.fractiondigits;s++)f*=10;v=Math.floor(E*f+.5);v/=f;if(\\\"number\\\"!=typeof v||!isFinite(v))return\\\"NaN\\\";f=v+\\\"\\\";0==v&&(u.fractiondigits||u.integerdigits)&&(H=0);if(0<=f.indexOf(\\\"e\\\"))return a+\\\"\\\";f=f.match(/^\\\\+{0,1}(\\\\d*)(?:\\\\.(\\\\d*)){0,1}$/);if(!f)return\\\"NaN\\\";(v=f[1])&&\\\"0\\\"!=v||(v=\\\"\\\");(w=f[2])||(w=\\\"\\\");if(u.hasdate){if(0>a)return\\\"??-???-??&nbsp;??:??:??\\\";g=(a-Math.floor(a))*d.datevalues.seconds_in_a_day;l=a*d.datevalues.seconds_in_a_day;h=Math.floor(g/\\nd.datevalues.seconds_in_an_hour);p=Math.floor(l/d.datevalues.seconds_in_an_hour);g-=h*d.datevalues.seconds_in_an_hour;m=Math.floor(g/60);r=Math.floor(l/60);f=1;for(s=0;s<u.fractiondigits;s++)f*=10;g=Math.floor((g-60*m)*f+.5);g/=f;l=Math.floor(l*f+.5);l/=f;60<=g&&(g=0,m++,r++,60<=m&&(m=0,h++,p++,24<=h&&(h=0,a++)));w=g-Math.floor(g)+\\\"\\\";w=w.substring(2);n=SocialCalc.FormatNumber.convert_date_julian_to_gregorian(Math.floor(a+d.datevalues.julian_offset));s=0;for(mspos=u.sectionstart;;mspos++){e=c.operators[mspos];\\nf=c.operands[mspos];if(!e)break;if(e==d.commands.section)break;e==d.commands.date?(\\\"am/pm\\\"!=f.toLowerCase()&&\\\"a/p\\\"!=f.toLowerCase()||q||(12<=h?(h-=12,q=\\\"a/p\\\"==f.toLowerCase()?b.s_FormatNumber_pm1:b.s_FormatNumber_pm):q=\\\"a/p\\\"==f.toLowerCase()?b.s_FormatNumber_am1:b.s_FormatNumber_am,0>f.indexOf(q)&&(q=q.toLowerCase())),!s||\\\"m\\\"!=f&&\\\"mm\\\"!=f||(c.operands[mspos]+=\\\"in\\\"),s=\\\"h\\\"==f.charAt(0)?1:0):e!=d.commands.copy&&(s=0)}s=0;for(--mspos;;mspos--){e=c.operators[mspos];f=c.operands[mspos];if(!e)break;if(e==\\nd.commands.section)break;e==d.commands.date?(!s||\\\"m\\\"!=f&&\\\"mm\\\"!=f||(c.operands[mspos]+=\\\"in\\\"),s=\\\"ss\\\"==f?1:0):e!=d.commands.copy&&(s=0)}}z=y=x=0;D=C=\\\"\\\";G=b.FormatNumber_separatorchar;0<=G.indexOf(\\\" \\\")&&(G=G.replace(/ /g,\\\"&nbsp;\\\"));I=b.FormatNumber_decimalchar;0<=I.indexOf(\\\" \\\")&&(I=I.replace(/ /g,\\\"&nbsp;\\\"));for(s=u.sectionstart;e=c.operators[s];)if(f=c.operands[s++],e==d.commands.copy)t+=f;else if(e==d.commands.color)C=f;else if(e==d.commands.style)D=f;else if(e==d.commands.integer_placeholder){H&&(t+=\\n\\\"-\\\",H=0);x++;if(1==x&&v.length>u.integerdigits)for(;y<v.length-u.integerdigits;y++)t+=v.charAt(y),u.thousandssep&&(e=v.length-y-1,2<e&&0==e%3&&(t+=G));if(v.length<u.integerdigits&&x<=u.integerdigits-v.length){if(\\\"0\\\"==f||\\\"?\\\"==f)t+=\\\"0\\\"==f?\\\"0\\\":\\\"&nbsp;\\\",u.thousandssep&&(e=u.integerdigits-x,2<e&&0==e%3&&(t+=G))}else t+=v.charAt(y),u.thousandssep&&(e=v.length-y-1,2<e&&0==e%3&&(t+=G)),y++}else if(e==d.commands.fraction_placeholder){if(z>=w.length){if(\\\"0\\\"==f||\\\"?\\\"==f)t+=\\\"0\\\"==f?\\\"0\\\":\\\"&nbsp;\\\"}else t+=w.charAt(z);\\nz++}else if(e==d.commands.decimal)H&&(t+=\\\"-\\\",H=0),t+=I;else if(e==d.commands.currency)H&&(t+=\\\"-\\\",H=0),t+=f;else if(e==d.commands.general){if(0!=E&&(f=Math.floor(Math.LOG10E*Math.log(E)),f=Math.pow(10,13-f),E=Math.floor(f*E+.5)/f,!isFinite(E)))return\\\"NaN\\\";H&&(t+=\\\"-\\\");f=E+\\\"\\\";if(0<=f.indexOf(\\\"e\\\"))t+=f;else{f=f.match(/^\\\\+{0,1}(\\\\d*)(?:\\\\.(\\\\d*)){0,1}$/);(v=f[1])&&\\\"0\\\"!=v||(v=\\\"\\\");(w=f[2])||(w=\\\"\\\");z=y=0;if(v.length)for(;y<v.length;y++)t+=v.charAt(y),u.thousandssep&&(e=v.length-y-1,2<e&&0==e%3&&(t+=G));else t+=\\n\\\"0\\\";if(w.length)for(t+=I;z<w.length;z++)t+=w.charAt(z)}}else if(e==d.commands.date)f=f.toLowerCase(),\\\"y\\\"==f||\\\"yy\\\"==f?t+=(n.year+\\\"\\\").substring(2):\\\"yyyy\\\"==f?t+=n.year+\\\"\\\":\\\"d\\\"==f?t+=n.day+\\\"\\\":\\\"dd\\\"==f?(f=1E3+n.day,t+=(f+\\\"\\\").substr(2)):\\\"ddd\\\"==f?(f=Math.floor(a+6)%7,t+=b.s_FormatNumber_daynames3[f]):\\\"dddd\\\"==f?(f=Math.floor(a+6)%7,t+=b.s_FormatNumber_daynames[f]):\\\"m\\\"==f?t+=n.month+\\\"\\\":\\\"mm\\\"==f?(f=1E3+n.month,t+=(f+\\\"\\\").substr(2)):\\\"mmm\\\"==f?t+=b.s_FormatNumber_monthnames3[n.month-1]:\\\"mmmm\\\"==f?t+=b.s_FormatNumber_monthnames[n.month-\\n1]:\\\"mmmmm\\\"==f?t+=b.s_FormatNumber_monthnames[n.month-1].charAt(0):\\\"h\\\"==f?t+=h+\\\"\\\":\\\"h]\\\"==f?t+=p+\\\"\\\":\\\"mmin\\\"==f?(f=1E3+m+\\\"\\\",t+=f.substr(2)):\\\"mm]\\\"==f?100>r?(f=1E3+r+\\\"\\\",t+=f.substr(2)):t+=r+\\\"\\\":\\\"min\\\"==f?t+=m+\\\"\\\":\\\"m]\\\"==f?t+=r+\\\"\\\":\\\"hh\\\"==f?(f=1E3+h+\\\"\\\",t+=f.substr(2)):\\\"s\\\"==f?(f=Math.floor(g),t+=f+\\\"\\\"):\\\"ss\\\"==f?(f=1E3+Math.floor(g)+\\\"\\\",t+=f.substr(2)):\\\"am/pm\\\"==f||\\\"a/p\\\"==f?t+=q:\\\"ss]\\\"==f&&(100>l?(f=1E3+Math.floor(l)+\\\"\\\",t+=f.substr(2)):(f=Math.floor(l),t+=f+\\\"\\\"));else if(e==d.commands.section)break;else e!=d.commands.comparison&&\\n(t+=\\\"!! Parse error !!\\\");C&&(t='<span style=\\\"color:'+C+';\\\">'+t+\\\"</span>\\\");D&&(t='<span style=\\\"'+D+';\\\">'+t+\\\"</span>\\\");return t};\\nSocialCalc.FormatNumber.formatTextWithFormat=function(a,c){var b=SocialCalc.FormatNumber,d=a+\\\"\\\",e=\\\"\\\",f,g,l=\\\"\\\",h=\\\"\\\";b.parse_format_string(b.format_definitions,c);thisformat=b.format_definitions[c];if(!thisformat)throw\\\"Format not parsed error!\\\";f=thisformat.sectioninfo.length-1;if(0==f)f=0;else if(3==f)f=3;else return d;for(f=thisformat.sectioninfo[f].sectionstart;op=thisformat.operators[f];)g=thisformat.operands[f++],op==b.commands.copy?e=\\\"@\\\"==g?e+d:e+g.replace(/ /g,\\\"&nbsp;\\\"):op==b.commands.color?\\nl=g:op==b.commands.style&&(h=g);l&&(e='<span style=\\\"color:'+l+';\\\">'+e+\\\"</span>\\\");h&&(e='<span style=\\\"'+h+';\\\">'+e+\\\"</span>\\\");return e};\\nSocialCalc.FormatNumber.parse_format_string=function(a,c){var b=SocialCalc.FormatNumber,d,e,f=1,g,l,h,m,p,r,q,n,s,t,u,w,v;if(!a[c]){d={operators:[],operands:[],sectioninfo:[{}]};a[c]=d;e=0;sectioninfo=d.sectioninfo[e];sectioninfo.sectionstart=0;sectioninfo.integerdigits=0;sectioninfo.fractiondigits=0;sectioninfo.commas=0;for(v=sectioninfo.percent=0;v<c.length;v++)if(s=c.charAt(v),p)'\\\"'==s?(p=0,d.operators.push(b.commands.copy),d.operands.push(r)):r+=s;else if(q)\\\"]\\\"==s?(q=0,s=SocialCalc.FormatNumber.parse_format_bracket(n),\\ns.operator==b.commands.separator?sectioninfo.thousandssep=1:(s.operator==b.commands.date&&(sectioninfo.hasdate=1),s.operator==b.commands.comparison&&(d.hascomparison=1),d.operators.push(s.operator),d.operands.push(s.operand))):n+=s;else if(l)d.operators.push(b.commands.copy),d.operands.push(s),l=!1;else if(h)d.operators.push(b.commands.copy),d.operands.push(s+s+s+s+s),h=!1;else if(m)d.operators.push(b.commands.copy),d.operands.push(\\\"&nbsp;\\\"),m=!1;else{if(t){if(\\\"general\\\".charAt(t)==s.toLowerCase()){t++;\\n7==t&&(d.operators.push(b.commands.general),d.operands.push(s),t=0);continue}t=0}if(w){if(w.charAt(0)==s){w+=s;continue}d.operators.push(b.commands.date);d.operands.push(w);sectioninfo.hasdate=1;w=\\\"\\\"}if(u)if(u+=s,s=u.toLowerCase(),s!=\\\"am/pm\\\".substring(0,s.length)&&s!=\\\"a/p\\\".substring(0,s.length))ampstr=\\\"\\\";else{if(\\\"am/pm\\\"==s||\\\"a/p\\\"==s)d.operators.push(b.commands.date),d.operands.push(u),u=\\\"\\\"}else\\\"#\\\"==s||\\\"0\\\"==s||\\\"?\\\"==s?(f?(sectioninfo.integerdigits++,sectioninfo.commas&&(sectioninfo.thousandssep=1,sectioninfo.commas=\\n0),g=1,d.operators.push(b.commands.integer_placeholder)):(sectioninfo.fractiondigits++,g=1,d.operators.push(b.commands.fraction_placeholder)),d.operands.push(s)):\\\".\\\"==s?(g=0,d.operators.push(b.commands.decimal),d.operands.push(s),f=0):\\\"$\\\"==s?(g=0,d.operators.push(b.commands.currency),d.operands.push(s)):\\\",\\\"==s?g?sectioninfo.commas++:(d.operators.push(b.commands.copy),d.operands.push(s)):\\\"%\\\"==s?(g=0,sectioninfo.percent++,d.operators.push(b.commands.copy),d.operands.push(s)):'\\\"'==s?(g=0,p=1,r=\\\"\\\"):\\\"[\\\"==\\ns?(g=0,q=1,n=\\\"\\\"):\\\"\\\\\\\\\\\"==s?(l=1,g=0):\\\"*\\\"==s?(h=1,g=0):\\\"_\\\"==s?(m=1,g=0):\\\";\\\"==s?(e++,d.sectioninfo[e]={},sectioninfo=d.sectioninfo[e],sectioninfo.sectionstart=1+d.operators.length,sectioninfo.integerdigits=0,sectioninfo.fractiondigits=0,sectioninfo.commas=0,sectioninfo.percent=0,f=1,g=0,d.operators.push(b.commands.section),d.operands.push(s)):\\\"g\\\"==s.toLowerCase()?(t=1,g=0):\\\"a\\\"==s.toLowerCase()?(u=s,g=0):0<=\\\"dmyhHs\\\".indexOf(s)?w=s:(g=0,d.operators.push(b.commands.copy),d.operands.push(s))}w&&(d.operators.push(b.commands.date),\\nd.operands.push(w),sectioninfo.hasdate=1)}};\\nSocialCalc.FormatNumber.parse_format_bracket=function(a){var c=SocialCalc.FormatNumber,b=SocialCalc.Constants,d={},e;\\\"$\\\"==a.charAt(0)?(d.operator=c.commands.currency,e=a.match(/^\\\\$(.+?)(\\\\-.+?){0,1}$/),d.operand=e?e[1]||b.FormatNumber_defaultCurrency||\\\"$\\\":a.substring(1)||b.FormatNumber_defaultCurrency||\\\"$\\\"):\\\"?$\\\"==a?(d.operator=c.commands.currency,d.operand=\\\"[?$]\\\"):c.allowedcolors[a.toUpperCase()]?(d.operator=c.commands.color,d.operand=c.allowedcolors[a.toUpperCase()]):(e=a.match(/^style=([^\\\"]*)$/))?\\n(d.operator=c.commands.style,d.operand=e[1]):\\\",\\\"==a?(d.operator=c.commands.separator,d.operand=a):c.alloweddates[a.toUpperCase()]?(d.operator=c.commands.date,d.operand=c.alloweddates[a.toUpperCase()]):a.match(/^[<>=]/)?(e=a.match(/^([<>=]+)(.+)$/),d.operator=c.commands.comparison,d.operand=e[1]+\\\":\\\"+e[2]):(d.operator=c.commands.copy,d.operand=\\\"[\\\"+a+\\\"]\\\");return d};\\nSocialCalc.FormatNumber.convert_date_gregorian_to_julian=function(a,c,b){b=b-32075+SocialCalc.intFunc(1461*(a+4800+SocialCalc.intFunc((c-14)/12))/4);b+=SocialCalc.intFunc(367*(c-2-12*SocialCalc.intFunc((c-14)/12))/12);return b-=SocialCalc.intFunc(3*SocialCalc.intFunc((a+4900+SocialCalc.intFunc((c-14)/12))/100)/4)};\\nSocialCalc.FormatNumber.convert_date_julian_to_gregorian=function(a){var c,b,d,e;a+=68569;c=Math.floor(4*a/146097);a-=Math.floor((146097*c+3)/4);b=Math.floor(4E3*(a+1)/1461001);a=a-Math.floor(1461*b/4)+31;d=Math.floor(80*a/2447);e=a-Math.floor(2447*d/80);a=Math.floor(d/11);return{year:100*(c-49)+b+a,month:d+2-12*a,day:e}};SocialCalc.intFunc=function(a){return 0>a?-Math.floor(-a):Math.floor(a)};SocialCalc||(SocialCalc={});SocialCalc.Formula={};SocialCalc.Formula.ParseState={num:1,alpha:2,coord:3,string:4,stringquote:5,numexp1:6,numexp2:7,alphanumeric:8,specialvalue:9};SocialCalc.Formula.TokenType={num:1,coord:2,op:3,name:4,error:5,string:6,space:7};SocialCalc.Formula.CharClass={num:1,numstart:2,op:3,eof:4,alpha:5,incoord:6,error:7,quote:8,space:9,specialstart:10};\\nSocialCalc.Formula.CharClassTable={\\\" \\\":9,\\\"!\\\":3,'\\\"':8,\\\"'\\\":8,\\\"#\\\":10,$:6,\\\"%\\\":3,\\\"&\\\":3,\\\"(\\\":3,\\\")\\\":3,\\\"*\\\":3,\\\"+\\\":3,\\\",\\\":3,\\\"-\\\":3,\\\".\\\":2,\\\"/\\\":3,0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1,\\\":\\\":3,\\\"<\\\":3,\\\"=\\\":3,\\\">\\\":3,A:5,B:5,C:5,D:5,E:5,F:5,G:5,H:5,I:5,J:5,K:5,L:5,M:5,N:5,O:5,P:5,Q:5,R:5,S:5,T:5,U:5,V:5,W:5,X:5,Y:5,Z:5,\\\"^\\\":3,_:5,a:5,b:5,c:5,d:5,e:5,f:5,g:5,h:5,i:5,j:5,k:5,l:5,m:5,n:5,o:5,p:5,q:5,r:5,s:5,t:5,u:5,v:5,w:5,x:5,y:5,z:5};\\nSocialCalc.Formula.UpperCaseTable={a:\\\"A\\\",b:\\\"B\\\",c:\\\"C\\\",d:\\\"D\\\",e:\\\"E\\\",f:\\\"F\\\",g:\\\"G\\\",h:\\\"H\\\",i:\\\"I\\\",j:\\\"J\\\",k:\\\"K\\\",l:\\\"L\\\",m:\\\"M\\\",n:\\\"N\\\",o:\\\"O\\\",p:\\\"P\\\",q:\\\"Q\\\",r:\\\"R\\\",s:\\\"S\\\",t:\\\"T\\\",u:\\\"U\\\",v:\\\"V\\\",w:\\\"W\\\",x:\\\"X\\\",y:\\\"Y\\\",z:\\\"Z\\\",A:\\\"A\\\",B:\\\"B\\\",C:\\\"C\\\",D:\\\"D\\\",E:\\\"E\\\",F:\\\"F\\\",G:\\\"G\\\",H:\\\"H\\\",I:\\\"I\\\",J:\\\"J\\\",K:\\\"K\\\",L:\\\"L\\\",M:\\\"M\\\",N:\\\"N\\\",O:\\\"O\\\",P:\\\"P\\\",Q:\\\"Q\\\",R:\\\"R\\\",S:\\\"S\\\",T:\\\"T\\\",U:\\\"U\\\",V:\\\"V\\\",W:\\\"W\\\",X:\\\"X\\\",Y:\\\"Y\\\",Z:\\\"Z\\\"};SocialCalc.Formula.SpecialConstants={\\\"#NULL!\\\":\\\"0,e#NULL!\\\",\\\"#NUM!\\\":\\\"0,e#NUM!\\\",\\\"#DIV/0!\\\":\\\"0,e#DIV/0!\\\",\\\"#VALUE!\\\":\\\"0,e#VALUE!\\\",\\\"#REF!\\\":\\\"0,e#REF!\\\",\\\"#NAME?\\\":\\\"0,e#NAME?\\\"};\\nSocialCalc.Formula.TokenPrecedence={\\\"!\\\":1,\\\":\\\":2,\\\",\\\":2,M:-3,P:-3,\\\"%\\\":4,\\\"^\\\":5,\\\"*\\\":6,\\\"/\\\":6,\\\"+\\\":7,\\\"-\\\":7,\\\"&\\\":8,\\\"<\\\":9,\\\">\\\":9,G:9,L:9,N:9};SocialCalc.Formula.TokenOpExpansion={G:\\\">=\\\",L:\\\"<=\\\",M:\\\"-\\\",N:\\\"<>\\\",P:\\\"+\\\"};\\nSocialCalc.Formula.TypeLookupTable={unaryminus:{\\\"n*\\\":\\\"|n*:1|\\\",\\\"e*\\\":\\\"|e*:1|\\\",\\\"t*\\\":\\\"|t*:e#VALUE!|\\\",b:\\\"|b:n|\\\"},unaryplus:{\\\"n*\\\":\\\"|n*:1|\\\",\\\"e*\\\":\\\"|e*:1|\\\",\\\"t*\\\":\\\"|t*:e#VALUE!|\\\",b:\\\"|b:n|\\\"},unarypercent:{\\\"n*\\\":\\\"|n:n%|n*:n|\\\",\\\"e*\\\":\\\"|e*:1|\\\",\\\"t*\\\":\\\"|t*:e#VALUE!|\\\",b:\\\"|b:n|\\\"},plus:{\\\"n%\\\":\\\"|n%:n%|nd:n|nt:n|ndt:n|n$:n|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|\\\",nd:\\\"|n%:n|nd:nd|nt:ndt|ndt:ndt|n$:n|n:nd|n*:n|b:n|e*:2|t*:e#VALUE!|\\\",nt:\\\"|n%:n|nd:ndt|nt:nt|ndt:ndt|n$:n|n:nt|n*:n|b:n|e*:2|t*:e#VALUE!|\\\",ndt:\\\"|n%:n|nd:ndt|nt:ndt|ndt:ndt|n$:n|n:ndt|n*:n|b:n|e*:2|t*:e#VALUE!|\\\",\\nn$:\\\"|n%:n|nd:n|nt:n|ndt:n|n$:n$|n:n$|n*:n|b:n|e*:2|t*:e#VALUE!|\\\",nl:\\\"|n%:n|nd:n|nt:n|ndt:n|n$:n|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|\\\",n:\\\"|n%:n|nd:nd|nt:nt|ndt:ndt|n$:n$|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|\\\",b:\\\"|n%:n%|nd:nd|nt:nt|ndt:ndt|n$:n$|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|\\\",\\\"t*\\\":\\\"|n*:e#VALUE!|t*:e#VALUE!|b:e#VALUE!|e*:2|\\\",\\\"e*\\\":\\\"|e*:1|n*:1|t*:1|b:1|\\\"},concat:{t:\\\"|t:t|th:th|tw:tw|tl:t|tr:tr|t*:2|e*:2|\\\",th:\\\"|t:th|th:th|tw:t|tl:th|tr:t|t*:t|e*:2|\\\",tw:\\\"|t:tw|th:t|tw:tw|tl:tw|tr:tw|t*:t|e*:2|\\\",tl:\\\"|t:tl|th:th|tw:tw|tl:tl|tr:tr|t*:t|e*:2|\\\",\\n\\\"t*\\\":\\\"|t*:t|e*:2|\\\",\\\"e*\\\":\\\"|e*:1|n*:1|t*:1|\\\"},oneargnumeric:{\\\"n*\\\":\\\"|n*:n|\\\",\\\"e*\\\":\\\"|e*:1|\\\",\\\"t*\\\":\\\"|t*:e#VALUE!|\\\",b:\\\"|b:n|\\\"},twoargnumeric:{\\\"n*\\\":\\\"|n*:n|t*:e#VALUE!|e*:2|\\\",\\\"e*\\\":\\\"|e*:1|n*:1|t*:1|\\\",\\\"t*\\\":\\\"|t*:e#VALUE!|n*:e#VALUE!|e*:2|\\\"},propagateerror:{\\\"n*\\\":\\\"|n*:2|e*:2|\\\",\\\"e*\\\":\\\"|e*:2|\\\",\\\"t*\\\":\\\"|t*:2|e*:2|\\\",b:\\\"|b:2|e*:2|\\\"}};\\nSocialCalc.Formula.ParseFormulaIntoTokens=function(a){var c,b,d,e,f,g;c=SocialCalc.Formula;var l=SocialCalc.Constants,h=c.ParseState,m=c.TokenType,p=c.CharClass,r=c.CharClassTable,q=c.UpperCaseTable,n=c.ParsePushToken,s=/^\\\\$?[A-Z]{1,2}\\\\$?[1-9]\\\\d*$/i,t=[],u=\\\"\\\";f=0;e=!1;for(c=0;c<=a.length;c++)c<a.length?(b=a.charAt(c),d=r[b]):(b=\\\"\\\",d=p.eof),f==h.num&&(d==p.num?u+=b:d!=p.numstart||e?\\\"E\\\"==b||\\\"e\\\"==b?(u+=b,e=!1,f=h.numexp1):(n(t,u,m.num,0),e=!1,f=0):(e=!0,u+=b)),f==h.numexp1&&(d==h.num?f=h.numexp2:\\\"+\\\"!=\\nb&&\\\"-\\\"!=b||\\\"E\\\"!=q[u.charAt(u.length-1)]?\\\"E\\\"!=b&&\\\"e\\\"!=b&&(n(t,l.s_parseerrexponent,m.error,0),f=0):u+=b),f==h.numexp2&&(d==p.num?u+=b:(n(t,u,m.num,0),f=0)),f==h.alpha&&(d==p.num?f=h.coord:d==p.alpha||\\\".\\\"==b?u+=b:d==p.incoord?f=h.coord:(d==p.op||d==p.numstart||d==p.space||d==p.eof?n(t,u.toUpperCase(),m.name,0):n(t,l.s_parseerrchar,m.error,0),f=0)),f==h.coord&&(d==p.num?u+=b:d==p.incoord?u+=b:d==p.alpha?f=h.alphanumeric:(d==p.op||d==p.numstart||d==p.eof||d==p.space?(f=s.test(u)?m.coord:m.name,n(t,u.toUpperCase(),\\nf,0)):n(t,l.s_parseerrchar,m.error,0),f=0)),f==h.alphanumeric&&(d==p.num||d==p.alpha?u+=b:(d==p.op||d==p.numstart||d==p.space||d==p.eof?n(t,u.toUpperCase(),m.name,0):n(t,l.s_parseerrchar,m.error,0),f=0)),f==h.string?d==p.quote?f=h.stringquote:d==p.eof?(n(t,l.s_parseerrstring,m.error,0),f=0):u+=b:f==h.stringquote?d==p.quote?(u+=b,f=h.string):(n(t,u,m.string,0),f=0):f==h.specialvalue&&(\\\"!\\\"==u.charAt(u.length-1)?(n(t,u,m.name,0),f=0):d==p.eof?(n(t,l.s_parseerrspecialvalue,m.error,0),f=0):u+=b),0==f&&\\n(d==p.num?(u=b,f=h.num):d==p.numstart?(u=b,e=!0,f=h.num):d==p.alpha||d==p.incoord?(u=b,f=h.alpha):d==p.specialstart?(u=b,f=h.specialvalue):d==p.op?(u=b,0<t.length?(f=t[t.length-1],d=f.type,g=f.text,d!=p.op||\\\"<\\\"!=g&&\\\">\\\"!=g||(u=g+u,t.pop(),0<t.length?(f=t[t.length-1],d=f.type,g=f.text):(d=p.eof,g=\\\"EOF\\\"))):(d=p.eof,g=\\\"EOF\\\"),f=m.op,0==t.length||d==p.op&&\\\")\\\"!=g&&\\\"%\\\"!=g?\\\"-\\\"==u?b=u=\\\"M\\\":\\\"+\\\"==u?b=u=\\\"P\\\":\\\")\\\"==u&&\\\"(\\\"==g||\\\"(\\\"==u||(f=m.error,u=l.s_parseerrtwoops):1<u.length&&(\\\">=\\\"==u?b=u=\\\"G\\\":\\\"<=\\\"==u?b=u=\\\"L\\\":\\\"<>\\\"==\\nu?b=u=\\\"N\\\":(f=m.error,u=l.s_parseerrtwoops)),n(t,u,f,b),f=0):d==p.quote?(u=\\\"\\\",f=h.string):d!=p.space&&d!=p.eof&&n(t,l.s_parseerrchar,m.error,0));return t};SocialCalc.Formula.ParsePushToken=function(a,c,b,d){a.push({text:c,type:b,opcode:d})};SocialCalc.Formula.evaluate_parsed_formula=function(a,c,b){var d=SocialCalc.Formula,e;e=d.ConvertInfixToPolish(a);return d.EvaluatePolish(a,e,c,b)};\\nSocialCalc.Formula.ConvertInfixToPolish=function(a){var c=SocialCalc.Formula,b=SocialCalc.Constants,d=c.TokenType,c=c.TokenPrecedence,e=[],f=[],g=\\\"\\\",l,h,m,p;for(l=0;l<a.length;l++)if(h=a[l],m=h.type,p=h.text,m==d.num||m==d.coord||m==d.string)e.push(l);else if(m==d.name)f.push(l),e.push(-1);else if(m!=d.space)if(\\\",\\\"==p){for(;f.length&&\\\"(\\\"!=a[f[f.length-1]].text;)e.push(f.pop());if(0==f.length){g=b.s_parseerrmissingopenparen;break}}else if(\\\"(\\\"==p)f.push(l);else if(\\\")\\\"==p){for(;f.length&&\\\"(\\\"!=a[f[f.length-\\n1]].text;)e.push(f.pop());if(0==f.length){g=b.s_parseerrcloseparennoopen;break}f.pop();f.length&&a[f[f.length-1]].type==d.name&&e.push(f.pop())}else if(m==d.op){for(f.length&&a[f[f.length-1]].type==d.name&&e.push(f.pop());f.length&&a[f[f.length-1]].type==d.op&&\\\"(\\\"!=a[f[f.length-1]].text;){m=c[h.opcode];p=c[a[f[f.length-1]].opcode];if(0<=m&&m<p)break;else if(0>m&&(m=-m,0>p&&(p=-p),m<=p))break;e.push(f.pop())}f.push(l)}else{g=m==d.error?p:\\\"Internal error while processing parsed formula. \\\";break}for(;0<\\nf.length;){if(\\\"(\\\"==a[f[f.length-1]].text){g=b.s_parseerrmissingcloseparen;break}e.push(f.pop())}return g?g:e};\\nSocialCalc.Formula.EvaluatePolish=function(a,c,b,d){var e=SocialCalc.Formula,f=SocialCalc.Constants,g=e.TokenType,l=e.LookupResultType,h=e.TypeLookupTable,m=e.OperandAsNumber,p=e.OperandAsText,r=e.OperandValueAndType,q=e.OperandsAsCoordOnSheet,n=SocialCalc.format_number_for_display||function(a,c,b){return a+\\\"\\\"},s=\\\"\\\",t={value:\\\"\\\",type:\\\"e#VALUE!\\\",error:f.s_parseerrmissingoperand},u=[],w=function(a,c){u.push({type:a,value:c})},v,x,y,z,C,D;if(!(a.length&&c instanceof Array))return{value:\\\"\\\",type:\\\"e#VALUE!\\\",\\nerror:\\\"string\\\"==typeof c?c:\\\"\\\"};for(v=0;v<c.length;v++)if(x=c[v],-1==x)w(\\\"start\\\",0);else if(x=a[x],y=x.type,x=x.text,y==g.num)w(\\\"n\\\",x-0);else if(y==g.coord)w(\\\"coord\\\",x);else if(y==g.string)w(\\\"t\\\",x);else if(y==g.op){if(0>=u.length)return t;if(\\\"M\\\"==x)y=m(b,u),x=l(y.type,y.type,h.unaryminus),w(x,-y.value);else if(\\\"P\\\"==x)y=m(b,u),x=l(y.type,y.type,h.unaryplus),w(x,y.value);else if(\\\"%\\\"==x)y=m(b,u),x=l(y.type,y.type,h.unarypercent),w(x,.01*y.value);else if(\\\"&\\\"==x){if(1>=u.length)return t;z=p(b,u);y=p(b,\\nu);x=l(y.type,y.type,h.concat);w(x,y.value+z.value)}else if(\\\":\\\"==x){if(1>=u.length)return t;y=e.OperandsAsRangeOnSheet(b,u);y.error&&(s=s||y.error);w(y.type,y.value)}else if(\\\"!\\\"==x){if(1>=u.length)return t;y=q(b,u);y.error&&(s=s||y.error);w(y.type,y.value)}else if(\\\"<\\\"==x||\\\"L\\\"==x||\\\"=\\\"==x||\\\"G\\\"==x||\\\">\\\"==x||\\\"N\\\"==x){if(1>=u.length){s=f.s_parseerrmissingoperand;break}z=r(b,u);y=r(b,u);\\\"n\\\"==y.type.charAt(0)&&\\\"n\\\"==z.type.charAt(0)?(C=0,\\\"<\\\"==x?C=y.value<z.value?1:0:\\\"L\\\"==x?C=y.value<=z.value?1:0:\\\"=\\\"==x?C=y.value==\\nz.value?1:0:\\\"G\\\"==x?C=y.value>=z.value?1:0:\\\">\\\"==x?C=y.value>z.value?1:0:\\\"N\\\"==x&&(C=y.value!=z.value?1:0),w(\\\"nl\\\",C)):\\\"e\\\"==y.type.charAt(0)?w(y.type,0):\\\"e\\\"==z.type.charAt(0)?w(z.type,0):(C=y.type.charAt(0),D=z.type.charAt(0),\\\"n\\\"==C?y.value=n(y.value,\\\"n\\\",\\\"\\\"):\\\"b\\\"==C&&(y.value=\\\"\\\"),\\\"n\\\"==D?z.value=n(z.value,\\\"n\\\",\\\"\\\"):\\\"b\\\"==D&&(z.value=\\\"\\\"),C=0,y.value=y.value.toLowerCase(),z.value=z.value.toLowerCase(),\\\"<\\\"==x?C=y.value<z.value?1:0:\\\"L\\\"==x?C=y.value<=z.value?1:0:\\\"=\\\"==x?C=y.value==z.value?1:0:\\\"G\\\"==x?C=y.value>=\\nz.value?1:0:\\\">\\\"==x?C=y.value>z.value?1:0:\\\"N\\\"==x&&(C=y.value!=z.value?1:0),w(\\\"nl\\\",C))}else{if(1>=u.length){s=f.s_parseerrmissingoperand;break}z=m(b,u);y=m(b,u);\\\"+\\\"==x?(x=l(y.type,z.type,h.plus),w(x,y.value+z.value)):\\\"-\\\"==x?(x=l(y.type,z.type,h.plus),w(x,y.value-z.value)):\\\"*\\\"==x?(x=l(y.type,z.type,h.plus),w(x,y.value*z.value)):\\\"/\\\"==x?0!=z.value?w(\\\"n\\\",y.value/z.value):w(\\\"e#DIV/0!\\\",0):\\\"^\\\"==x&&(y.value=Math.pow(y.value,z.value),y.type=\\\"n\\\",isNaN(y.value)&&(y.value=0,y.type=\\\"e#NUM!\\\"),w(y.type,y.value))}}else if(y==\\ng.name){if(s=e.CalculateFunction(x,u,b))break}else{s=f.s_InternalError+\\\"Unknown token \\\"+y+\\\" (\\\"+x+\\\"). \\\";break}value=u[0]?u[0].value:\\\"\\\";C=u[0]?u[0].type:\\\"\\\";\\\"name\\\"==C&&(y=SocialCalc.Formula.LookupName(b,value),value=y.value,C=y.type,s=s||y.error);\\\"coord\\\"==C&&(y=r(b,u),value=y.value,C=y.type,\\\"b\\\"==C&&(C=\\\"n\\\",value=0));1<u.length&&!s&&(s+=f.s_parseerrerrorinformula);a=C;\\\"e\\\"==C.charAt(0)?s=s||C.substring(1)||f.s_calcerrerrorvalueinformula:\\\"range\\\"==C&&(c=value.match(/^(.*)\\\\|(.*)\\\\|/),b=c[1].indexOf(\\\"!\\\"),c[1]=\\n0<=b?c[1].substring(b+1)+\\\"!\\\"+c[1].substring(0,b).toUpperCase():c[1].toUpperCase(),value=c[1]+\\\":\\\"+c[2].toUpperCase(),d||(s=f.s_formularangeresult+\\\" \\\"+value));s&&\\\"e\\\"!=a.charAt(0)&&(value=s,a=\\\"e\\\");\\\"n\\\"!=a.charAt(0)||!isNaN(value)&&isFinite(value)||(value=0,a=\\\"e#NUM!\\\",s=isNaN(value)?f.s_calcerrnumericnan:f.s_calcerrnumericoverflow);return{value:value,type:a,error:s}};\\nSocialCalc.Formula.LookupResultType=function(a,c,b){var d,e;e=b[a];if(!e&&(e=b[a.charAt(0)+\\\"*\\\"],!e))return\\\"e#VALUE! (internal error, missing LookupResultType \\\"+a.charAt(0)+\\\"*)\\\";b=e.indexOf(\\\"|\\\"+c+\\\":\\\");if(0<=b){d=e.indexOf(\\\"|\\\",b+1);if(0>d)return\\\"e#VALUE! (internal error, incorrect LookupResultType \\\"+e+\\\")\\\";e=e.substring(b+c.length+2,d);return\\\"1\\\"==e?a:\\\"2\\\"==e?c:e}b=e.indexOf(\\\"|\\\"+c.charAt(0)+\\\"*:\\\");if(0<=b){d=e.indexOf(\\\"|\\\",b+1);if(0>d)return\\\"e#VALUE! (internal error, incorrect LookupResultType \\\"+e+\\\")\\\";e=\\ne.substring(b+4,d);return\\\"1\\\"==e?a:\\\"2\\\"==e?c:e}return\\\"e#VALUE!\\\"};SocialCalc.Formula.TopOfStackValueAndType=function(a,c){var b=SocialCalc.Formula,d={type:\\\"\\\",value:\\\"\\\"},e=c.length;if(!e)return d.error=SocialCalc.Constants.s_InternalError+\\\"no operand on stack\\\",d;d.value=c[e-1].value;d.type=c[e-1].type;c.pop();\\\"name\\\"==d.type&&(d=b.LookupName(a,d.value));return d};\\nSocialCalc.Formula.OperandAsNumber=function(a,c){var b,d=SocialCalc.Formula.OperandValueAndType(a,c);b=d.type.charAt(0);\\\"n\\\"==b?d.value-=0:\\\"b\\\"==b?(d.type=\\\"n\\\",d.value=0):\\\"e\\\"==b?d.value=0:(b=SocialCalc.DetermineValueType?SocialCalc.DetermineValueType(d.value):{value:d.value-0,type:\\\"n\\\"},\\\"n\\\"==b.type.charAt(0)?d.value=b.value-0:d.value=0,d.type=b.type);return d};\\nSocialCalc.Formula.OperandAsText=function(a,c){var b,d=SocialCalc.Formula.OperandValueAndType(a,c);b=d.type.charAt(0);\\\"t\\\"!=b&&(\\\"n\\\"==b?(d.value=SocialCalc.format_number_for_display?SocialCalc.format_number_for_display(d.value,d.type,\\\"\\\"):d.value+=\\\"\\\",d.type=\\\"t\\\"):\\\"b\\\"==b?(d.value=\\\"\\\",d.type=\\\"t\\\"):\\\"e\\\"==b?d.value=\\\"\\\":(c.value=d.value+\\\"\\\",c.type=\\\"t\\\"));return d};\\nSocialCalc.Formula.OperandValueAndType=function(a,c){var b,d,e;b=SocialCalc.Formula;var f={type:\\\"\\\",value:\\\"\\\"};d=c.length;if(!d)return f.error=SocialCalc.Constants.s_InternalError+\\\"no operand on stack\\\",f;f.value=c[d-1].value;f.type=c[d-1].type;c.pop();\\\"name\\\"==f.type&&(f=b.LookupName(a,f.value));\\\"range\\\"==f.type&&(f=b.StepThroughRangeDown(c,f.value));if(\\\"coord\\\"==f.type){e=a;d=f.value.indexOf(\\\"!\\\");if(-1!=d){e=b.FindInSheetCache(f.value.substring(d+1));if(null==e)return f.type=\\\"e#REF!\\\",f.error=SocialCalc.Constants.s_sheetunavailable+\\n\\\" \\\"+f.value.substring(d+1),f.value=0,f;f.value=f.value.substring(0,d)}e?(d=e.cells[SocialCalc.Formula.PlainCoord(f.value)])?(b=d.valuetype,f.value=d.datavalue):b=\\\"b\\\":(b=\\\"e#N/A\\\",f.value=0);f.type=b||\\\"b\\\";\\\"b\\\"==f.type&&(f.value=0)}return f};\\nSocialCalc.Formula.OperandAsCoord=function(a,c){var b={type:\\\"\\\",value:\\\"\\\"},d=c.length;b.value=c[d-1].value;b.type=c[d-1].type;c.pop();\\\"name\\\"==b.type&&(b=SocialCalc.Formula.LookupName(a,b.value));\\\"coord\\\"!=b.type&&(b.value=SocialCalc.Constants.s_calcerrcellrefmissing,b.type=\\\"e#REF!\\\");return b};\\nSocialCalc.Formula.OperandsAsCoordOnSheet=function(a,c){var b,d,e,f={},g={};e=SocialCalc.Formula;b=c.length;f.value=c[b-1].value;f.type=c[b-1].type;c.pop();b=e.OperandAsSheetName(a,c);d=e.FindInSheetCache(b.value);if(null==d)return g.type=\\\"e#REF!\\\",g.value=0,g.error=SocialCalc.Constants.s_sheetunavailable+\\\" \\\"+b.value,g;\\\"name\\\"==f.type&&(f=e.LookupName(d,f.value));g.type=f.type;\\\"coord\\\"==f.type?g.value=f.value+\\\"!\\\"+b.value:\\\"range\\\"==f.type?(e=f.value.indexOf(\\\"|\\\"),d=f.value.indexOf(\\\"|\\\",e+1),g.value=f.value.substring(0,\\ne)+\\\"!\\\"+b.value+\\\"|\\\"+f.value.substring(e+1,d)+\\\"|\\\"):\\\"e\\\"==f.type.charAt(0)?g.value=f.value:(g.error=SocialCalc.Constants.s_calcerrcellrefmissing,g.type=\\\"e#REF!\\\",g.value=0);return g};\\nSocialCalc.Formula.OperandsAsRangeOnSheet=function(a,c){var b,d,e,f,g={},l=SocialCalc.Formula,h=SocialCalc.Constants;b=c.length;g.value=c[b-1].value;g.type=c[b-1].type;c.pop();b=l.OperandAsCoord(a,c);if(\\\"coord\\\"!=b.type)return{value:0,type:\\\"e#REF!\\\"};d=a;e=b.value.indexOf(\\\"!\\\");if(-1!=e&&(f=b.value.indexOf(\\\"|\\\",e+1),0>f&&(f=b.value.length),d=l.FindInSheetCache(b.value.substring(e+1,f)),null==d))return{value:0,type:\\\"e#REF!\\\",errortext:h.s_sheetunavailable+\\\" \\\"+b.value.substring(e+1,f)};\\\"name\\\"==g.type&&(g=\\nl.LookupName(d,g.value,\\\"end\\\"));return\\\"coord\\\"==g.type?{value:b.value+\\\"|\\\"+g.value+\\\"|\\\",type:\\\"range\\\"}:{value:h.s_calcerrcellrefmissing,type:\\\"e#REF!\\\"}};\\nSocialCalc.Formula.OperandAsSheetName=function(a,c){var b,d={type:\\\"\\\",value:\\\"\\\"};b=c.length;d.value=c[b-1].value;d.type=c[b-1].type;c.pop();if(\\\"name\\\"==d.type){b=SocialCalc.Formula.LookupName(a,d.value);if(!b.value)return d;d.value=b.value;d.type=b.type}\\\"coord\\\"==d.type&&((b=a.cells[SocialCalc.Formula.PlainCoord(d.value)])?(d.value=b.datavalue,d.type=b.valuetype):(d.value=\\\"\\\",d.type=\\\"b\\\"));\\\"t\\\"!=d.type.charAt(0)&&(d.value=\\\"\\\",d.error=SocialCalc.Constants.s_calcerrsheetnamemissing);return d};\\nSocialCalc.Formula.LookupName=function(a,c,b){var d,e,f=a.names;e={};d=!1;if(f[c.toUpperCase()]){e.value=f[c.toUpperCase()].definition;if(\\\"=\\\"==e.value.charAt(0)){if(!a.checknamecirc)a.checknamecirc={},d=!0;else if(a.checknamecirc[c])return e.type=\\\"e#NAME?\\\",e.error=SocialCalc.Constants.s_circularnameref+' \\\"'+c+'\\\".',e;a.checknamecirc[c]=!0;e=SocialCalc.Formula.ParseFormulaIntoTokens(e.value.substring(1));e=SocialCalc.Formula.evaluate_parsed_formula(e,a,1);delete a.checknamecirc[c];d&&delete a.checknamecirc;\\nif(\\\"range\\\"!=e.type)return e}a=e.value.indexOf(\\\":\\\");-1!=a?(e.type=\\\"range\\\",e.value=e.value.substring(0,a)+\\\"|\\\"+e.value.substring(a+1)+\\\"|\\\"):e.type=\\\"coord\\\";e.value=e.value.toUpperCase()}else(d=SocialCalc.Formula.SpecialConstants[c.toUpperCase()])?(a=d.indexOf(\\\",\\\"),e.value=d.substring(0,a)-0,e.type=d.substring(a+1)):/^[a-zA-Z][a-zA-Z]?$/.test(c)?(e.type=\\\"coord\\\",e.value=c.toUpperCase()+(b?a.attribs.lastrow:1)):(e.value=\\\"\\\",e.type=\\\"e#NAME?\\\",e.error=SocialCalc.Constants.s_calcerrunknownname+' \\\"'+c+'\\\"');return e};\\nSocialCalc.Formula.StepThroughRangeDown=function(a,c){var b,d,e,f,g,l,h,m,p=SocialCalc.Formula;f=c.indexOf(\\\"|\\\");e=c.indexOf(\\\"|\\\",f+1);b=c.substring(0,f);d=c.substring(f+1,e);e=c.substring(e+1)-0;f=b.indexOf(\\\"!\\\");-1!=f?(g=b.substring(f),b=b.substring(0,f)):g=\\\"\\\";f=d.indexOf(\\\"!\\\");-1!=f&&(d=d.substring(0,f));f=p.OrderRangeParts(b,d);m=0;for(h=f.r1;h<=f.r2;h++)for(l=f.c1;l<=f.c2;l++)if(m++,m>e)return h==f.r2&&l==f.c2||p.PushOperand(a,\\\"range\\\",b+g+\\\"|\\\"+d+\\\"|\\\"+m),{value:SocialCalc.crToCoord(l,h)+g,type:\\\"coord\\\"}};\\nSocialCalc.Formula.DecodeRangeParts=function(a,c){var b,d,e,f,g=SocialCalc.Formula;e=c.indexOf(\\\"|\\\");f=c.indexOf(\\\"|\\\",e+1);b=c.substring(0,e);d=c.substring(e+1,f);e=b.indexOf(\\\"!\\\");-1!=e?(f=b.substring(e+1),b=b.substring(0,e)):f=\\\"\\\";e=d.indexOf(\\\"!\\\");-1!=e&&(d=d.substring(0,e));e=a;if(f&&(e=g.FindInSheetCache(f),null==e))return null;b=g.OrderRangeParts(b,d);return{sheetdata:e,sheetname:f,col1num:b.c1,ncols:b.c2-b.c1+1,row1num:b.r1,nrows:b.r2-b.r1+1}};\\nSocialCalc.Formula.FunctionList||(SocialCalc.Formula.FunctionList={});SocialCalc.Formula.FunctionClasses=null;SocialCalc.Formula.FunctionArgDefs={};\\nSocialCalc.Formula.CalculateFunction=function(a,c,b){var d,e,f,g=SocialCalc.Formula;e=\\\"\\\";if(d=g.FunctionList[a]){e=[];f=d[0];d=d[1];g.CopyFunctionArgs(c,e);if(100!=d)if(0>d){if(e.length<-d)return e=g.FunctionArgsError(a,c)}else if(e.length!=d)return e=g.FunctionArgsError(a,c);e=f(a,c,e,b)}else c.length&&\\\"start\\\"==c[c.length-1].type?(c.pop(),g.PushOperand(c,\\\"name\\\",a)):e=SocialCalc.Constants.s_sheetfuncunknownfunction+\\\" \\\"+a+\\\". \\\";return e};\\nSocialCalc.Formula.PushOperand=function(a,c,b){a.push({type:c,value:b})};SocialCalc.Formula.CopyFunctionArgs=function(a,c){for(;0<a.length&&\\\"start\\\"!=a[a.length-1].type;)c.push(a.pop());a.pop()};SocialCalc.Formula.FunctionArgsError=function(a,c){var b=SocialCalc.Constants.s_calcerrincorrectargstofunction+\\\" \\\"+a+\\\". \\\";SocialCalc.Formula.PushOperand(c,\\\"e#VALUE!\\\",b);return b};SocialCalc.Formula.FunctionSpecificError=function(a,c,b,d){SocialCalc.Formula.PushOperand(c,b,d);return d};\\nSocialCalc.Formula.CheckForErrorValue=function(a,c){return\\\"e\\\"==c.type.charAt(0)?(a.push(c),!0):!1};\\nSocialCalc.Formula.FillFunctionInfo=function(){var a=SocialCalc.Formula,c=SocialCalc.Constants,b,d,e;if(!a.FunctionClasses){for(b in a.FunctionList)d=a.FunctionList[b],d[2]&&(a.FunctionArgDefs[d[2]]=c[\\\"s_farg_\\\"+d[2]]||\\\"\\\"),d[3]||c[\\\"s_fdef_\\\"+b]&&(a.FunctionList[b][3]=c[\\\"s_fdef_\\\"+b]);a.FunctionClasses={};for(d=0;d<c.function_classlist.length;d++)e=c.function_classlist[d],a.FunctionClasses[e]={name:c[\\\"s_fclass_\\\"+e],items:[]};for(b in a.FunctionList)for(d=a.FunctionList[b],c=d[4]?d[4].split(\\\",\\\"):[],c.push(\\\"all\\\"),\\nd=0;d<c.length;d++)e=c[d],a.FunctionClasses[e].items.push(b);for(e in a.FunctionClasses)a.FunctionClasses[e].items.sort()}};SocialCalc.Formula.FunctionArgString=function(a){var c=SocialCalc.Formula;a=c.FunctionList[a];var b;b=a[2];if(!b)if(a=a[1],0==a)b=\\\" \\\";else{if(0<a){b=\\\"v1\\\";for(c=2;c<=a;c++)b+=\\\", v\\\"+c;return b}if(0>a){b=\\\"v1\\\";for(c=2;c<-a;c++)b+=\\\", v\\\"+c;return b+\\\", ...\\\"}return\\\"nargs: \\\"+a}return b=c.FunctionArgDefs[b]||b};\\nSocialCalc.Formula.SeriesFunctions=function(a,c,b,d){var e,f;e=SocialCalc.Formula;for(var g=e.OperandValueAndType,l=e.LookupResultType,h=e.TypeLookupTable.plus,m=function(a,b){c.push({type:a,value:b})},p=0,r=\\\"\\\",q=0,n=0,s=0,t=1,u,w,v,x,y,z;0<b.length;)e=g(d,b),f=e.type.charAt(0),\\\"n\\\"==f&&(q+=1),\\\"b\\\"!=f&&(n+=1),\\\"b\\\"==f&&(s+=1),\\\"n\\\"==f?(f=e.value-0,p+=f,t*=f,u=void 0!=u?f>u?f:u:f,w=void 0!=w?f<w?f:w:f,1==q?(y=f,z=0):(v=y+(f-y)/q,z=x=z+(f-y)*(f-v),y=v),r=l(e.type,r||e.type,h)):\\\"e\\\"==f&&\\\"e\\\"!=r.charAt(0)&&(r=\\ne.type);r=r||\\\"n\\\";switch(a){case \\\"SUM\\\":m(r,p);break;case \\\"PRODUCT\\\":m(r,t);break;case \\\"MIN\\\":m(r,w||0);break;case \\\"MAX\\\":m(r,u||0);break;case \\\"COUNT\\\":m(\\\"n\\\",q);break;case \\\"COUNTA\\\":m(\\\"n\\\",n);break;case \\\"COUNTBLANK\\\":m(\\\"n\\\",s);break;case \\\"AVERAGE\\\":0<q?m(r,p/q):m(\\\"e#DIV/0!\\\",0);break;case \\\"STDEV\\\":1<q?m(r,Math.sqrt(x/(q-1))):m(\\\"e#DIV/0!\\\",0);break;case \\\"STDEVP\\\":1<q?m(r,Math.sqrt(x/q)):m(\\\"e#DIV/0!\\\",0);break;case \\\"VAR\\\":1<q?m(r,x/(q-1)):m(\\\"e#DIV/0!\\\",0);break;case \\\"VARP\\\":1<q?m(r,x/q):m(\\\"e#DIV/0!\\\",0)}return null};\\nSocialCalc.Formula.FunctionList.AVERAGE=[SocialCalc.Formula.SeriesFunctions,-1,\\\"vn\\\",null,\\\"stat\\\"];SocialCalc.Formula.FunctionList.COUNT=[SocialCalc.Formula.SeriesFunctions,-1,\\\"vn\\\",null,\\\"stat\\\"];SocialCalc.Formula.FunctionList.COUNTA=[SocialCalc.Formula.SeriesFunctions,-1,\\\"vn\\\",null,\\\"stat\\\"];SocialCalc.Formula.FunctionList.COUNTBLANK=[SocialCalc.Formula.SeriesFunctions,-1,\\\"vn\\\",null,\\\"stat\\\"];SocialCalc.Formula.FunctionList.MAX=[SocialCalc.Formula.SeriesFunctions,-1,\\\"vn\\\",null,\\\"stat\\\"];\\nSocialCalc.Formula.FunctionList.MIN=[SocialCalc.Formula.SeriesFunctions,-1,\\\"vn\\\",null,\\\"stat\\\"];SocialCalc.Formula.FunctionList.PRODUCT=[SocialCalc.Formula.SeriesFunctions,-1,\\\"vn\\\",null,\\\"stat\\\"];SocialCalc.Formula.FunctionList.STDEV=[SocialCalc.Formula.SeriesFunctions,-1,\\\"vn\\\",null,\\\"stat\\\"];SocialCalc.Formula.FunctionList.STDEVP=[SocialCalc.Formula.SeriesFunctions,-1,\\\"vn\\\",null,\\\"stat\\\"];SocialCalc.Formula.FunctionList.SUM=[SocialCalc.Formula.SeriesFunctions,-1,\\\"vn\\\",null,\\\"stat\\\"];\\nSocialCalc.Formula.FunctionList.VAR=[SocialCalc.Formula.SeriesFunctions,-1,\\\"vn\\\",null,\\\"stat\\\"];SocialCalc.Formula.FunctionList.VARP=[SocialCalc.Formula.SeriesFunctions,-1,\\\"vn\\\",null,\\\"stat\\\"];\\nSocialCalc.Formula.SumProductFunction=function(a,c,b,d){for(var e=[],f=0,g=SocialCalc.Formula,l=0,h=0,m=function(a,b){c.push({type:a,value:b})};0<b.length;){a=g.TopOfStackValueAndType(d,b);if(\\\"range\\\"!=a.type){m(\\\"e#VALUE!\\\",0);return}rangeinfo=g.DecodeRangeParts(d,a.value);if(!l)l=rangeinfo.ncols;else if(l!=rangeinfo.ncols){m(\\\"e#VALUE!\\\",0);return}if(!h)h=rangeinfo.nrows;else if(h!=rangeinfo.nrows){m(\\\"e#VALUE!\\\",0);return}for(i=0;i<rangeinfo.ncols;i++)for(j=0;j<rangeinfo.nrows;j++)k=i*rangeinfo.nrows+\\nj,cellcr=SocialCalc.crToCoord(rangeinfo.col1num+i,rangeinfo.row1num+j),cell=rangeinfo.sheetdata.GetAssuredCell(cellcr),value=\\\"n\\\"==cell.valuetype?cell.datavalue:0,e[k]=(e[k]||1)*value}for(i=0;i<e.length;i++)f+=e[i];m(\\\"n\\\",f)};SocialCalc.Formula.FunctionList.SUMPRODUCT=[SocialCalc.Formula.SumProductFunction,-1,\\\"rangen\\\",\\\"\\\",\\\"stat\\\"];\\nSocialCalc.Formula.DSeriesFunctions=function(a,c,b,d){var e,f,g,l,h,m,p,r,q=SocialCalc.Formula,n=q.LookupResultType,s=q.TypeLookupTable.plus,t=function(a,b){c.push({type:a,value:b})};f=e=void 0;var u=0,w=\\\"\\\",v=0,x=0,y=1,z,C,D,G,I;g=q.TopOfStackValueAndType(d,b);l=q.OperandValueAndType(d,b);h=q.TopOfStackValueAndType(d,b);if(\\\"range\\\"!=g.type||\\\"range\\\"!=h.type)return q.FunctionArgsError(a,c);b=q.DecodeRangeParts(d,g.value);d=q.DecodeRangeParts(d,h.value);l=q.FieldToColnum(b.sheetdata,b.col1num,b.ncols,\\nb.row1num,l.value,l.type);if(0>=l)t(\\\"e#VALUE!\\\",0);else{l=b.col1num+l-1;h=[];for(g=0;g<d.ncols;g++){m=d.sheetdata.GetAssuredCell(SocialCalc.crToCoord(d.col1num+g,d.row1num));criterianum=q.FieldToColnum(b.sheetdata,b.col1num,b.ncols,b.row1num,m.datavalue,m.valuetype);if(0>=criterianum){t(\\\"e#VALUE!\\\",0);return}h.push(b.col1num+criterianum-1)}for(g=1;g<b.nrows;g++){p=!1;e=1;a:for(;e<d.nrows;e++){for(f=0;f<d.ncols;f++)if(r=SocialCalc.crToCoord(d.col1num+f,d.row1num+e),m=d.sheetdata.GetAssuredCell(r),r=\\nm.datavalue,\\\"string\\\"!=typeof r||0!=r.length)if(m=h[f],m=SocialCalc.crToCoord(m,b.row1num+g),m=d.sheetdata.GetAssuredCell(m),!q.TestCriteria(m.datavalue,m.valuetype||\\\"b\\\",r))continue a;p=!0;break a}p&&(e=SocialCalc.crToCoord(l,b.row1num+g),m=b.sheetdata.GetAssuredCell(e),e=m.datavalue,f=m.valuetype,p=f.charAt(0),\\\"n\\\"==p&&(v+=1),\\\"b\\\"!=p&&(x+=1),\\\"n\\\"==p?(v1=e-0,u+=v1,y*=v1,z=void 0!=z?v1>z?v1:z:v1,C=void 0!=C?v1<C?v1:C:v1,1==v?(G=v1,I=0):(e=G+(v1-G)/v,I=D=I+(v1-G)*(v1-e),G=e),w=n(f,w||f,s)):\\\"e\\\"==p&&\\\"e\\\"!=\\nw.charAt(0)&&(w=f))}w=w||\\\"n\\\";switch(a){case \\\"DSUM\\\":t(w,u);break;case \\\"DPRODUCT\\\":t(w,y);break;case \\\"DMIN\\\":t(w,C||0);break;case \\\"DMAX\\\":t(w,z||0);break;case \\\"DCOUNT\\\":t(\\\"n\\\",v);break;case \\\"DCOUNTA\\\":t(\\\"n\\\",x);break;case \\\"DAVERAGE\\\":0<v?t(w,u/v):t(\\\"e#DIV/0!\\\",0);break;case \\\"DSTDEV\\\":1<v?t(w,Math.sqrt(D/(v-1))):t(\\\"e#DIV/0!\\\",0);break;case \\\"DSTDEVP\\\":1<v?t(w,Math.sqrt(D/v)):t(\\\"e#DIV/0!\\\",0);break;case \\\"DVAR\\\":1<v?t(w,D/(v-1)):t(\\\"e#DIV/0!\\\",0);break;case \\\"DVARP\\\":1<v?t(w,D/v):t(\\\"e#DIV/0!\\\",0);break;case \\\"DGET\\\":1==v?t(w,\\nu):0==v?t(\\\"e#VALUE!\\\",0):t(\\\"e#NUM!\\\",0)}}};SocialCalc.Formula.FunctionList.DAVERAGE=[SocialCalc.Formula.DSeriesFunctions,3,\\\"dfunc\\\",\\\"\\\",\\\"stat\\\"];SocialCalc.Formula.FunctionList.DCOUNT=[SocialCalc.Formula.DSeriesFunctions,3,\\\"dfunc\\\",\\\"\\\",\\\"stat\\\"];SocialCalc.Formula.FunctionList.DCOUNTA=[SocialCalc.Formula.DSeriesFunctions,3,\\\"dfunc\\\",\\\"\\\",\\\"stat\\\"];SocialCalc.Formula.FunctionList.DGET=[SocialCalc.Formula.DSeriesFunctions,3,\\\"dfunc\\\",\\\"\\\",\\\"stat\\\"];\\nSocialCalc.Formula.FunctionList.DMAX=[SocialCalc.Formula.DSeriesFunctions,3,\\\"dfunc\\\",\\\"\\\",\\\"stat\\\"];SocialCalc.Formula.FunctionList.DMIN=[SocialCalc.Formula.DSeriesFunctions,3,\\\"dfunc\\\",\\\"\\\",\\\"stat\\\"];SocialCalc.Formula.FunctionList.DPRODUCT=[SocialCalc.Formula.DSeriesFunctions,3,\\\"dfunc\\\",\\\"\\\",\\\"stat\\\"];SocialCalc.Formula.FunctionList.DSTDEV=[SocialCalc.Formula.DSeriesFunctions,3,\\\"dfunc\\\",\\\"\\\",\\\"stat\\\"];SocialCalc.Formula.FunctionList.DSTDEVP=[SocialCalc.Formula.DSeriesFunctions,3,\\\"dfunc\\\",\\\"\\\",\\\"stat\\\"];\\nSocialCalc.Formula.FunctionList.DSUM=[SocialCalc.Formula.DSeriesFunctions,3,\\\"dfunc\\\",\\\"\\\",\\\"stat\\\"];SocialCalc.Formula.FunctionList.DVAR=[SocialCalc.Formula.DSeriesFunctions,3,\\\"dfunc\\\",\\\"\\\",\\\"stat\\\"];SocialCalc.Formula.FunctionList.DVARP=[SocialCalc.Formula.DSeriesFunctions,3,\\\"dfunc\\\",\\\"\\\",\\\"stat\\\"];\\nSocialCalc.Formula.FieldToColnum=function(a,c,b,d,e,f){var g;if(\\\"n\\\"==f.charAt(0))return f=e-0,0>=f||f>b?0:Math.floor(f);if(\\\"t\\\"!=f.charAt(0))return 0;e=e?e.toLowerCase():\\\"\\\";for(f=0;f<b;f++)if(g=a.GetAssuredCell(SocialCalc.crToCoord(c+f,d)),g=g.datavalue,g=(g+\\\"\\\").toLowerCase(),g==e)return f+1;return 0};\\nSocialCalc.Formula.LookupFunctions=function(a,c,b,d){var e,f,g,l,h,m,p,r,q,n,s;s=SocialCalc.Formula;e=s.OperandValueAndType;var t=function(a,b){c.push({type:a,value:b})};e=e(d,b);\\\"string\\\"==typeof e.value&&(e.value=e.value.toLowerCase());f=s.TopOfStackValueAndType(d,b);g=1;if(\\\"MATCH\\\"==a){if(b.length){g=s.OperandAsNumber(d,b);if(\\\"n\\\"!=g.type.charAt(0)){t(\\\"e#VALUE!\\\",0);return}if(b.length)return s.FunctionArgsError(a,c),0;g=g.value-0}}else{l=s.OperandAsNumber(d,b);if(\\\"n\\\"!=l.type.charAt(0)){t(\\\"e#VALUE!\\\",\\n0);return}l=Math.floor(l.value);if(b.length){g=s.OperandAsNumber(d,b);if(\\\"n\\\"!=g.type.charAt(0)){t(\\\"e#VALUE!\\\",0);return}if(b.length)return s.FunctionArgsError(a,c),0;g=g.value?1:0}}e.type=e.type.charAt(0);\\\"n\\\"==e.type&&(e.value-=0);if(\\\"range\\\"!=f.type)return s.FunctionArgsError(a,c),0;if(b=s.DecodeRangeParts(d,f.value,f.type)){m=h=f=d=0;if(\\\"HLOOKUP\\\"==a){if(h=1,l>b.nrows){t(\\\"e#REF!\\\",0);return}}else if(\\\"VLOOKUP\\\"==a){if(m=1,l>b.ncols){t(\\\"e#REF!\\\",0);return}}else if(\\\"MATCH\\\"==a)if(1<b.ncols){if(1<b.nrows){t(\\\"e#N/A\\\",\\n0);return}h=1}else m=1;else return s.FunctionArgsError(a,c),0;if(1>l&&\\\"MATCH\\\"!=a)return t(\\\"e#VALUE!\\\",0),0;for(;;){s=SocialCalc.crToCoord(b.col1num+d,b.row1num+f);n=b.sheetdata.GetAssuredCell(s);s=n.datavalue;n=n.valuetype?n.valuetype.charAt(0):\\\"b\\\";\\\"n\\\"==n&&(s-=0);if(g)if(\\\"n\\\"==e.type&&\\\"n\\\"==n){if(e.value==s)break;if(0<g&&e.value>s||0>g&&e.value<s)p=1,r=d,q=f;else if(p){p=2;break}}else{if(\\\"t\\\"==e.type&&\\\"t\\\"==n){s=\\\"string\\\"==typeof s?s.toLowerCase():\\\"\\\";if(e.value==s)break;if(0<g&&e.value>s||0>g&&e.value<\\ns)p=1,r=d,q=f;else if(p){p=2;break}}}else if(\\\"n\\\"==e.type&&\\\"n\\\"==n){if(e.value==s)break}else if(\\\"t\\\"==e.type&&\\\"t\\\"==n&&(s=\\\"string\\\"==typeof s?s.toLowerCase():\\\"\\\",e.value==s))break;f+=m;d+=h;if(f>=b.nrows||d>=b.ncols){if(p){p=2;break}t(\\\"e#N/A\\\",0);return}}2==p&&(f=q,d=r);\\\"MATCH\\\"==a?(s=d+f+1,n=\\\"n\\\"):(s=SocialCalc.crToCoord(b.col1num+d+(\\\"VLOOKUP\\\"==a?l-1:0),b.row1num+f+(\\\"HLOOKUP\\\"==a?l-1:0)),n=b.sheetdata.GetAssuredCell(s),s=n.datavalue,n=n.valuetype);t(n,s)}else t(\\\"e#REF!\\\",0)};\\nSocialCalc.Formula.FunctionList.HLOOKUP=[SocialCalc.Formula.LookupFunctions,-3,\\\"hlookup\\\",\\\"\\\",\\\"lookup\\\"];SocialCalc.Formula.FunctionList.MATCH=[SocialCalc.Formula.LookupFunctions,-2,\\\"match\\\",\\\"\\\",\\\"lookup\\\"];SocialCalc.Formula.FunctionList.VLOOKUP=[SocialCalc.Formula.LookupFunctions,-3,\\\"vlookup\\\",\\\"\\\",\\\"lookup\\\"];\\nSocialCalc.Formula.IndexFunction=function(a,c,b,d){var e,f,g,l,h=SocialCalc.Formula,m=function(a,b){c.push({type:a,value:b})};e=h.TopOfStackValueAndType(d,b);if(\\\"range\\\"!=e.type)return h.FunctionArgsError(a,c),0;f=h.DecodeRangeParts(d,e.value,e.type);e=f.sheetname?\\\"!\\\"+f.sheetname:\\\"\\\";g={value:0};l={value:0};if(b.length){g=h.OperandAsNumber(d,b);if(\\\"n\\\"!=g.type.charAt(0)||0>g.value){m(\\\"e#VALUE!\\\",0);return}if(b.length){l=h.OperandAsNumber(d,b);if(\\\"n\\\"!=l.type.charAt(0)||0>l.value){m(\\\"e#VALUE!\\\",0);return}if(b.length)return h.FunctionArgsError(a,\\nc),0}else 1==f.nrows&&(l.value=g.value,g.value=0)}g.value>f.nrows||l.value>f.ncols?m(\\\"e#REF!\\\",0):(0==g.value?0==l.value?1==f.nrows&&1==f.ncols?(a=SocialCalc.crToCoord(f.col1num,f.row1num)+e,b=\\\"coord\\\"):(a=SocialCalc.crToCoord(f.col1num,f.row1num)+e+\\\"|\\\"+SocialCalc.crToCoord(f.col1num+f.ncols-1,f.row1num+f.nrows-1)+\\\"|\\\",b=\\\"range\\\"):1==f.nrows?(a=SocialCalc.crToCoord(f.col1num+l.value-1,f.row1num)+e,b=\\\"coord\\\"):(a=SocialCalc.crToCoord(f.col1num+l.value-1,f.row1num)+e+\\\"|\\\"+SocialCalc.crToCoord(f.col1num+l.value-\\n1,f.row1num+f.nrows-1)+\\\"|\\\",b=\\\"range\\\"):0==l.value?1==f.ncols?(a=SocialCalc.crToCoord(f.col1num,f.row1num+g.value-1)+e,b=\\\"coord\\\"):(a=SocialCalc.crToCoord(f.col1num,f.row1num+g.value-1)+e+\\\"|\\\"+SocialCalc.crToCoord(f.col1num+f.ncols-1,f.row1num+g.value-1)+\\\"|\\\",b=\\\"range\\\"):(a=SocialCalc.crToCoord(f.col1num+l.value-1,f.row1num+g.value-1)+e,b=\\\"coord\\\"),m(b,a))};SocialCalc.Formula.FunctionList.INDEX=[SocialCalc.Formula.IndexFunction,-1,\\\"index\\\",\\\"\\\",\\\"lookup\\\"];\\nSocialCalc.Formula.CountifSumifFunctions=function(a,c,b,d){var e,f,g,l,h=0,m=\\\"\\\",p=0,r=SocialCalc.Formula,q=r.OperandValueAndType,n=r.LookupResultType,s=r.TypeLookupTable.plus;e=r.TopOfStackValueAndType(d,b);f=r.OperandAsText(d,b);if(\\\"SUMIF\\\"==a)if(1==b.length)g=r.TopOfStackValueAndType(d,b);else if(0==b.length)g={value:e.value,type:e.type};else return r.FunctionArgsError(a,c),0;else g={value:e.value,type:e.type};\\\"n\\\"==f.type.charAt(0)?f.value+=\\\"\\\":\\\"e\\\"==f.type.charAt(0)?f.value=null:\\\"b\\\"==f.type.charAt(0)&&\\n(f.value=null);if(\\\"coord\\\"!=e.type&&\\\"range\\\"!=e.type||\\\"SUMIF\\\"==a&&\\\"coord\\\"!=g.type&&\\\"range\\\"!=g.type)return r.FunctionArgsError(a,c),0;b.push(e);e=[];for(e.push(g);b.length;)g=q(d,b),l=q(d,e),r.TestCriteria(g.value,g.type,f.value)&&(p+=1,\\\"n\\\"==l.type.charAt(0)?(h+=l.value-0,m=n(l.type,m||l.type,s)):\\\"e\\\"==l.type.charAt(0)&&\\\"e\\\"!=m.charAt(0)&&(m=l.type));\\\"SUMIF\\\"==a?c.push({type:m||\\\"n\\\",value:h}):\\\"COUNTIF\\\"==a&&c.push({type:\\\"n\\\",value:p})};\\nSocialCalc.Formula.FunctionList.COUNTIF=[SocialCalc.Formula.CountifSumifFunctions,2,\\\"rangec\\\",\\\"\\\",\\\"stat\\\"];SocialCalc.Formula.FunctionList.SUMIF=[SocialCalc.Formula.CountifSumifFunctions,-2,\\\"sumif\\\",\\\"\\\",\\\"stat\\\"];\\nSocialCalc.Formula.SumifsFunction=function(a,c,b,d){var e,f,g,l=0,h=\\\"\\\",m=SocialCalc.Formula,p=m.OperandValueAndType,r=m.LookupResultType,q=m.TypeLookupTable.plus;g=m.TopOfStackValueAndType(d,b);if(\\\"coord\\\"!=g.type&&\\\"range\\\"!=g.type)return m.FunctionArgsError(a,c),0;for(var n=[],s=[];b.length;){e=m.TopOfStackValueAndType(d,b);f=m.OperandAsText(d,b);\\\"n\\\"==f.type.charAt(0)?f.value+=\\\"\\\":\\\"e\\\"==f.type.charAt(0)?f.value=null:\\\"b\\\"==f.type.charAt(0)&&(f.value=null);if(\\\"coord\\\"!=e.type&&\\\"range\\\"!=e.type)return m.FunctionArgsError(a,\\nc),0;n.push([e]);s.push(f)}a=[];for(a.push(g);a.length;){b=p(d,a);e=!0;for(f=0;f<n.length;f++)if(g=p(d,n[f]),!m.TestCriteria(g.value,g.type,s[f].value)){e=!1;break}e&&(\\\"n\\\"==b.type.charAt(0)?(l+=b.value-0,h=r(b.type,h||b.type,q)):\\\"e\\\"==b.type.charAt(0)&&\\\"e\\\"!=h.charAt(0)&&(h=b.type))}c.push({type:h||\\\"n\\\",value:l})};SocialCalc.Formula.FunctionList.SUMIFS=[SocialCalc.Formula.SumifsFunction,-3,\\\"sumifs\\\",\\\"\\\",\\\"stat\\\"];\\nSocialCalc.Formula.IfFunction=function(a,c,b,d){var e;d=SocialCalc.Formula.OperandValueAndType(d,b);e=d.type.charAt(0);if(\\\"n\\\"!=e&&\\\"b\\\"!=e)c.push({type:\\\"e#VALUE!\\\",value:0});else{e=b.pop();if(1==b.length)a=b.pop();else if(0==b.length)a={type:\\\"n\\\",value:0};else{scf.FunctionArgsError(a,c);return}c.push(d.value?e:a)}};SocialCalc.Formula.FunctionList.IF=[SocialCalc.Formula.IfFunction,-2,\\\"iffunc\\\",\\\"\\\",\\\"test\\\"];\\nSocialCalc.Formula.DateFunction=function(a,c,b,d){a=SocialCalc.Formula;var e=0,f=a.OperandAsNumber(d,b),g=a.OperandAsNumber(d,b);b=a.OperandAsNumber(d,b);d=a.LookupResultType(f.type,g.type,a.TypeLookupTable.twoargnumeric);d=a.LookupResultType(d,b.type,a.TypeLookupTable.twoargnumeric);\\\"n\\\"==d.charAt(0)&&(e=SocialCalc.FormatNumber.convert_date_gregorian_to_julian(Math.floor(f.value),Math.floor(g.value),Math.floor(b.value))-SocialCalc.FormatNumber.datevalues.julian_offset,d=\\\"nd\\\");a.PushOperand(c,d,e)};\\nSocialCalc.Formula.FunctionList.DATE=[SocialCalc.Formula.DateFunction,3,\\\"date\\\",\\\"\\\",\\\"datetime\\\"];SocialCalc.Formula.TimeFunction=function(a,c,b,d){a=SocialCalc.Formula;var e=0,f=a.OperandAsNumber(d,b),g=a.OperandAsNumber(d,b);b=a.OperandAsNumber(d,b);d=a.LookupResultType(f.type,g.type,a.TypeLookupTable.twoargnumeric);d=a.LookupResultType(d,b.type,a.TypeLookupTable.twoargnumeric);\\\"n\\\"==d.charAt(0)&&(e=(3600*f.value+60*g.value+b.value)/86400,d=\\\"nt\\\");a.PushOperand(c,d,e)};\\nSocialCalc.Formula.FunctionList.TIME=[SocialCalc.Formula.TimeFunction,3,\\\"hms\\\",\\\"\\\",\\\"datetime\\\"];\\nSocialCalc.Formula.DMYFunctions=function(a,c,b,d){var e,f=SocialCalc.Formula,g=0,l=f.OperandAsNumber(d,b),h=f.LookupResultType(l.type,l.type,f.TypeLookupTable.oneargnumeric);if(\\\"n\\\"==h.charAt(0))switch(e=SocialCalc.FormatNumber.convert_date_julian_to_gregorian(Math.floor(l.value+SocialCalc.FormatNumber.datevalues.julian_offset)),a){case \\\"DAY\\\":g=e.day;break;case \\\"MONTH\\\":g=e.month;break;case \\\"YEAR\\\":g=e.year;break;case \\\"WEEKDAY\\\":e={value:1};if(b.length){e=f.OperandAsNumber(d,b);if(\\\"n\\\"!=e.type.charAt(0)||\\n1>e.value||3<e.value){f.PushOperand(c,\\\"e#VALUE!\\\",0);return}if(b.length){f.FunctionArgsError(a,c);return}}a=6;1<e.value&&--a;g=Math.floor(l.value+a)%7+(3>e.value?1:0)}f.PushOperand(c,h,g)};SocialCalc.Formula.FunctionList.DAY=[SocialCalc.Formula.DMYFunctions,1,\\\"v\\\",\\\"\\\",\\\"datetime\\\"];SocialCalc.Formula.FunctionList.MONTH=[SocialCalc.Formula.DMYFunctions,1,\\\"v\\\",\\\"\\\",\\\"datetime\\\"];SocialCalc.Formula.FunctionList.YEAR=[SocialCalc.Formula.DMYFunctions,1,\\\"v\\\",\\\"\\\",\\\"datetime\\\"];\\nSocialCalc.Formula.FunctionList.WEEKDAY=[SocialCalc.Formula.DMYFunctions,-1,\\\"weekday\\\",\\\"\\\",\\\"datetime\\\"];\\nSocialCalc.Formula.HMSFunctions=function(a,c,b,d){var e,f=SocialCalc.Formula,g=0,l=f.OperandAsNumber(d,b),h=f.LookupResultType(l.type,l.type,f.TypeLookupTable.oneargnumeric);if(\\\"n\\\"==h.charAt(0)){if(0>l.value){f.PushOperand(c,\\\"e#NUM!\\\",0);return}e=l.value-Math.floor(l.value);e*=24;b=Math.floor(e);e-=Math.floor(e);e*=60;d=Math.floor(e);e-=Math.floor(e);e=Math.floor(60*e+(0<=l.value?.5:-.5));\\\"HOUR\\\"==a?g=b:\\\"MINUTE\\\"==a?g=d:\\\"SECOND\\\"==a&&(g=e)}f.PushOperand(c,h,g)};\\nSocialCalc.Formula.FunctionList.HOUR=[SocialCalc.Formula.HMSFunctions,1,\\\"v\\\",\\\"\\\",\\\"datetime\\\"];SocialCalc.Formula.FunctionList.MINUTE=[SocialCalc.Formula.HMSFunctions,1,\\\"v\\\",\\\"\\\",\\\"datetime\\\"];SocialCalc.Formula.FunctionList.SECOND=[SocialCalc.Formula.HMSFunctions,1,\\\"v\\\",\\\"\\\",\\\"datetime\\\"];\\nSocialCalc.Formula.ExactFunction=function(a,c,b,d){a=SocialCalc.Formula;var e=0,f=\\\"nl\\\",g=a.OperandValueAndType(d,b),l=g.type.charAt(0);b=a.OperandValueAndType(d,b);d=b.type.charAt(0);\\\"t\\\"==l?\\\"t\\\"==d?e=g.value==b.value?1:0:\\\"b\\\"==d?e=g.value.length?0:1:\\\"n\\\"==d?e=g.value==b.value+\\\"\\\"?1:0:\\\"e\\\"==d?(e=b.value,f=b.type):e=0:\\\"n\\\"==l?\\\"n\\\"==d?e=g.value-0==b.value-0?1:0:\\\"b\\\"==d?e=0:\\\"t\\\"==d?e=g.value+\\\"\\\"==b.value?1:0:\\\"e\\\"==d?(e=b.value,f=b.type):e=0:\\\"b\\\"==l?\\\"t\\\"==d?e=b.value.length?0:1:\\\"b\\\"==d?e=1:\\\"n\\\"==d?e=0:\\\"e\\\"==d?(e=b.value,\\nf=b.type):e=0:\\\"e\\\"==l&&(e=g.value,f=g.type);a.PushOperand(c,f,e)};SocialCalc.Formula.FunctionList.EXACT=[SocialCalc.Formula.ExactFunction,2,\\\"\\\",\\\"\\\",\\\"text\\\"];SocialCalc.Formula.ArgList={FIND:[1,1,0],LEFT:[1,0],LEN:[1],LOWER:[1],MID:[1,0,0],PROPER:[1],REPLACE:[1,0,0,1],REPT:[1,0],RIGHT:[1,0],SUBSTITUTE:[1,1,1,0],TRIM:[1],HEXCODE:[1],UPPER:[1]};\\nSocialCalc.Formula.StringFunctions=function(a,c,b,d){var e,f,g,l=SocialCalc.Formula;g=0;var h=\\\"e#VALUE!\\\",m=b.length,p=l.ArgList[a],r=[],q=[];for(e=1;e<=m;e++){if(e>p.length){l.FunctionArgsError(a,c);return}0==p[e-1]?f=l.OperandAsNumber(d,b):1==p[e-1]?f=l.OperandAsText(d,b):-1==p[e-1]&&(f=l.OperandValueAndType(d,b));r[e]=f.value;q[e]=f.type;if(\\\"e\\\"==f.type.charAt(0)){l.PushOperand(c,f.type,g);return}}switch(a){case \\\"FIND\\\":g=q[3]?r[3]-1:0;0>g?g=\\\"Start is before string\\\":(g=r[2].indexOf(r[1],g),0<=g?(g+=\\n1,h=\\\"n\\\"):g=\\\"Not found\\\");break;case \\\"LEFT\\\":g=q[2]?r[2]-0:1;0>g?g=\\\"Negative length\\\":(g=r[1].substring(0,g),h=\\\"t\\\");break;case \\\"LEN\\\":g=r[1].length;h=\\\"n\\\";break;case \\\"LOWER\\\":g=r[1].toLowerCase();h=\\\"t\\\";break;case \\\"MID\\\":a=r[2]-0;g=r[3]-0;1>g||1>a?g=\\\"Bad arguments\\\":(g=r[1].substring(a-1,a+g-1),h=\\\"t\\\");break;case \\\"PROPER\\\":g=r[1].replace(/\\\\b\\\\w+\\\\b/g,function(a){return a.substring(0,1).toUpperCase()+a.substring(1)});h=\\\"t\\\";break;case \\\"REPLACE\\\":a=r[2]-0;g=r[3]-0;0>g||1>a?g=\\\"Bad arguments\\\":(g=r[1].substring(0,a-1)+\\nr[4]+r[1].substring(a-1+g),h=\\\"t\\\");break;case \\\"REPT\\\":a=r[2]-0;if(0>a)g=\\\"Negative count\\\";else{for(g=\\\"\\\";0<a;a--)g+=r[1];h=\\\"t\\\"}break;case \\\"RIGHT\\\":g=q[2]?r[2]-0:1;0>g?g=\\\"Negative length\\\":(g=r[1].slice(-g),h=\\\"t\\\");break;case \\\"SUBSTITUTE\\\":fulltext=r[1];oldtext=r[2];newtext=r[3];if(null!=r[4]){if(which=r[4]-0,0>=which){g=\\\"Non-positive instance number\\\";break}}else which=0;oldpos=a=0;for(g=\\\"\\\";;)if(pos=fulltext.indexOf(oldtext,oldpos),0<=pos){a++;g+=fulltext.substring(oldpos,pos);if(0==which)g+=newtext;else if(which==\\na){g+=newtext+fulltext.substring(pos+oldtext.length);break}else g+=oldtext;oldpos=pos+oldtext.length}else{g+=fulltext.substring(oldpos);break}h=\\\"t\\\";break;case \\\"TRIM\\\":g=r[1];g=g.replace(/^ */,\\\"\\\");g=g.replace(/ *$/,\\\"\\\");g=g.replace(/ +/g,\\\" \\\");h=\\\"t\\\";break;case \\\"HEXCODE\\\":g=String(r[1]);h=g.charCodeAt(0);55296<=h&&56319>=h&&(r=g.charCodeAt(1),56320<=r&&57343>=r&&(h=1024*(h-55296)+(r-56320)+65536));g=h.toString(16).toUpperCase();h=\\\"t\\\";break;case \\\"UPPER\\\":g=r[1].toUpperCase(),h=\\\"t\\\"}l.PushOperand(c,h,g)};\\nSocialCalc.Formula.FunctionList.FIND=[SocialCalc.Formula.StringFunctions,-2,\\\"find\\\",\\\"\\\",\\\"text\\\"];SocialCalc.Formula.FunctionList.LEFT=[SocialCalc.Formula.StringFunctions,-2,\\\"tc\\\",\\\"\\\",\\\"text\\\"];SocialCalc.Formula.FunctionList.LEN=[SocialCalc.Formula.StringFunctions,1,\\\"txt\\\",\\\"\\\",\\\"text\\\"];SocialCalc.Formula.FunctionList.LOWER=[SocialCalc.Formula.StringFunctions,1,\\\"txt\\\",\\\"\\\",\\\"text\\\"];SocialCalc.Formula.FunctionList.MID=[SocialCalc.Formula.StringFunctions,3,\\\"mid\\\",\\\"\\\",\\\"text\\\"];\\nSocialCalc.Formula.FunctionList.PROPER=[SocialCalc.Formula.StringFunctions,1,\\\"v\\\",\\\"\\\",\\\"text\\\"];SocialCalc.Formula.FunctionList.REPLACE=[SocialCalc.Formula.StringFunctions,4,\\\"replace\\\",\\\"\\\",\\\"text\\\"];SocialCalc.Formula.FunctionList.REPT=[SocialCalc.Formula.StringFunctions,2,\\\"tc\\\",\\\"\\\",\\\"text\\\"];SocialCalc.Formula.FunctionList.RIGHT=[SocialCalc.Formula.StringFunctions,-1,\\\"tc\\\",\\\"\\\",\\\"text\\\"];SocialCalc.Formula.FunctionList.SUBSTITUTE=[SocialCalc.Formula.StringFunctions,-3,\\\"subs\\\",\\\"\\\",\\\"text\\\"];\\nSocialCalc.Formula.FunctionList.TRIM=[SocialCalc.Formula.StringFunctions,1,\\\"v\\\",\\\"\\\",\\\"text\\\"];SocialCalc.Formula.FunctionList.HEXCODE=[SocialCalc.Formula.StringFunctions,1,\\\"v\\\",\\\"\\\",\\\"text\\\"];SocialCalc.Formula.FunctionList.UPPER=[SocialCalc.Formula.StringFunctions,1,\\\"v\\\",\\\"\\\",\\\"text\\\"];\\nSocialCalc.Formula.IsFunctions=function(a,c,b,d){var e=SocialCalc.Formula,f=0;b=e.OperandValueAndType(d,b);d=b.type.charAt(0);switch(a){case \\\"ISBLANK\\\":f=\\\"b\\\"==b.type?1:0;break;case \\\"ISERR\\\":f=\\\"e\\\"==d?\\\"e#N/A\\\"==b.type?0:1:0;break;case \\\"ISERROR\\\":f=\\\"e\\\"==d?1:0;break;case \\\"ISLOGICAL\\\":f=\\\"nl\\\"==b.type?1:0;break;case \\\"ISNA\\\":f=\\\"e#N/A\\\"==b.type?1:0;break;case \\\"ISNONTEXT\\\":f=\\\"t\\\"==d?0:1;break;case \\\"ISNUMBER\\\":f=\\\"n\\\"==d?1:0;break;case \\\"ISTEXT\\\":f=\\\"t\\\"==d?1:0}e.PushOperand(c,\\\"nl\\\",f)};\\nSocialCalc.Formula.FunctionList.ISBLANK=[SocialCalc.Formula.IsFunctions,1,\\\"v\\\",\\\"\\\",\\\"test\\\"];SocialCalc.Formula.FunctionList.ISERR=[SocialCalc.Formula.IsFunctions,1,\\\"v\\\",\\\"\\\",\\\"test\\\"];SocialCalc.Formula.FunctionList.ISERROR=[SocialCalc.Formula.IsFunctions,1,\\\"v\\\",\\\"\\\",\\\"test\\\"];SocialCalc.Formula.FunctionList.ISLOGICAL=[SocialCalc.Formula.IsFunctions,1,\\\"v\\\",\\\"\\\",\\\"test\\\"];SocialCalc.Formula.FunctionList.ISNA=[SocialCalc.Formula.IsFunctions,1,\\\"v\\\",\\\"\\\",\\\"test\\\"];\\nSocialCalc.Formula.FunctionList.ISNONTEXT=[SocialCalc.Formula.IsFunctions,1,\\\"v\\\",\\\"\\\",\\\"test\\\"];SocialCalc.Formula.FunctionList.ISNUMBER=[SocialCalc.Formula.IsFunctions,1,\\\"v\\\",\\\"\\\",\\\"test\\\"];SocialCalc.Formula.FunctionList.ISTEXT=[SocialCalc.Formula.IsFunctions,1,\\\"v\\\",\\\"\\\",\\\"test\\\"];\\nSocialCalc.Formula.NTVFunctions=function(a,c,b,d){var e=SocialCalc.Formula,f=0,g=\\\"e#VALUE!\\\";b=e.OperandValueAndType(d,b);d=b.type.charAt(0);switch(a){case \\\"N\\\":f=\\\"n\\\"==d?b.value-0:0;g=\\\"n\\\";break;case \\\"T\\\":f=\\\"t\\\"==d?b.value+\\\"\\\":\\\"\\\";g=\\\"t\\\";break;case \\\"VALUE\\\":\\\"n\\\"==d||\\\"b\\\"==d?(f=b.value||0,g=\\\"n\\\"):\\\"t\\\"==d&&(b=SocialCalc.DetermineValueType(b.value),\\\"n\\\"!=b.type.charAt(0)?(f=0,g=\\\"e#VALUE!\\\"):(f=b.value-0,g=\\\"n\\\"))}\\\"e\\\"==d&&(g=b.type);e.PushOperand(c,g,f)};\\nSocialCalc.Formula.FunctionList.N=[SocialCalc.Formula.NTVFunctions,1,\\\"v\\\",\\\"\\\",\\\"math\\\"];SocialCalc.Formula.FunctionList.T=[SocialCalc.Formula.NTVFunctions,1,\\\"v\\\",\\\"\\\",\\\"text\\\"];SocialCalc.Formula.FunctionList.VALUE=[SocialCalc.Formula.NTVFunctions,1,\\\"v\\\",\\\"\\\",\\\"text\\\"];\\nSocialCalc.Formula.Math1Functions=function(a,c,b,d){var e={},f=SocialCalc.Formula;d=f.OperandAsNumber(d,b);b=d.value;e.type=f.LookupResultType(d.type,d.type,f.TypeLookupTable.oneargnumeric);if(\\\"n\\\"==e.type)switch(a){case \\\"ABS\\\":b=Math.abs(b);break;case \\\"ACOS\\\":-1<=b&&1>=b?b=Math.acos(b):e.type=\\\"e#NUM!\\\";break;case \\\"ASIN\\\":-1<=b&&1>=b?b=Math.asin(b):e.type=\\\"e#NUM!\\\";break;case \\\"ATAN\\\":b=Math.atan(b);break;case \\\"COS\\\":b=Math.cos(b);break;case \\\"DEGREES\\\":b=180*b/Math.PI;break;case \\\"EVEN\\\":b=0>b?-b:b;b=b!=Math.floor(b)?\\nMath.floor(b+1)+Math.floor(b+1)%2:b+b%2;0>d.value&&(b=-b);break;case \\\"EXP\\\":b=Math.exp(b);break;case \\\"FACT\\\":a=1;for(b=Math.floor(b);0<b;b--)a*=b;b=a;break;case \\\"INT\\\":b=Math.floor(b);break;case \\\"LN\\\":0>=b&&(e.type=\\\"e#NUM!\\\",e.error=SocialCalc.Constants.s_sheetfunclnarg);b=Math.log(b);break;case \\\"LOG10\\\":0>=b&&(e.type=\\\"e#NUM!\\\",e.error=SocialCalc.Constants.s_sheetfunclog10arg);b=Math.log(b)/Math.log(10);break;case \\\"ODD\\\":b=0>b?-b:b;b=b!=Math.floor(b)?Math.floor(b+1)+(1-Math.floor(b+1)%2):b+(1-b%2);0>d.value&&\\n(b=-b);break;case \\\"RADIANS\\\":b=b*Math.PI/180;break;case \\\"SIN\\\":b=Math.sin(b);break;case \\\"SQRT\\\":0<=b?b=Math.sqrt(b):e.type=\\\"e#NUM!\\\";break;case \\\"TAN\\\":0!=Math.cos(b)?b=Math.tan(b):e.type=\\\"e#NUM!\\\"}e.value=b;c.push(e);return null};SocialCalc.Formula.FunctionList.ABS=[SocialCalc.Formula.Math1Functions,1,\\\"v\\\",\\\"\\\",\\\"math\\\"];SocialCalc.Formula.FunctionList.ACOS=[SocialCalc.Formula.Math1Functions,1,\\\"v\\\",\\\"\\\",\\\"math\\\"];SocialCalc.Formula.FunctionList.ASIN=[SocialCalc.Formula.Math1Functions,1,\\\"v\\\",\\\"\\\",\\\"math\\\"];\\nSocialCalc.Formula.FunctionList.ATAN=[SocialCalc.Formula.Math1Functions,1,\\\"v\\\",\\\"\\\",\\\"math\\\"];SocialCalc.Formula.FunctionList.COS=[SocialCalc.Formula.Math1Functions,1,\\\"v\\\",\\\"\\\",\\\"math\\\"];SocialCalc.Formula.FunctionList.DEGREES=[SocialCalc.Formula.Math1Functions,1,\\\"v\\\",\\\"\\\",\\\"math\\\"];SocialCalc.Formula.FunctionList.EVEN=[SocialCalc.Formula.Math1Functions,1,\\\"v\\\",\\\"\\\",\\\"math\\\"];SocialCalc.Formula.FunctionList.EXP=[SocialCalc.Formula.Math1Functions,1,\\\"v\\\",\\\"\\\",\\\"math\\\"];\\nSocialCalc.Formula.FunctionList.FACT=[SocialCalc.Formula.Math1Functions,1,\\\"v\\\",\\\"\\\",\\\"math\\\"];SocialCalc.Formula.FunctionList.INT=[SocialCalc.Formula.Math1Functions,1,\\\"v\\\",\\\"\\\",\\\"math\\\"];SocialCalc.Formula.FunctionList.LN=[SocialCalc.Formula.Math1Functions,1,\\\"v\\\",\\\"\\\",\\\"math\\\"];SocialCalc.Formula.FunctionList.LOG10=[SocialCalc.Formula.Math1Functions,1,\\\"v\\\",\\\"\\\",\\\"math\\\"];SocialCalc.Formula.FunctionList.ODD=[SocialCalc.Formula.Math1Functions,1,\\\"v\\\",\\\"\\\",\\\"math\\\"];\\nSocialCalc.Formula.FunctionList.RADIANS=[SocialCalc.Formula.Math1Functions,1,\\\"v\\\",\\\"\\\",\\\"math\\\"];SocialCalc.Formula.FunctionList.SIN=[SocialCalc.Formula.Math1Functions,1,\\\"v\\\",\\\"\\\",\\\"math\\\"];SocialCalc.Formula.FunctionList.SQRT=[SocialCalc.Formula.Math1Functions,1,\\\"v\\\",\\\"\\\",\\\"math\\\"];SocialCalc.Formula.FunctionList.TAN=[SocialCalc.Formula.Math1Functions,1,\\\"v\\\",\\\"\\\",\\\"math\\\"];\\nSocialCalc.Formula.Math2Functions=function(a,c,b,d){var e,f,g={};f=SocialCalc.Formula;e=f.OperandAsNumber(d,b);b=f.OperandAsNumber(d,b);g.type=f.LookupResultType(e.type,b.type,f.TypeLookupTable.twoargnumeric);if(\\\"n\\\"==g.type)switch(a){case \\\"ATAN2\\\":0==e.value&&0==b.value?g.type=\\\"e#DIV/0!\\\":g.value=Math.atan2(b.value,e.value);break;case \\\"POWER\\\":g.value=Math.pow(e.value,b.value);isNaN(g.value)&&(g.value=0,g.type=\\\"e#NUM!\\\");break;case \\\"MOD\\\":0==b.value?g.type=\\\"e#DIV/0!\\\":(a=e.value/b.value,a=Math.floor(a),\\ng.value=e.value-a*b.value);break;case \\\"TRUNC\\\":a=1;if(0<=b.value){b.value=Math.floor(b.value);for(f=0;f<b.value;f++)a*=10;g.value=Math.floor(Math.abs(e.value)*a)/a}else if(0>b.value){b.value=Math.floor(-b.value);for(f=0;f<b.value;f++)a*=10;g.value=Math.floor(Math.abs(e.value)/a)*a}0>e.value&&(g.value=-g.value)}c.push(g);return null};SocialCalc.Formula.FunctionList.ATAN2=[SocialCalc.Formula.Math2Functions,2,\\\"xy\\\",\\\"\\\",\\\"math\\\"];\\nSocialCalc.Formula.FunctionList.MOD=[SocialCalc.Formula.Math2Functions,2,\\\"\\\",\\\"\\\",\\\"math\\\"];SocialCalc.Formula.FunctionList.POWER=[SocialCalc.Formula.Math2Functions,2,\\\"\\\",\\\"\\\",\\\"math\\\"];SocialCalc.Formula.FunctionList.TRUNC=[SocialCalc.Formula.Math2Functions,2,\\\"valpre\\\",\\\"\\\",\\\"math\\\"];\\nSocialCalc.Formula.LogFunction=function(a,c,b,d){var e,f={},g=SocialCalc.Formula;f.value=0;e=g.OperandAsNumber(d,b);f.type=g.LookupResultType(e.type,e.type,g.TypeLookupTable.oneargnumeric);if(1==b.length){if(b=g.OperandAsNumber(d,b),\\\"n\\\"!=b.type.charAt(0)||0>=b.value)return g.FunctionSpecificError(a,c,\\\"e#NUM!\\\",SocialCalc.Constants.s_sheetfunclogsecondarg),0}else{if(0!=b.length)return g.FunctionArgsError(a,c),0;b={value:Math.E,type:\\\"n\\\"}}if(\\\"n\\\"==f.type){if(0>=e.value)return g.FunctionSpecificError(a,\\nc,\\\"e#NUM!\\\",SocialCalc.Constants.s_sheetfunclogfirstarg),0;f.value=Math.log(e.value)/Math.log(b.value)}c.push(f)};SocialCalc.Formula.FunctionList.LOG=[SocialCalc.Formula.LogFunction,-1,\\\"log\\\",\\\"\\\",\\\"math\\\"];\\nSocialCalc.Formula.RoundFunction=function(a,c,b,d){var e,f,g=SocialCalc.Formula;f=0;var l=\\\"e#VALUE!\\\";e=g.OperandValueAndType(d,b);l=g.LookupResultType(e.type,e.type,g.TypeLookupTable.oneargnumeric);if(1==b.length){if(b=g.OperandValueAndType(d,b),\\\"n\\\"!=b.type.charAt(0))return g.FunctionSpecificError(a,c,\\\"e#NUM!\\\",SocialCalc.Constants.s_sheetfuncroundsecondarg),0}else{if(0!=b.length)return g.FunctionArgsError(a,c),0;b={value:0,type:\\\"n\\\"}}if(\\\"n\\\"==l)if(b.value-=0,0==b.value)f=Math.round(e.value);else if(0<\\nb.value){a=1;b.value=Math.floor(b.value);for(f=0;f<b.value;f++)a*=10;e=Math.round(e.value*a);f=e/a}else if(0>b.value){a=1;b.value=Math.floor(-b.value);for(f=0;f<b.value;f++)a*=10;e=Math.round(e.value/a);f=e*a}g.PushOperand(c,l,f)};SocialCalc.Formula.FunctionList.ROUND=[SocialCalc.Formula.RoundFunction,-1,\\\"vp\\\",\\\"\\\",\\\"math\\\"];\\nSocialCalc.Formula.CeilingFloorFunctions=function(a,c,b,d){var e=SocialCalc.Formula,f,g,l=function(a,b){c.push({type:a,value:b})};f=e.OperandValueAndType(d,b);g=f.type.charAt(0);if(\\\"n\\\"!=g)l(\\\"e#VALUE!\\\",0);else if(0==f.value)l(\\\"n\\\",0);else{if(1==b.length){if(b=e.OperandValueAndType(d,b),g=f.type.charAt(0),\\\"n\\\"!=g){l(\\\"e#VALUE!\\\",0);return}}else if(0==b.length)b={type:\\\"n\\\",value:0<f.value?1:-1};else{l(\\\"e#VALUE!\\\",0);return}if(0==b.value)l(\\\"n\\\",0);else if(0>b.value*f.value)l(\\\"e#NUM!\\\",0);else switch(a){case \\\"CEILING\\\":l(\\\"n\\\",\\nMath.ceil(f.value/b.value)*b.value);break;case \\\"FLOOR\\\":l(\\\"n\\\",Math.floor(f.value/b.value)*b.value)}}};SocialCalc.Formula.FunctionList.CEILING=[SocialCalc.Formula.CeilingFloorFunctions,-1,\\\"vsig\\\",\\\"\\\",\\\"math\\\"];SocialCalc.Formula.FunctionList.FLOOR=[SocialCalc.Formula.CeilingFloorFunctions,-1,\\\"vsig\\\",\\\"\\\",\\\"math\\\"];\\nSocialCalc.Formula.AndOrFunctions=function(a,c,b,d){var e,f,g=SocialCalc.Formula,l=\\\"\\\";for(\\\"AND\\\"==a?f=1:\\\"OR\\\"==a&&(f=0);b.length;)e=g.OperandValueAndType(d,b),\\\"n\\\"==e.type.charAt(0)?(e.value-=0,\\\"AND\\\"==a?f=0!=e.value?f:0:\\\"OR\\\"==a&&(f=0!=e.value?1:f),l=g.LookupResultType(e.type,l||\\\"nl\\\",g.TypeLookupTable.propagateerror)):\\\"e\\\"==e.type.charAt(0)&&\\\"e\\\"!=l.charAt(0)&&(l=e.type);1>l.length&&(l=\\\"e#VALUE!\\\",f=0);g.PushOperand(c,l,f)};\\nSocialCalc.Formula.FunctionList.AND=[SocialCalc.Formula.AndOrFunctions,-1,\\\"vn\\\",\\\"\\\",\\\"test\\\"];SocialCalc.Formula.FunctionList.OR=[SocialCalc.Formula.AndOrFunctions,-1,\\\"vn\\\",\\\"\\\",\\\"test\\\"];SocialCalc.Formula.NotFunction=function(a,c,b,d){a=0;var e=SocialCalc.Formula;b=e.OperandValueAndType(d,b);d=e.LookupResultType(b.type,b.type,e.TypeLookupTable.propagateerror);\\\"n\\\"==b.type.charAt(0)||\\\"b\\\"==b.type?(a=0!=b.value-0?0:1,d=\\\"nl\\\"):\\\"t\\\"==b.type.charAt(0)&&(d=\\\"e#VALUE!\\\");e.PushOperand(c,d,a)};\\nSocialCalc.Formula.FunctionList.NOT=[SocialCalc.Formula.NotFunction,1,\\\"v\\\",\\\"\\\",\\\"test\\\"];SocialCalc.Formula.ChooseFunction=function(a,c,b,d){var e,f,g=0,l=SocialCalc.Formula,h=l.OperandAsNumber(d,b);\\\"n\\\"!=h.type.charAt(0)&&(h.value=0);h.value=Math.floor(h.value);for(a=0;b.length;)if(f=l.TopOfStackValueAndType(d,b),a+=1,h.value==a){g=f.value;e=f.type;break}e?l.PushOperand(c,e,g):l.PushOperand(c,\\\"e#VALUE!\\\",0)};SocialCalc.Formula.FunctionList.CHOOSE=[SocialCalc.Formula.ChooseFunction,-2,\\\"choose\\\",\\\"\\\",\\\"lookup\\\"];\\nSocialCalc.Formula.ColumnsRowsFunctions=function(a,c,b,d){var e=0,f=SocialCalc.Formula;b=f.TopOfStackValueAndType(d,b);\\\"coord\\\"==b.type?(e=1,a=\\\"n\\\"):\\\"range\\\"==b.type?(d=f.DecodeRangeParts(d,b.value),\\\"COLUMNS\\\"==a?e=d.ncols:\\\"ROWS\\\"==a&&(e=d.nrows),a=\\\"n\\\"):(e=0,a=\\\"e#VALUE!\\\");f.PushOperand(c,a,e)};SocialCalc.Formula.FunctionList.COLUMNS=[SocialCalc.Formula.ColumnsRowsFunctions,1,\\\"range\\\",\\\"\\\",\\\"lookup\\\"];SocialCalc.Formula.FunctionList.ROWS=[SocialCalc.Formula.ColumnsRowsFunctions,1,\\\"range\\\",\\\"\\\",\\\"lookup\\\"];\\nSocialCalc.Formula.ZeroArgFunctions=function(a,c,b,d){b={value:0};switch(a){case \\\"FALSE\\\":b.type=\\\"nl\\\";b.value=0;break;case \\\"NA\\\":b.type=\\\"e#N/A\\\";break;case \\\"NOW\\\":a=new Date;d=a.getTimezoneOffset();a=a.getTime()/1E3;b.value=25569+a/86400-d/1440;b.type=\\\"ndt\\\";SocialCalc.Formula.FreshnessInfo.volatile.NOW=!0;break;case \\\"PI\\\":b.type=\\\"n\\\";b.value=Math.PI;break;case \\\"TODAY\\\":a=new Date;d=a.getTimezoneOffset();a=a.getTime()/1E3;b.value=Math.floor(25569+a/86400-d/1440);b.type=\\\"nd\\\";SocialCalc.Formula.FreshnessInfo.volatile.TODAY=\\n!0;break;case \\\"TRUE\\\":b.type=\\\"nl\\\";b.value=1;break;case \\\"RAND\\\":b.type=\\\"n\\\",b.value=Math.random(),SocialCalc.Formula.FreshnessInfo.volatile.RAND=!0}c.push(b);return null};SocialCalc.Formula.FunctionList.FALSE=[SocialCalc.Formula.ZeroArgFunctions,0,\\\"\\\",\\\"\\\",\\\"test\\\"];SocialCalc.Formula.FunctionList.NA=[SocialCalc.Formula.ZeroArgFunctions,0,\\\"\\\",\\\"\\\",\\\"test\\\"];SocialCalc.Formula.FunctionList.NOW=[SocialCalc.Formula.ZeroArgFunctions,0,\\\"\\\",\\\"\\\",\\\"datetime\\\"];\\nSocialCalc.Formula.FunctionList.RAND=[SocialCalc.Formula.ZeroArgFunctions,0,\\\"\\\",\\\"\\\",\\\"math\\\"];SocialCalc.Formula.FunctionList.PI=[SocialCalc.Formula.ZeroArgFunctions,0,\\\"\\\",\\\"\\\",\\\"math\\\"];SocialCalc.Formula.FunctionList.TODAY=[SocialCalc.Formula.ZeroArgFunctions,0,\\\"\\\",\\\"\\\",\\\"datetime\\\"];SocialCalc.Formula.FunctionList.TRUE=[SocialCalc.Formula.ZeroArgFunctions,0,\\\"\\\",\\\"\\\",\\\"test\\\"];\\nSocialCalc.Formula.DDBFunction=function(a,c,b,d){var e,f=SocialCalc.Formula,g=f.OperandAsNumber(d,b),l=f.OperandAsNumber(d,b),h=f.OperandAsNumber(d,b),m=f.OperandAsNumber(d,b);if(!(f.CheckForErrorValue(c,g)||f.CheckForErrorValue(c,l)||f.CheckForErrorValue(c,h)||f.CheckForErrorValue(c,m))){if(1>h.value)return f.FunctionSpecificError(a,c,\\\"e#NUM!\\\",SocialCalc.Constants.s_sheetfuncddblife),0;e={value:2,type:\\\"n\\\"};0<b.length&&(e=f.OperandAsNumber(d,b));if(0!=b.length)return f.FunctionArgsError(a,c),0;if(!f.CheckForErrorValue(c,\\ne)){b=a=0;for(d=1;d<=m.value-0&&d<=h.value;d++)a=e.value/h.value*(g.value-b),g.value-b-a<l.value&&(a=g.value-b-l.value),b+=a;f.PushOperand(c,\\\"n$\\\",a)}}};SocialCalc.Formula.FunctionList.DDB=[SocialCalc.Formula.DDBFunction,-4,\\\"ddb\\\",\\\"\\\",\\\"financial\\\"];\\nSocialCalc.Formula.SLNFunction=function(a,c,b,d){var e=SocialCalc.Formula,f=e.OperandAsNumber(d,b),g=e.OperandAsNumber(d,b);b=e.OperandAsNumber(d,b);if(!e.CheckForErrorValue(c,f)&&!e.CheckForErrorValue(c,g)&&!e.CheckForErrorValue(c,b)){if(1>b.value)return e.FunctionSpecificError(a,c,\\\"e#NUM!\\\",SocialCalc.Constants.s_sheetfuncslnlife),0;a=(f.value-g.value)/b.value;e.PushOperand(c,\\\"n$\\\",a)}};SocialCalc.Formula.FunctionList.SLN=[SocialCalc.Formula.SLNFunction,3,\\\"csl\\\",\\\"\\\",\\\"financial\\\"];\\nSocialCalc.Formula.SYDFunction=function(a,c,b,d){var e;a=SocialCalc.Formula;e=a.OperandAsNumber(d,b);var f=a.OperandAsNumber(d,b),g=a.OperandAsNumber(d,b);d=a.OperandAsNumber(d,b);if(!(a.CheckForErrorValue(c,e)||a.CheckForErrorValue(c,f)||a.CheckForErrorValue(c,g)||a.CheckForErrorValue(c,d))){if(1>g.value||0>=d.value)return a.PushOperand(c,\\\"e#NUM!\\\",0),0;b=(g.value+1)*g.value/2;e=(e.value-f.value)*(g.value-d.value+1)/b;a.PushOperand(c,\\\"n$\\\",e)}};\\nSocialCalc.Formula.FunctionList.SYD=[SocialCalc.Formula.SYDFunction,4,\\\"cslp\\\",\\\"\\\",\\\"financial\\\"];\\nSocialCalc.Formula.InterestFunctions=function(a,c,b,d){var e,f,g,l,h,m,p,r,q,n=SocialCalc.Formula,s=n.OperandAsNumber(d,b);p=n.OperandAsNumber(d,b);m=n.OperandAsNumber(d,b);e=n.LookupResultType(s.type,p.type,n.TypeLookupTable.twoargnumeric);e=n.LookupResultType(e,m.type,n.TypeLookupTable.twoargnumeric);if(b.length&&(g=n.OperandAsNumber(d,b),e=n.LookupResultType(e,g.type,n.TypeLookupTable.twoargnumeric),b.length&&(l=n.OperandAsNumber(d,b),e=n.LookupResultType(e,l.type,n.TypeLookupTable.twoargnumeric),\\nb.length))){if(\\\"RATE\\\"!=a)return n.FunctionArgsError(a,c),0;h=n.OperandAsNumber(d,b);e=n.LookupResultType(e,h.type,n.TypeLookupTable.twoargnumeric)}if(\\\"n\\\"==e)switch(a){case \\\"FV\\\":h=s.value;a=p.value;p=m.value;m=null!=g?g.value:0;l=null!=l?l.value?1:0:0;f=g=0==h?-m-p*a:-(m*Math.pow(1+h,a)+p*(1+h*l)*(Math.pow(1+h,a)-1)/h);e=\\\"n$\\\";break;case \\\"NPER\\\":h=s.value;p=p.value;m=m.value;g=null!=g?g.value:0;l=null!=l?l.value?1:0:0;if(0==h){if(0==p){n.PushOperand(c,\\\"e#NUM!\\\",0);return}a=(m+g)/-p}else{r=p*(1+h*l)/h;\\nq=m+r;if(0==q||-1>=h){n.PushOperand(c,\\\"e#NUM!\\\",0);return}r=(r-g)/q;if(0>=r){n.PushOperand(c,\\\"e#NUM!\\\",0);return}r=Math.log(r);q=Math.log(1+h);a=r/q}f=a;e=\\\"n\\\";break;case \\\"PMT\\\":h=s.value;a=p.value;m=m.value;g=null!=g?g.value:0;l=null!=l?l.value?1:0:0;if(0==a){n.PushOperand(c,\\\"e#NUM!\\\",0);return}f=p=0==h?(g-m)/a:(0-g-m*Math.pow(1+h,a))/((1+h*l)*(Math.pow(1+h,a)-1)/h);e=\\\"n$\\\";break;case \\\"PV\\\":h=s.value;a=p.value;p=m.value;g=null!=g?g.value:0;l=null!=l?l.value?1:0:0;if(-1==h){n.PushOperand(c,\\\"e#DIV/0!\\\",0);\\nreturn}f=m=0==h?-g-p*a:(-g-p*(1+h*l)*(Math.pow(1+h,a)-1)/h)/Math.pow(1+h,a);e=\\\"n$\\\";break;case \\\"RATE\\\":a=s.value;p=p.value;m=m.value;g=null!=g?g.value:0;l=null!=l?l.value?1:0:0;h=null!=h?h.value:.1;b=0;delta=1;epsilon=1E-7;for(h=h||1E-8;(0<=delta?delta:-delta)>epsilon&&h!=r;)if(delta=g+m*Math.pow(1+h,a)+p*(1+h*l)*(Math.pow(1+h,a)-1)/h,null!=q?(q=(delta-q)/(h-r)||.001,r=h,h-=delta/q):(r=h,h*=1.1),q=delta,b++,100<=b){n.PushOperand(c,\\\"e#NUM!\\\",0);return}f=h;e=\\\"n%\\\"}n.PushOperand(c,e,f)};\\nSocialCalc.Formula.FunctionList.FV=[SocialCalc.Formula.InterestFunctions,-3,\\\"fv\\\",\\\"\\\",\\\"financial\\\"];SocialCalc.Formula.FunctionList.NPER=[SocialCalc.Formula.InterestFunctions,-3,\\\"nper\\\",\\\"\\\",\\\"financial\\\"];SocialCalc.Formula.FunctionList.PMT=[SocialCalc.Formula.InterestFunctions,-3,\\\"pmt\\\",\\\"\\\",\\\"financial\\\"];SocialCalc.Formula.FunctionList.PV=[SocialCalc.Formula.InterestFunctions,-3,\\\"pv\\\",\\\"\\\",\\\"financial\\\"];SocialCalc.Formula.FunctionList.RATE=[SocialCalc.Formula.InterestFunctions,-3,\\\"rate\\\",\\\"\\\",\\\"financial\\\"];\\nSocialCalc.Formula.NPVFunction=function(a,c,b,d){var e,f,g,l,h=SocialCalc.Formula;e=h.OperandAsNumber(d,b);if(!h.CheckForErrorValue(c,e)){f=0;a=\\\"n\\\";for(g=1;b.length;)if(l=h.OperandValueAndType(d,b),\\\"n\\\"==l.type.charAt(0)){g*=1+e.value;if(0==g){h.PushOperand(c,\\\"e#DIV/0!\\\",0);return}f+=l.value/g;a=h.LookupResultType(l.type,a||l.type,h.TypeLookupTable.plus)}else if(\\\"e\\\"==l.type.charAt(0)&&\\\"e\\\"!=a.charAt(0)){a=l.type;break}\\\"n\\\"==a.charAt(0)&&(a=\\\"n$\\\");h.PushOperand(c,a,f)}};\\nSocialCalc.Formula.FunctionList.NPV=[SocialCalc.Formula.NPVFunction,-2,\\\"npv\\\",\\\"\\\",\\\"financial\\\"];\\nSocialCalc.Formula.IRRFunction=function(a,c,b,d){var e,f,g,l;l=[];var h=[],m=SocialCalc.Formula;for(l.push(b.pop());l.length;)if(e=m.OperandValueAndType(d,l),\\\"n\\\"==e.type.charAt(0))h.push(e.value);else if(\\\"e\\\"==e.type.charAt(0)){m.PushOperand(c,\\\"e#VALUE!\\\",0);return}if(h.length){e={value:0};if(b.length){e=m.OperandAsNumber(d,b);if(\\\"n\\\"!=e.type.charAt(0)&&\\\"b\\\"!=e.type.charAt(0)){m.PushOperand(c,\\\"e#VALUE!\\\",0);return}if(b.length){m.FunctionArgsError(a,c);return}}e.value=e.value||.1;a=0;b=e.value;for(d=1;1E-7<\\n(0<=d?d:-d)&&b!=g;){d=0;e=1;for(l=0;l<h.length;l++){e*=1+b;if(0==e){m.PushOperand(c,\\\"e#DIV/0!\\\",0);return}d+=h[l]/e}null!=f?(f=(d-f)/(b-g),g=b,b-=d/f):(g=b,b*=1.1);f=d;a++;if(20<=a){m.PushOperand(c,\\\"e#NUM!\\\",0);return}}m.PushOperand(c,\\\"n%\\\",b)}else m.PushOperand(c,\\\"e#NUM!\\\",0)};SocialCalc.Formula.FunctionList.IRR=[SocialCalc.Formula.IRRFunction,-1,\\\"irr\\\",\\\"\\\",\\\"financial\\\"];SocialCalc.Formula.SheetCache={sheets:{},waitingForLoading:null,constants:{asloaded:0,recalcing:1,recalcdone:2},loadsheet:null,tiddlersToSheets:{}};\\nSocialCalc.Formula.FindInSheetCache=function(a){var c=SocialCalc.Formula.SheetCache,b=SocialCalc.Formula.NormalizeSheetName(a);if(c.sheets[b])return hack.log(\\\"Found: \\\"+a,hack.recalcLink,\\\"SocialCalc.Formula.FindInSheetCache\\\"),hack.log(\\\"  .name: \\\"+c.sheets[b].name,hack.recalcLink,\\\"SocialCalc.Formula.FindInSheetCache\\\"),hack.log(\\\"  .tiddlerTitle: \\\"+c.sheets[b].tiddlerTitle,hack.recalcLink,\\\"SocialCalc.Formula.FindInSheetCache\\\"),hack.log(\\\"  .recalcstate: \\\"+c.sheets[b].recalcstate,hack.recalcLink,\\\"SocialCalc.Formula.FindInSheetCache\\\"),\\nTiddlyWiki?c.tiddlersToSheets[c.sheets[b].tiddlerTitle]:c.sheets[b].sheet;hack.log(\\\"Not found: \\\"+a,hack.recalcLink,\\\"SocialCalc.Formula.FindInSheetCache\\\");if(c.waitingForLoading)return hack.log(\\\"Waiting other sheet to be loaded: sfsc.waitingForLoading = \\\"+c.waitingForLoading,hack.recalcLink,\\\"SocialCalc.Formula.FindInSheetCache\\\"),null;c.loadsheet&&alert(\\\"Using SocialCalc.Formula.SheetCache.loadsheet - deprecated\\\");c.waitingForLoading=b;hack.log(\\\"To be loaded: sfsc.waitingForLoading = \\\"+c.waitingForLoading,\\nhack.recalcLink,\\\"SocialCalc.Formula.FindInSheetCache\\\");return null};\\nSocialCalc.Formula.AddSheetToCache=function(a,c,b,d){var e=null,f=SocialCalc.Formula.SheetCache,g=f.constants;a=SocialCalc.Formula.NormalizeSheetName(a);if(TiddlyWiki){if(f.sheets[a])return f.tiddlersToSheets[f.sheets[a].tiddlerTitle];f.sheets[a]={recalcstate:g.asloaded,name:a,tiddlerTitle:d};d&&f.tiddlersToSheets[d]?e=f.tiddlersToSheets[d]:(c&&(e=new SocialCalc.Sheet,e.ParseSheetSave(c)),f.tiddlersToSheets[d]=e)}else c&&(e=new SocialCalc.Sheet,e.ParseSheetSave(c)),f.sheets[a]={sheet:e,recalcstate:g.asloaded,\\nname:a};SocialCalc.Formula.FreshnessInfo.sheets[a]=\\\"undefined\\\"==typeof b||!1===b;return e};SocialCalc.Formula.NormalizeSheetName=function(a){return SocialCalc.Callbacks.NormalizeSheetName?SocialCalc.Callbacks.NormalizeSheetName(a):a.toLowerCase()};SocialCalc.Formula.RemoteFunctionInfo={waitingForServer:null};SocialCalc.Formula.FreshnessInfo={sheets:{},volatile:{},recalc_completed:!1};\\nSocialCalc.Formula.FreshnessInfoReset=function(){var a=SocialCalc.Formula.FreshnessInfo,c=SocialCalc.Formula.SheetCache,b;for(b in a.sheets)!1===a.sheets[b]&&delete c.sheets[b];TiddlyWiki&&(tiddlersToSheets={});a.sheets={};a.volatile={};a.recalc_completed=!1};SocialCalc.Formula.PlainCoord=function(a){return-1==a.indexOf(\\\"$\\\")?a:a.replace(/\\\\$/g,\\\"\\\")};\\nSocialCalc.Formula.OrderRangeParts=function(a,c){var b,d,e={};b=SocialCalc.coordToCr(a);d=SocialCalc.coordToCr(c);b.col>d.col?(e.c1=d.col,e.c2=b.col):(e.c1=b.col,e.c2=d.col);b.row>d.row?(e.r1=d.row,e.r2=b.row):(e.r1=b.row,e.r2=d.row);return e};\\nSocialCalc.Formula.TestCriteria=function(a,c,b){var d,e,f;if(null==b)return!1;b+=\\\"\\\";d=b.charAt(0);\\\"=\\\"==d||\\\"<\\\"==d||\\\">\\\"==d?b=b.substring(1):(d=b.substring(0,2),\\\"<=\\\"==d||\\\"<>\\\"==d||\\\">=\\\"==d?b=b.substring(2):d=\\\"none\\\");b=SocialCalc.DetermineValueType(b);if(!b.type){if(\\\"none\\\"==d)return!1;if(\\\"b\\\"==c.charAt(0)){if(\\\"=\\\"==d)return!0}else if(\\\"<>\\\"==d)return!0;return!1}e=!1;\\\"n\\\"==b.type.charAt(0)&&\\\"t\\\"==c.charAt(0)&&(f=SocialCalc.DetermineValueType(a),\\\"n\\\"==f.type.charAt(0)&&(a=f.value,c=f.type));if(\\\"n\\\"==c.charAt(0)&&\\n\\\"n\\\"==b.type.charAt(0))switch(a-=0,b.value-=0,d){case \\\"<\\\":e=a<b.value;break;case \\\"<=\\\":e=a<=b.value;break;case \\\"=\\\":case \\\"none\\\":e=a==b.value;break;case \\\">=\\\":e=a>=b.value;break;case \\\">\\\":e=a>b.value;break;case \\\"<>\\\":e=a!=b.value}else if(\\\"e\\\"==c.charAt(0))e=!1;else if(\\\"e\\\"==b.type.charAt(0))e=!1;else{\\\"n\\\"==c.charAt(0)&&(a=SocialCalc.format_number_for_display(a,\\\"n\\\",\\\"\\\"));if(\\\"n\\\"==b.type.charAt(0))return!1;a=a?a.toLowerCase():\\\"\\\";b.value=b.value?b.value.toLowerCase():\\\"\\\";switch(d){case \\\"<\\\":e=a<b.value;break;case \\\"<=\\\":e=\\na<=b.value;break;case \\\"=\\\":e=a==b.value;break;case \\\"none\\\":e=a.substring(0,b.value.length)==b.value;break;case \\\">=\\\":e=a>=b.value;break;case \\\">\\\":e=a>b.value;break;case \\\"<>\\\":e=a!=b.value}}return e};SocialCalc||(SocialCalc={});SocialCalc.Popup={};SocialCalc.Popup.Types={};SocialCalc.Popup.Controls={};SocialCalc.Popup.Current={};SocialCalc.Popup.LocalizeString=function(a){return a};SocialCalc.Popup.Create=function(a,c,b){var d=SocialCalc.Popup.Types[a];d&&d.Create&&d.Create(a,c,b);SocialCalc.Popup.imagePrefix=SocialCalc.Constants.defaultImagePrefix};\\nSocialCalc.Popup.SetValue=function(a,c){var b=SocialCalc.Popup,d=b.Types,e=b.Controls;e[a]?(b=e[a].type,d=d[b],e=e[a].data,d&&d.Create&&(d.SetValue(b,a,c),e.attribs&&e.attribs.changedcallback&&e.attribs.changedcallback(e.attribs,a,c))):alert(\\\"Unknown control \\\"+a)};\\nSocialCalc.Popup.SetDisabled=function(a,c){var b=SocialCalc.Popup,d=b.Types,e=b.Controls;e[a]?(e=e[a].type,(d=d[e])&&d.Create&&(b.Current.id&&a==b.Current.id&&(d.Hide(e,b.Current.id),b.Current.id=null),d.SetDisabled(e,a,c))):alert(\\\"Unknown control \\\"+a)};SocialCalc.Popup.GetValue=function(a){var c=SocialCalc.Popup,b=c.Types,c=c.Controls;if(c[a])return c=c[a].type,(b=b[c])&&b.Create?b.GetValue(c,a):null;alert(\\\"Unknown control \\\"+a)};\\nSocialCalc.Popup.Initialize=function(a,c){var b=SocialCalc.Popup,d=b.Types,b=b.Controls;b[a]?(b=b[a].type,(d=d[b])&&d.Initialize&&d.Initialize(b,a,c)):alert(\\\"Unknown control \\\"+a)};SocialCalc.Popup.Reset=function(a){var c=SocialCalc.Popup.Types;c[a].Reset&&c[a].Reset(a)};\\nSocialCalc.Popup.CClick=function(a){var c=SocialCalc.Popup,b=c.Types,d=c.Controls;if(!d[a])alert(\\\"Unknown control \\\"+a);else if(!d[a].data||!d[a].data.disabled){var e=d[a].type,f=b[e];if(c.Current.id&&(b[d[c.Current.id].type].Hide(e,c.Current.id),a==c.Current.id)){c.Current.id=null;return}f&&f.Show&&f.Show(e,a);c.Current.id=a}};SocialCalc.Popup.Close=function(){var a=SocialCalc.Popup;a.Current.id&&a.CClick(a.Current.id)};\\nSocialCalc.Popup.Cancel=function(){var a=SocialCalc.Popup,c=a.Types,b=a.Controls;a.Current.id&&(b=b[a.Current.id].type,c[b].Cancel(b,a.Current.id),a.Current.id=null)};\\nSocialCalc.Popup.CreatePopupDiv=function(a,c){var b,d=SocialCalc.Popup.Controls[a].data,e=document.createElement(\\\"div\\\");e.style.position=\\\"absolute\\\";b=SocialCalc.GetElementPosition(d.mainele);e.style.top=b.top+d.mainele.offsetHeight+\\\"px\\\";e.style.left=b.left+\\\"px\\\";e.style.zIndex=100;e.style.backgroundColor=\\\"#FFF\\\";e.style.border=\\\"1px solid black\\\";c.width&&(e.style.width=c.width);d.mainele.appendChild(e);c.title&&(e.innerHTML='<table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\" style=\\\"border-bottom:1px solid black;\\\"><tr><td style=\\\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\\\">'+\\nc.title+'</td><td style=\\\"font-size:10px;cursor:default;color:#666;\\\" onclick=\\\"SocialCalc.Popup.Cancel();\\\">&nbsp;X&nbsp;</td></tr></table>',c.moveable&&(d.dragregistered=e.firstChild.firstChild.firstChild.firstChild,SocialCalc.DragRegister(d.dragregistered,!0,!0,{MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null,positionobj:e},d.mainele)));return e};\\nSocialCalc.Popup.EnsurePosition=function(a,c){function b(a){var c=SocialCalc.GetElementPosition(a);c.height=a.offsetHeight;c.width=a.offsetWidth;c.bottom=c.top+c.height;c.right=c.left+c.width;return c}var d=SocialCalc.Popup.Controls[a].data,e=d.mainele.firstChild;if(e){var d=d.popupele,f=b(d),g=b(c),e=b(e);e.bottom+f.height<g.bottom&&e.left+f.width<g.right?(d.style.top=e.bottom+\\\"px\\\",d.style.left=e.left+\\\"px\\\"):e.top-f.height>g.top&&e.left+f.width<g.right?(d.style.top=e.top-f.height+\\\"px\\\",d.style.left=\\ne.left+\\\"px\\\"):e.bottom+f.height<g.bottom&&e.right-f.width>g.left?(d.style.top=e.bottom+\\\"px\\\",d.style.left=e.right-f.width+\\\"px\\\"):e.top-f.height>g.top&&e.right-f.width>g.left?(d.style.top=e.top-f.height+\\\"px\\\",d.style.left=e.right-f.width+\\\"px\\\"):e.bottom+f.height<g.bottom&&f.width<g.width?(d.style.top=e.bottom+\\\"px\\\",d.style.left=g.left+Math.floor((g.width-f.width)/2)+\\\"px\\\"):e.top-f.height>g.top&&f.width<g.width?(d.style.top=e.top-f.height+\\\"px\\\",d.style.left=g.left+Math.floor((g.width-f.width)/2)+\\\"px\\\"):f.height<\\ng.height&&e.right+f.width<g.right?(d.style.top=g.top+Math.floor((g.height-f.height)/2)+\\\"px\\\",d.style.left=e.right+\\\"px\\\"):f.height<g.height&&e.left-f.width>g.left&&(d.style.top=g.top+Math.floor((g.height-f.height)/2)+\\\"px\\\",d.style.left=e.left-f.width+\\\"px\\\")}else alert(\\\"No main popup element firstChild.\\\")};SocialCalc.Popup.DestroyPopupDiv=function(a,c){a&&(a.innerHTML=\\\"\\\",SocialCalc.DragUnregister(c),a.parentNode&&a.parentNode.removeChild(a))};\\nSocialCalc.Popup.RGBToHex=function(a){var c=SocialCalc.Popup;return\\\"\\\"==a?\\\"000000\\\":(a=a.match(/(\\\\d+)\\\\D+(\\\\d+)\\\\D+(\\\\d+)/))?c.ToHex(a[1])+c.ToHex(a[2])+c.ToHex(a[3]):\\\"000000\\\"};SocialCalc.Popup.HexDigits=\\\"0123456789ABCDEF\\\";SocialCalc.Popup.ToHex=function(a){var c=SocialCalc.Popup,b=a%16;return c.HexDigits.charAt(Math.floor(a/16))+c.HexDigits.charAt(b)};\\nSocialCalc.Popup.FromHex=function(a){var c=SocialCalc.Popup,b=c.HexDigits.indexOf(a.charAt(0).toUpperCase());a=c.HexDigits.indexOf(a.charAt(1).toUpperCase());return 16*(0<=b?b:0)+(0<=a?a:0)};SocialCalc.Popup.HexToRGB=function(a){var c=SocialCalc.Popup;return\\\"rgb(\\\"+c.FromHex(a.substring(1,3))+\\\",\\\"+c.FromHex(a.substring(3,5))+\\\",\\\"+c.FromHex(a.substring(5,7))+\\\")\\\"};SocialCalc.Popup.makeRGB=function(a,c,b){return\\\"rgb(\\\"+(0<a?a:0)+\\\",\\\"+(0<c?c:0)+\\\",\\\"+(0<b?b:0)+\\\")\\\"};\\nSocialCalc.Popup.splitRGB=function(a){return(a=a.match(/(\\\\d+)\\\\D+(\\\\d+)\\\\D+(\\\\d+)\\\\D/))?{r:a[1]-0,g:a[2]-0,b:a[3]-0}:{r:0,g:0,b:0}};SocialCalc.Popup.Types.List={};\\nSocialCalc.Popup.Types.List.Create=function(a,c,b){a={type:a,value:\\\"\\\",display:\\\"\\\",data:{}};SocialCalc.Popup.Controls[c]=a;a=a.data;a.attribs=b||{};(b=document.getElementById(c))?(a.mainele=b,b.innerHTML='<input style=\\\"cursor:pointer;width:100px;font-size:smaller;\\\" onfocus=\\\"this.blur();\\\" onclick=\\\"SocialCalc.Popup.CClick(\\\\''+c+'\\\\');\\\" value=\\\"\\\">',a.options=[]):alert(\\\"Missing element \\\"+c)};\\nSocialCalc.Popup.Types.List.SetValue=function(a,c,b){a=SocialCalc.Popup.Controls[c].data;a.value=b;a.custom=!1;for(b=0;b<a.options.length;b++)if(o=a.options[b],!(o.a&&(o.a.skip||o.a.custom||o.a.cancel)||o.v!=a.value)){a.display=o.o;break}b==a.options.length&&(a.display=\\\"Custom\\\",a.custom=!0);a.mainele&&a.mainele.firstChild&&(a.mainele.firstChild.value=a.display)};\\nSocialCalc.Popup.Types.List.SetDisabled=function(a,c,b){a=SocialCalc.Popup.Controls[c].data;a.disabled=b;a.mainele&&a.mainele.firstChild&&(a.mainele.firstChild.disabled=b)};SocialCalc.Popup.Types.List.GetValue=function(a,c){return SocialCalc.Popup.Controls[c].data.value};SocialCalc.Popup.Types.List.Initialize=function(a,c,b){var d;a=SocialCalc.Popup;var e=a.Controls[c].data;for(d in b.attribs)e.attribs[d]=b.attribs[d];e.options=b?b.options:[];b.value&&a.SetValue(c,b.value)};\\nSocialCalc.Popup.Types.List.Reset=function(a){var c=SocialCalc.Popup,b=c.Types,d=c.Controls;c.Current.id&&d[c.Current.id].type==a&&(b[a].Hide(a,c.Current.id),c.Current.id=null)};\\nSocialCalc.Popup.Types.List.Show=function(a,c){var b;b=SocialCalc.Popup;var d=b.Controls[c].data,e=\\\"\\\";d.popupele=b.CreatePopupDiv(c,d.attribs);d.custom?(e=SocialCalc.Popup.Types.List.MakeCustom(a,c),b=document.createElement(\\\"div\\\"),b.innerHTML='<div style=\\\"cursor:default;padding:4px;background-color:#CCC;\\\">'+e+\\\"</div>\\\",d.customele=b.firstChild.firstChild.childNodes[1],d.listdiv=null):(e=SocialCalc.Popup.Types.List.MakeList(a,c),b=document.createElement(\\\"div\\\"),b.innerHTML='<div style=\\\"cursor:default;padding:4px;\\\">'+\\ne+\\\"</div>\\\",d.customele=null,d.listdiv=b.firstChild);d.contentele=b;d.mainele&&d.mainele.firstChild&&(d.mainele.firstChild.disabled=!0);d.popupele.appendChild(b);d.attribs.ensureWithin&&SocialCalc.Popup.EnsurePosition(c,d.attribs.ensureWithin)};\\nSocialCalc.Popup.Types.List.MakeList=function(a,c){var b,d,e,f=SocialCalc.Popup.Controls[c].data,g;g='<table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"><tr><td style=\\\"vertical-align:top;\\\">';f.ncols=1;for(b=0;b<f.options.length;b++){d=f.options[b];if(d.a){if(d.a.newcol){g+='</td><td style=\\\"vertical-align:top;\\\">&nbsp;&nbsp;&nbsp;&nbsp;</td><td style=\\\"vertical-align:top;\\\">';f.ncols+=1;continue}if(d.a.skip){g+='<div style=\\\"font-size:x-small;white-space:nowrap;\\\">'+d.o+\\\"</div>\\\";continue}}e=d.v!=f.value||d.a&&(d.a.custom||\\nd.a.cancel)?\\\"\\\":\\\"background-color:#DDF;\\\";g+='<div style=\\\"font-size:x-small;white-space:nowrap;'+e+'\\\" onclick=\\\"SocialCalc.Popup.Types.List.ItemClicked(\\\\''+c+\\\"','\\\"+b+\\\"');\\\\\\\" onmousemove=\\\\\\\"SocialCalc.Popup.Types.List.MouseMove('\\\"+c+\\\"',this);\\\\\\\">\\\"+d.o+\\\"</div>\\\"}return g+\\\"</td></tr></table>\\\"};\\nSocialCalc.Popup.Types.List.MakeCustom=function(a,c){var b=SocialCalc.Popup.LocalizeString,d=\\\"\\\",d=SocialCalc.Popup.Controls[c].data.value,d=SocialCalc.special_chars(d);return d='<div style=\\\"white-space:nowrap;\\\"><br><input id=\\\"customvalue\\\" value=\\\"'+d+'\\\"><br><br><input style=\\\"font-size:smaller;\\\" type=\\\"button\\\" value=\\\"'+b(\\\"OK\\\")+'\\\" onclick=\\\"SocialCalc.Popup.Types.List.CustomOK(\\\\''+c+'\\\\');return false;\\\"><input style=\\\"font-size:smaller;\\\" type=\\\"button\\\" value=\\\"'+b(\\\"List\\\")+'\\\" onclick=\\\"SocialCalc.Popup.Types.List.CustomToList(\\\\''+\\nc+'\\\\');\\\"><input style=\\\"font-size:smaller;\\\" type=\\\"button\\\" value=\\\"'+b(\\\"Cancel\\\")+'\\\" onclick=\\\"SocialCalc.Popup.Close();\\\"><br></div>'};\\nSocialCalc.Popup.Types.List.ItemClicked=function(a,c){var b,d,e,f=SocialCalc.Popup.Controls[a].data;(b=f.options[c].a)&&b.custom?(b=f.contentele,d=SocialCalc.Popup.Types.List.MakeCustom(\\\"List\\\",a),e=document.createElement(\\\"div\\\"),e.innerHTML='<div style=\\\"cursor:default;padding:4px;background-color:#CCC;\\\">'+d+\\\"</div>\\\",f.customele=e.firstChild.firstChild.childNodes[1],f.listdiv=null,f.contentele=e,f.popupele.replaceChild(e,b),f.attribs.ensureWithin&&SocialCalc.Popup.EnsurePosition(a,f.attribs.ensureWithin)):\\n(b&&b.cancel||SocialCalc.Popup.SetValue(a,f.options[c].v),SocialCalc.Popup.Close())};SocialCalc.Popup.Types.List.CustomToList=function(a){var c,b,d,e=SocialCalc.Popup.Controls[a].data;c=e.contentele;b=SocialCalc.Popup.Types.List.MakeList(\\\"List\\\",a);d=document.createElement(\\\"div\\\");d.innerHTML='<div style=\\\"cursor:default;padding:4px;\\\">'+b+\\\"</div>\\\";e.customele=null;e.listdiv=d.firstChild;e.contentele=d;e.popupele.replaceChild(d,c);e.attribs.ensureWithin&&SocialCalc.Popup.EnsurePosition(a,e.attribs.ensureWithin)};\\nSocialCalc.Popup.Types.List.CustomOK=function(a){SocialCalc.Popup.SetValue(a,SocialCalc.Popup.Controls[a].data.customele.value);SocialCalc.Popup.Close()};SocialCalc.Popup.Types.List.MouseMove=function(a,c){var b,d,e=SocialCalc.Popup.Controls[a].data;if(b=e.listdiv){var f=b.firstChild.firstChild.firstChild;for(b=0;b<e.ncols;b++)for(d=0;d<f.childNodes[2*b].childNodes.length;d++)f.childNodes[2*b].childNodes[d].style.backgroundColor=\\\"#FFF\\\";c.style.backgroundColor=\\\"#DDF\\\"}};\\nSocialCalc.Popup.Types.List.Hide=function(a,c){var b=SocialCalc.Popup,d=b.Controls[c].data;b.DestroyPopupDiv(d.popupele,d.dragregistered);d.popupele=null;d.mainele&&d.mainele.firstChild&&(d.mainele.firstChild.disabled=!1)};SocialCalc.Popup.Types.List.Cancel=function(a,c){SocialCalc.Popup.Types.List.Hide(a,c)};SocialCalc.Popup.Types.ColorChooser={};\\nSocialCalc.Popup.Types.ColorChooser.Create=function(a,c,b){a={type:a,value:\\\"\\\",display:\\\"\\\",data:{}};SocialCalc.Popup.Controls[c]=a;a=a.data;a.attribs=b||{};b=a.attribs;a.value=\\\"\\\";var d=document.getElementById(c);d?(a.mainele=d,d.innerHTML='<div style=\\\"cursor:pointer;border:1px solid black;vertical-align:top;width:'+(b.sampleWidth||\\\"15px\\\")+\\\";height:\\\"+(b.sampleHeight||\\\"15px\\\")+';\\\" onclick=\\\"SocialCalc.Popup.Types.ColorChooser.ControlClicked(\\\\''+c+\\\"');\\\\\\\">&nbsp;</div>\\\"):alert(\\\"Missing element \\\"+c)};\\nSocialCalc.Popup.Types.ColorChooser.SetValue=function(a,c,b){a=SocialCalc.Popup;c=a.Controls[c].data;var d=c.attribs;c.value=b;c.custom=!1;c.mainele&&c.mainele.firstChild&&(c.value?(c.mainele.firstChild.style.backgroundColor=c.value,b=d.backgroundImage?\\\"url(\\\"+a.imagePrefix+d.backgroundImage+\\\")\\\":\\\"\\\",a=\\\"center center\\\"):(c.mainele.firstChild.style.backgroundColor=\\\"#FFF\\\",d.backgroundImageDefault?(b=\\\"url(\\\"+a.imagePrefix+d.backgroundImageDefault+\\\")\\\",a=\\\"center center\\\"):(b=\\\"url(\\\"+a.imagePrefix+\\\"defaultcolor.gif)\\\",\\na=\\\"left top\\\")),c.mainele.firstChild.style.backgroundPosition=a,TiddlyWiki&&(b=TiddlyWiki.getModifiedCssImageStyle(b)),c.mainele.firstChild.style.backgroundImage=b)};\\nSocialCalc.Popup.Types.ColorChooser.SetDisabled=function(a,c,b){a=SocialCalc.Popup;var d=a.Controls[c].data,e=d.attribs;d.disabled=b;d.mainele&&d.mainele.firstChild&&(b?(d.mainele.firstChild.style.backgroundColor=\\\"#DDD\\\",e.backgroundImageDisabled?(img=\\\"url(\\\"+a.imagePrefix+e.backgroundImageDisabled+\\\")\\\",pos=\\\"center center\\\"):(img=\\\"url(\\\"+a.imagePrefix+\\\"defaultcolor.gif)\\\",pos=\\\"left top\\\"),d.mainele.firstChild.style.backgroundPosition=pos,TiddlyWiki&&(img=TiddlyWiki.getModifiedCssImageStyle(img)),d.mainele.firstChild.style.backgroundImage=\\nimg):a.SetValue(c,d.value))};SocialCalc.Popup.Types.ColorChooser.GetValue=function(a,c){return SocialCalc.Popup.Controls[c].data.value};SocialCalc.Popup.Types.ColorChooser.Initialize=function(a,c,b){var d;a=SocialCalc.Popup;var e=a.Controls[c].data;for(d in b.attribs)e.attribs[d]=b.attribs[d];b.value&&a.SetValue(c,b.value)};\\nSocialCalc.Popup.Types.ColorChooser.Reset=function(a){var c=SocialCalc.Popup,b=c.Types,d=c.Controls;c.Current.id&&d[c.Current.id].type==a&&(b[a].Hide(a,c.Current.id),c.Current.id=null)};\\nSocialCalc.Popup.Types.ColorChooser.Show=function(a,c){var b,d;b=SocialCalc.Popup;var e=b.Controls[c].data;d=\\\"\\\";e.oldvalue=e.value;e.popupele=b.CreatePopupDiv(c,e.attribs);e.custom?(d=SocialCalc.Popup.Types.ColorChooser.MakeCustom(a,c),b=document.createElement(\\\"div\\\"),b.innerHTML='<div style=\\\"cursor:default;padding:4px;background-color:#CCC;\\\">'+d+\\\"</div>\\\",e.customele=b.firstChild.firstChild.childNodes[2]):(d=SocialCalc.Popup.Types.ColorChooser.CreateGrid(a,c),b=document.createElement(\\\"div\\\"),b.style.padding=\\n\\\"3px\\\",b.style.backgroundColor=\\\"#CCC\\\",b.appendChild(d),e.customele=null);e.contentele=b;e.popupele.appendChild(b);e.attribs.ensureWithin&&SocialCalc.Popup.EnsurePosition(c,e.attribs.ensureWithin)};\\nSocialCalc.Popup.Types.ColorChooser.MakeCustom=function(a,c){var b=SocialCalc.Popup,d=b.LocalizeString,e=\\\"\\\";return e='<div style=\\\"white-space:nowrap;\\\"><br>#<input id=\\\"customvalue\\\" style=\\\"width:75px;\\\" value=\\\"'+b.Controls[c].data.value+'\\\"><br><br><input style=\\\"font-size:smaller;\\\" type=\\\"button\\\" value=\\\"'+d(\\\"OK\\\")+'\\\" onclick=\\\"SocialCalc.Popup.Types.ColorChooser.CustomOK(\\\\''+c+'\\\\');return false;\\\"><input style=\\\"font-size:smaller;\\\" type=\\\"button\\\" value=\\\"'+d(\\\"Grid\\\")+'\\\" onclick=\\\"SocialCalc.Popup.Types.ColorChooser.CustomToGrid(\\\\''+\\nc+\\\"');\\\\\\\"><br></div>\\\"};SocialCalc.Popup.Types.ColorChooser.ItemClicked=function(a,c){SocialCalc.Popup.Close()};SocialCalc.Popup.Types.ColorChooser.CustomToList=function(a){};SocialCalc.Popup.Types.ColorChooser.CustomOK=function(a){var c=SocialCalc.Popup;c.SetValue(a,c.Controls[a].data.customele.value);c.Close()};SocialCalc.Popup.Types.ColorChooser.Hide=function(a,c){var b=SocialCalc.Popup,d=b.Controls[c].data;b.DestroyPopupDiv(d.popupele,d.dragregistered);d.popupele=null};\\nSocialCalc.Popup.Types.ColorChooser.Cancel=function(a,c){var b=SocialCalc.Popup;b.SetValue(c,b.Controls[c].data.oldvalue);SocialCalc.Popup.Types.ColorChooser.Hide(a,c)};\\nSocialCalc.Popup.Types.ColorChooser.CreateGrid=function(a,c){var b,d,e,f,g,l=SocialCalc.Popup,h=l.Types,m=l.LocalizeString;b=l.Controls[c].data;b.grid={};var p=b.grid,r=document.createElement(\\\"div\\\");b=document.createElement(\\\"table\\\");b.cellSpacing=0;b.cellPadding=0;b.style.width=\\\"100px\\\";p.table=b;b=document.createElement(\\\"tbody\\\");p.table.appendChild(b);p.tbody=b;for(d=0;16>d;d++){e=document.createElement(\\\"tr\\\");for(f=0;5>f;f++)g={},p[d+\\\",\\\"+f]=g,b=document.createElement(\\\"td\\\"),b.style.fontSize=\\\"1px\\\",\\nb.innerHTML=\\\"&nbsp;\\\",b.style.height=\\\"10px\\\",1>=f?(b.style.width=\\\"17px\\\",b.style.borderRight=\\\"3px solid white\\\"):(b.style.width=\\\"20px\\\",b.style.backgroundRepeat=\\\"no-repeat\\\"),e.appendChild(b),g.ele=b;p.tbody.appendChild(e)}r.appendChild(p.table);b=document.createElement(\\\"div\\\");b.style.marginTop=\\\"3px\\\";b.innerHTML='<table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"><tr><td style=\\\"width:17px;background-color:#FFF;background-image:url('+l.imagePrefix+'defaultcolor.gif);height:16px;font-size:10px;cursor:pointer;\\\" title=\\\"'+\\nm(\\\"Default\\\")+'\\\">&nbsp;</td><td style=\\\"width:23px;height:16px;font-size:10px;text-align:center;cursor:pointer;\\\" title=\\\"'+m(\\\"Custom\\\")+'\\\">#</td><td style=\\\"width:60px;height:16px;font-size:10px;text-align:center;cursor:pointer;\\\">'+m(\\\"OK\\\")+\\\"</td></tr></table>\\\";TiddlyWiki&&(b.innerHTML=TiddlyWiki.getModifiedCssImageStyle(b.innerHTML));p.defaultbox=b.firstChild.firstChild.firstChild.childNodes[0];p.defaultbox.onclick=h.ColorChooser.DefaultClicked;p.custom=b.firstChild.firstChild.firstChild.childNodes[1];\\np.custom.onclick=h.ColorChooser.CustomClicked;p.msg=b.firstChild.firstChild.firstChild.childNodes[2];p.msg.onclick=h.ColorChooser.CloseOK;r.appendChild(b);p.table.onmousedown=h.ColorChooser.GridMouseDown;h.ColorChooser.DetermineColors(c);h.ColorChooser.SetColors(c);return r};SocialCalc.Popup.Types.ColorChooser.gridToG=function(a,c,b){return a[c+\\\",\\\"+b]};\\nSocialCalc.Popup.Types.ColorChooser.DetermineColors=function(a){var c=SocialCalc.Popup,b=c.Types.ColorChooser,d=c.Controls[a].data;a=d.grid;var e,f=c.splitRGB(d.value),d=2;e=16-Math.floor((f.r+16)/16);a[\\\"selectedrow\\\"+d]=e;for(e=0;16>e;e++)b.gridToG(a,e,d).rgb=c.makeRGB(17*(15-e),0,0);d=3;e=16-Math.floor((f.g+16)/16);a[\\\"selectedrow\\\"+d]=e;for(e=0;16>e;e++)b.gridToG(a,e,d).rgb=c.makeRGB(0,17*(15-e),0);d=4;e=16-Math.floor((f.b+16)/16);a[\\\"selectedrow\\\"+d]=e;for(e=0;16>e;e++)b.gridToG(a,e,d).rgb=c.makeRGB(0,\\n0,17*(15-e));d=1;for(e=0;16>e;e++)b.gridToG(a,e,d).rgb=c.makeRGB(17*(15-e),17*(15-e),17*(15-e));var d=0,c=[0,68,153,204,255],f=\\\"400 310 420 440 442 340 040 042 032 044 024 004 204 314 402 414\\\".split(\\\" \\\"),g;for(e=0;16>e;e++)g=f[e],b.gridToG(a,e,d).rgb=\\\"rgb(\\\"+c[g.charAt(0)-0]+\\\",\\\"+c[g.charAt(1)-0]+\\\",\\\"+c[g.charAt(2)-0]+\\\")\\\"};\\nSocialCalc.Popup.Types.ColorChooser.SetColors=function(a){var c,b,d,e=SocialCalc.Popup,f=e.Types.ColorChooser,g=e.Controls[a].data,l=g.grid;for(c=0;16>c;c++)for(b=0;5>b;b++)d=f.gridToG(l,c,b),d.ele.style.backgroundColor=d.rgb,d.ele.title=e.RGBToHex(d.rgb),d.ele.style.backgroundImage=l[\\\"selectedrow\\\"+b]==c?TiddlyWiki?TiddlyWiki.getModifiedCssImageStyle(\\\"url(\\\"+e.imagePrefix+\\\"chooserarrow.gif)\\\"):\\\"url(\\\"+e.imagePrefix+\\\"chooserarrow.gif)\\\":\\\"\\\";e.SetValue(a,g.value);l.msg.style.backgroundColor=g.value;a=e.splitRGB(g.value||\\n\\\"rgb(255,255,255)\\\");l.msg.style.color=220>a.r+a.g+a.b?\\\"#FFF\\\":\\\"#000\\\";g.value?(l.msg.style.backgroundImage=\\\"\\\",l.msg.title=e.RGBToHex(g.value)):(l.msg.style.backgroundColor=\\\"#FFF\\\",l.msg.style.backgroundImage=TiddlyWiki?TiddlyWiki.getModifiedCssImageStyle(\\\"url(\\\"+e.imagePrefix+\\\"defaultcolor.gif)\\\"):\\\"url(\\\"+e.imagePrefix+\\\"defaultcolor.gif)\\\",l.msg.title=\\\"Default\\\")};\\nSocialCalc.Popup.Types.ColorChooser.GridMouseDown=function(a){var c=a||window.event;a=SocialCalc.Popup;var b=a.Types.ColorChooser,d=a.Controls,e=a.Current.id;if(e){var d=d[e].data,f=d.grid;switch(c.type){case \\\"mousedown\\\":f.mousedown=!0;break;case \\\"mouseup\\\":f.mousedown=!1;break;case \\\"mousemove\\\":if(!f.mousedown)return}var g=SocialCalc.GetElementPositionWithScroll(d.mainele),l=c.clientX-g.left,h=c.clientY-g.top,c=SocialCalc.GetElementPositionWithScroll(f.table);c.left-=g.left;c.top-=g.top;g=Math.floor((h-\\nc.top-2)/10);g=0>g?0:g;l=Math.floor((l-c.left)/20);l=0>l?0:4<l?4:l;f=b.gridToG(f,0>g?0:15<g?15:g,l).ele.style.backgroundColor;g=a.splitRGB(f);c=a.splitRGB(d.value);switch(l){case 2:d.value=a.makeRGB(g.r,c.g,c.b);break;case 3:d.value=a.makeRGB(c.r,g.g,c.b);break;case 4:d.value=a.makeRGB(c.r,c.g,g.b);break;case 0:case 1:d.value=f}b.DetermineColors(e);b.SetColors(e)}};\\nSocialCalc.Popup.Types.ColorChooser.ControlClicked=function(a){var c=SocialCalc.Popup,b=c.Types.ColorChooser,d=c.Current.id;d&&a==d?b.CloseOK():c.CClick(a)};SocialCalc.Popup.Types.ColorChooser.DefaultClicked=function(a){var c=SocialCalc.Popup;a=c.Controls;if(c=c.Current.id)a=a[c].data,a.value=\\\"\\\",SocialCalc.Popup.SetValue(c,a.value),SocialCalc.Popup.Close()};\\nSocialCalc.Popup.Types.ColorChooser.CustomClicked=function(a){a=SocialCalc.Popup;var c=a.Controls,b=a.Current.id;if(b){var c=c[b].data,d,e,f;d=c.contentele;e=SocialCalc.Popup.Types.ColorChooser.MakeCustom(\\\"ColorChooser\\\",b);f=document.createElement(\\\"div\\\");f.innerHTML='<div style=\\\"cursor:default;padding:4px;background-color:#CCC;\\\">'+e+\\\"</div>\\\";c.customele=f.firstChild.firstChild.childNodes[2];c.contentele=f;c.popupele.replaceChild(f,d);c.customele.value=a.RGBToHex(c.value);c.attribs.ensureWithin&&SocialCalc.Popup.EnsurePosition(b,\\nc.attribs.ensureWithin)}};\\nSocialCalc.Popup.Types.ColorChooser.CustomToGrid=function(a){var c,b;c=SocialCalc.Popup;var d=c.Controls[a].data;SocialCalc.Popup.SetValue(a,c.HexToRGB(\\\"#\\\"+d.customele.value));var e;c=d.contentele;e=SocialCalc.Popup.Types.ColorChooser.CreateGrid(\\\"ColorChooser\\\",a);b=document.createElement(\\\"div\\\");b.style.padding=\\\"3px\\\";b.style.backgroundColor=\\\"#CCC\\\";b.appendChild(e);d.customele=null;d.contentele=b;d.popupele.replaceChild(b,c);d.attribs.ensureWithin&&SocialCalc.Popup.EnsurePosition(a,d.attribs.ensureWithin)};\\nSocialCalc.Popup.Types.ColorChooser.CustomOK=function(a){var c=SocialCalc.Popup;SocialCalc.Popup.SetValue(a,c.HexToRGB(\\\"#\\\"+c.Controls[a].data.customele.value));SocialCalc.Popup.Close()};SocialCalc.Popup.Types.ColorChooser.CloseOK=function(a){var c=SocialCalc.Popup;a=c.Controls;if(c=c.Current.id)SocialCalc.Popup.SetValue(c,a[c].data.value),SocialCalc.Popup.Close()};SocialCalc||(alert(\\\"Main SocialCalc code module needed\\\"),SocialCalc={});SocialCalc.TableEditor||alert(\\\"SocialCalc TableEditor code module needed\\\");SocialCalc.CurrentSpreadsheetControlObject=null;\\nSocialCalc.SpreadsheetControl=function(a,c){var b=SocialCalc.Constants;TiddlyWiki&&(this.tiddlyWiki=c,this.keyboard={areListener:!1,focusTable:null,passThru:null,didProcessKey:!1,statusFromProcessKey:!1,repeatingKeyPress:!1,chForProcessKey:\\\"\\\"},this.importExport=null);this.spreadsheetDiv=this.parentNode=null;this.viewheight=this.width=this.height=this.requestedSpaceBelow=this.requestedWidth=this.requestedHeight=0;this.tabs=[];this.tabnums={};this.tabreplacements={};this.currentTab=-1;this.views={};\\nthis.editorDiv=this.spreadsheetDiv=this.editor=this.context=this.sheet=null;this.moverange=this.sortrange=\\\"\\\";this.idPrefix=a||\\\"SocialCalc-\\\";this.multipartBoundary=\\\"SocialCalcSpreadsheetControlSave\\\";this.imagePrefix=b.defaultImagePrefix;this.toolbarbackground=b.SCToolbarbackground;this.tabbackground=b.SCTabbackground;this.tabselectedCSS=b.SCTabselectedCSS;this.tabplainCSS=b.SCTabplainCSS;this.toolbartext=b.SCToolbartext;this.formulabarheight=b.SCFormulabarheight;this.statuslineheight=b.SCStatuslineheight;\\nthis.statuslineCSS=b.SCStatuslineCSS;this.ExportCallback=null;this.sheet=new SocialCalc.Sheet;this.context=new SocialCalc.RenderContext(this.sheet);this.context.showGrid=!0;this.context.showRCHeaders=!0;this.editor=new SocialCalc.TableEditor(this.context);this.editor.StatusCallback.statusline={func:SocialCalc.SpreadsheetControlStatuslineCallback,params:{statuslineid:this.idPrefix+\\\"statusline\\\",recalcid1:this.idPrefix+\\\"divider_recalc\\\",recalcid2:this.idPrefix+\\\"button_recalc\\\"}};SocialCalc.CurrentSpreadsheetControlObject=\\nthis;this.editor.MoveECellCallback.movefrom=function(a){var c=SocialCalc.GetSpreadsheetControlObject();c.context.cursorsuffix=\\\"\\\";a.range2.hasrange&&!a.cellhandles.noCursorSuffix&&(a.ecell.row==a.range2.top&&(a.ecell.col<a.range2.left||a.ecell.col>a.range2.right+1)&&(c.context.cursorsuffix=\\\"insertleft\\\"),a.ecell.col==a.range2.left&&(a.ecell.row<a.range2.top||a.ecell.row>a.range2.bottom+1)&&(c.context.cursorsuffix=\\\"insertup\\\"))};this.formulabuttons={formulafunctions:{image:\\\"formuladialog.gif\\\",tooltip:\\\"Functions\\\",\\ncommand:SocialCalc.SpreadsheetControl.DoFunctionList},multilineinput:{image:\\\"multilinedialog.gif\\\",tooltip:\\\"Multi-line Input Box\\\",command:SocialCalc.SpreadsheetControl.DoMultiline},link:{image:\\\"linkdialog.gif\\\",tooltip:\\\"Link Input Box\\\",command:SocialCalc.SpreadsheetControl.DoLink},sum:{image:\\\"sumdialog.gif\\\",tooltip:\\\"Auto Sum\\\",command:SocialCalc.SpreadsheetControl.DoSum}};this.tabnums.edit=this.tabs.length;this.tabs.push({name:\\\"edit\\\",text:\\\"Edit\\\",html:' <div id=\\\"%id.edittools\\\" class=\\\"SocialCalc-toolbar\\\">&nbsp;<img id=\\\"%id.button_undo\\\" src=\\\"%img.undo.gif\\\" style=\\\"vertical-align:bottom;\\\"> <img id=\\\"%id.button_redo\\\" src=\\\"%img.redo.gif\\\" style=\\\"vertical-align:bottom;\\\"> &nbsp;<img src=\\\"%img.divider1.gif\\\" style=\\\"vertical-align:bottom;\\\">&nbsp; <img id=\\\"%id.button_copy\\\" src=\\\"%img.copy.gif\\\" style=\\\"vertical-align:bottom;\\\"> <img id=\\\"%id.button_cut\\\" src=\\\"%img.cut.gif\\\" style=\\\"vertical-align:bottom;\\\"> <img id=\\\"%id.button_paste\\\" src=\\\"%img.paste.gif\\\" style=\\\"vertical-align:bottom;\\\"> &nbsp;<img src=\\\"%img.divider1.gif\\\" style=\\\"vertical-align:bottom;\\\">&nbsp; <img id=\\\"%id.button_delete\\\" src=\\\"%img.delete.gif\\\" style=\\\"vertical-align:bottom;\\\"> <img id=\\\"%id.button_pasteformats\\\" src=\\\"%img.pasteformats.gif\\\" style=\\\"vertical-align:bottom;\\\"> &nbsp;<img src=\\\"%img.divider1.gif\\\" style=\\\"vertical-align:bottom;\\\">&nbsp;  <span id=\\\"%id.locktools\\\"><img id=\\\"%id.button_lock\\\" src=\\\"%img.lock.gif\\\" style=\\\"vertical-align:bottom;\\\"> <img id=\\\"%id.button_unlock\\\" src=\\\"%img.unlock.gif\\\" style=\\\"vertical-align:bottom;\\\"> &nbsp;<img src=\\\"%img.divider1.gif\\\" style=\\\"vertical-align:bottom;\\\">&nbsp;</span> <img id=\\\"%id.button_filldown\\\" src=\\\"%img.filldown.gif\\\" style=\\\"vertical-align:bottom;\\\"> <img id=\\\"%id.button_fillright\\\" src=\\\"%img.fillright.gif\\\" style=\\\"vertical-align:bottom;\\\"> &nbsp;<img src=\\\"%img.divider1.gif\\\" style=\\\"vertical-align:bottom;\\\">&nbsp; <img id=\\\"%id.button_movefrom\\\" src=\\\"%img.movefromoff.gif\\\" style=\\\"vertical-align:bottom;\\\"> <img id=\\\"%id.button_movepaste\\\" src=\\\"%img.movepasteoff.gif\\\" style=\\\"vertical-align:bottom;\\\"> <img id=\\\"%id.button_moveinsert\\\" src=\\\"%img.moveinsertoff.gif\\\" style=\\\"vertical-align:bottom;\\\"> &nbsp;<img src=\\\"%img.divider1.gif\\\" style=\\\"vertical-align:bottom;\\\">&nbsp; <img id=\\\"%id.button_alignleft\\\" src=\\\"%img.alignleft.gif\\\" style=\\\"vertical-align:bottom;\\\"> <img id=\\\"%id.button_aligncenter\\\" src=\\\"%img.aligncenter.gif\\\" style=\\\"vertical-align:bottom;\\\"> <img id=\\\"%id.button_alignright\\\" src=\\\"%img.alignright.gif\\\" style=\\\"vertical-align:bottom;\\\"> &nbsp;<img src=\\\"%img.divider1.gif\\\" style=\\\"vertical-align:bottom;\\\">&nbsp; <img id=\\\"%id.button_borderon\\\" src=\\\"%img.borderson.gif\\\" style=\\\"vertical-align:bottom;\\\">  <img id=\\\"%id.button_borderoff\\\" src=\\\"%img.bordersoff.gif\\\" style=\\\"vertical-align:bottom;\\\">  <img id=\\\"%id.button_swapcolors\\\" src=\\\"%img.swapcolors.gif\\\" style=\\\"vertical-align:bottom;\\\">  &nbsp;<img src=\\\"%img.divider1.gif\\\" style=\\\"vertical-align:bottom;\\\">&nbsp; <img id=\\\"%id.button_merge\\\" src=\\\"%img.merge.gif\\\" style=\\\"vertical-align:bottom;\\\">  <img id=\\\"%id.button_unmerge\\\" src=\\\"%img.unmerge.gif\\\" style=\\\"vertical-align:bottom;\\\">  &nbsp;<img src=\\\"%img.divider1.gif\\\" style=\\\"vertical-align:bottom;\\\">&nbsp; <img id=\\\"%id.button_insertrow\\\" src=\\\"%img.insertrow.gif\\\" style=\\\"vertical-align:bottom;\\\">  <img id=\\\"%id.button_insertcol\\\" src=\\\"%img.insertcol.gif\\\" style=\\\"vertical-align:bottom;\\\"> &nbsp; <img id=\\\"%id.button_deleterow\\\" src=\\\"%img.deleterow.gif\\\" style=\\\"vertical-align:bottom;\\\">  <img id=\\\"%id.button_deletecol\\\" src=\\\"%img.deletecol.gif\\\" style=\\\"vertical-align:bottom;\\\"> &nbsp; <img id=\\\"%id.button_hiderow\\\" src=\\\"%img.hiderow.gif\\\" style=\\\"vertical-align:bottom;\\\">  <img id=\\\"%id.button_hidecol\\\" src=\\\"%img.hidecol.gif\\\" style=\\\"vertical-align:bottom;\\\">  &nbsp;<img id=\\\"%id.divider_recalc\\\" src=\\\"%img.divider1.gif\\\" style=\\\"vertical-align:bottom;\\\">&nbsp; <img id=\\\"%id.button_recalc\\\" src=\\\"%img.recalc.gif\\\" style=\\\"vertical-align:bottom;\\\">  </div>',\\noncreate:null,onclick:null});this.tabnums.settings=this.tabs.length;this.tabs.push({name:\\\"settings\\\",text:\\\"Format\\\",html:'<div id=\\\"%id.settingstools\\\" class=\\\"SocialCalc-toolbar\\\" style=\\\"display:none;\\\"> <div id=\\\"%id.sheetsettingstoolbar\\\" style=\\\"display:none;\\\">  <table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"><tr><td>   <div style=\\\"%tbt.\\\">%loc!SHEET SETTINGS!:</div>   </td></tr><tr><td>   <input id=\\\"%id.settings-savesheet\\\" type=\\\"button\\\" value=\\\"%loc!Save!\\\" onclick=\\\"SocialCalc.SettingsControlSave(\\\\'sheet\\\\');\\\">   <input type=\\\"button\\\" value=\\\"%loc!Cancel!\\\" onclick=\\\"SocialCalc.SettingsControlSave(\\\\'cancel\\\\');\\\">   <input type=\\\"button\\\" value=\\\"%loc!Show Cell Settings!\\\" onclick=\\\"SocialCalc.SpreadsheetControlSettingsSwitch(\\\\'cell\\\\');return false;\\\">   </td></tr></table> </div> <div id=\\\"%id.cellsettingstoolbar\\\" style=\\\"display:none;\\\">  <table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"><tr><td>   <div style=\\\"%tbt.\\\">%loc!CELL SETTINGS!: <span id=\\\"%id.settingsecell\\\">&nbsp;</span></div>   </td></tr><tr><td>  <input id=\\\"%id.settings-savecell\\\" type=\\\"button\\\" value=\\\"%loc!Save!\\\" onclick=\\\"SocialCalc.SettingsControlSave(\\\\'cell\\\\');\\\">  <input type=\\\"button\\\" value=\\\"%loc!Cancel!\\\" onclick=\\\"SocialCalc.SettingsControlSave(\\\\'cancel\\\\');\\\">  <input type=\\\"button\\\" value=\\\"%loc!Show Sheet Settings!\\\" onclick=\\\"SocialCalc.SpreadsheetControlSettingsSwitch(\\\\'sheet\\\\');return false;\\\">  </td></tr></table> </div></div>',\\nview:\\\"settings\\\",onclick:function(a,c){SocialCalc.SettingsControls.idPrefix=a.idPrefix;SocialCalc.SettingControlReset();var b=a.sheet.EncodeSheetAttributes(),g=a.sheet.EncodeCellAttributes(a.editor.ecell.coord);SocialCalc.SettingsControlLoadPanel(a.views.settings.values.sheetspanel,b);SocialCalc.SettingsControlLoadPanel(a.views.settings.values.cellspanel,g);document.getElementById(a.idPrefix+\\\"settingsecell\\\").innerHTML=a.editor.ecell.coord;SocialCalc.SpreadsheetControlSettingsSwitch(\\\"cell\\\");a.views.settings.element.style.height=\\na.viewheight+\\\"px\\\";a.views.settings.element.firstChild.style.height=a.viewheight+\\\"px\\\";b=a.editor.range.hasrange?SocialCalc.crToCoord(a.editor.range.left,a.editor.range.top)+\\\":\\\"+SocialCalc.crToCoord(a.editor.range.right,a.editor.range.bottom):a.editor.ecell.coord;document.getElementById(a.idPrefix+\\\"settings-savecell\\\").value=SocialCalc.LocalizeString(\\\"Save to\\\")+\\\": \\\"+b},onclickFocus:!0});this.views.settings={name:\\\"settings\\\",values:{},oncreate:function(a,c){var b=SocialCalc.Constants;c.values.sheetspanel=\\n{colorchooser:{id:a.idPrefix+\\\"scolorchooser\\\"},formatnumber:{setting:\\\"numberformat\\\",type:\\\"PopupList\\\",id:a.idPrefix+\\\"formatnumber\\\",initialdata:b.SCFormatNumberFormats},formattext:{setting:\\\"textformat\\\",type:\\\"PopupList\\\",id:a.idPrefix+\\\"formattext\\\",initialdata:b.SCFormatTextFormats},fontfamily:{setting:\\\"fontfamily\\\",type:\\\"PopupList\\\",id:a.idPrefix+\\\"fontfamily\\\",initialdata:b.SCFormatFontfamilies},fontlook:{setting:\\\"fontlook\\\",type:\\\"PopupList\\\",id:a.idPrefix+\\\"fontlook\\\",initialdata:b.SCFormatFontlook},fontsize:{setting:\\\"fontsize\\\",\\ntype:\\\"PopupList\\\",id:a.idPrefix+\\\"fontsize\\\",initialdata:b.SCFormatFontsizes},textalignhoriz:{setting:\\\"textalignhoriz\\\",type:\\\"PopupList\\\",id:a.idPrefix+\\\"textalignhoriz\\\",initialdata:b.SCFormatTextAlignhoriz},numberalignhoriz:{setting:\\\"numberalignhoriz\\\",type:\\\"PopupList\\\",id:a.idPrefix+\\\"numberalignhoriz\\\",initialdata:b.SCFormatNumberAlignhoriz},alignvert:{setting:\\\"alignvert\\\",type:\\\"PopupList\\\",id:a.idPrefix+\\\"alignvert\\\",initialdata:b.SCFormatAlignVertical},textcolor:{setting:\\\"textcolor\\\",type:\\\"ColorChooser\\\",id:a.idPrefix+\\n\\\"textcolor\\\"},bgcolor:{setting:\\\"bgcolor\\\",type:\\\"ColorChooser\\\",id:a.idPrefix+\\\"bgcolor\\\"},padtop:{setting:\\\"padtop\\\",type:\\\"PopupList\\\",id:a.idPrefix+\\\"padtop\\\",initialdata:b.SCFormatPadsizes},padright:{setting:\\\"padright\\\",type:\\\"PopupList\\\",id:a.idPrefix+\\\"padright\\\",initialdata:b.SCFormatPadsizes},padbottom:{setting:\\\"padbottom\\\",type:\\\"PopupList\\\",id:a.idPrefix+\\\"padbottom\\\",initialdata:b.SCFormatPadsizes},padleft:{setting:\\\"padleft\\\",type:\\\"PopupList\\\",id:a.idPrefix+\\\"padleft\\\",initialdata:b.SCFormatPadsizes},colwidth:{setting:\\\"colwidth\\\",\\ntype:\\\"PopupList\\\",id:a.idPrefix+\\\"colwidth\\\",initialdata:b.SCFormatColwidth},recalc:{setting:\\\"recalc\\\",type:\\\"PopupList\\\",id:a.idPrefix+\\\"recalc\\\",initialdata:b.SCFormatRecalc},usermaxcol:{setting:\\\"usermaxcol\\\",type:\\\"PopupList\\\",id:a.idPrefix+\\\"usermaxcol\\\",initialdata:b.SCFormatUserMaxCol},usermaxrow:{setting:\\\"usermaxrow\\\",type:\\\"PopupList\\\",id:a.idPrefix+\\\"usermaxrow\\\",initialdata:b.SCFormatUserMaxRow}};c.values.cellspanel={name:\\\"cell\\\",colorchooser:{id:a.idPrefix+\\\"scolorchooser\\\"},cformatnumber:{setting:\\\"numberformat\\\",\\ntype:\\\"PopupList\\\",id:a.idPrefix+\\\"cformatnumber\\\",initialdata:b.SCFormatNumberFormats},cformattext:{setting:\\\"textformat\\\",type:\\\"PopupList\\\",id:a.idPrefix+\\\"cformattext\\\",initialdata:b.SCFormatTextFormats},cfontfamily:{setting:\\\"fontfamily\\\",type:\\\"PopupList\\\",id:a.idPrefix+\\\"cfontfamily\\\",initialdata:b.SCFormatFontfamilies},cfontlook:{setting:\\\"fontlook\\\",type:\\\"PopupList\\\",id:a.idPrefix+\\\"cfontlook\\\",initialdata:b.SCFormatFontlook},cfontsize:{setting:\\\"fontsize\\\",type:\\\"PopupList\\\",id:a.idPrefix+\\\"cfontsize\\\",initialdata:b.SCFormatFontsizes},\\ncalignhoriz:{setting:\\\"alignhoriz\\\",type:\\\"PopupList\\\",id:a.idPrefix+\\\"calignhoriz\\\",initialdata:b.SCFormatTextAlignhoriz},calignvert:{setting:\\\"alignvert\\\",type:\\\"PopupList\\\",id:a.idPrefix+\\\"calignvert\\\",initialdata:b.SCFormatAlignVertical},ctextcolor:{setting:\\\"textcolor\\\",type:\\\"ColorChooser\\\",id:a.idPrefix+\\\"ctextcolor\\\"},cbgcolor:{setting:\\\"bgcolor\\\",type:\\\"ColorChooser\\\",id:a.idPrefix+\\\"cbgcolor\\\"},cbt:{setting:\\\"bt\\\",type:\\\"BorderSide\\\",id:a.idPrefix+\\\"cbt\\\"},cbr:{setting:\\\"br\\\",type:\\\"BorderSide\\\",id:a.idPrefix+\\\"cbr\\\"},cbb:{setting:\\\"bb\\\",\\ntype:\\\"BorderSide\\\",id:a.idPrefix+\\\"cbb\\\"},cbl:{setting:\\\"bl\\\",type:\\\"BorderSide\\\",id:a.idPrefix+\\\"cbl\\\"},cpadtop:{setting:\\\"padtop\\\",type:\\\"PopupList\\\",id:a.idPrefix+\\\"cpadtop\\\",initialdata:b.SCFormatPadsizes},cpadright:{setting:\\\"padright\\\",type:\\\"PopupList\\\",id:a.idPrefix+\\\"cpadright\\\",initialdata:b.SCFormatPadsizes},cpadbottom:{setting:\\\"padbottom\\\",type:\\\"PopupList\\\",id:a.idPrefix+\\\"cpadbottom\\\",initialdata:b.SCFormatPadsizes},cpadleft:{setting:\\\"padleft\\\",type:\\\"PopupList\\\",id:a.idPrefix+\\\"cpadleft\\\",initialdata:b.SCFormatPadsizes}};\\nSocialCalc.SettingsControlInitializePanel(c.values.sheetspanel);SocialCalc.SettingsControlInitializePanel(c.values.cellspanel)},replacements:{itemtitle:{regex:/\\\\%itemtitle\\\\./g,replacement:'style=\\\"padding:12px 10px 0px 10px;font-weight:bold;text-align:right;vertical-align:top;font-size:small;\\\"'},sectiontitle:{regex:/\\\\%sectiontitle\\\\./g,replacement:'style=\\\"padding:16px 10px 0px 0px;font-weight:bold;vertical-align:top;font-size:small;color:#C00;\\\"'},parttitle:{regex:/\\\\%parttitle\\\\./g,replacement:'style=\\\"font-weight:bold;font-size:x-small;padding:0px 0px 3px 0px;\\\"'},\\nitembody:{regex:/\\\\%itembody\\\\./g,replacement:'style=\\\"padding:12px 0px 0px 0px;vertical-align:top;font-size:small;\\\"'},bodypart:{regex:/\\\\%bodypart\\\\./g,replacement:'style=\\\"padding:0px 10px 0px 0px;font-size:small;vertical-align:top;\\\"'}},divStyle:\\\"border:1px solid black;overflow:auto;\\\",html:'<div id=\\\"%id.scolorchooser\\\" style=\\\"display:none;position:absolute;z-index:20;\\\"></div><table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"> <tr><td style=\\\"vertical-align:top;\\\"><table id=\\\"%id.sheetsettingstable\\\" style=\\\"display:none;\\\" cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"><tr> <td %itemtitle.><br>%loc!Default Format!:</td> <td %itembody.>   <table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Number!</div>     <span id=\\\"%id.formatnumber\\\"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Text!</div>     <span id=\\\"%id.formattext\\\"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Alignment!:</td> <td %itembody.>   <table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Text Horizontal!</div>     <span id=\\\"%id.textalignhoriz\\\"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Number Horizontal!</div>     <span id=\\\"%id.numberalignhoriz\\\"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Vertical!</div>     <span id=\\\"%id.alignvert\\\"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Font!:</td> <td %itembody.>   <table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Family!</div>     <span id=\\\"%id.fontfamily\\\"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bold &amp; Italics!</div>     <span id=\\\"%id.fontlook\\\"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Size!</div>     <span id=\\\"%id.fontsize\\\"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Color!</div>     <div id=\\\"%id.textcolor\\\" class=\\\"SocialCalc-colorchooser\\\"></div>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Background!</div>     <div id=\\\"%id.bgcolor\\\" class=\\\"SocialCalc-colorchooser\\\"></div>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Padding!:</td> <td %itembody.>   <table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Top!</div>     <span id=\\\"%id.padtop\\\"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Right!</div>     <span id=\\\"%id.padright\\\"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bottom!</div>     <span id=\\\"%id.padbottom\\\"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Left!</div>     <span id=\\\"%id.padleft\\\"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Default Column Width!:</td> <td %itembody.>   <table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"><tr>    <td %bodypart.>     <div %parttitle.>&nbsp;</div>     <span id=\\\"%id.colwidth\\\"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Recalculation!:</td> <td %itembody.>   <table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"><tr>    <td %bodypart.>     <div %parttitle.>&nbsp;</div>     <span id=\\\"%id.recalc\\\"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Dimensions!:</td> <td %itembody.>   <table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Columns!</div>     <span id=\\\"%id.usermaxcol\\\"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Rows!</div>     <span id=\\\"%id.usermaxrow\\\"></span>    </td>   </tr></table> </td></tr></table><table id=\\\"%id.cellsettingstable\\\" cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"><tr> <td %itemtitle.><br>%loc!Format!:</td> <td %itembody.>   <table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Number!</div>     <span id=\\\"%id.cformatnumber\\\"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Text!</div>     <span id=\\\"%id.cformattext\\\"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Alignment!:</td> <td %itembody.>   <table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Horizontal!</div>     <span id=\\\"%id.calignhoriz\\\"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Vertical!</div>     <span id=\\\"%id.calignvert\\\"></span>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Font!:</td> <td %itembody.>   <table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Family!</div>     <span id=\\\"%id.cfontfamily\\\"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bold &amp; Italics!</div>     <span id=\\\"%id.cfontlook\\\"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Size!</div>     <span id=\\\"%id.cfontsize\\\"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Color!</div>     <div id=\\\"%id.ctextcolor\\\" class=\\\"SocialCalc-colorchooser\\\"></div>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Background!</div>     <div id=\\\"%id.cbgcolor\\\" class=\\\"SocialCalc-colorchooser\\\"></div>    </td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Borders!:</td> <td %itembody.>   <table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\">    <tr><td %bodypart. colspan=\\\"3\\\"><div %parttitle.>%loc!Top Border!</div></td>     <td %bodypart. colspan=\\\"3\\\"><div %parttitle.>%loc!Right Border!</div></td>     <td %bodypart. colspan=\\\"3\\\"><div %parttitle.>%loc!Bottom Border!</div></td>     <td %bodypart. colspan=\\\"3\\\"><div %parttitle.>%loc!Left Border!</div></td>    </tr><tr>    <td %bodypart.>     <input id=\\\"%id.cbt-onoff-bcb\\\" onclick=\\\"SocialCalc.SettingsControlOnchangeBorder(this);\\\" type=\\\"checkbox\\\">    </td>    <td %bodypart.>     <div id=\\\"%id.cbt-color\\\" class=\\\"SocialCalc-colorchooser\\\"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>    <td %bodypart.>     <input id=\\\"%id.cbr-onoff-bcb\\\" onclick=\\\"SocialCalc.SettingsControlOnchangeBorder(this);\\\" type=\\\"checkbox\\\">    </td>    <td %bodypart.>     <div id=\\\"%id.cbr-color\\\" class=\\\"SocialCalc-colorchooser\\\"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>    <td %bodypart.>     <input id=\\\"%id.cbb-onoff-bcb\\\" onclick=\\\"SocialCalc.SettingsControlOnchangeBorder(this);\\\" type=\\\"checkbox\\\">    </td>    <td %bodypart.>     <div id=\\\"%id.cbb-color\\\" class=\\\"SocialCalc-colorchooser\\\"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>    <td %bodypart.>     <input id=\\\"%id.cbl-onoff-bcb\\\" onclick=\\\"SocialCalc.SettingsControlOnchangeBorder(this);\\\" type=\\\"checkbox\\\">    </td>    <td %bodypart.>     <div id=\\\"%id.cbl-color\\\" class=\\\"SocialCalc-colorchooser\\\"></div>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>   </tr></table> </td></tr><tr> <td %itemtitle.><br>%loc!Padding!:</td> <td %itembody.>   <table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"><tr>    <td %bodypart.>     <div %parttitle.>%loc!Top!</div>     <span id=\\\"%id.cpadtop\\\"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Right!</div>     <span id=\\\"%id.cpadright\\\"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Bottom!</div>     <span id=\\\"%id.cpadbottom\\\"></span>    </td>    <td %bodypart.>     <div %parttitle.>%loc!Left!</div>     <span id=\\\"%id.cpadleft\\\"></span>    </td>   </tr></table> </td></tr></table> </td><td style=\\\"vertical-align:top;padding:12px 0px 0px 12px;\\\">  <div style=\\\"width:100px;height:100px;overflow:hidden;border:1px solid black;background-color:#EEE;padding:6px;\\\">   <table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"><tr>    <td id=\\\"sample-text\\\" style=\\\"height:100px;width:100px;\\\"><div>%loc!This is a<br>sample!</div><div>-1234.5</div></td>   </tr></table>  </div> </td></tr></table><br>'};\\nthis.tabnums.sort=this.tabs.length;this.tabs.push({name:\\\"sort\\\",text:\\\"Sort\\\",html:' <div id=\\\"%id.sorttools\\\" class=\\\"SocialCalc-toolbar\\\" style=\\\"display:none;\\\">  <table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"><tr>   <td style=\\\"vertical-align:top;padding-right:4px;width:160px;\\\">    <div style=\\\"%tbt.\\\">%loc!Set Cells To Sort!</div>    <select id=\\\"%id.sortlist\\\" size=\\\"1\\\" onfocus=\\\"%s.CmdGotFocus(this);\\\"><option selected>[select range]</option></select>    <input type=\\\"button\\\" value=\\\"%loc!OK!\\\" onclick=\\\"%s.DoCmd(this, \\\\'ok-setsort\\\\');\\\" style=\\\"font-size:x-small;\\\">   </td>   <td style=\\\"vertical-align:middle;padding-right:16px;width:100px;text-align:right;\\\">    <div style=\\\"%tbt.\\\">&nbsp;</div>    <input type=\\\"button\\\" id=\\\"%id.sortbutton\\\" value=\\\"%loc!Sort Cells! A1:A1\\\" onclick=\\\"%s.DoCmd(this, \\\\'dosort\\\\');\\\" style=\\\"visibility:hidden;\\\">   </td>   <td style=\\\"vertical-align:top;padding-right:16px;\\\">    <table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"><tr>     <td style=\\\"vertical-align:top;\\\">      <div style=\\\"%tbt.\\\">%loc!Major Sort!</div>      <select id=\\\"%id.majorsort\\\" size=\\\"1\\\" onfocus=\\\"%s.CmdGotFocus(this);\\\"></select>     </td><td>      <input type=\\\"radio\\\" name=\\\"majorsort\\\" id=\\\"%id.majorsortup\\\" value=\\\"up\\\" checked><span style=\\\"font-size:x-small;color:#FFF;\\\">%loc!Up!</span><br>      <input type=\\\"radio\\\" name=\\\"majorsort\\\" id=\\\"%id.majorsortdown\\\" value=\\\"down\\\"><span style=\\\"font-size:x-small;color:#FFF;\\\">%loc!Down!</span>     </td>    </tr></table>   </td>   <td style=\\\"vertical-align:top;padding-right:16px;\\\">    <table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"><tr>     <td style=\\\"vertical-align:top;\\\">      <div style=\\\"%tbt.\\\">%loc!Minor Sort!</div>      <select id=\\\"%id.minorsort\\\" size=\\\"1\\\" onfocus=\\\"%s.CmdGotFocus(this);\\\"></select>     </td><td>      <input type=\\\"radio\\\" name=\\\"minorsort\\\" id=\\\"%id.minorsortup\\\" value=\\\"up\\\" checked><span style=\\\"font-size:x-small;color:#FFF;\\\">%loc!Up!</span><br>      <input type=\\\"radio\\\" name=\\\"minorsort\\\" id=\\\"%id.minorsortdown\\\" value=\\\"down\\\"><span style=\\\"font-size:x-small;color:#FFF;\\\">%loc!Down!</span>     </td>    </tr></table>   </td>   <td style=\\\"vertical-align:top;padding-right:16px;\\\">    <table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"><tr>     <td style=\\\"vertical-align:top;\\\">      <div style=\\\"%tbt.\\\">%loc!Last Sort!</div>      <select id=\\\"%id.lastsort\\\" size=\\\"1\\\" onfocus=\\\"%s.CmdGotFocus(this);\\\"></select>     </td><td>      <input type=\\\"radio\\\" name=\\\"lastsort\\\" id=\\\"%id.lastsortup\\\" value=\\\"up\\\" checked><span style=\\\"font-size:x-small;color:#FFF;\\\">%loc!Up!</span><br>      <input type=\\\"radio\\\" name=\\\"lastsort\\\" id=\\\"%id.lastsortdown\\\" value=\\\"down\\\"><span style=\\\"font-size:x-small;color:#FFF;\\\">%loc!Down!</span>     </td>    </tr></table>   </td>  </tr></table> </div>',\\nonclick:SocialCalc.SpreadsheetControlSortOnclick});this.editor.SettingsCallbacks.sort={save:SocialCalc.SpreadsheetControlSortSave,load:SocialCalc.SpreadsheetControlSortLoad};this.tabnums.audit=this.tabs.length;this.tabs.push({name:\\\"audit\\\",text:\\\"Audit\\\",html:'<div id=\\\"%id.audittools\\\" class=\\\"SocialCalc-toolbar\\\" style=\\\"display:none;\\\"> <div style=\\\"%tbt.\\\">&nbsp;</div></div>',view:\\\"audit\\\",onclick:function(a,c){var b=SocialCalc.LocalizeString,g,l,h='<table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\" style=\\\"margin-bottom:10px;\\\"><tr><td style=\\\"font-size:small;padding:6px;\\\"><b>'+\\nb(\\\"Audit Trail This Session\\\")+\\\":</b><br><br>\\\",m=a.sheet.changes.stack,p=a.sheet.changes.tos;for(g=0;g<m.length;g++)for(g==p+1&&(h+='<br></td></tr><tr><td style=\\\"font-size:small;background-color:#EEE;padding:6px;\\\">'+b(\\\"UNDONE STEPS\\\")+\\\":<br>\\\"),l=0;l<m[g].command.length;l++)h+=SocialCalc.special_chars(m[g].command[l])+\\\"<br>\\\";a.views.audit.element.innerHTML=h+\\\"</td></tr></table>\\\";SocialCalc.CmdGotFocus(!0)},onclickFocus:!0});this.views.audit={name:\\\"audit\\\",divStyle:\\\"border:1px solid black;overflow:auto;\\\",\\nhtml:\\\"Audit Trail\\\"};this.tabnums.comment=this.tabs.length;this.tabs.push({name:\\\"comment\\\",text:\\\"Comment\\\",html:'<div id=\\\"%id.commenttools\\\" class=\\\"SocialCalc-toolbar\\\" style=\\\"display:none;\\\"><table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"><tr><td><textarea id=\\\"%id.commenttext\\\" class=\\\"SocialCalc-commenttext\\\" style=\\\"font-size:small;overflow:auto;\\\" onfocus=\\\"%s.CmdGotFocus(this);\\\"></textarea></td><td style=\\\"vertical-align:top;\\\">&nbsp;<input type=\\\"button\\\" value=\\\"%loc!Save!\\\" onclick=\\\"%s.SpreadsheetControlCommentSet();\\\" style=\\\"font-size:x-small;\\\"></td></tr></table></div>',\\nview:\\\"sheet\\\",onclick:SocialCalc.SpreadsheetControlCommentOnclick,onunclick:SocialCalc.SpreadsheetControlCommentOnunclick});this.tabnums.names=this.tabs.length;this.tabs.push({name:\\\"names\\\",text:\\\"Names\\\",html:'<div id=\\\"%id.namestools\\\" class=\\\"SocialCalc-toolbar\\\" style=\\\"display:none;\\\">  <table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"><tr>   <td style=\\\"vertical-align:top;padding-right:24px;\\\">    <div style=\\\"%tbt.\\\">%loc!Existing Names!</div>    <select id=\\\"%id.nameslist\\\" size=\\\"1\\\" onchange=\\\"%s.SpreadsheetControlNamesChangedName();\\\" onfocus=\\\"%s.CmdGotFocus(this);\\\"><option selected>[New]</option></select>   </td>   <td style=\\\"vertical-align:top;padding-right:6px;\\\">    <div style=\\\"%tbt.\\\">%loc!Name!</div>    <input type=\\\"text\\\" id=\\\"%id.namesname\\\" style=\\\"font-size:x-small;width:75px;\\\" onfocus=\\\"%s.CmdGotFocus(this);\\\">   </td>   <td style=\\\"vertical-align:top;padding-right:6px;\\\">    <div style=\\\"%tbt.\\\">%loc!Description!</div>    <input type=\\\"text\\\" id=\\\"%id.namesdesc\\\" style=\\\"font-size:x-small;width:150px;\\\" onfocus=\\\"%s.CmdGotFocus(this);\\\">   </td>   <td style=\\\"vertical-align:top;padding-right:6px;\\\">    <div style=\\\"%tbt.\\\">%loc!Value!</div>    <input type=\\\"text\\\" id=\\\"%id.namesvalue\\\" width=\\\"16\\\" style=\\\"font-size:x-small;width:100px;\\\" onfocus=\\\"%s.CmdGotFocus(this);\\\">   </td>   <td style=\\\"vertical-align:top;padding-right:12px;width:100px;\\\">    <div style=\\\"%tbt.\\\">%loc!Set Value To!</div>    <input type=\\\"button\\\" id=\\\"%id.namesrangeproposal\\\" value=\\\"A1\\\" onclick=\\\"%s.SpreadsheetControlNamesSetValue();\\\" style=\\\"font-size:x-small;\\\">   </td>   <td style=\\\"vertical-align:top;padding-right:6px;\\\">    <div style=\\\"%tbt.\\\">&nbsp;</div>    <input type=\\\"button\\\" value=\\\"%loc!Save!\\\" onclick=\\\"%s.SpreadsheetControlNamesSave();\\\" style=\\\"font-size:x-small;\\\">    <input type=\\\"button\\\" value=\\\"%loc!Delete!\\\" onclick=\\\"%s.SpreadsheetControlNamesDelete()\\\" style=\\\"font-size:x-small;\\\">   </td>  </tr></table></div>',\\nview:\\\"sheet\\\",onclick:SocialCalc.SpreadsheetControlNamesOnclick,onunclick:SocialCalc.SpreadsheetControlNamesOnunclick});this.tabnums.clipboard=this.tabs.length;this.tabs.push({name:\\\"clipboard\\\",text:\\\"Clipboard\\\",html:'<div id=\\\"%id.clipboardtools\\\" class=\\\"SocialCalc-toolbar\\\" style=\\\"display:none;\\\">  <table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"><tr>    <td style=\\\"vertical-align:top;padding-right:24px;\\\"><!- *tiddlywiki* begin />      <div style=\\\"%tbt.\\\">'+SocialCalc.Constants.s_clipboard_menu_title+'</div>    </td>    <td style=\\\"vertical-align:top;padding-right:16px;\\\">      <span style=\\\"%tbt.\\\">%loc!Tiddler! : </span>      <input type=\\\"text\\\" id=\\\"%id.clipboard-tiddler\\\" onfocus=\\\"%s.CmdGotFocus(this);\\\">    </td>    <td style=\\\"vertical-align:top;\\\">      <input type=\\\"button\\\" value=\\\"%loc!Export!\\\" id=\\\"%id.clipboard-export\\\" style=\\\"font-size:x-small;\\\">      <select id=\\\"%id.clipboard-export-select-source\\\" onfocus=\\\"%s.CmdGotFocus(this);\\\"></select>      <span style=\\\"%tbt.\\\"> %loc!to! </span>      <select id=\\\"%id.clipboard-export-select-format\\\" onfocus=\\\"%s.CmdGotFocus(this);\\\"></select>      <div style=\\\"padding-top:4px;\\\">        <input type=\\\"button\\\" value=\\\"%loc!Import!\\\" id=\\\"%id.clipboard-import\\\" style=\\\"font-size:x-small;\\\">      </div><!- *tiddlywiki* end />    </td>  </tr></table></div>',\\nview:\\\"clipboard\\\",onclick:SocialCalc.SpreadsheetControlClipboardOnclick,onclickFocus:\\\"clipboardtext\\\"});this.views.clipboard={name:\\\"clipboard\\\",divStyle:\\\"overflow:auto;\\\",html:'<div style=\\\"width:100%;height:100%;overflow:hidden\\\"> <div style=\\\"font-size:x-small;padding:5px 0px 10px 0px;\\\">   <b>%loc!Display Clipboard in!:</b>   <input type=\\\"radio\\\" id=\\\"%id.clipboardformat-tab\\\" name=\\\"%id.clipboardformat\\\" checked onclick=\\\"%s.SpreadsheetControlClipboardFormat(\\\\'tab\\\\');\\\"> %loc!Tab-delimited format! &nbsp;   <input type=\\\"radio\\\" id=\\\"%id.clipboardformat-csv\\\" name=\\\"%id.clipboardformat\\\" onclick=\\\"%s.SpreadsheetControlClipboardFormat(\\\\'csv\\\\');\\\"> %loc!CSV format! &nbsp;   <input type=\\\"radio\\\" id=\\\"%id.clipboardformat-scsave\\\" name=\\\"%id.clipboardformat\\\" onclick=\\\"%s.SpreadsheetControlClipboardFormat(\\\\'scsave\\\\');\\\"> %loc!SocialCalc-save format! </div> <input type=\\\"button\\\" value=\\\"%loc!Load SocialCalc Clipboard With This!\\\" style=\\\"font-size:x-small;\\\" onclick=\\\"%s.SpreadsheetControlClipboardLoad();\\\">&nbsp;  <input type=\\\"button\\\" value=\\\"%loc!Clear SocialCalc Clipboard!\\\" style=\\\"font-size:x-small;\\\" onclick=\\\"%s.SpreadsheetControlClipboardClear();\\\">&nbsp;  <textarea id=\\\"%id.clipboardtext\\\" style=\\\"width:100%;height:80%;font-size:small;overflow:auto;margin-top:5px;\\\" onfocus=\\\"%s.CmdGotFocus(this);\\\"></textarea></div>'}};\\nSocialCalc.SpreadsheetControl.prototype.InitializeSpreadsheetControl=function(a,c,b,d){return SocialCalc.InitializeSpreadsheetControl(this,a,c,b,d)};SocialCalc.SpreadsheetControl.prototype.DoOnResize=function(){return SocialCalc.DoOnResize(this)};SocialCalc.SpreadsheetControl.prototype.SizeSSDiv=function(){return SocialCalc.SizeSSDiv(this)};SocialCalc.SpreadsheetControl.prototype.ExecuteCommand=function(a,c){return SocialCalc.SpreadsheetControlExecuteCommand(this,a,c)};\\nSocialCalc.SpreadsheetControl.prototype.CreateSheetHTML=function(){return SocialCalc.SpreadsheetControlCreateSheetHTML(this)};SocialCalc.SpreadsheetControl.prototype.CreateSpreadsheetSave=function(a){return SocialCalc.SpreadsheetControlCreateSpreadsheetSave(this,a)};SocialCalc.SpreadsheetControl.prototype.DecodeSpreadsheetSave=function(a){return SocialCalc.SpreadsheetControlDecodeSpreadsheetSave(this,a)};\\nSocialCalc.SpreadsheetControl.prototype.CreateCellHTML=function(a){return SocialCalc.SpreadsheetControlCreateCellHTML(this,a)};SocialCalc.SpreadsheetControl.prototype.CreateCellHTMLSave=function(a){return SocialCalc.SpreadsheetControlCreateCellHTMLSave(this,a)};SocialCalc.SpreadsheetControl.prototype.ParseSheetSave=function(a){return this.sheet.ParseSheetSave(a)};SocialCalc.SpreadsheetControl.prototype.CreateSheetSave=function(){return this.sheet.CreateSheetSave()};\\nSocialCalc.InitializeSpreadsheetControl=function(a,c,b,d,e){var f=SocialCalc.Constants,g=SocialCalc.LocalizeString,l=SocialCalc.LocalizeSubstrings,h,m,p,r=a.tabs,q=a.views;a.requestedHeight=b;a.requestedWidth=d;a.requestedSpaceBelow=e;\\\"string\\\"==typeof c&&(c=document.getElementById(c));null==c&&alert(\\\"SocialCalc.SpreadsheetControl not given parent node.\\\");a.parentNode=c;a.spreadsheetDiv=document.createElement(\\\"div\\\");a.SizeSSDiv();for(b=c.firstChild;null!=b;b=c.firstChild)c.removeChild(b);b=TiddlyWiki?\\n'<div><div style=\\\"'+a.toolbarbackground+'padding:0px 0px 0p 0px;\\\">':'<div><div style=\\\"'+a.toolbarbackground+'padding:12px 10px 10px 4px;height:40px;\\\">';for(d=0;d<r.length;d++)b+=r[d].html;b+=\\\"</div>\\\";b=TiddlyWiki?b+('<div style=\\\"'+a.tabbackground+'margin:0px 0px 8px 0px;\\\">'):b+('<div style=\\\"'+a.tabbackground+'padding-bottom:4px;margin:0px 0px 8px 0px;\\\">');if(TiddlyWiki)for(d=0;d<r.length;d++)b+='<div id=\\\"%id.'+r[d].name+'tab\\\" style=\\\"'+(0==d?a.tabselectedCSS:a.tabplainCSS)+'\\\" onclick=\\\"%s.SetTab(this);\\\">'+\\ng(r[d].text)+\\\"</div>\\\";else{b+='<table cellpadding=\\\"0\\\" cellspacing=\\\"0\\\"><tr>';for(d=0;d<r.length;d++)b+='  <td id=\\\"%id.'+r[d].name+'tab\\\" style=\\\"'+(0==d?a.tabselectedCSS:a.tabplainCSS)+'\\\" onclick=\\\"%s.SetTab(this);\\\">'+g(r[d].text)+\\\"</td>\\\";b+=\\\" </tr></table>\\\"}b+=\\\"</div></div>\\\";a.currentTab=0;for(m in a.tabreplacements)b=b.replace(a.tabreplacements[m].regex,a.tabreplacements[m].replacement);b=b.replace(/\\\\%s\\\\./g,\\\"SocialCalc.\\\");b=b.replace(/\\\\%id\\\\./g,a.idPrefix);b=b.replace(/\\\\%tbt\\\\./g,a.toolbartext);b=b.replace(/\\\\%img\\\\./g,\\na.imagePrefix);b=l(b);if(TiddlyWiki){e=/[\\\"][.]?[/]?images\\\\/(.+?)[\\\"]/g;for(var n;n=e.exec(b);)(d=TiddlyWiki.getModifiedImgSrc(n[0].replace(/\\\\\\\"/g,\\\"\\\")))&&(b=b.replace(n[0],'\\\"'+d+'\\\"'))}a.spreadsheetDiv.innerHTML=b;c.appendChild(a.spreadsheetDiv);a.Buttons={button_undo:{tooltip:\\\"Undo\\\",command:\\\"undo\\\"},button_redo:{tooltip:\\\"Redo\\\",command:\\\"redo\\\"},button_copy:{tooltip:\\\"Copy\\\",command:\\\"copy\\\"},button_cut:{tooltip:\\\"Cut\\\",command:\\\"cut\\\"},button_paste:{tooltip:\\\"Paste\\\",command:\\\"paste\\\"},button_pasteformats:{tooltip:\\\"Paste Formats\\\",\\ncommand:\\\"pasteformats\\\"},button_lock:{tooltip:\\\"Lock\\\",command:\\\"lock\\\"},button_unlock:{tooltip:\\\"Unlock\\\",command:\\\"unlock\\\"},button_delete:{tooltip:\\\"Delete Contents\\\",command:\\\"delete\\\"},button_filldown:{tooltip:\\\"Fill Down\\\",command:\\\"filldown\\\"},button_fillright:{tooltip:\\\"Fill Right\\\",command:\\\"fillright\\\"},button_movefrom:{tooltip:\\\"Set/Clear Move From\\\",command:\\\"movefrom\\\"},button_movepaste:{tooltip:\\\"Move Paste\\\",command:\\\"movepaste\\\"},button_moveinsert:{tooltip:\\\"Move Insert\\\",command:\\\"moveinsert\\\"},button_alignleft:{tooltip:\\\"Align Left\\\",\\ncommand:\\\"align-left\\\"},button_aligncenter:{tooltip:\\\"Align Center\\\",command:\\\"align-center\\\"},button_alignright:{tooltip:\\\"Align Right\\\",command:\\\"align-right\\\"},button_borderon:{tooltip:\\\"Borders On\\\",command:\\\"borderon\\\"},button_borderoff:{tooltip:\\\"Borders Off\\\",command:\\\"borderoff\\\"},button_swapcolors:{tooltip:\\\"Swap Colors\\\",command:\\\"swapcolors\\\"},button_merge:{tooltip:\\\"Merge Cells\\\",command:\\\"merge\\\"},button_unmerge:{tooltip:\\\"Unmerge Cells\\\",command:\\\"unmerge\\\"},button_insertrow:{tooltip:\\\"Insert Row\\\",command:\\\"insertrow\\\"},\\nbutton_insertcol:{tooltip:\\\"Insert Column\\\",command:\\\"insertcol\\\"},button_deleterow:{tooltip:\\\"Delete Row\\\",command:\\\"deleterow\\\"},button_deletecol:{tooltip:\\\"Delete Column\\\",command:\\\"deletecol\\\"},button_hiderow:{tooltip:\\\"Hide Row\\\",command:\\\"hiderow\\\"},button_hidecol:{tooltip:\\\"Hide Column\\\",command:\\\"hidecol\\\"},button_recalc:{tooltip:\\\"Recalc\\\",command:\\\"recalc\\\"}};for(p in a.Buttons)(c=document.getElementById(a.idPrefix+p))?(c.style.border=\\\"1px solid \\\"+f.ISCButtonBorderNormal,SocialCalc.TooltipRegister(c,g(a.Buttons[p].tooltip),\\n{},a.spreadsheetDiv),SocialCalc.ButtonRegister(a.editor,c,{normalstyle:\\\"border:1px solid \\\"+f.ISCButtonBorderNormal+\\\";backgroundColor:\\\"+f.ISCButtonBorderNormal+\\\";\\\",hoverstyle:\\\"border:1px solid \\\"+f.ISCButtonBorderHover+\\\";backgroundColor:\\\"+f.ISCButtonBorderNormal+\\\";\\\",downstyle:\\\"border:1px solid \\\"+f.ISCButtonBorderDown+\\\";backgroundColor:\\\"+f.ISCButtonDownBackground+\\\";\\\"},{MouseDown:SocialCalc.DoButtonCmd,command:a.Buttons[p].command})):alert(\\\"Button \\\"+(a.idPrefix+p)+\\\" missing\\\");TiddlyWiki?(a.formulabarDiv=\\ndocument.createElement(\\\"div\\\"),a.formulabarDiv.style=\\\"margin: 0px 0px 8px 0px;\\\",a.formulabarDiv.innerHTML='<input type=\\\"text\\\" style=\\\"width:70%;margin-right:4px;\\\" value=\\\"\\\">'):(a.formulabarDiv=document.createElement(\\\"div\\\"),a.formulabarDiv.style.height=a.formulabarheight+\\\"px\\\",a.formulabarDiv.innerHTML='<input type=\\\"text\\\" size=\\\"60\\\" value=\\\"\\\">&nbsp;');a.spreadsheetDiv.appendChild(a.formulabarDiv);f=new SocialCalc.InputBox(a.formulabarDiv.firstChild,a.editor);TiddlyWiki&&SocialCalc.CmdGotFocus(f.element);\\nfor(p in a.formulabuttons){c=document.createElement(\\\"img\\\");c.id=a.idPrefix+p;if(TiddlyWiki){if(d=(a.formulabuttons[p].skipImagePrefix?\\\"\\\":a.imagePrefix)+a.formulabuttons[p].image,d=TiddlyWiki.getModifiedImgSrc(d))c.src=d}else c.src=(a.formulabuttons[p].skipImagePrefix?\\\"\\\":a.imagePrefix)+a.formulabuttons[p].image;c.style.verticalAlign=\\\"middle\\\";c.style.border=\\\"1px solid #FFF\\\";c.style.marginLeft=\\\"4px\\\";SocialCalc.TooltipRegister(c,g(a.formulabuttons[p].tooltip),{},a.spreadsheetDiv);SocialCalc.ButtonRegister(a.editor,\\nc,{normalstyle:\\\"border:1px solid #FFF;backgroundColor:#FFF;\\\",hoverstyle:\\\"border:1px solid #CCC;backgroundColor:#FFF;\\\",downstyle:\\\"border:1px solid #000;backgroundColor:#FFF;\\\"},{MouseDown:a.formulabuttons[p].command,Disabled:function(){return a.editor.ECellReadonly()}});a.formulabarDiv.appendChild(c)}for(d=0;d<r.length;d++)if(r[d].oncreate)r[d].oncreate(a,r[d].name);a.nonviewheight=a.statuslineheight+a.spreadsheetDiv.firstChild.offsetHeight+a.spreadsheetDiv.lastChild.offsetHeight;a.viewheight=a.height-\\na.nonviewheight;a.editorDiv=a.editor.CreateTableEditor(a.width,a.viewheight);a.spreadsheetDiv.appendChild(a.editorDiv);for(h in q){b=q[h].html;for(m in q[h].replacements)b=b.replace(q[h].replacements[m].regex,q[h].replacements[m].replacement);b=b.replace(/\\\\%s\\\\./g,\\\"SocialCalc.\\\");b=b.replace(/\\\\%id\\\\./g,a.idPrefix);b=b.replace(/\\\\%tbt\\\\./g,a.toolbartext);b=b.replace(/\\\\%img\\\\./g,a.imagePrefix);g=document.createElement(\\\"div\\\");SocialCalc.setStyles(g,q[h].divStyle);g.style.display=\\\"none\\\";g.style.width=a.width+\\n\\\"px\\\";g.style.height=a.viewheight+\\\"px\\\";g.id=a.idPrefix+q[h].name+\\\"view\\\";b=l(b);g.innerHTML=b;a.spreadsheetDiv.appendChild(g);q[h].element=g;if(q[h].oncreate)q[h].oncreate(a,q[h])}q.sheet={name:\\\"sheet\\\",element:a.editorDiv};a.statuslineDiv=document.createElement(\\\"div\\\");TiddlyWiki?a.statuslineDiv.setAttribute(\\\"class\\\",\\\"SocialCalc-statusline\\\"):(a.statuslineDiv.style.cssText=a.statuslineCSS,a.statuslineDiv.style.height=a.statuslineheight-(a.statuslineDiv.style.paddingTop.slice(0,-2)-0)-(a.statuslineDiv.style.paddingBottom.slice(0,\\n-2)-0)+\\\"px\\\");a.statuslineDiv.id=a.idPrefix+\\\"statusline\\\";a.spreadsheetDiv.appendChild(a.statuslineDiv);TiddlyWiki&&a.spreadsheetDiv.setAttribute(\\\"tabindex\\\",\\\"0\\\");if(a.spreadsheetDiv.addEventListener)a.spreadsheetDiv.addEventListener(\\\"mousedown\\\",function(){SocialCalc.SetSpreadsheetControlObject(a);TiddlyWiki&&(a.tiddlyWiki.saveTodo.flagStart=!0)},!1),a.spreadsheetDiv.addEventListener(\\\"mouseover\\\",function(){SocialCalc.SetSpreadsheetControlObject(a)},!1);else if(a.spreadsheetDiv.attachEvent)a.spreadsheetDiv.attachEvent(\\\"onmousedown\\\",\\nfunction(){SocialCalc.SetSpreadsheetControlObject(a)}),a.spreadsheetDiv.attachEvent(\\\"onmouseover\\\",function(){SocialCalc.SetSpreadsheetControlObject(a)});else throw SocialCalc.Constants.s_BrowserNotSupported;};SocialCalc.LocalizeString=function(a){var c=SocialCalc.LocalizeStringList[a];c||(c=SocialCalc.Constants[\\\"s_loc_\\\"+a.toLowerCase().replace(/\\\\s/g,\\\"_\\\").replace(/\\\\W/g,\\\"X\\\")]||a,SocialCalc.LocalizeStringList[a]=c);return c};SocialCalc.LocalizeStringList={};\\nSocialCalc.LocalizeSubstrings=function(a){var c=SocialCalc.LocalizeString;return a.replace(/%(loc|ssc)!(.*?)!/g,function(a,d,e){return\\\"ssc\\\"==d?SocialCalc.Constants[e]||alert(\\\"Missing constant: \\\"+e):c(e)})};SocialCalc.GetSpreadsheetControlObject=function(){var a=SocialCalc.CurrentSpreadsheetControlObject;if(a)return a};SocialCalc.SetSpreadsheetControlObject=function(a){SocialCalc.CurrentSpreadsheetControlObject=a;a.keyboard.focusTable&&a&&(a.keyboard.focusTable=a.editor)};\\nSocialCalc.DoOnResize=function(a){var c,b=a.views;TiddlyWiki&&(a.keyboard.areListener=!1);if(a.SizeSSDiv()){for(vname in b)c=b[vname].element,c.style.width=a.width+\\\"px\\\",c.style.height=a.height-a.nonviewheight+\\\"px\\\";a.editor.ResizeTableEditor(a.width,a.height-a.nonviewheight)}};\\nSocialCalc.SizeSSDiv=function(a){var c,b=!1,d;c=SocialCalc.GetViewportInfo();d=a.requestedHeight||c.height-(a.requestedSpaceBelow||0);a.height!=d&&(a.height=d,a.spreadsheetDiv.style.height=d+\\\"px\\\",b=!0);d=a.requestedWidth||c.width;a.width!=d&&(a.width=d,a.spreadsheetDiv.style.width=d+\\\"px\\\",b=!0);a.spreadsheetDiv.style.position=\\\"relative\\\";return b};\\nSocialCalc.SetTab=function(a){var c,b,d,e,f,g={},l={},h=SocialCalc.GetSpreadsheetControlObject(),m=h.tabs,p=h.views;a=\\\"string\\\"==typeof a?a:a.id.slice(h.idPrefix.length,-3);if(h.editor.busy&&(!m[h.currentTab].view||\\\"sheet\\\"==m[h.currentTab].view))for(e=0;e<m.length;e++)if(m[e].name==a&&m[e].view&&\\\"sheet\\\"!=m[e].view)return;if(h.tabs[h.currentTab].onunclick)h.tabs[h.currentTab].onunclick(h,h.tabs[h.currentTab].name);for(e=0;e<m.length;e++)c=m[e].name,g[c]=document.getElementById(h.idPrefix+c+\\\"tab\\\"),l[c]=\\ndocument.getElementById(h.idPrefix+c+\\\"tools\\\"),c==a?(b=e,l[c].style.display=\\\"block\\\",g[c].style.cssText=h.tabselectedCSS):(l[c].style.display=\\\"none\\\",g[c].style.cssText=h.tabplainCSS);h.currentTab=b;if(m[b].onclick)m[b].onclick(h,a);for(f in p)!m[b].view&&\\\"sheet\\\"==f||m[b].view==f?(p[f].element.style.display=\\\"block\\\",d=f):p[f].element.style.display=\\\"none\\\";m[b].onclickFocus?(b=m[b].onclickFocus,\\\"string\\\"==typeof b&&(b=document.getElementById(h.idPrefix+b),b.focus()),SocialCalc.CmdGotFocus(b)):SocialCalc.KeyboardFocus();\\np[d].needsresize&&p[d].onresize&&(p[d].needsresize=!1,p[d].onresize(h,p[d]));\\\"sheet\\\"==d?(h.statuslineDiv.style.display=\\\"block\\\",h.editor.ScheduleRender()):h.statuslineDiv.style.display=\\\"none\\\"};\\nSocialCalc.SpreadsheetControlStatuslineCallback=function(a,c,b,d){var e=document.getElementById(d.statuslineid);e&&(e.innerHTML=a.GetStatuslineString(c,b,d));switch(c){case \\\"cmdendnorender\\\":case \\\"calcfinished\\\":case \\\"doneposcalc\\\":c=document.getElementById(d.recalcid1);d=document.getElementById(d.recalcid2);if(!c||!d)break;\\\"yes\\\"==a.context.sheetobj.attribs.needsrecalc?(c.style.display=\\\"inline\\\",d.style.display=\\\"inline\\\"):(c.style.display=\\\"none\\\",d.style.display=\\\"none\\\")}};\\nSocialCalc.UpdateSortRangeProposal=function(a){document.getElementById(SocialCalc.GetSpreadsheetControlObject().idPrefix+\\\"sortlist\\\").options[0].text=a.range.hasrange?SocialCalc.crToCoord(a.range.left,a.range.top)+\\\":\\\"+SocialCalc.crToCoord(a.range.right,a.range.bottom):SocialCalc.LocalizeString(\\\"[select range]\\\")};\\nSocialCalc.LoadColumnChoosers=function(a){var c=SocialCalc.LocalizeString,b,d,e,f;a.sortrange&&-1==a.sortrange.indexOf(\\\":\\\")?(b=SocialCalc.Formula.LookupName(a.sheet,a.sortrange||\\\"\\\"),\\\"range\\\"==b.type?(b=b.value.match(/^(.*)\\\\|(.*)\\\\|$/),b=b[1]+\\\":\\\"+b[2]):b=\\\"A1:A1\\\"):b=a.sortrange;var g=SocialCalc.ParseRange(b);e=document.getElementById(a.idPrefix+\\\"majorsort\\\");f=e.selectedIndex;e.options.length=0;e.options[e.options.length]=new Option(c(\\\"[None]\\\"),\\\"\\\");for(b=g.cr1.col;b<=g.cr2.col;b++)d=SocialCalc.rcColname(b),\\ne.options[e.options.length]=new Option(c(\\\"Column \\\")+d,d);e.selectedIndex=1<f&&f<=g.cr2.col-g.cr1.col+1?f:1;e=document.getElementById(a.idPrefix+\\\"minorsort\\\");f=e.selectedIndex;e.options.length=0;e.options[e.options.length]=new Option(c(\\\"[None]\\\"),\\\"\\\");for(b=g.cr1.col;b<=g.cr2.col;b++)d=SocialCalc.rcColname(b),e.options[e.options.length]=new Option(d,d);e.selectedIndex=0<f&&f<=g.cr2.col-g.cr1.col+1?f:0;e=document.getElementById(a.idPrefix+\\\"lastsort\\\");f=e.selectedIndex;e.options.length=0;e.options[e.options.length]=\\nnew Option(c(\\\"[None]\\\"),\\\"\\\");for(b=g.cr1.col;b<=g.cr2.col;b++)d=SocialCalc.rcColname(b),e.options[e.options.length]=new Option(d,d);e.selectedIndex=0<f&&f<=g.cr2.col-g.cr1.col+1?f:0};SocialCalc.CmdGotFocus=function(a){SocialCalc.GetSpreadsheetControlObject().keyboard.passThru=a};SocialCalc.DoButtonCmd=function(a,c,b){SocialCalc.DoCmd(b.element,b.functionobj.command)};\\nSocialCalc.DoCmd=function(a,c){var b,d,e,f,g,l;f=SocialCalc.GetSpreadsheetControlObject();e=f.editor;switch(c){case \\\"undo\\\":f.ExecuteCommand(\\\"undo\\\",\\\"\\\");break;case \\\"redo\\\":f.ExecuteCommand(\\\"redo\\\",\\\"\\\");break;case \\\"fill-rowcolstuff\\\":case \\\"fill-text\\\":e=c.substring(5);d=document.getElementById(f.idPrefix+e+\\\"list\\\");for(b=d.length=0;b<SocialCalc.SpreadsheetCmdTable[e].length;b++)d.options[b]=new Option(SocialCalc.SpreadsheetCmdTable[e][b].t);c=\\\"changed-\\\"+e;case \\\"changed-rowcolstuff\\\":case \\\"changed-text\\\":e=c.substring(8);\\nd=document.getElementById(f.idPrefix+e+\\\"list\\\");d=SocialCalc.SpreadsheetCmdTable.slists[SocialCalc.SpreadsheetCmdTable[e][d.selectedIndex].s];f=document.getElementById(f.idPrefix+e+\\\"slist\\\");for(b=f.length=0;b<(d.length||0);b++)f.options[b]=new Option(d[b].t,d[b].s);return;case \\\"ok-rowcolstuff\\\":case \\\"ok-text\\\":e=c.substring(3);d=document.getElementById(f.idPrefix+e+\\\"list\\\");f=document.getElementById(f.idPrefix+e+\\\"slist\\\");b=SocialCalc.SpreadsheetCmdTable[e][d.selectedIndex].c;d=f[f.selectedIndex].value;\\nSocialCalc.SpreadsheetControlExecuteCommand(a,b,d);break;case \\\"ok-setsort\\\":b=document.getElementById(f.idPrefix+\\\"sortlist\\\");f.sortrange=0==b.selectedIndex?e.range.hasrange?SocialCalc.crToCoord(e.range.left,e.range.top)+\\\":\\\"+SocialCalc.crToCoord(e.range.right,e.range.bottom):e.ecell.coord+\\\":\\\"+e.ecell.coord:b.options[b.selectedIndex].value;d=document.getElementById(f.idPrefix+\\\"sortbutton\\\");d.value=SocialCalc.LocalizeString(\\\"Sort \\\")+f.sortrange;d.style.visibility=\\\"visible\\\";SocialCalc.LoadColumnChoosers(f);\\na&&a.blur&&a.blur();SocialCalc.KeyboardFocus();return;case \\\"dosort\\\":if(f.sortrange&&-1==f.sortrange.indexOf(\\\":\\\")){e=SocialCalc.Formula.LookupName(f.sheet,f.sortrange||\\\"\\\");if(\\\"range\\\"!=e.type)return;e=e.value.match(/^(.*)\\\\|(.*)\\\\|$/);e=e[1]+\\\":\\\"+e[2]}else e=f.sortrange;if(\\\"A1:A1\\\"==e)return;b=\\\"sort \\\"+e+\\\" \\\";e=document.getElementById(f.idPrefix+\\\"majorsort\\\");d=document.getElementById(f.idPrefix+\\\"majorsortup\\\");b+=e.options[e.selectedIndex].value+(d.checked?\\\" up\\\":\\\" down\\\");e=document.getElementById(f.idPrefix+\\n\\\"minorsort\\\");0<e.selectedIndex&&(d=document.getElementById(f.idPrefix+\\\"minorsortup\\\"),b+=\\\" \\\"+e.options[e.selectedIndex].value+(d.checked?\\\" up\\\":\\\" down\\\"));e=document.getElementById(f.idPrefix+\\\"lastsort\\\");0<e.selectedIndex&&(d=document.getElementById(f.idPrefix+\\\"lastsortup\\\"),b+=\\\" \\\"+e.options[e.selectedIndex].value+(d.checked?\\\" up\\\":\\\" down\\\"));f.ExecuteCommand(b,\\\"\\\");break;case \\\"merge\\\":b=SocialCalc.SpreadsheetCmdLookup[c]||\\\"\\\";d=SocialCalc.SpreadsheetCmdSLookup[c]||\\\"\\\";f.ExecuteCommand(b,d);e.range.hasrange&&\\n(e.MoveECell(SocialCalc.crToCoord(e.range.left,e.range.top)),e.RangeRemove());break;case \\\"movefrom\\\":e.range2.hasrange?(f.context.cursorsuffix=\\\"\\\",e.Range2Remove(),f.ExecuteCommand(\\\"redisplay\\\",\\\"\\\")):e.range.hasrange?(e.range2.top=e.range.top,e.range2.right=e.range.right,e.range2.bottom=e.range.bottom,e.range2.left=e.range.left,e.range2.hasrange=!0,e.MoveECell(SocialCalc.crToCoord(e.range.left,e.range.top))):(e.range2.top=e.ecell.row,e.range2.right=e.ecell.col,e.range2.bottom=e.ecell.row,e.range2.left=\\ne.ecell.col,e.range2.hasrange=!0);b=e.range2.hasrange?\\\"\\\":\\\"off\\\";d=document.getElementById(f.idPrefix+\\\"button_movefrom\\\");d.src=f.imagePrefix+\\\"movefrom\\\"+b+\\\".gif\\\";d=document.getElementById(f.idPrefix+\\\"button_movepaste\\\");d.src=f.imagePrefix+\\\"movepaste\\\"+b+\\\".gif\\\";d=document.getElementById(f.idPrefix+\\\"button_moveinsert\\\");d.src=f.imagePrefix+\\\"moveinsert\\\"+b+\\\".gif\\\";e.range2.hasrange&&e.RangeRemove();break;case \\\"movepaste\\\":case \\\"moveinsert\\\":e.range2.hasrange&&(f.context.cursorsuffix=\\\"\\\",b=c+\\\" \\\"+SocialCalc.crToCoord(e.range2.left,\\ne.range2.top)+\\\":\\\"+SocialCalc.crToCoord(e.range2.right,e.range2.bottom)+\\\" \\\"+e.ecell.coord,f.ExecuteCommand(b,\\\"\\\"),e.Range2Remove(),d=document.getElementById(f.idPrefix+\\\"button_movefrom\\\"),d.src=f.imagePrefix+\\\"movefromoff.gif\\\",d=document.getElementById(f.idPrefix+\\\"button_movepaste\\\"),d.src=f.imagePrefix+\\\"movepasteoff.gif\\\",d=document.getElementById(f.idPrefix+\\\"button_moveinsert\\\"),d.src=f.imagePrefix+\\\"moveinsertoff.gif\\\");break;case \\\"swapcolors\\\":b=f.sheet;g=b.GetAssuredCell(e.ecell.coord);d=b.attribs.defaultcolor?\\nb.colors[b.attribs.defaultcolor]:\\\"rgb(0,0,0)\\\";l=b.attribs.defaultbgcolor?b.colors[b.attribs.defaultbgcolor]:\\\"rgb(255,255,255)\\\";e=g.color?b.colors[g.color]:d;e==l&&(e=\\\"\\\");b=g.bgcolor?b.colors[g.bgcolor]:l;b==d&&(b=\\\"\\\");f.ExecuteCommand(\\\"set %C color \\\"+b+\\\"%Nset %C bgcolor \\\"+e,\\\"\\\");break;default:b=SocialCalc.SpreadsheetCmdLookup[c]||\\\"\\\",d=SocialCalc.SpreadsheetCmdSLookup[c]||\\\"\\\",f.ExecuteCommand(b,d)}a&&a.blur&&a.blur();SocialCalc.KeyboardFocus()};\\nSocialCalc.SpreadsheetCmdLookup={copy:\\\"copy %C all\\\",cut:\\\"cut %C all\\\",paste:\\\"paste %C all\\\",pasteformats:\\\"paste %C formats\\\",lock:\\\"set %C readonly yes\\\",unlock:\\\"set %C readonly no\\\",\\\"delete\\\":\\\"erase %C formulas\\\",filldown:\\\"filldown %C all\\\",fillright:\\\"fillright %C all\\\",erase:\\\"erase %C all\\\",borderon:\\\"set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S\\\",borderoff:\\\"set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S\\\",merge:\\\"merge %C\\\",unmerge:\\\"unmerge %C\\\",\\\"align-left\\\":\\\"set %C cellformat left\\\",\\\"align-center\\\":\\\"set %C cellformat center\\\",\\n\\\"align-right\\\":\\\"set %C cellformat right\\\",\\\"align-default\\\":\\\"set %C cellformat\\\",insertrow:\\\"insertrow %C\\\",insertcol:\\\"insertcol %C\\\",deleterow:\\\"deleterow %C\\\",deletecol:\\\"deletecol %C\\\",hiderow:\\\"set %H hide yes\\\",hidecol:\\\"set %W hide yes\\\",undo:\\\"undo\\\",redo:\\\"redo\\\",recalc:\\\"recalc\\\"};SocialCalc.SpreadsheetCmdSLookup={borderon:\\\"1px solid rgb(0,0,0)\\\",borderoff:\\\"\\\"};\\nSocialCalc.SpreadsheetControlExecuteCommand=function(a,c,b){a=SocialCalc.GetSpreadsheetControlObject().editor;var d,e,f,g;a.range.hasrange?(e=d=SocialCalc.crToCoord(a.range.left,a.range.top)+\\\":\\\"+SocialCalc.crToCoord(a.range.right,a.range.bottom),f=SocialCalc.rcColname(a.range.left)+\\\":\\\"+SocialCalc.rcColname(a.range.right),g=a.range.top+\\\":\\\"+a.range.bottom):(e=a.ecell.coord,d=a.ecell.coord+\\\":\\\"+a.ecell.coord,f=SocialCalc.rcColname(SocialCalc.coordToCr(a.ecell.coord).col),g=SocialCalc.coordToCr(a.ecell.coord).row);\\nc=c.replace(/%C/g,e);c=c.replace(/%R/g,d);c=c.replace(/%N/g,\\\"\\\\n\\\");c=c.replace(/%S/g,b);c=c.replace(/%W/g,f);c=c.replace(/%H/g,g);c=c.replace(/%P/g,\\\"%\\\");a.EditorScheduleSheetCommands(c,!0,!1)};SocialCalc.SpreadsheetControlCreateSheetHTML=function(a){var c,b;c=\\\"\\\";c=new SocialCalc.RenderContext(a.sheet);a=document.createElement(\\\"div\\\");b=c.RenderSheet(null,{type:\\\"html\\\"});a.appendChild(b);delete c;c=a.innerHTML;delete b;delete a;return c};\\nSocialCalc.SpreadsheetControlCreateCellHTML=function(a,c,b){var d=\\\"\\\",d=a.sheet.cells[c];if(!d)return\\\"\\\";d=void 0==d.displaystring?SocialCalc.FormatValueForDisplay(a.sheet,d.datavalue,c,b||a.context.defaultHTMLlinkstyle):d.displaystring;\\\"&nbsp;\\\"==d&&(d=\\\"\\\");return d};\\nSocialCalc.SpreadsheetControlCreateCellHTMLSave=function(a,c,b){var d,e,f,g,l,h=[];d=c?SocialCalc.ParseRange(c):{cr1:{row:1,col:1},cr2:{row:a.sheet.attribs.lastrow,col:a.sheet.attribs.lastcol}};c=d.cr1;d=d.cr2;h.push(\\\"version:1.0\\\");for(e=c.row;e<=d.row;e++)for(f=c.col;f<=d.col;f++)if(g=SocialCalc.crToCoord(f,e),l=a.sheet.cells[g])l=void 0==l.displaystring?SocialCalc.FormatValueForDisplay(a.sheet,l.datavalue,g,b||a.context.defaultHTMLlinkstyle):l.displaystring,\\\"&nbsp;\\\"!=l&&h.push(g+\\\":\\\"+SocialCalc.encodeForSave(l));\\nh.push(\\\"\\\");return h.join(\\\"\\\\n\\\")};\\nSocialCalc.SpreadsheetControl.DoFunctionList=function(){var a,c,b=SocialCalc.Formula,d=SocialCalc.Constants.function_classlist,e=SocialCalc.GetSpreadsheetControlObject(),f=e.idPrefix+\\\"function\\\";c=document.getElementById(f+\\\"dialog\\\");if(!c){b.FillFunctionInfo();c='<table><tr><td><span style=\\\"font-size:x-small;font-weight:bold\\\">%loc!Category!</span><br><select id=\\\"'+f+'class\\\" size=\\\"'+d.length+'\\\" style=\\\"width:120px;\\\" onchange=\\\"SocialCalc.SpreadsheetControl.FunctionClassChosen(this.options[this.selectedIndex].value);\\\">';for(a=\\n0;a<d.length;a++)c+='<option value=\\\"'+d[a]+'\\\"'+(0==a?\\\" selected>\\\":\\\">\\\")+SocialCalc.special_chars(b.FunctionClasses[d[a]].name)+\\\"</option>\\\";c+='</select></td><td>&nbsp;&nbsp;</td><td id=\\\"'+f+'list\\\"><span style=\\\"font-size:x-small;font-weight:bold\\\">%loc!Functions!</span><br><select id=\\\"'+f+'name\\\" size=\\\"'+d.length+'\\\" style=\\\"width:240px;\\\" onchange=\\\"SocialCalc.SpreadsheetControl.FunctionChosen(this.options[this.selectedIndex].value);\\\" ondblclick=\\\"SocialCalc.SpreadsheetControl.DoFunctionPaste();\\\">';c+=SocialCalc.SpreadsheetControl.GetFunctionNamesStr(\\\"all\\\");\\nc+='</td></tr><tr><td colspan=\\\"3\\\"><div id=\\\"'+f+'desc\\\" style=\\\"width:380px;height:80px;overflow:auto;font-size:x-small;\\\">'+SocialCalc.SpreadsheetControl.GetFunctionInfoStr(b.FunctionClasses[d[0]].items[0])+'</div><div style=\\\"width:380px;text-align:right;padding-top:6px;font-size:small;\\\"><input type=\\\"button\\\" value=\\\"%loc!Paste!\\\" style=\\\"font-size:smaller;\\\" onclick=\\\"SocialCalc.SpreadsheetControl.DoFunctionPaste();\\\">&nbsp;<input type=\\\"button\\\" value=\\\"%loc!Cancel!\\\" style=\\\"font-size:smaller;\\\" onclick=\\\"SocialCalc.SpreadsheetControl.HideFunctions();\\\"></div></td></tr></table>';\\nb=document.createElement(\\\"div\\\");b.id=f+\\\"dialog\\\";b.style.position=\\\"absolute\\\";d=SocialCalc.GetViewportInfo();a=SocialCalc.GetElementPositionWithScroll(e.spreadsheetDiv);b.style.top=d.height/3-a.top+\\\"px\\\";b.style.left=d.width/3-a.left+\\\"px\\\";b.style.zIndex=100;b.style.backgroundColor=\\\"#FFF\\\";b.style.border=\\\"1px solid black\\\";b.style.width=\\\"400px\\\";c=SocialCalc.LocalizeSubstrings('<table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\" style=\\\"border-bottom:1px solid black;\\\"><tr><td style=\\\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\\\">&nbsp;%loc!Function List!</td><td style=\\\"font-size:10px;cursor:default;color:#666;\\\" onclick=\\\"SocialCalc.SpreadsheetControl.HideFunctions();\\\">&nbsp;X&nbsp;</td></tr></table><div class=\\\"SocialCalc-functiondialogbody\\\" style=\\\"background-color:#DDD;\\\">'+\\nc+\\\"</div>\\\");b.innerHTML=c;SocialCalc.DragRegister(b.firstChild.firstChild.firstChild.firstChild,!0,!0,{MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null,positionobj:b},e.spreadsheetDiv);e.spreadsheetDiv.appendChild(b);c=document.getElementById(f+\\\"name\\\");c.focus();SocialCalc.CmdGotFocus(c)}};\\nSocialCalc.SpreadsheetControl.GetFunctionNamesStr=function(a){var c,b=\\\"\\\";c=SocialCalc.Formula.FunctionClasses[a];for(a=0;a<c.items.length;a++)b+='<option value=\\\"'+c.items[a]+'\\\"'+(0==a?\\\" selected>\\\":\\\">\\\")+c.items[a]+\\\"</option>\\\";return b};SocialCalc.SpreadsheetControl.FillFunctionNames=function(a,c){var b,d;b=SocialCalc.Formula;c.length=0;d=b.FunctionClasses[a];for(b=0;b<d.items.length;b++)c.options[b]=new Option(d.items[b],d.items[b]),0==b&&(c.options[b].selected=!0)};\\nSocialCalc.SpreadsheetControl.GetFunctionInfoStr=function(a){var c=SocialCalc.Formula,b=c.FunctionList[a],d=SocialCalc.special_chars;a=\\\"<b>\\\"+a+\\\"(\\\"+d(c.FunctionArgString(a))+\\\")</b><br>\\\";return a+=d(b[3])};SocialCalc.SpreadsheetControl.FunctionClassChosen=function(a){var c=SocialCalc.GetSpreadsheetControlObject().idPrefix+\\\"function\\\",b=SocialCalc.Formula;SocialCalc.SpreadsheetControl.FillFunctionNames(a,document.getElementById(c+\\\"name\\\"));SocialCalc.SpreadsheetControl.FunctionChosen(b.FunctionClasses[a].items[0])};\\nSocialCalc.SpreadsheetControl.FunctionChosen=function(a){var c=SocialCalc.GetSpreadsheetControlObject().idPrefix+\\\"function\\\";document.getElementById(c+\\\"desc\\\").innerHTML=SocialCalc.SpreadsheetControl.GetFunctionInfoStr(a)};SocialCalc.SpreadsheetControl.HideFunctions=function(){var a=SocialCalc.GetSpreadsheetControlObject(),a=document.getElementById(a.idPrefix+\\\"functiondialog\\\");a.innerHTML=\\\"\\\";SocialCalc.DragUnregister(a);SocialCalc.KeyboardFocus();a.parentNode&&a.parentNode.removeChild(a)};\\nSocialCalc.SpreadsheetControl.DoFunctionPaste=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=a.editor,b=document.getElementById(a.idPrefix+\\\"functionname\\\"),a=document.getElementById(a.idPrefix+\\\"multilinetextarea\\\"),b=b.value+\\\"(\\\";SocialCalc.SpreadsheetControl.HideFunctions();a?(a.value+=b,a.focus(),SocialCalc.CmdGotFocus(a)):c.EditorAddToInput(b,\\\"=\\\")};\\nSocialCalc.SpreadsheetControl.DoMultiline=function(){var a=SocialCalc.LocalizeSubstrings,c,b,d=SocialCalc.GetSpreadsheetControlObject(),e=d.editor,f=e.workingvalues,d=SocialCalc.GetSpreadsheetControlObject(),g=d.idPrefix+\\\"multiline\\\";c=document.getElementById(g+\\\"dialog\\\");if(!c){switch(e.state){case \\\"start\\\":f.ecoord=e.ecell.coord;f.erow=e.ecell.row;f.ecol=e.ecell.col;e.RangeRemove();b=SocialCalc.GetCellContents(e.context.sheetobj,f.ecoord);break;case \\\"input\\\":case \\\"inputboxdirect\\\":b=e.inputBox.GetText()}e.inputBox.element.disabled=\\n!0;b=SocialCalc.special_chars(b);c='<textarea id=\\\"'+g+'textarea\\\" style=\\\"width:380px;height:120px;margin:10px 0px 0px 6px;\\\">'+b+'</textarea><div style=\\\"width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;\\\">'+a('<input type=\\\"button\\\" value=\\\"%loc!Set Cell Contents!\\\" style=\\\"font-size:smaller;\\\" onclick=\\\"SocialCalc.SpreadsheetControl.DoMultilinePaste();\\\">&nbsp;<input type=\\\"button\\\" value=\\\"%loc!Clear!\\\" style=\\\"font-size:smaller;\\\" onclick=\\\"SocialCalc.SpreadsheetControl.DoMultilineClear();\\\">&nbsp;<input type=\\\"button\\\" value=\\\"%loc!Cancel!\\\" style=\\\"font-size:smaller;\\\" onclick=\\\"SocialCalc.SpreadsheetControl.HideMultiline();\\\"></div></div>');\\nb=document.createElement(\\\"div\\\");b.id=g+\\\"dialog\\\";b.style.position=\\\"absolute\\\";e=SocialCalc.GetViewportInfo();f=SocialCalc.GetElementPositionWithScroll(d.spreadsheetDiv);b.style.top=e.height/3-f.top+\\\"px\\\";b.style.left=e.width/3-f.left+\\\"px\\\";b.style.zIndex=100;b.style.backgroundColor=\\\"#FFF\\\";b.style.border=\\\"1px solid black\\\";b.style.width=\\\"400px\\\";b.innerHTML='<table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\" style=\\\"border-bottom:1px solid black;\\\"><tr><td style=\\\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\\\">'+\\na(\\\"&nbsp;%loc!Multi-line Input Box!\\\")+'</td><td style=\\\"font-size:10px;cursor:default;color:#666;\\\" onclick=\\\"SocialCalc.SpreadsheetControl.HideMultiline();\\\">&nbsp;X&nbsp;</td></tr></table><div style=\\\"background-color:#DDD;\\\">'+c+\\\"</div>\\\";SocialCalc.DragRegister(b.firstChild.firstChild.firstChild.firstChild,!0,!0,{MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null,positionobj:b},d.spreadsheetDiv);d.spreadsheetDiv.appendChild(b);\\nc=document.getElementById(g+\\\"textarea\\\");c.focus();SocialCalc.CmdGotFocus(c)}};SocialCalc.SpreadsheetControl.HideMultiline=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=a.editor,a=document.getElementById(a.idPrefix+\\\"multilinedialog\\\");a.innerHTML=\\\"\\\";SocialCalc.DragUnregister(a);SocialCalc.KeyboardFocus();a.parentNode&&a.parentNode.removeChild(a);switch(c.state){case \\\"start\\\":c.inputBox.DisplayCellContents(null);break;case \\\"input\\\":case \\\"inputboxdirect\\\":c.inputBox.element.disabled=!1,c.inputBox.Focus()}};\\nSocialCalc.SpreadsheetControl.DoMultilineClear=function(){var a=SocialCalc.GetSpreadsheetControlObject(),a=document.getElementById(a.idPrefix+\\\"multilinetextarea\\\");a.value=\\\"\\\";a.focus()};\\nSocialCalc.SpreadsheetControl.DoMultilinePaste=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=a.editor,b=c.workingvalues,a=document.getElementById(a.idPrefix+\\\"multilinetextarea\\\").value;SocialCalc.SpreadsheetControl.HideMultiline();switch(c.state){case \\\"start\\\":b.partialexpr=\\\"\\\";b.ecoord=c.ecell.coord;b.erow=c.ecell.row;b.ecol=c.ecell.col;break;case \\\"input\\\":case \\\"inputboxdirect\\\":c.inputBox.Blur(),c.inputBox.ShowInputBox(!1),c.state=\\\"start\\\"}c.EditorSaveEdit(a)};\\nSocialCalc.SpreadsheetControl.DoLink=function(){var a=SocialCalc.LocalizeString,c,b,d,e,f=SocialCalc.GetSpreadsheetControlObject();d=f.editor;e=d.workingvalues;var f=SocialCalc.GetSpreadsheetControlObject(),g=f.idPrefix+\\\"link\\\";b=document.getElementById(g+\\\"dialog\\\");if(!b){switch(d.state){case \\\"start\\\":e.ecoord=d.ecell.coord;e.erow=d.ecell.row;e.ecol=d.ecell.col;d.RangeRemove();c=SocialCalc.GetCellContents(d.context.sheetobj,e.ecoord);break;case \\\"input\\\":case \\\"inputboxdirect\\\":c=d.inputBox.GetText()}d.inputBox.element.disabled=\\n!0;\\\"'\\\"==c.charAt(0)&&(c=c.slice(1));b=SocialCalc.ParseCellLinkText(c);SocialCalc.special_chars(c);d=(c=f.sheet.cells[d.ecell.coord])&&c.textvalueformat?\\\"\\\":\\\" checked\\\";e=b.newwin?\\\" checked\\\":\\\"\\\";c='<div style=\\\"padding:6px 0px 4px 6px;\\\"><span style=\\\"font-size:smaller;\\\">'+a(\\\"Description\\\")+'</span><br><input type=\\\"text\\\" id=\\\"'+g+'desc\\\" style=\\\"width:380px;\\\" value=\\\"'+SocialCalc.special_chars(b.desc)+'\\\"><br><span style=\\\"font-size:smaller;\\\">'+a(\\\"URL\\\")+'</span><br><input type=\\\"text\\\" id=\\\"'+g+'url\\\" style=\\\"width:380px;\\\" value=\\\"'+\\nSocialCalc.special_chars(b.url)+'\\\"><br>';SocialCalc.Callbacks.MakePageLink&&(c+='<span style=\\\"font-size:smaller;\\\">'+a(\\\"Page Name\\\")+'</span><br><input type=\\\"text\\\" id=\\\"'+g+'pagename\\\" style=\\\"width:380px;\\\" value=\\\"'+SocialCalc.special_chars(b.pagename)+'\\\"><br><span style=\\\"font-size:smaller;\\\">'+a(\\\"Workspace\\\")+'</span><br><input type=\\\"text\\\" id=\\\"'+g+'workspace\\\" style=\\\"width:380px;\\\" value=\\\"'+SocialCalc.special_chars(b.workspace)+'\\\"><br>');c+=SocialCalc.LocalizeSubstrings('<input type=\\\"checkbox\\\" id=\\\"'+g+'format\\\"'+\\nd+'>&nbsp;<span style=\\\"font-size:smaller;\\\">%loc!Set to Link format!</span><br><input type=\\\"checkbox\\\" id=\\\"'+g+'popup\\\"'+e+'>&nbsp;<span style=\\\"font-size:smaller;\\\">%loc!Show in new browser window!</span></div><div style=\\\"width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;\\\"><input type=\\\"button\\\" value=\\\"%loc!Set Cell Contents!\\\" style=\\\"font-size:smaller;\\\" onclick=\\\"SocialCalc.SpreadsheetControl.DoLinkPaste();\\\">&nbsp;<input type=\\\"button\\\" value=\\\"%loc!Clear!\\\" style=\\\"font-size:smaller;\\\" onclick=\\\"SocialCalc.SpreadsheetControl.DoLinkClear();\\\">&nbsp;<input type=\\\"button\\\" value=\\\"%loc!Cancel!\\\" style=\\\"font-size:smaller;\\\" onclick=\\\"SocialCalc.SpreadsheetControl.HideLink();\\\"></div></div>');\\nb=document.createElement(\\\"div\\\");b.id=g+\\\"dialog\\\";b.style.position=\\\"absolute\\\";d=SocialCalc.GetViewportInfo();e=SocialCalc.GetElementPositionWithScroll(f.spreadsheetDiv);b.style.top=d.height/3-e.top+\\\"px\\\";b.style.left=d.width/3-e.left+\\\"px\\\";b.style.zIndex=100;b.style.backgroundColor=\\\"#FFF\\\";b.style.border=\\\"1px solid black\\\";b.style.width=\\\"400px\\\";b.innerHTML='<table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\" style=\\\"border-bottom:1px solid black;\\\"><tr><td style=\\\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\\\">&nbsp;'+\\na(\\\"Link Input Box\\\")+'</td><td style=\\\"font-size:10px;cursor:default;color:#666;\\\" onclick=\\\"SocialCalc.SpreadsheetControl.HideLink();\\\">&nbsp;X&nbsp;</td></tr></table><div style=\\\"background-color:#DDD;\\\">'+c+\\\"</div>\\\";SocialCalc.DragRegister(b.firstChild.firstChild.firstChild.firstChild,!0,!0,{MouseDown:SocialCalc.DragFunctionStart,MouseMove:SocialCalc.DragFunctionPosition,MouseUp:SocialCalc.DragFunctionPosition,Disabled:null,positionobj:b},f.spreadsheetDiv);f.spreadsheetDiv.appendChild(b);b=document.getElementById(g+\\n\\\"url\\\");b.focus();SocialCalc.CmdGotFocus(b)}};SocialCalc.SpreadsheetControl.HideLink=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=a.editor,a=document.getElementById(a.idPrefix+\\\"linkdialog\\\");a.innerHTML=\\\"\\\";SocialCalc.DragUnregister(a);SocialCalc.KeyboardFocus();a.parentNode&&a.parentNode.removeChild(a);switch(c.state){case \\\"start\\\":c.inputBox.DisplayCellContents(null);break;case \\\"input\\\":case \\\"inputboxdirect\\\":c.inputBox.element.disabled=!1,c.inputBox.Focus()}};\\nSocialCalc.SpreadsheetControl.DoLinkClear=function(){var a=SocialCalc.GetSpreadsheetControlObject();document.getElementById(a.idPrefix+\\\"linkdesc\\\").value=\\\"\\\";document.getElementById(a.idPrefix+\\\"linkpagename\\\").value=\\\"\\\";document.getElementById(a.idPrefix+\\\"linkworkspace\\\").value=\\\"\\\";a=document.getElementById(a.idPrefix+\\\"linkurl\\\");a.value=\\\"\\\";a.focus()};\\nSocialCalc.SpreadsheetControl.DoLinkPaste=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=a.editor,b=c.workingvalues,d=document.getElementById(a.idPrefix+\\\"linkdesc\\\"),e=document.getElementById(a.idPrefix+\\\"linkurl\\\"),f=document.getElementById(a.idPrefix+\\\"linkpagename\\\"),g=document.getElementById(a.idPrefix+\\\"linkworkspace\\\"),l=document.getElementById(a.idPrefix+\\\"linkformat\\\"),h=\\\"\\\",m,p;document.getElementById(a.idPrefix+\\\"linkpopup\\\").checked?(a=\\\"<<\\\",h=\\\">>\\\",m=\\\"[[\\\",p=\\\"]]\\\"):(a=\\\"<\\\",h=\\\">\\\",m=\\\"[\\\",p=\\\"]\\\");\\nh=f&&f.value?g.value?d.value+\\\"{\\\"+g.value+m+f.value+p+\\\"}\\\":d.value+m+f.value+p:d.value+a+e.value+h;SocialCalc.SpreadsheetControl.HideLink();switch(c.state){case \\\"start\\\":b.partialexpr=\\\"\\\";b.ecoord=c.ecell.coord;b.erow=c.ecell.row;b.ecol=c.ecell.col;break;case \\\"input\\\":case \\\"inputboxdirect\\\":c.inputBox.Blur(),c.inputBox.ShowInputBox(!1),c.state=\\\"start\\\"}l.checked&&SocialCalc.SpreadsheetControlExecuteCommand(null,\\\"set %C textvalueformat text-link\\\",\\\"\\\");c.EditorSaveEdit(h)};\\nSocialCalc.SpreadsheetControl.DoSum=function(){var a,c,b,d,e=SocialCalc.GetSpreadsheetControlObject().editor,f=e.context.sheetobj;if(e.range.hasrange)a=SocialCalc.crToCoord(e.range.left,e.range.top)+\\\":\\\"+SocialCalc.crToCoord(e.range.right,e.range.bottom),a=\\\"set \\\"+SocialCalc.crToCoord(e.range.right,e.range.bottom+1)+\\\" formula sum(\\\"+a+\\\")\\\";else if(a=e.ecell.row-1,b=e.ecell.col,1>=a)a=\\\"set \\\"+e.ecell.coord+\\\" constant e#REF! 0 #REF!\\\";else{for(d=!1;0<a;){c=SocialCalc.crToCoord(b,a);c=f.GetAssuredCell(c);\\nif(c.datatype&&\\\"t\\\"!=c.datatype)d=!0;else if(d){a++;break}a--}a=\\\"set \\\"+e.ecell.coord+\\\" formula sum(\\\"+SocialCalc.crToCoord(b,a)+\\\":\\\"+SocialCalc.crToCoord(b,e.ecell.row-1)+\\\")\\\"}e.EditorScheduleSheetCommands(a,!0,!1)};\\nSocialCalc.SpreadsheetControlSortOnclick=function(a,c){var b,d,e=[],f=document.getElementById(a.idPrefix+\\\"sortlist\\\");SocialCalc.LoadColumnChoosers(a);a.editor.RangeChangeCallback.sort=SocialCalc.UpdateSortRangeProposal;for(b in a.sheet.names)e.push(b);e.sort();f.length=0;f.options[0]=new Option(SocialCalc.LocalizeString(\\\"[select range]\\\"));for(d=0;d<e.length;d++)b=e[d],f.options[d+1]=new Option(b,b),b==a.sortrange&&(f.options[d+1].selected=!0);\\\"\\\"==a.sortrange&&(f.options[0].selected=!0);SocialCalc.UpdateSortRangeProposal(a.editor);\\nSocialCalc.KeyboardFocus()};\\nSocialCalc.SpreadsheetControlSortSave=function(a,c){var b=SocialCalc.GetSpreadsheetControlObject(),d,e,f;d=\\\"sort:\\\"+SocialCalc.encodeForSave(b.sortrange)+\\\":\\\";e=document.getElementById(b.idPrefix+\\\"majorsort\\\");f=document.getElementById(b.idPrefix+\\\"majorsortup\\\");d+=e.selectedIndex+(f.checked?\\\":up\\\":\\\":down\\\");e=document.getElementById(b.idPrefix+\\\"minorsort\\\");0<e.selectedIndex?(f=document.getElementById(b.idPrefix+\\\"minorsortup\\\"),d+=\\\":\\\"+e.selectedIndex+(f.checked?\\\":up\\\":\\\":down\\\")):d+=\\\"::\\\";e=document.getElementById(b.idPrefix+\\n\\\"lastsort\\\");0<e.selectedIndex?(f=document.getElementById(b.idPrefix+\\\"lastsortup\\\"),d+=\\\":\\\"+e.selectedIndex+(f.checked?\\\":up\\\":\\\":down\\\")):d+=\\\"::\\\";return d+\\\"\\\\n\\\"};\\nSocialCalc.SpreadsheetControlSortLoad=function(a,c,b,d){a=SocialCalc.GetSpreadsheetControlObject();b=b.split(\\\":\\\");a.sortrange=SocialCalc.decodeFromSave(b[1]);c=document.getElementById(a.idPrefix+\\\"sortbutton\\\");a.sortrange?(c.value=SocialCalc.LocalizeString(\\\"Sort \\\")+a.sortrange,c.style.visibility=\\\"visible\\\"):c.style.visibility=\\\"hidden\\\";SocialCalc.LoadColumnChoosers(a);sele=document.getElementById(a.idPrefix+\\\"majorsort\\\");sele.selectedIndex=b[2]-0;document.getElementById(a.idPrefix+\\\"majorsort\\\"+b[3]).checked=\\n!0;sele=document.getElementById(a.idPrefix+\\\"minorsort\\\");b[4]?(sele.selectedIndex=b[4]-0,document.getElementById(a.idPrefix+\\\"minorsort\\\"+b[5]).checked=!0):(sele.selectedIndex=0,document.getElementById(a.idPrefix+\\\"minorsortup\\\").checked=!0);sele=document.getElementById(a.idPrefix+\\\"lastsort\\\");b[6]?(sele.selectedIndex=b[6]-0,document.getElementById(a.idPrefix+\\\"lastsort\\\"+b[7]).checked=!0):(sele.selectedIndex=0,document.getElementById(a.idPrefix+\\\"lastsortup\\\").checked=!0);return!0};\\nSocialCalc.SpreadsheetControlCommentOnclick=function(a,c){a.editor.MoveECellCallback.comment=SocialCalc.SpreadsheetControlCommentMoveECell;SocialCalc.SpreadsheetControlCommentDisplay(a,c);SocialCalc.KeyboardFocus()};SocialCalc.SpreadsheetControlCommentDisplay=function(a,c){var b=\\\"\\\";a.editor.ecell&&a.editor.ecell.coord&&a.sheet.cells[a.editor.ecell.coord]&&(b=a.sheet.cells[a.editor.ecell.coord].comment||\\\"\\\");document.getElementById(a.idPrefix+\\\"commenttext\\\").value=b};\\nSocialCalc.SpreadsheetControlCommentMoveECell=function(a){SocialCalc.SpreadsheetControlCommentDisplay(SocialCalc.GetSpreadsheetControlObject(),\\\"comment\\\")};\\nSocialCalc.SpreadsheetControlCommentSet=function(){var a=SocialCalc.GetSpreadsheetControlObject();a.ExecuteCommand(\\\"set %C comment \\\"+SocialCalc.encodeForSave(document.getElementById(a.idPrefix+\\\"commenttext\\\").value));var c=SocialCalc.GetEditorCellElement(a.editor,a.editor.ecell.row,a.editor.ecell.col);a.editor.ECellReadonly()||(c.element.title=document.getElementById(a.idPrefix+\\\"commenttext\\\").value,a.editor.UpdateCellCSS(c,a.editor.ecell.row,a.editor.ecell.col));SocialCalc.KeyboardFocus()};\\nSocialCalc.SpreadsheetControlCommentOnunclick=function(a,c){delete a.editor.MoveECellCallback.comment};\\nSocialCalc.SpreadsheetControlNamesOnclick=function(a,c){document.getElementById(a.idPrefix+\\\"namesname\\\").value=\\\"\\\";document.getElementById(a.idPrefix+\\\"namesdesc\\\").value=\\\"\\\";document.getElementById(a.idPrefix+\\\"namesvalue\\\").value=\\\"\\\";a.editor.RangeChangeCallback.names=SocialCalc.SpreadsheetControlNamesRangeChange;a.editor.MoveECellCallback.names=SocialCalc.SpreadsheetControlNamesRangeChange;SocialCalc.SpreadsheetControlNamesRangeChange(a.editor);SocialCalc.SpreadsheetControlNamesFillNameList();SocialCalc.SpreadsheetControlNamesChangedName()};\\nSocialCalc.SpreadsheetControlNamesFillNameList=function(){var a=SocialCalc.LocalizeString,c,b=[],d=SocialCalc.GetSpreadsheetControlObject(),e=document.getElementById(d.idPrefix+\\\"nameslist\\\"),f=document.getElementById(d.idPrefix+\\\"namesname\\\").value.toUpperCase().replace(/[^A-Z0-9_\\\\.]/g,\\\"\\\");for(c in d.sheet.names)b.push(c);b.sort();e.length=0;e.options[0]=0<b.length?new Option(a(\\\"[New]\\\")):new Option(a(\\\"[None]\\\"));for(a=0;a<b.length;a++)c=b[a],e.options[a+1]=new Option(c,c),c==f&&(e.options[a+1].selected=\\n!0);\\\"\\\"==f&&(e.options[0].selected=!0)};\\nSocialCalc.SpreadsheetControlNamesChangedName=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=document.getElementById(a.idPrefix+\\\"nameslist\\\"),c=c.options[c.selectedIndex].value;a.sheet.names[c]?(document.getElementById(a.idPrefix+\\\"namesname\\\").value=c,document.getElementById(a.idPrefix+\\\"namesdesc\\\").value=a.sheet.names[c].desc||\\\"\\\",document.getElementById(a.idPrefix+\\\"namesvalue\\\").value=a.sheet.names[c].definition||\\\"\\\"):(document.getElementById(a.idPrefix+\\\"namesname\\\").value=\\\"\\\",document.getElementById(a.idPrefix+\\n\\\"namesdesc\\\").value=\\\"\\\",document.getElementById(a.idPrefix+\\\"namesvalue\\\").value=\\\"\\\")};SocialCalc.SpreadsheetControlNamesRangeChange=function(a){var c=SocialCalc.GetSpreadsheetControlObject();document.getElementById(c.idPrefix+\\\"namesrangeproposal\\\").value=a.range.hasrange?SocialCalc.crToCoord(a.range.left,a.range.top)+\\\":\\\"+SocialCalc.crToCoord(a.range.right,a.range.bottom):a.ecell.coord};SocialCalc.SpreadsheetControlNamesOnunclick=function(a,c){delete a.editor.RangeChangeCallback.names;delete a.editor.MoveECellCallback.names};\\nSocialCalc.SpreadsheetControlNamesSetValue=function(){var a=SocialCalc.GetSpreadsheetControlObject();document.getElementById(a.idPrefix+\\\"namesvalue\\\").value=document.getElementById(a.idPrefix+\\\"namesrangeproposal\\\").value;SocialCalc.KeyboardFocus()};\\nSocialCalc.SpreadsheetControlNamesSave=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=document.getElementById(a.idPrefix+\\\"namesname\\\").value;SocialCalc.SetTab(a.tabs[0].name);SocialCalc.KeyboardFocus();\\\"\\\"!=c&&a.ExecuteCommand(\\\"name define \\\"+c+\\\" \\\"+document.getElementById(a.idPrefix+\\\"namesvalue\\\").value+\\\"\\\\nname desc \\\"+c+\\\" \\\"+document.getElementById(a.idPrefix+\\\"namesdesc\\\").value)};\\nSocialCalc.SpreadsheetControlNamesDelete=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=document.getElementById(a.idPrefix+\\\"namesname\\\").value;SocialCalc.SetTab(a.tabs[0].name);SocialCalc.KeyboardFocus();\\\"\\\"!=c&&a.ExecuteCommand(\\\"name delete \\\"+c);SocialCalc.KeyboardFocus()};\\nSocialCalc.SpreadsheetControlClipboardOnclick=function(a,c){a=SocialCalc.GetSpreadsheetControlObject();TiddlyWiki&&a.tiddlyWiki.clickImportExportUI(a);clipele=document.getElementById(a.idPrefix+\\\"clipboardtext\\\");document.getElementById(a.idPrefix+\\\"clipboardformat-tab\\\").checked=!0;clipele.value=SocialCalc.ConvertSaveToOtherFormat(SocialCalc.Clipboard.clipboard,\\\"tab\\\")};\\nSocialCalc.SpreadsheetControlClipboardFormat=function(a){var c=SocialCalc.GetSpreadsheetControlObject();clipele=document.getElementById(c.idPrefix+\\\"clipboardtext\\\");clipele.value=SocialCalc.ConvertSaveToOtherFormat(SocialCalc.Clipboard.clipboard,a)};\\nSocialCalc.SpreadsheetControlClipboardLoad=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=\\\"tab\\\";SocialCalc.SetTab(a.tabs[0].name);SocialCalc.KeyboardFocus();document.getElementById(a.idPrefix+\\\"clipboardformat-csv\\\").checked?c=\\\"csv\\\":document.getElementById(a.idPrefix+\\\"clipboardformat-scsave\\\").checked&&(c=\\\"scsave\\\");a.editor.EditorScheduleSheetCommands(\\\"loadclipboard \\\"+SocialCalc.encodeForSave(SocialCalc.ConvertOtherFormatToSave(document.getElementById(a.idPrefix+\\\"clipboardtext\\\").value,c)),\\n!0,!1)};SocialCalc.SpreadsheetControlClipboardClear=function(){var a=SocialCalc.GetSpreadsheetControlObject(),c=document.getElementById(a.idPrefix+\\\"clipboardtext\\\");c.value=\\\"\\\";a.editor.EditorScheduleSheetCommands(\\\"clearclipboard\\\",!0,!1);c.focus()};SocialCalc.SpreadsheetControlClipboardExport=function(){var a=SocialCalc.GetSpreadsheetControlObject();a.ExportCallback&&a.ExportCallback(a);SocialCalc.SetTab(a.tabs[0].name);SocialCalc.KeyboardFocus()};\\nSocialCalc.SpreadsheetControlSettingsSwitch=function(a){SocialCalc.SettingControlReset();var c=SocialCalc.GetSpreadsheetControlObject(),b=document.getElementById(c.idPrefix+\\\"sheetsettingstable\\\"),d=document.getElementById(c.idPrefix+\\\"cellsettingstable\\\"),e=document.getElementById(c.idPrefix+\\\"sheetsettingstoolbar\\\"),f=document.getElementById(c.idPrefix+\\\"cellsettingstoolbar\\\");\\\"sheet\\\"==a?(b.style.display=\\\"block\\\",d.style.display=\\\"none\\\",e.style.display=\\\"block\\\",f.style.display=\\\"none\\\",SocialCalc.SettingsControlSetCurrentPanel(c.views.settings.values.sheetspanel)):\\n(b.style.display=\\\"none\\\",d.style.display=\\\"block\\\",e.style.display=\\\"none\\\",f.style.display=\\\"block\\\",SocialCalc.SettingsControlSetCurrentPanel(c.views.settings.values.cellspanel))};\\nSocialCalc.SettingsControlSave=function(a){var c,b,d=SocialCalc.GetSpreadsheetControlObject(),e=SocialCalc.SettingsControlUnloadPanel(SocialCalc.SettingsControls.CurrentPanel);SocialCalc.SetTab(d.tabs[0].name);SocialCalc.KeyboardFocus();\\\"sheet\\\"==a?b=d.sheet.DecodeSheetAttributes(e):\\\"cell\\\"==a&&(d.editor.range.hasrange&&(c=SocialCalc.crToCoord(d.editor.range.left,d.editor.range.top)+\\\":\\\"+SocialCalc.crToCoord(d.editor.range.right,d.editor.range.bottom)),b=d.sheet.DecodeCellAttributes(d.editor.ecell.coord,\\ne,c));b&&d.editor.EditorScheduleSheetCommands(b,!0,!1)};\\nSocialCalc.SpreadsheetControlCreateSpreadsheetSave=function(a,c){var b=\\\"\\\",d=\\\"\\\",e,f;if(c)for(e in c)f=\\\"\\\\n\\\"!=c[e].charAt(c[e]-1)?\\\"\\\\n\\\":\\\"\\\",b+=\\\"--\\\"+a.multipartBoundary+\\\"\\\\nContent-type: text/plain; charset=UTF-8\\\\n\\\\n\\\"+c[e]+f,d+=\\\"part:\\\"+e+\\\"\\\\n\\\";return\\\"socialcalc:version:1.0\\\\nMIME-Version: 1.0\\\\nContent-Type: multipart/mixed; boundary=\\\"+a.multipartBoundary+\\\"\\\\n--\\\"+a.multipartBoundary+\\\"\\\\nContent-type: text/plain; charset=UTF-8\\\\n\\\\n# SocialCalc Spreadsheet Control Save\\\\nversion:1.0\\\\npart:sheet\\\\npart:edit\\\\npart:audit\\\\n\\\"+d+\\n\\\"--\\\"+a.multipartBoundary+\\\"\\\\nContent-type: text/plain; charset=UTF-8\\\\n\\\\n\\\"+a.CreateSheetSave()+\\\"--\\\"+a.multipartBoundary+\\\"\\\\nContent-type: text/plain; charset=UTF-8\\\\n\\\\n\\\"+a.editor.SaveEditorSettings()+\\\"--\\\"+a.multipartBoundary+\\\"\\\\nContent-type: text/plain; charset=UTF-8\\\\n\\\\n\\\"+a.sheet.CreateAuditString()+b+\\\"--\\\"+a.multipartBoundary+\\\"--\\\\n\\\"};\\nSocialCalc.SpreadsheetControlDecodeSpreadsheetSave=function(a,c){var b,d,e,f,g,l,h,m={},p=[];b=c.search(/^MIME-Version:\\\\s1\\\\.0/mi);if(0>b)return m;d=/^Content-Type:\\\\s*multipart\\\\/mixed;\\\\s*boundary=(\\\\S+)/mig;d.lastIndex=b;e=d.exec(c);if(0>=d.lastIndex)return m;b=e[1];f=new RegExp(\\\"^--\\\"+b+\\\"(?:\\\\r\\\\n|\\\\n)\\\",\\\"mg\\\");f.lastIndex=d.lastIndex;f.exec(c);d=/(?:\\\\r\\\\n|\\\\n)(?:\\\\r\\\\n|\\\\n)/gm;d.lastIndex=f.lastIndex;e=d.exec(c);if(!e)return m;g=d.lastIndex;f.lastIndex=g;e=f.exec(c);if(!e)return m;e=e.index;g=c.substring(g,\\ne).split(/\\\\r\\\\n|\\\\n/);for(l=0;l<g.length;l++)switch(line=g[l],h=line.split(\\\":\\\"),h[0]){case \\\"part\\\":p.push(h[1])}for(pnum=0;pnum<p.length;pnum++){d.lastIndex=e;e=d.exec(c);if(!e)break;g=d.lastIndex;pnum==p.length-1&&(f=new RegExp(\\\"^--\\\"+b+\\\"--$\\\",\\\"mg\\\"));f.lastIndex=g;e=f.exec(c);if(!e)break;e=e.index;m[p[pnum]]={start:g,end:e}}return m};SocialCalc.SettingsControls={Controls:{},CurrentPanel:null};\\nSocialCalc.SettingsControlSetCurrentPanel=function(a){SocialCalc.SettingsControls.CurrentPanel=a;SocialCalc.SettingsControls.PopupChangeCallback({panelobj:a},\\\"\\\",null)};SocialCalc.SettingsControlInitializePanel=function(a){var c,b=SocialCalc.SettingsControls;for(c in a)\\\"name\\\"!=c&&(ctrl=b.Controls[a[c].type])&&ctrl.Initialize&&ctrl.Initialize(a,c)};\\nSocialCalc.SettingsControlLoadPanel=function(a,c){var b,d=SocialCalc.SettingsControls;for(b in a)\\\"name\\\"!=b&&(ctrl=d.Controls[a[b].type])&&ctrl.SetValue&&ctrl.SetValue(a,b,c[a[b].setting])};SocialCalc.SettingsControlUnloadPanel=function(a){var c,b=SocialCalc.SettingsControls,d={};for(c in a)\\\"name\\\"!=c&&(ctrl=b.Controls[a[c].type])&&ctrl.GetValue&&(d[a[c].setting]=ctrl.GetValue(a,c));return d};\\nSocialCalc.SettingsControls.PopupChangeCallback=function(a,c,b){var d=SocialCalc.Constants;if((c=document.getElementById(\\\"sample-text\\\"))&&a&&a.panelobj){b=SocialCalc.CurrentSpreadsheetControlObject.idPrefix;var e=\\\"cell\\\"==a.panelobj.name?\\\"c\\\":\\\"\\\",f,g;g=d.defaultCellLayout.match(/^padding.(\\\\S+) (\\\\S+) (\\\\S+) (\\\\S+).vertical.align.(\\\\S+);$/)||[];g={color:[\\\"textcolor\\\"],backgroundColor:[\\\"bgcolor\\\",\\\"#FFF\\\"],fontSize:[\\\"fontsize\\\",d.defaultCellFontSize],fontFamily:[\\\"fontfamily\\\"],paddingTop:[\\\"padtop\\\",g[1]],paddingRight:[\\\"padright\\\",\\ng[2]],paddingBottom:[\\\"padbottom\\\",g[3]],paddingLeft:[\\\"padleft\\\",g[4]],verticalAlign:[\\\"alignvert\\\",g[5]]};for(f in g)d=SocialCalc.Popup.GetValue(b+e+g[f][0])||g[f][1]||\\\"\\\",c.style[f]=d;if(\\\"c\\\"==e){g={borderTop:\\\"cbt\\\",borderRight:\\\"cbr\\\",borderBottom:\\\"cbb\\\",borderLeft:\\\"cbl\\\"};for(f in g)d=SocialCalc.SettingsControls.BorderSideGetValue(a.panelobj,g[f]),c.style[f]=d?d.val||\\\"\\\":\\\"\\\";d=SocialCalc.Popup.GetValue(b+\\\"calignhoriz\\\");c.style.textAlign=d||\\\"left\\\"}else c.style.border=\\\"\\\",d=SocialCalc.Popup.GetValue(b+\\\"textalignhoriz\\\"),\\nc.style.textAlign=d||\\\"left\\\",d=SocialCalc.Popup.GetValue(b+\\\"numberalignhoriz\\\");c.childNodes[1].style.textAlign=d||\\\"right\\\";g=(d=SocialCalc.Popup.GetValue(b+e+\\\"fontlook\\\"))?d.match(/^(\\\\S+) (\\\\S+)$/)||[]:[];c.style.fontStyle=g[1]||\\\"\\\";c.style.fontWeight=g[2]||\\\"\\\";d=SocialCalc.Popup.GetValue(b+e+\\\"formatnumber\\\")||\\\"General\\\";a=SocialCalc.FormatNumber.formatNumberWithFormat(9.8765,d,\\\"\\\");f=SocialCalc.FormatNumber.formatNumberWithFormat(-1234.5,d,\\\"\\\");\\\"??-???-??&nbsp;??:??:??\\\"!=f&&(a+=\\\"<br>\\\"+f);c.childNodes[1].innerHTML=\\na}};SocialCalc.SettingsControls.PopupListSetValue=function(a,c,b){if(b){var d=SocialCalc.Popup;b.def?d.SetValue(a[c].id,\\\"\\\"):d.SetValue(a[c].id,b.val)}else alert(c+\\\" no value\\\")};SocialCalc.SettingsControls.PopupListGetValue=function(a,c){var b=a[c];return b?(b=SocialCalc.Popup.GetValue(b.id))?{def:!1,val:b}:{def:!0,val:0}:null};\\nSocialCalc.SettingsControls.PopupListInitialize=function(a,c){var b,d,e,f;b=SocialCalc.SettingsControls;b=a[c].initialdata||b.Controls[a[c].type].InitialData||\\\"\\\";b=SocialCalc.LocalizeSubstrings(b);var g=b.split(/\\\\|/),l=[];for(b=0;b<(g.length||0);b++)d=g[b],e=d.indexOf(\\\":\\\"),f=d.substring(0,e),-1!=f.indexOf(\\\"\\\\\\\\\\\")&&(f=f.replace(/\\\\\\\\c/g,\\\":\\\"),f=f.replace(/\\\\\\\\b/g,\\\"\\\\\\\\\\\")),f=SocialCalc.special_chars(f),l[b]=\\\"[custom]\\\"==f?{o:SocialCalc.Constants.s_PopupListCustom,v:d.substring(e+1),a:{custom:!0}}:\\\"[cancel]\\\"==\\nf?{o:SocialCalc.Constants.s_PopupListCancel,v:\\\"\\\",a:{cancel:!0}}:\\\"[break]\\\"==f?{o:\\\"-----\\\",v:\\\"\\\",a:{skip:!0}}:\\\"[newcol]\\\"==f?{o:\\\"\\\",v:\\\"\\\",a:{newcol:!0}}:{o:f,v:d.substring(e+1)};SocialCalc.Popup.Create(\\\"List\\\",a[c].id,{});SocialCalc.Popup.Initialize(a[c].id,{options:l,attribs:{changedcallback:SocialCalc.SettingsControls.PopupChangeCallback,panelobj:a}})};SocialCalc.SettingsControls.PopupListReset=function(a){SocialCalc.Popup.Reset(\\\"List\\\")};\\nSocialCalc.SettingsControls.Controls.PopupList={SetValue:SocialCalc.SettingsControls.PopupListSetValue,GetValue:SocialCalc.SettingsControls.PopupListGetValue,Initialize:SocialCalc.SettingsControls.PopupListInitialize,OnReset:SocialCalc.SettingsControls.PopupListReset,ChangedCallback:null};SocialCalc.SettingsControls.ColorChooserSetValue=function(a,c,b){if(b){var d=SocialCalc.Popup;b.def?d.SetValue(a[c].id,\\\"\\\"):d.SetValue(a[c].id,b.val)}else alert(c+\\\" no value\\\")};\\nSocialCalc.SettingsControls.ColorChooserGetValue=function(a,c){var b=SocialCalc.Popup.GetValue(a[c].id);return b?{def:!1,val:b}:{def:!0,val:0}};SocialCalc.SettingsControls.ColorChooserInitialize=function(a,c){SocialCalc.Popup.Create(\\\"ColorChooser\\\",a[c].id,{});SocialCalc.Popup.Initialize(a[c].id,{attribs:{title:\\\"&nbsp;\\\",moveable:!0,width:\\\"106px\\\",changedcallback:SocialCalc.SettingsControls.PopupChangeCallback,panelobj:a}})};SocialCalc.SettingsControls.ColorChooserReset=function(a){SocialCalc.Popup.Reset(\\\"ColorChooser\\\")};\\nSocialCalc.SettingsControls.Controls.ColorChooser={SetValue:SocialCalc.SettingsControls.ColorChooserSetValue,GetValue:SocialCalc.SettingsControls.ColorChooserGetValue,Initialize:SocialCalc.SettingsControls.ColorChooserInitialize,OnReset:SocialCalc.SettingsControls.ColorChooserReset,ChangedCallback:null};\\nSocialCalc.SettingsControls.BorderSideSetValue=function(a,c,b){a=a[c].id;if(b){if(c=document.getElementById(a+\\\"-onoff-bcb\\\"))b.val?(c.checked=!0,c.value=b.val,b=b.val.match(/(\\\\S+)\\\\s+(\\\\S+)\\\\s+(\\\\S.+)/),a+=\\\"-color\\\",SocialCalc.Popup.SetValue(a,b[3]),SocialCalc.Popup.SetDisabled(a,!1)):(c.checked=!1,c.value=b.val,a+=\\\"-color\\\",SocialCalc.Popup.SetValue(a,\\\"\\\"),SocialCalc.Popup.SetDisabled(a,!0))}else alert(c+\\\" no value\\\")};\\nSocialCalc.SettingsControls.BorderSideGetValue=function(a,c){var b,d=a[c].id;if(b=document.getElementById(d+\\\"-onoff-bcb\\\"))return b.checked?(b=SocialCalc.Popup.GetValue(d+\\\"-color\\\"),{def:!1,val:\\\"1px solid \\\"+(b||\\\"rgb(0,0,0)\\\")}):{def:!1,val:\\\"\\\"}};\\nSocialCalc.SettingsControls.BorderSideInitialize=function(a,c){var b=a[c].id;SocialCalc.Popup.Create(\\\"ColorChooser\\\",b+\\\"-color\\\",{});SocialCalc.Popup.Initialize(b+\\\"-color\\\",{attribs:{title:\\\"&nbsp;\\\",width:\\\"106px\\\",moveable:!0,changedcallback:SocialCalc.SettingsControls.PopupChangeCallback,panelobj:a}})};\\nSocialCalc.SettingsControlOnchangeBorder=function(a){var c=SocialCalc.SettingsControls,b=c.CurrentPanel,d=a.id.match(/(^.*\\\\-)(\\\\w+)\\\\-(\\\\w+)\\\\-(\\\\w+)$/);if(d){var e=d[2],b=b[e].type;switch(d[4]){case \\\"bcb\\\":a.checked?c.Controls[b].SetValue(c.CurrentPanel,e,{def:!1,val:a.value||\\\"1px solid rgb(0,0,0)\\\"}):c.Controls[b].SetValue(c.CurrentPanel,e,{def:!1,val:\\\"\\\"})}}};\\nSocialCalc.SettingsControls.Controls.BorderSide={SetValue:SocialCalc.SettingsControls.BorderSideSetValue,GetValue:SocialCalc.SettingsControls.BorderSideGetValue,OnClick:SocialCalc.SettingsControls.ColorComboOnClick,Initialize:SocialCalc.SettingsControls.BorderSideInitialize,InitialData:{thickness:\\\"1 pixel:1px\\\",style:\\\"Solid:solid\\\"},ChangedCallback:null};SocialCalc.SettingControlReset=function(){var a=SocialCalc.SettingsControls,c;for(c in a.Controls)a.Controls[c].OnReset&&a.Controls[c].OnReset(c)};\\nSocialCalc.OtherSaveParts={};\\nSocialCalc.CtrlSEditor=function(a){var c,b;if(0<a.length)c=SocialCalc.special_chars(SocialCalc.OtherSaveParts[a]||\\\"\\\");else for(b in c=\\\"Listing of Parts\\\\n\\\",SocialCalc.OtherSaveParts)c+=SocialCalc.special_chars(\\\"\\\\nPart: \\\"+b+\\\"\\\\n=====\\\\n\\\"+SocialCalc.OtherSaveParts[b]+\\\"\\\\n\\\");b=document.createElement(\\\"div\\\");b.style.cssText=\\\"position:absolute;z-index:500;width:300px;height:300px;left:100px;top:200px;border:1px solid black;background-color:#EEE;text-align:center;\\\";b.id=\\\"socialcalc-editbox\\\";b.innerHTML=a+'<br><br><textarea id=\\\"socialcalc-editbox-textarea\\\" style=\\\"width:250px;height:200px;\\\">'+\\nc+\\\"</textarea><br><br><input type=button onclick=\\\\\\\"SocialCalc.CtrlSEditorDone ('socialcalc-editbox', '\\\"+a+'\\\\');\\\" value=\\\"OK\\\">';document.body.appendChild(b);a=document.getElementById(\\\"socialcalc-editbox-textarea\\\");a.focus();SocialCalc.CmdGotFocus(a)};SocialCalc.CtrlSEditorDone=function(a,c){var b=document.getElementById(a+\\\"-textarea\\\").value;0<c.length&&(0<b.length?SocialCalc.OtherSaveParts[c]=b:delete SocialCalc.OtherSaveParts[c]);b=document.getElementById(a);SocialCalc.KeyboardFocus();b.parentNode.removeChild(b)};SocialCalc||(alert(\\\"Main SocialCalc code module needed\\\"),SocialCalc={});SocialCalc.TableEditor||alert(\\\"SocialCalc TableEditor code module needed\\\");SocialCalc.CurrentSpreadsheetViewerObject=null;\\nSocialCalc.SpreadsheetViewer=function(a,c){var b=SocialCalc.Constants;TiddlyWiki&&(this.tiddlyWiki=c,this.keyboard={areListener:!1,focusTable:null,passThru:null,didProcessKey:!1,statusFromProcessKey:!1,repeatingKeyPress:!1,chForProcessKey:\\\"\\\"},this.inputView=null);this.spreadsheetDiv=this.parentNode=null;this.viewheight=this.width=this.height=this.requestedSpaceBelow=this.requestedWidth=this.requestedHeight=0;this.editorDiv=this.spreadsheetDiv=this.editor=this.context=this.sheet=null;this.sortrange=\\n\\\"\\\";this.idPrefix=a||\\\"SocialCalc-\\\";this.imagePrefix=b.defaultImagePrefix;this.statuslineheight=b.SVStatuslineheight;this.statuslineCSS=b.SVStatuslineCSS;this.sheet=new SocialCalc.Sheet;this.context=new SocialCalc.RenderContext(this.sheet);this.context.showGrid=!0;this.context.showRCHeaders=!0;this.editor=new SocialCalc.TableEditor(this.context);this.editor.noEdit=!0;this.editor.StatusCallback.statusline={func:SocialCalc.SpreadsheetViewerStatuslineCallback,params:{}};this.hasStatusLine=!0;this.statuslineHTML=\\n'<table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\"><tr><td width=\\\"100%\\\" style=\\\"overflow:hidden;\\\">{status}</td><td>&nbsp;</td></tr></table>';this.noRecalc=this.statuslineFull=!0;this.repeatingMacroTimer=null;this.repeatingMacroInterval=60;this.repeatingMacroCommands=\\\"\\\";TiddlyWiki?SocialCalc.CurrentSpreadsheetControlObject=this:SocialCalc.CurrentSpreadsheetViewerObject=this};\\nSocialCalc.SpreadsheetViewer.prototype.InitializeSpreadsheetViewer=function(a,c,b,d){return SocialCalc.InitializeSpreadsheetViewer(this,a,c,b,d)};SocialCalc.SpreadsheetViewer.prototype.LoadSave=function(a){return SocialCalc.SpreadsheetViewerLoadSave(this,a)};SocialCalc.SpreadsheetViewer.prototype.DoOnResize=function(){return SocialCalc.DoOnResize(this)};SocialCalc.SpreadsheetViewer.prototype.SizeSSDiv=function(){return SocialCalc.SizeSSDiv(this)};\\nSocialCalc.SpreadsheetViewer.prototype.DecodeSpreadsheetSave=function(a){return SocialCalc.SpreadsheetViewerDecodeSpreadsheetSave(this,a)};SocialCalc.SpreadsheetViewer.prototype.ParseSheetSave=function(a){return this.sheet.ParseSheetSave(a)};\\nSocialCalc.InitializeSpreadsheetViewer=function(a,c,b,d,e){a.requestedHeight=b;a.requestedWidth=d;a.requestedSpaceBelow=e;\\\"string\\\"==typeof c&&(c=document.getElementById(c));null==c&&alert(\\\"SocialCalc.SpreadsheetControl not given parent node.\\\");a.parentNode=c;a.spreadsheetDiv=document.createElement(\\\"div\\\");a.SizeSSDiv();for(b=c.firstChild;null!=b;b=c.firstChild)c.removeChild(b);c.appendChild(a.spreadsheetDiv);a.nonviewheight=a.hasStatusLine?a.statuslineheight:0;a.viewheight=a.height-a.nonviewheight;\\na.editorDiv=a.editor.CreateTableEditor(a.width,a.viewheight);a.spreadsheetDiv.appendChild(a.editorDiv);a.hasStatusLine&&(a.statuslineDiv=document.createElement(\\\"div\\\"),a.statuslineDiv.style.cssText=a.statuslineCSS,a.statuslineDiv.style.height=a.statuslineheight-(a.statuslineDiv.style.paddingTop.slice(0,-2)-0)-(a.statuslineDiv.style.paddingBottom.slice(0,-2)-0)+\\\"px\\\",a.statuslineDiv.id=a.idPrefix+\\\"statusline\\\",a.spreadsheetDiv.appendChild(a.statuslineDiv),a.editor.StatusCallback.statusline={func:SocialCalc.SpreadsheetViewerStatuslineCallback,\\nparams:{spreadsheetobj:a}});TiddlyWiki&&(a.inputView=document.createElement(\\\"input\\\"),a.inputView.setAttribute(\\\"type\\\",\\\"text\\\"),a.inputView.style.width=\\\"0px\\\",a.inputView.style.height=\\\"0px\\\",a.inputView.style.padding=\\\"0\\\",a.inputView.style.border=\\\"0\\\",a.spreadsheetDiv.appendChild(a.inputView),SocialCalc.CmdGotFocus(a.inputView));if(TiddlyWiki)if(a.spreadsheetDiv.addEventListener)a.spreadsheetDiv.addEventListener(\\\"mousedown\\\",function(){SocialCalc.SetSpreadsheetControlObject(a)},!1),a.spreadsheetDiv.addEventListener(\\\"mouseover\\\",\\nfunction(){SocialCalc.SetSpreadsheetControlObject(a)},!1);else if(a.spreadsheetDiv.attachEvent)a.spreadsheetDiv.attachEvent(\\\"onmousedown\\\",function(){SocialCalc.SetSpreadsheetControlObject(a)}),a.spreadsheetDiv.attachEvent(\\\"onmouseover\\\",function(){SocialCalc.SetSpreadsheetControlObject(a)});else throw SocialCalc.Constants.s_BrowserNotSupported;};\\nSocialCalc.SpreadsheetViewerLoadSave=function(a,c){var b,d,e;if(b=a.DecodeSpreadsheetSave(c))b.sheet&&(a.sheet.ResetSheet(),a.sheet.ParseSheetSave(c.substring(b.sheet.start,b.sheet.end))),b.edit&&a.editor.LoadEditorSettings(c.substring(b.edit.start,b.edit.end)),b.startupmacro&&a.editor.EditorScheduleSheetCommands(c.substring(b.startupmacro.start,b.startupmacro.end),!1,!0),b.repeatingmacro&&(b=c.substring(b.repeatingmacro.start,b.repeatingmacro.end),b=b.replace(\\\"\\\\r\\\",\\\"\\\"),d=b.indexOf(\\\"\\\\n\\\"),0<d&&(e=b.substring(0,\\nd)-0,a.repeatingMacroInterval=e,a.repeatingMacroCommands=b.substring(d+1),0<e&&(a.repeatingMacroTimer=window.setTimeout(SocialCalc.SpreadsheetViewerDoRepeatingMacro,1E3*a.repeatingMacroInterval))));\\\"off\\\"==a.editor.context.sheetobj.attribs.recalc||a.noRecalc?a.editor.ScheduleRender():a.editor.EditorScheduleSheetCommands(\\\"recalc\\\")};\\nSocialCalc.SpreadsheetViewerDoRepeatingMacro=function(){var a=SocialCalc.GetSpreadsheetViewerObject(),c=a.editor;a.repeatingMacroTimer=null;SocialCalc.SheetCommandInfo.CmdExtensionCallbacks.repeatmacro={func:SocialCalc.SpreadsheetViewerRepeatMacroCommand,data:null};c.EditorScheduleSheetCommands(a.repeatingMacroCommands)};\\nSocialCalc.SpreadsheetViewerRepeatMacroCommand=function(a,c,b,d,e){a=SocialCalc.GetSpreadsheetViewerObject();d=d.RestOfString()-0;0<d||(d=a.repeatingMacroInterval);a.repeatingMacroInterval=d;a.repeatingMacroTimer=window.setTimeout(SocialCalc.SpreadsheetViewerDoRepeatingMacro,1E3*a.repeatingMacroInterval)};SocialCalc.SpreadsheetViewerStopRepeatingMacro=function(){var a=SocialCalc.GetSpreadsheetViewerObject();a.repeatingMacroTimer&&(window.clearTimeout(a.repeatingMacroTimer),a.repeatingMacroTimer=null)};\\nSocialCalc.SpreadsheetViewerDoButtonCmd=function(a,c,b){a=b.element;b=b.functionobj.command;c=SocialCalc.GetSpreadsheetViewerObject().editor;switch(b){case \\\"recalc\\\":c.EditorScheduleSheetCommands(\\\"recalc\\\")}a&&a.blur&&a.blur();SocialCalc.KeyboardFocus()};SocialCalc.LocalizeString=function(a){var c=SocialCalc.LocalizeStringList[a];c||(c=SocialCalc.Constants[\\\"s_loc_\\\"+a.toLowerCase().replace(/\\\\s/g,\\\"_\\\").replace(/\\\\W/g,\\\"X\\\")]||a,SocialCalc.LocalizeStringList[a]=c);return c};SocialCalc.LocalizeStringList={};\\nSocialCalc.LocalizeSubstrings=function(a){var c=SocialCalc.LocalizeString;return a.replace(/%(loc|ssc)!(.*?)!/g,function(a,d,e){return\\\"ssc\\\"==d?SocialCalc.Constants[e]||alert(\\\"Missing constant: \\\"+e):c(e)})};SocialCalc.GetSpreadsheetViewerObject=function(){var a=SocialCalc.CurrentSpreadsheetViewerObject;if(a)return a;throw\\\"No current SpreadsheetViewer object.\\\";};\\nSocialCalc.DoOnResize=function(a){var c,b=a.views;if(a.SizeSSDiv()){for(vname in b)c=b[vname].element,c.style.width=a.width+\\\"px\\\",c.style.height=a.height-a.nonviewheight+\\\"px\\\";a.editor.ResizeTableEditor(a.width,a.height-a.nonviewheight)}};SocialCalc.SpreadsheetViewerStatuslineCallback=function(a,c,b,d){var e=d.spreadsheetobj,f=\\\"\\\";e&&e.statuslineDiv&&(f=e.statuslineFull?a.GetStatuslineString(c,b,d):a.ecell.coord,f=e.statuslineHTML.replace(/\\\\{status\\\\}/,f),e.statuslineDiv.innerHTML=f)};\\nSocialCalc.CmdGotFocus=function(a){SocialCalc.GetSpreadsheetControlObject().keyboard.passThru=a};SocialCalc.SpreadsheetViewerCreateSheetHTML=function(a){var c,b;c=\\\"\\\";c=new SocialCalc.RenderContext(a.sheet);a=document.createElement(\\\"div\\\");b=c.RenderSheet(null,{type:\\\"html\\\"});a.appendChild(b);delete c;c=a.innerHTML;delete b;delete a;return c};\\nSocialCalc.SpreadsheetViewerDecodeSpreadsheetSave=function(a,c){var b,d,e,f,g,l,h,m={},p=[];/[^\\\\n]\\\\r[^\\\\n]/.test(c)&&(c=c.replace(/([^\\\\n])\\\\r([^\\\\n])/g,\\\"$1\\\\r\\\\n$2\\\"));b=c.search(/^MIME-Version:\\\\s1\\\\.0/mi);if(0>b)return m;d=/^Content-Type:\\\\s*multipart\\\\/mixed;\\\\s*boundary=(\\\\S+)/mig;d.lastIndex=b;e=d.exec(c);if(0>=d.lastIndex)return m;b=e[1];f=new RegExp(\\\"^--\\\"+b+\\\"(?:\\\\r\\\\n|\\\\n)\\\",\\\"mg\\\");f.lastIndex=d.lastIndex;f.exec(c);d=/(?:\\\\r\\\\n|\\\\n)(?:\\\\r\\\\n|\\\\n)/gm;d.lastIndex=f.lastIndex;e=d.exec(c);if(!e)return m;g=d.lastIndex;\\nf.lastIndex=g;e=f.exec(c);if(!e)return m;e=e.index;g=c.substring(g,e).split(/\\\\r\\\\n|\\\\n/);for(l=0;l<g.length;l++)switch(line=g[l],h=line.split(\\\":\\\"),h[0]){case \\\"part\\\":p.push(h[1])}for(pnum=0;pnum<p.length;pnum++){d.lastIndex=e;e=d.exec(c);if(!e)break;g=d.lastIndex;pnum==p.length-1&&(f=new RegExp(\\\"^--\\\"+b+\\\"--$\\\",\\\"mg\\\"));f.lastIndex=g;e=f.exec(c);if(!e)break;e=e.index;m[p[pnum]]={start:g,end:e}}return m};(function(){Class=function(a,c){if(!a)throw\\\"Class requires a class definition string as its first argument\\\";if(!c)throw\\\"Class requires a class wrapper function as its second argument\\\";if(!a.match(/^([\\\\w\\\\.]+)(?:\\\\(\\\\s*([\\\\w\\\\.]+)\\\\s*\\\\))?(?:\\\\s+(.*?)\\\\s*)?$/))throw\\\"Can't parse Class Definition: '\\\"+a+\\\"'\\\";var b=RegExp.$1,d=RegExp.$2||\\\"\\\",e=[];RegExp.$3&&(e=RegExp.$3.split(/\\\\s+/));for(var f=[],g=!0,l=0,h=e.length;l<h;l++){var m=e[l];\\\"-nostrict\\\"==m&&(g=!1);m.match(/^-inc=(.+)$/)&&(f=RegExp.$1.split(\\\",\\\"))}for(var e=\\nb.split(\\\".\\\"),p=Class.global,l=0;l<e.length;l++)p[e[l]]||(p[e[l]]=function(){try{this.init()}catch(a){}}),p=p[e[l]];p.className=b;p.isa=function(a){if(p.baseClassName=a)p.prototype=eval(\\\"new \\\"+a+\\\"()\\\"),p.prototype.superFunc=function(c){return eval(a).prototype[c]}};p.isa(d);p.global=Class.global;p.addGlobal=function(){this.newGlobals++;return Class.global};p.extend=function(a){if(\\\"object\\\"!=typeof a)throw\\\"extend requires an object of name:value pairs\\\";for(var c in a)p.prototype[c]=a[c]};b=0;for(d=f.length;b<\\nd;b++)l=f[b],f[b]=\\\"proto\\\"==l?p.prototype:\\\"this\\\"==l?p:Class.global[l];g?Class.eval_strict(c,p,f):c.apply(p,f);return p}})();Class.global=this;Class.eval_strict=function(a,c,b){var d=0,e;for(e in Class.global)d++;c.newGlobals=0;a.apply(c,b);a=0;for(e in Class.global)a++;if(d+c.newGlobals!=a)throw\\\"Class '\\\"+c.className+\\\"' defines \\\"+(a-d)+\\\" new global JavaScript variables without using this.addGlobal()\\\";delete c.newGlobals};Class(\\\"Document.Emitter\\\",function(){var a=this.prototype;a.className=\\\"Document.Emitter\\\";a.instantiate=function(){return eval(\\\"new \\\"+this.className+\\\"()\\\")};a.init=function(){this.output=\\\"\\\"};a.content=function(){return this.output};a.insert=function(a){this.output+=a.output}});Class(\\\"Document.Emitter.HTML(Document.Emitter)\\\",function(){var a=this.prototype;a.className=\\\"Document.Emitter.HTML\\\";a.begin_node=function(a){var b=a.type;switch(b){case \\\"asis\\\":case \\\"line\\\":break;case \\\"br\\\":case \\\"hr\\\":this.output+=\\\"<\\\"+b+\\\" />\\\";break;case \\\"html\\\":this.output+='<span class=\\\"wafl\\\">Raw HTML section. Edit in Wiki Text mode.</span>';break;case \\\"waflparagraph\\\":case \\\"waflphrase\\\":case \\\"im\\\":if(a._wafl.match(/^image:\\\\s*(\\\\S+)(?:\\\\s+size=(\\\\w+))?/)){a=\\\"if (typeof(ss) != 'undefined' && ss.editor) { var recalc = function () { try { ss.editor.DoPositionCalculations() } catch (e) { setTimeout(recalc, 500) } }; recalc() } if (!window.image_dimension_cache) window.image_dimension_cache = {};window.image_dimension_cache['/data/wafl/\\\"+\\na._label.replace(/&/g,\\\"&amp;\\\").replace(/\\\"/g,\\\"&quot;\\\").replace(/</g,\\\"&lt;\\\").replace(/>/g,\\\"&gt;\\\").replace(/'/g,\\\"\\\\\\\\'\\\").replace(/\\\\\\\\/g,\\\"\\\\\\\\\\\\\\\\\\\")+\\\"'] = [ this.offsetWidth, this.offsetHeight ]; this.style.width = this.offsetWidth + 'px'; this.style.height = this.offsetHeight + 'px'\\\";var b=RegExp.$1,d=RegExp.$2;switch(d){case \\\"small\\\":d=\\\"100\\\";break;case \\\"medium\\\":d=\\\"300\\\";break;case \\\"large\\\":d=\\\"600\\\"}d&&(d=' width=\\\"'+d+'\\\"');this.output+='<img src=\\\"'+b.replace(/&/g,\\\"&amp;\\\").replace(/\\\"/g,\\\"&quot;\\\").replace(/</g,\\\"&lt;\\\").replace(/>/g,\\n\\\"&gt;\\\")+'\\\" onload=\\\"'+a+'\\\"'+d+\\\" />\\\";break}this.output+='<span class=\\\"wafl\\\">'+a._label.replace(/&/g,\\\"&amp;\\\").replace(/\\\"/g,\\\"&quot;\\\").replace(/</g,\\\"&lt;\\\").replace(/>/g,\\\"&gt;\\\").replace(/'/g,\\\"\\\\\\\\'\\\").replace(/\\\\\\\\/g,\\\"\\\\\\\\\\\\\\\\\\\")+\\\"</span>\\\";break;case \\\"a\\\":case \\\"wikilink\\\":this.output+='<a href=\\\"'+encodeURI(a._href)+'\\\">';break;case \\\"file\\\":this.output+='<a title=\\\"(network resource)\\\" href=\\\"'+encodeURI(a._href)+'\\\">';break;case \\\"ul\\\":case \\\"ol\\\":case \\\"table\\\":case \\\"tr\\\":this.output+=\\\"<\\\"+b+\\\">\\\\n\\\";break;default:this.output+=\\\"<\\\"+\\nb+\\\">\\\"}};a.end_node=function(a){a=a.type;switch(a){case \\\"asis\\\":case \\\"br\\\":case \\\"hr\\\":case \\\"html\\\":case \\\"waflparagraph\\\":case \\\"waflphrase\\\":case \\\"im\\\":break;case \\\"line\\\":this.output+=\\\"<br />\\\";break;case \\\"file\\\":case \\\"wikilink\\\":this.output+=\\\"</a>\\\";break;default:0==a.search(/^(?:p|ul|ol|li|h\\\\d|table|tr|td)$/)?this.output+=\\\"</\\\"+a+\\\">\\\\n\\\":this.output+=\\\"</\\\"+a+\\\">\\\"}};a.text_node=function(a){this.output+=a.replace(/&/g,\\\"&amp;\\\").replace(/>/g,\\\"&gt;\\\").replace(/</g,\\\"&lt;\\\").replace(/\\\"/g,\\\"&quot;\\\").replace(/'/g,\\\"&apos;\\\")}});Class(\\\"Document.Parser\\\",function(){var a=this.prototype;a.className=\\\"Document.Parser\\\";a.init=function(){};a.parse=function(a,b){this.input=-1==a.search(/\\\\n$/)?a+\\\"\\\\n\\\":a;b&&(this.receiver=b);this.receiver.init();this.grammar=this.create_grammar();this.parse_blocks(\\\"top\\\");return this.receiver.content()};a.create_grammar=function(){throw\\\"Please define create_grammar in a derived class of Document.Parser.\\\";};a.parse_blocks=function(a){if(a=this.grammar[a].blocks)for(;this.input.length;){for(var b=this.input.length,\\nd=0;d<a.length;d++){var e=a[d],f=this.find_match(\\\"matched_block\\\",e);if(f){this.input=this.input.substr(f.end);this.handle_match(e,f);break}}if(this.input.length>=b)throw this.classname+\\\": Reduction error for:\\\\n\\\"+this.input+\\\"\\\\n\\\"+JSON.stringify(this);}};a.handle_match=function(a,b){var d=this.grammar[a];this.subparse(d.blocks?\\\"parse_blocks\\\":\\\"parse_phrases\\\",b,a,d.filter)};a.find_match=function(a,b){var d=this.grammar[b].match;if(!d)throw\\\"no regexp for type: \\\"+b;if(d=this.input.match(d))return d=this[a].call(this,\\nd,this.grammar[b].lookbehind),d.type=this.grammar[b].type||b,d};a.parse_phrases=function(a){if(a=this.grammar[a].phrases)for(;this.input.length;){for(var b=null,d=0;d<a.length;d++){var e=this.find_match(\\\"matched_phrase\\\",a[d]);if(e&&(!b||e.begin<b.begin)&&(b=e,0==b.begin))break}if(!b){this.receiver.text_node(this.input||\\\"\\\");break}0!=b.begin&&this.receiver.text_node(this.input.substr(0,b.begin)||\\\"\\\");this.input=this.input.substr(b.end);this.handle_match(b.type,b)}else this.receiver.text_node(this.input||\\n\\\"\\\")};a.subparse=function(a,b,d,e){b.type=this.grammar[d].type;null==b.type&&(b.type=d);e=e?e(b):null;b.type&&this.receiver.begin_node(b);var f=eval(\\\"new \\\"+this.className+\\\"()\\\");f.input=null==e?b.text:e;f.grammar=this.grammar;f.receiver=this.receiver.instantiate();f[a].call(f,d);this.receiver.insert(f.receiver);b.type&&this.receiver.end_node(b)};a.matched_block=function(a){return{begin:a.index,text:a[1],end:a[0].length,1:a[2],2:a[3],3:a[4]}};a.matched_phrase=function(a,b){if(b){var d=a[2],e=this.input.indexOf(a[1]);\\nreturn{text:d,begin:e,end:e+a[1].length,1:RegExp.$2,2:RegExp.$3,3:RegExp.$4}}return{begin:a.index,text:a[1],end:a.index+a[0].length,1:a[2],2:a[3],3:a[4]}}});Class(\\\"Document.Parser.Wikitext(Document.Parser)\\\",function(){var a=this.prototype;a.className=\\\"Document.Parser.Wikitext\\\";a.init=function(){};a.create_grammar=function(){var a=\\\"pre html hr hx waflparagraph ul ol blockquote p empty else\\\".split(\\\" \\\"),b=\\\"waflphrase asis wikilink wikilink2 a im mail file tt b i del a\\\".split(\\\" \\\"),d=function(a,c){c=\\\"\\\\\\\\\\\"+(c||a);a=\\\"\\\\\\\\\\\"+a;return{match:new RegExp(\\\"(?:^|[^\\\"+a+\\\"\\\\\\\\w])(\\\"+a+\\\"(?=\\\\\\\\S)(?!\\\"+c+\\\")(.*?)\\\"+c+\\\"(?=[^\\\"+c+\\\"\\\\\\\\w]|$))\\\"),phrases:\\\"\\\\\\\\`\\\"==a?null:b,lookbehind:!0}},e=\\n{yahoo:\\\"yahoo\\\",ymsgr:\\\"yahoo\\\",callto:\\\"callto\\\",callme:\\\"callto\\\",skype:\\\"callto\\\",aim:\\\"aim\\\"},f={aim:\\\"AIM: %1\\\",yahoo:\\\"Yahoo: %1\\\",callto:\\\"Skype: %1\\\"},g=\\\"(\\\\\\\\b(\\\",l;for(l in e)g+=l+\\\"|\\\";g=g.replace(/\\\\|$/,\\\")\\\\\\\\:([^\\\\\\\\s\\\\\\\\>\\\\\\\\)]+))\\\");l=function(a,b){var c=new RegExp(\\\"(^|\\\\n)\\\"+b+\\\" *\\\",\\\"g\\\");return{match:new RegExp(\\\"^(\\\"+a+\\\"+ .*\\\\n(?:[*-+#]+ .*\\\\n)*)(?:s*\\\\n)?\\\"),blocks:[\\\"ul\\\",\\\"ol\\\",\\\"subl\\\",\\\"li\\\"],filter:function(a){return a.text.replace(c,\\\"$1\\\")}}};return{_all_blocks:a,_all_phrases:b,top:{blocks:a},ol:l(\\\"#\\\",\\\"[*#]\\\"),ul:l(\\\"[-+*]\\\",\\n\\\"[-+*#]\\\"),blockquote:{match:/^((?:>[^\\\\n]*\\\\n)+)(?:\\\\s*\\\\n)?/,blocks:[\\\"blockquote\\\",\\\"line\\\"],filter:function(a){return a.text.replace(/(^|\\\\n)>\\\\ ?/g,\\\"$1\\\")}},line:{match:/([^\\\\n]*)\\\\n/,phrases:b},subl:{type:\\\"li\\\",match:/^(([^\\\\n]*)\\\\n[*#]+\\\\ [^\\\\n]*\\\\n(?:[*#]+\\\\ [^\\\\n]*\\\\n)*)(?:\\\\s*\\\\n)?/,blocks:[\\\"ul\\\",\\\"ol\\\",\\\"li2\\\"]},li:{match:/([^\\\\n]*)\\\\n/,phrases:b},li2:{type:\\\"\\\",match:/([^\\\\n]*)\\\\n/,phrases:b},html:{match:/^(\\\\.html\\\\ *\\\\n(?:[^\\\\n]*\\\\n)*?\\\\.html)\\\\ *\\\\n(?:\\\\s*\\\\n)?/,filter:function(a){a._html=a.text;return\\\"\\\"}},pre:{match:/^\\\\.pre\\\\ *\\\\n((?:[^\\\\n]*\\\\n)*?)\\\\.pre\\\\ *\\\\n(?:\\\\s*\\\\n)?/},\\nhr:{match:/^--+(?:\\\\s*\\\\n)?/},hx:{match:/^((\\\\^+) *([^\\\\n]*?)(\\\\s+=+)?\\\\s*?\\\\n+)/,phrases:b,filter:function(a){a.type=\\\"h\\\"+a[\\\"1\\\"].length;return a[2]}},p:{match:/^((?:(?!(?:(?:\\\\^+|\\\\#+|\\\\*+|\\\\-+) |\\\\>|\\\\.\\\\w+\\\\s*\\\\n|\\\\{[^\\\\}]+\\\\}\\\\s*\\\\n))[^\\\\n]*\\\\S[^\\\\n]*\\\\n)+(?:(?=^|\\\\n)\\\\s*\\\\n)*)/,phrases:b,filter:function(a){return a.text.replace(/\\\\n$/,\\\"\\\")}},empty:{match:/^(\\\\s*\\\\n)/,filter:function(a){a.type=\\\"\\\"}},\\\"else\\\":{match:/^(([^\\\\n]*)\\\\n)/,phrases:[],filter:function(a){a.type=\\\"p\\\"}},waflparagraph:{match:/^\\\\{(.*)\\\\}[\\\\ \\\\t]*\\\\n(?:\\\\s*\\\\n)?/,filter:function(a){a._wafl=\\na._label=a.text;return\\\"\\\"}},waflphrase:{match:/(?:^|[\\\\s\\\\-])((?:\\\"([^\\\\n]+?)\\\")?\\\\{([\\\\w-]+(?=[\\\\:\\\\ \\\\}])(?:\\\\s*:)?\\\\s*[^\\\\n]*?\\\\s*)\\\\}(?=[\\\\W_]|$))/,filter:function(a){a._wafl=a[2];a._label=a[1]||a._wafl;return\\\"\\\"},lookbehind:!0},asis:{match:/(\\\\{\\\\{([^\\\\n]*?)\\\\}\\\\}(\\\\}*))/,filter:function(a){a.type=\\\"\\\";return a[1]+a[2]}},wikilink:{match:/(?:^|[_\\\\W])(\\\\[()(?=[^\\\\s\\\\[\\\\]])(.*?)\\\\](?=[_\\\\W]|$))/,filter:function(a){a._href=\\\"?\\\"+a[2];return a.text||a[2]},lookbehind:!0},wikilink2:{type:\\\"wikilink\\\",match:/(?:\\\"([^\\\"]*)\\\"\\\\s*)(\\\\[(?=[^\\\\s\\\\[\\\\]])(.*?)\\\\](?=[_\\\\W]|$))/,\\nfilter:function(a){a._href=\\\"?\\\"+a[2];return a[1]||a[2]}},a:{match:/((?:\\\"([^\\\"]*)\\\"\\\\s*)?<?((?:http|https|ftp|irc|file):(?:\\\\/\\\\/)?[\\\\;\\\\/\\\\?\\\\:\\\\@\\\\&\\\\=\\\\+\\\\$\\\\,\\\\[\\\\]\\\\#A-Za-z0-9\\\\-\\\\_\\\\.\\\\!\\\\~\\\\*\\\\'\\\\(\\\\)]+[A-Za-z0-9\\\\/#])>?)/,filter:function(a){a._href=a[2];return a[1]||a[2]}},file:{match:/((?:\\\"([^\\\"]*)\\\")?<(\\\\\\\\\\\\\\\\[^\\\\s\\\\>\\\\)]+)>)/,filter:function(a){var b=a[2].replace(/^\\\\\\\\\\\\\\\\/,\\\"\\\");a._href=\\\"file://\\\"+b.replace(/\\\\\\\\/g,\\\"/\\\");return a[\\\"1\\\"]||b}},im:{match:new RegExp(g),filter:function(a){a._wafl=a[1]+\\\": \\\"+a[2];a._label=(f[e[a[1]]]||\\\"%1\\\").replace(/%1/g,\\na[2]);return\\\"\\\"}},mail:{match:/([\\\\w+%\\\\-\\\\.]+@(?:[\\\\w\\\\-]+\\\\.)+[\\\\w\\\\-]+)/,filter:function(a){a.type=\\\"a\\\";a._href=\\\"mailto:\\\"+a.text.replace(/%/g,\\\"%25\\\")}},tt:d(\\\"`\\\"),b:d(\\\"*\\\"),i:d(\\\"_\\\"),del:d(\\\"-\\\")}}});\\n\\nexports.SocialCalc = SocialCalc;\\n})();\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/graph.js\": {\n            \"type\": \"application/javascript\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/graph.js\",\n            \"module-type\": \"library\",\n            \"text\": \"(function (){\\n\\n  // Graph object\\n\\n  var Graph = function() {};\\n\\n  Graph.init = function(SocialCalc, sessionConfig) {\\n    if (!SocialCalc) alert('Cannot find SocialCalc');\\n\\n    // Localization\\n\\n    SocialCalc.Constants.s_loc_plain = \\\"Plain\\\";\\n    SocialCalc.Constants.s_loc_graph = \\\"Graph\\\";\\n    SocialCalc.Constants.s_loc_cells_to_graph = \\\"Cells to Graph\\\";\\n    SocialCalc.Constants.s_loc_set_cells_to_graph = \\\"Set Cells To Graph\\\";\\n    SocialCalc.Constants.s_loc_graph_type = \\\"Graph Type\\\";\\n    SocialCalc.Constants.s_loc_help = \\\"Help\\\";\\n    SocialCalc.Constants.s_loc_horizontal_bar = \\\"Horizontal Bar\\\";\\n    SocialCalc.Constants.s_loc_vertical_bar = \\\"Vertical Bar\\\";\\n    SocialCalc.Constants.s_loc_pie_chart = \\\"Pie Chart\\\";\\n    SocialCalc.Constants.s_loc_line_chart = \\\"Line Chart\\\";\\n    SocialCalc.Constants.s_loc_scatter_chart = \\\"Plot Points\\\";\\n    SocialCalc.Constants.s_loc_not_set = \\\"Not Set\\\";\\n    SocialCalc.Constants.s_loc_unknown_range_name = \\\"Unknown range name\\\";\\n    SocialCalc.Constants.s_loc_hide_help = \\\"Hide Help\\\";\\n    SocialCalc.Constants.s_loc_x = \\\"X\\\";\\n    SocialCalc.Constants.s_loc_y = \\\"Y\\\";\\n    SocialCalc.Constants.s_loc_max = \\\"Max\\\";\\n    SocialCalc.Constants.s_loc_min = \\\"Min\\\";\\n    SocialCalc.Constants.s_loc_ok = \\\" OK \\\";\\n    SocialCalc.Constants.s_loc_Xselect_rangeX = \\\"[select range]\\\";\\n    SocialCalc.Constants.s_GraphRangeNotSelected = \\\"Select a range of cells with numeric values to graph and use the OK button above to set the range as the graph range.\\\";\\n    SocialCalc.Constants.s_graph_error_selection = \\\"<b>Range selection error</b>.<br>You must select cells in a single row or column !\\\";\\n    SocialCalc.Constants.s_graph_help_intro = \\\"This is the help text for graph type: \\\";\\n    SocialCalc.Constants.s_graph_VerticalBar_help = \\\"The <b>Graph</b> tab displays a bar graph of the cells which have been selected (either in a single row across or column down). If the row above (or column to the left) of the selection has values, those values are used as labels. Otherwise the cell coordinates are used (e.g., B5).\\\";\\n    SocialCalc.Constants.s_graph_HorizontalBar_help = \\\"The <b>Graph</b> tab displays a bar graph of the cells which have been selected (either in a single row across or column down). If the row above (or column to the left) of the selection has values, those values are used as labels. Otherwise the cell coordinates are used (e.g., B5).\\\";\\n    SocialCalc.Constants.s_graph_PieChart_help = \\\"The <b>Graph</b> tab displays a pie chart of the cells which have been selected (either in a single row across or column down). If the row above (or column to the left) of the selection has values, those values are used as labels. Otherwise the cell coordinates are used (e.g., B5).\\\";\\n    SocialCalc.Constants.s_graph_PieChart_error_selection = \\\"<b>Selection error</b><br>You must select cells with positive value !\\\";\\n    SocialCalc.Constants.s_graph_LineChart_help = \\\"The <b>Graph</b> tab displays a XY profile line of the cells which have been selected (either in a single row across or column down). The row above (or column to the left) of the selection is used as X coordinates.\\\";\\n    SocialCalc.Constants.s_graph_ScatterChart_help = \\\"The <b>Graph</b> tab displays a XY scattered chart of the cells which have been selected (either in a single row across or column down). The row above (or column to the left) of the selection is used as X coordinates. If row below (or column to the right) have values, they are interpreted as plot dimensions.\\\";\\n\\n    // Configuration\\n\\n    SocialCalc.GraphTypesInfo = {\\n      // Graph types\\n      displayorder: [\\\"verticalbar\\\", \\\"horizontalbar\\\", \\\"piechart\\\", \\\"linechart\\\", \\\"scatterchart\\\"],\\n      verticalbar: {\\n        display: SocialCalc.Constants.s_loc_vertical_bar,\\n        func: Graph.GraphVerticalBar\\n      },\\n      horizontalbar: {\\n        display: SocialCalc.Constants.s_loc_horizontal_bar,\\n        func: Graph.GraphHorizontalBar\\n      },\\n      piechart: {\\n        display: SocialCalc.Constants.s_loc_pie_chart,\\n        func: Graph.MakePieChart\\n      },\\n      linechart: {\\n        display: SocialCalc.Constants.s_loc_line_chart,\\n        func: Graph.MakeLineChart\\n      },\\n      scatterchart: {\\n        display: SocialCalc.Constants.s_loc_scatter_chart,\\n        func: Graph.MakeScatterChart\\n      },\\n\\n      // Graph visuals\\n      visual: {\\n        marginX: 0.07,    // X margin ratio v/s graph width\\n        marginY: 0.07,    // Y margin ratio v/s graph height\\n        axisWidth: 0.01,  // axis printed width\\n        fontSize: 0.03,   // font size ratio v/s graph height\\n        fontSizeMin: 10,  // minimum font size in pixel\\n        valueMargin: 0.7, // margin between value and X axis, in font size unit\\n        labelMargin: 0.7  // margin between label and X axis, in font size unit\\n      }\\n    };\\n  };\\n\\n      \\n  var colorIndex = 0;\\n  var getBarColor = function(){\\n    var colors = ['00f', 'ff0', '0ff', 'f0f', 'f00', '0f0', '888', '880', '088', '808', '008', '800', '080'];\\n    var iMax = colors.length - 1;\\n    if (colorIndex <= iMax)\\n      return colors[colorIndex++]\\n    else {\\n      return colors[Math.round(Math.random() * iMax)];\\n    }\\n  };\\n  var getDrawColor = function(){\\n    return \\\"#\\\" + getBarColor();\\n  };\\n\\n  // Add Graph tab\\n  Graph.addGraphTab = function(spreadsheet) {\\n    if (spreadsheet.tabs) {\\n      spreadsheet.tabnums.graph = spreadsheet.tabs.length;\\n      spreadsheet.tabs.push({\\n        name: 'graph',\\n        text: SocialCalc.Constants.s_loc_graph,\\n        html:\\n        '<div id=\\\"%id.graphtools\\\" class=\\\"SocialCalc-toolbar\\\" style=\\\"display:none;\\\">' +\\n          '    <table cellspacing=\\\"0\\\" cellpadding=\\\"0\\\">' +\\n          '      <tr>' +\\n          '        <td style=\\\"vertical-align:top;padding-right:24px;\\\">' +\\n          '          <div style=\\\"%tbt.\\\">%loc!Cells to Graph!</div>' +\\n          '          <div id=\\\"%id.graphrange\\\" style=\\\"%tbt.\\\">Not Set</div>' +\\n          '        </td>' +\\n          '        <td style=\\\"vertical-align:top;padding-right:24px;\\\">' +\\n          '          <div style=\\\"%tbt.\\\">%loc!Set Cells To Graph!</div>' +\\n          '          <select id=\\\"%id.graphlist\\\" size=\\\"1\\\" onfocus=\\\"%s.CmdGotFocus(this);\\\">' +\\n          '            <option selected>[select range]</option>' +\\n          '          </select>' +\\n          '        </td>' +\\n          '        <td style=\\\"vertical-align:top;padding-right:4px;\\\">' +\\n          '          <div style=\\\"%tbt.\\\">%loc!Graph Type!</div>' +\\n          '          <select id=\\\"%id.graphtype\\\" size=\\\"1\\\" onchange=\\\"Graph.GraphChanged(this);\\\" onfocus=\\\"%s.CmdGotFocus(this);\\\">' +\\n          '          </select>' +\\n          '          <input type=\\\"button\\\" value=\\\"OK\\\" onclick=\\\"Graph.GraphSetCells();\\\" style=\\\"font-size:x-small;\\\">' +\\n          '        </td>' +\\n          '        <td style=\\\"vertical-align:top;padding-right:16px;\\\">' +\\n          '          <div style=\\\"%tbt.\\\">&nbsp;</div>' +\\n          '          <input id=\\\"%id.graphhelp\\\" type=\\\"button\\\" onclick=\\\"Graph.DoGraph(true);\\\" value=\\\"Help\\\" style=\\\"font-size:x-small;\\\"/>' +\\n          '        </td>' +\\n          '        <td style=\\\"vertical-align:top\\\">' +\\n          '          <div id=\\\"%id.graphLimits\\\">' +\\n          '            <span style=\\\"%tbt.\\\">%loc!Min! %loc!X!</span>' +\\n          '            <input type=\\\"text\\\" id=\\\"%id.graphMinX\\\" onchange=\\\"Graph.MinMaxChanged(this,0);\\\" onfocus=\\\"%s.CmdGotFocus(this);\\\" size=\\\"5\\\"/>' +\\n          '            <span style=\\\"%tbt.\\\">%loc!Max! %loc!X!</span>' +\\n          '            <input type=\\\"text\\\" id=\\\"%id.graphMaxX\\\" onchange=\\\"Graph.MinMaxChanged(this,1);\\\" onfocus=\\\"%s.CmdGotFocus(this);\\\" size=\\\"5\\\"/><br>' +\\n          '            <span style=\\\"%tbt.\\\">%loc!Min! %loc!Y!</span>' +\\n          '            <input type=\\\"text\\\" id=\\\"%id.graphMinY\\\" onchange=\\\"Graph.MinMaxChanged(this,2);\\\" onfocus=\\\"%s.CmdGotFocus(this);\\\" size=\\\"5\\\"/>' +\\n          '            <span style=\\\"%tbt.\\\">%loc!Max! %loc!Y!</span>' +\\n          '            <input type=\\\"text\\\" id=\\\"%id.graphMaxY\\\" onchange=\\\"Graph.MinMaxChanged(this,3);\\\" onfocus=\\\"%s.CmdGotFocus(this);\\\" size=\\\"5\\\"/>' +\\n          '          </div>' +\\n          '        </td>' +\\n          '      </tr>' +\\n          '    </table>' +\\n          '</div>',\\n        view: 'graph',\\n        onclick: Graph.GraphOnClick,\\n        onclickFocus: true\\n      });\\n    }\\n    if (spreadsheet.views) {\\n      spreadsheet.views.graph = {\\n        name: 'graph',\\n        divStyle: \\\"overflow:auto;\\\",\\n        values: {},\\n        html: '<div style=\\\"padding:6px;\\\">Graph View</div>'\\n      };\\n    }\\n    if (spreadsheet.editor) {\\n      spreadsheet.editor.SettingsCallbacks.graph = {\\n        save: Graph.GraphSave,\\n        load: Graph.GraphLoad\\n      };\\n    }\\n  };\\n\\n  Graph.GraphOnClick = function(s, t){\\n    colorIndex = 0;\\n    var SCLoc = SocialCalc.LocalizeString;\\n    var namelist = [];\\n    var nl = document.getElementById(s.idPrefix + 'graphlist');\\n    s.editor.RangeChangeCallback.graph = Graph.UpdateGraphRangeProposal;\\n    for (var name in s.sheet.names) {\\n      namelist.push(name);\\n    }\\n    namelist.sort();\\n    nl.length = 0;\\n    nl.options[0] = new Option(SCLoc(\\\"[select range]\\\"));\\n    for (var i = 0; i < namelist.length; i++) {\\n      var name = namelist[i];\\n      nl.options[i + 1] = new Option(name, name);\\n      if (name === s.graphrange) {\\n        nl.options[i + 1].selected = true;\\n      }\\n    }\\n    if (s.graphrange === '') {\\n      nl.options[0].selected = true;\\n    }\\n    Graph.UpdateGraphRangeProposal(s.editor);\\n    nl = document.getElementById(s.idPrefix + 'graphtype');\\n    nl.length = 0;\\n    for (var i = 0; i < SocialCalc.GraphTypesInfo.displayorder.length; i++) {\\n      var name = SocialCalc.GraphTypesInfo.displayorder[i];\\n      nl.options[i] = new Option(SCLoc(SocialCalc.GraphTypesInfo[name].display), name);\\n      if (name === s.graphtype) {\\n        nl.options[i].selected = true;\\n      }\\n    }\\n    if (!s.graphtype) {\\n      nl.options[0].selected = true;\\n      s.graphtype = nl.options[0].value;\\n    }\\n    var graphLimits = document.getElementById(s.idPrefix + \\\"graphLimits\\\");\\n    graphLimits.style.display = \\\"none\\\";\\n\\n    Graph.DoGraph(false, false);\\n  };\\n\\n  Graph.UpdateGraphRangeProposal = function(editor){\\n    var ele;\\n    ele = document.getElementById(SocialCalc.GetSpreadsheetControlObject().idPrefix + \\\"graphlist\\\");\\n    if (editor.range.hasrange) {\\n      return ele.options[0].text = SocialCalc.crToCoord(editor.range.left, editor.range.top) + \\\":\\\" + SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\\n    } else {\\n      return ele.options[0].text = SocialCalc.LocalizeString(\\\"[select range]\\\");\\n    }\\n  };\\n\\n  Graph.GraphSetCells = function(){\\n    var spreadsheet, editor, lele, ele;\\n    spreadsheet = SocialCalc.GetSpreadsheetControlObject();\\n    editor = spreadsheet.editor;\\n    lele = document.getElementById(spreadsheet.idPrefix + \\\"graphlist\\\");\\n    if (lele.selectedIndex === 0) {\\n      if (editor.range.hasrange) {\\n        spreadsheet.graphrange = SocialCalc.crToCoord(editor.range.left, editor.range.top) + \\\":\\\" + SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\\n      } else {\\n        spreadsheet.graphrange = editor.ecell.coord + \\\":\\\" + editor.ecell.coord;\\n      }\\n    } else {\\n      spreadsheet.graphrange = lele.options[lele.selectedIndex].value;\\n    }\\n    ele = document.getElementById(spreadsheet.idPrefix + \\\"graphrange\\\");\\n    ele.innerHTML = spreadsheet.graphrange;\\n    Graph.DoGraph(false, false);\\n  };\\n\\n  Graph.DoGraph = function(helpflag, isResize){\\n    colorIndex = 0;\\n    var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\\n    var editor = spreadsheet.editor;\\n    var gview = spreadsheet.views.graph.element;\\n    var ginfo = SocialCalc.GraphTypesInfo[spreadsheet.graphtype];\\n    var gfunc = ginfo.func;\\n    if (!spreadsheet.graphrange) {\\n      if (gfunc && helpflag) {\\n        gfunc(spreadsheet, null, gview, spreadsheet.graphtype, helpflag, isResize);\\n      } else {\\n        gview.innerHTML = \\\"<div style=\\\\\\\"padding:30px;font-weight:bold;\\\\\\\">\\\" + SocialCalc.Constants.s_GraphRangeNotSelected + \\\"</div>\\\";\\n      }\\n      return;\\n    }\\n    var grange = spreadsheet.graphrange;\\n    if (grange && grange.indexOf(\\\":\\\") === -1) {\\n      var nrange = SocialCalc.Formula.LookupName(spreadsheet.sheet, grange || \\\"\\\");\\n      if (nrange.type !== \\\"range\\\") {\\n        gview.innerHTML = SocialCalc.LocalizeString(\\\"Unknown range name\\\") + \\\": \\\" + grange;\\n        return;\\n      }\\n      var rparts = nrange.value.match(/^(.*)\\\\|(.*)\\\\|$/);\\n      grange = rparts[1] + \\\":\\\" + rparts[2];\\n    }\\n    var prange = SocialCalc.ParseRange(grange);\\n    var range = {};\\n    if (prange.cr1.col <= prange.cr2.col) {\\n      range.left = prange.cr1.col;\\n      range.right = prange.cr2.col;\\n    } else {\\n      range.left = prange.cr2.col;\\n      range.right = prange.cr1.col;\\n    }\\n    if (prange.cr1.row <= prange.cr2.row) {\\n      range.top = prange.cr1.row;\\n      range.bottom = prange.cr2.row;\\n    } else {\\n      range.top = prange.cr2.row;\\n      range.bottom = prange.cr1.row;\\n    }\\n    if (gfunc) {\\n      gfunc(spreadsheet, range, gview, spreadsheet.graphtype, helpflag, isResize);\\n    }\\n  };\\n\\n  Graph.GraphChanged = function(gtobj){\\n    SocialCalc.CurrentSpreadsheetControlObject.graphtype = gtobj.options[gtobj.selectedIndex].value;\\n    return Graph.DoGraph(false, false);\\n  };\\n\\n  Graph.MinMaxChanged = function(minmaxobj, index){\\n    var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\\n    switch (index) {\\n    case 0:\\n      spreadsheet.graphMinX = minmaxobj.value;\\n      break;\\n    case 1:\\n      spreadsheet.graphMaxX = minmaxobj.value;\\n      break;\\n    case 2:\\n      spreadsheet.graphMinY = minmaxobj.value;\\n      break;\\n    case 3:\\n      spreadsheet.graphMaxY = minmaxobj.value;\\n    }\\n    return Graph.DoGraph(false, true);\\n  };\\n\\n  Graph.GraphSave = function(editor, setting){\\n    var spreadsheet, gtype, str;\\n    spreadsheet = SocialCalc.GetSpreadsheetControlObject();\\n    gtype = spreadsheet.graphtype || \\\"\\\";\\n    str = \\\"graph:range:\\\" + SocialCalc.encodeForSave(spreadsheet.graphrange) + \\\":type:\\\" + SocialCalc.encodeForSave(gtype);\\n    str += \\\":minmax:\\\" + SocialCalc.encodeForSave(spreadsheet.graphMinX + \\\",\\\" + spreadsheet.graphMaxX + \\\",\\\" + spreadsheet.graphMinY + \\\",\\\" + spreadsheet.graphMaxY) + \\\"\\\\n\\\";\\n    return str;\\n  };\\n\\n  Graph.GraphLoad = function(editor, setting, line, flags){\\n    var spreadsheet, parts, i, splitMinMax;\\n    spreadsheet = SocialCalc.GetSpreadsheetControlObject();\\n    parts = line.split(\\\":\\\");\\n    i = 1;\\n    while (i < parts.length) {\\n      switch (parts[i]) {\\n      case 'type':\\n        spreadsheet.graphtype = SocialCalc.decodeFromSave(parts[i + 1]);\\n        break;\\n      case 'range':\\n        spreadsheet.graphrange = SocialCalc.decodeFromSave(parts[i + 1]);\\n        break;\\n      case 'minmax':\\n        splitMinMax = SocialCalc.decodeFromSave(parts[i + 1]).split(',');\\n        spreadsheet.graphMinX = splitMinMax[0];\\n        document.getElementById(spreadsheet.idPrefix+\\\"graphMinX\\\").value = spreadsheet.graphMinX;\\n        spreadsheet.graphMaxX = splitMinMax[1];\\n        document.getElementById(spreadsheet.idPrefix+\\\"graphMaxX\\\").value = spreadsheet.graphMaxX;\\n        spreadsheet.graphMinY = splitMinMax[2];\\n        document.getElementById(spreadsheet.idPrefix+\\\"graphMinY\\\").value = spreadsheet.graphMinY;\\n        spreadsheet.graphMaxY = splitMinMax[3];\\n        document.getElementById(spreadsheet.idPrefix+\\\"graphMaxY\\\").value = spreadsheet.graphMaxY;\\n      }\\n      i += 2;\\n    }\\n    return true;\\n  };\\n\\n  // Extract display data from a range of cell\\n  var cellRangeToDisplay = function(range) {\\n    var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\\n    var values = [];\\n    var labels = [];\\n    var nitems, byrow;\\n    if (!(range.right === range.left || range.top === range.bottom))\\n      return null;\\n    if (range.left === range.right) {\\n      nitems = range.bottom - range.top + 1;\\n      byrow = true;\\n    } else {\\n      nitems = range.right - range.left + 1;\\n      byrow = false;\\n    }\\n    var val = null; minval = null, maxval = null;\\n    for (var i = 0; i < nitems; i++) {\\n      var cr = byrow\\n        ? SocialCalc.rcColname(range.left) + (i + range.top)\\n        : SocialCalc.rcColname(i + range.left) + range.top;\\n      var cr1 = byrow\\n        ? SocialCalc.rcColname(range.left - 1 || 1) + (i + range.top)\\n        : SocialCalc.rcColname(i + range.left) + (range.top - 1 || 1);\\n      var cell = spreadsheet.sheet.GetAssuredCell(cr);\\n      if (cell.valuetype.charAt(0) === \\\"n\\\") {\\n        val = cell.datavalue - 0;\\n        if (maxval == null || maxval < val) maxval = val;\\n        if (minval == null || minval > val) minval = val;\\n        values.push(val);\\n        cell = spreadsheet.sheet.GetAssuredCell(cr1);\\n        if (cell.valuetype.charAt(0) === \\\"t\\\" || cell.valuetype.charAt(0) === \\\"n\\\")\\n          labels.push(\\\"\\\" + cell.datavalue);\\n        else\\n          labels.push(cr);\\n      }\\n    }\\n    if (maxval < 0) maxval = 0;\\n    if (minval > 0) minval = 0;\\n\\n    return {values: values, labels: labels, minval: minval, maxval: maxval};\\n  };\\n\\n  Graph.GraphVerticalBar = function(spreadsheet, range, gview, gtype, helpflag) {\\n    fonc = \\\"Graph.GraphVerticalBar\\\";\\n    var scc = SocialCalc.Constants;\\n    var str;\\n    if (helpflag || !range) {\\n      str = \\\"<input type=\\\\\\\"button\\\\\\\" value=\\\" + scc.s_loc_hide_help + \\\" onclick=\\\\\\\"Graph.DoGraph(false,false);\\\\\\\"><br><br>\\\" + scc.s_graph_help_intro + SocialCalc.GraphTypesInfo[gtype].display + \\\".<br><br>\\\" + scc.s_graph_VerticalBar_help + \\\"<br><br><input type=\\\\\\\"button\\\\\\\" value=\\\" + scc.s_loc_hide_help + \\\" onclick=\\\\\\\"Graph.DoGraph(false,false);\\\\\\\">\\\";\\n      str = SocialCalc.LocalizeSubstrings(str);\\n      gview.innerHTML = str;\\n      return;\\n    }\\n    var data = cellRangeToDisplay(range);\\n    if (!data) {\\n      gview.innerHTML = scc.s_graph_error_selection;\\n      return;\\n    }\\n    var graphLimits = document.getElementById(spreadsheet.idPrefix + \\\"graphLimits\\\");\\n    graphLimits.style.display = \\\"none\\\";\\n\\n    // Create display\\n    str = \\\"<table cellspacing=\\\\\\\"0\\\\\\\" cellpadding=\\\\\\\"0\\\\\\\" style=\\\\\\\"width:100%;\\\\\\\"><tr><td><canvas id=\\\\\\\"\\\"+spreadsheet.idPrefix+\\\"myBarCanvas\\\\\\\" style=\\\\\\\"border:1px solid black;\\\\\\\"></canvas></td></tr></table>\\\";\\n    gview.innerHTML = str;\\n    var canv = document.getElementById(spreadsheet.idPrefix+'myBarCanvas');\\n\\n    // The canvas must be explicitly resized to fill space\\n    canv.width = 0 + gview.style.width.replace(\\\"px\\\", \\\"\\\") - 4;\\n    canv.height = 0 + gview.style.height.replace(\\\"px\\\", \\\"\\\") - 4;\\n\\n    var configVisual = SocialCalc.GraphTypesInfo.visual;\\n    var marginX = Math.floor(canv.width * configVisual.marginX);\\n    var marginY = Math.floor(canv.height * configVisual.marginY);\\n    totalWidth = canv.width - 2 * marginX;\\n    totalHeight = canv.height - 2 * marginY;\\n\\n    // Draw X axis\\n    var ctx = canv.getContext('2d');\\n    var barColor = getBarColor();\\n    ctx.fillStyle = '#' + barColor;\\n    var originY = totalHeight * (data.maxval / (data.maxval - data.minval)) + marginY;\\n    ctx.lineWidth = totalHeight * configVisual.axisWidth;\\n    ctx.moveTo(0, originY);\\n    ctx.lineTo(canv.width, originY);\\n    ctx.stroke();\\n\\n    // Draw bars\\n    var barWidth = Math.floor(totalWidth / (data.values.length || 1));\\n    var yScale = totalHeight / (data.maxval - data.minval);\\n    for (var i = 0; i < data.values.length; i++) {\\n      ctx.fillRect(marginX + i * barWidth, originY - yScale * data.values[i], barWidth, yScale * data.values[i]);\\n      barColor = getBarColor();\\n      ctx.fillStyle = '#' + barColor;\\n    }\\n\\n    // Draw labels\\n    ctx.strokeStyle = '#000000';\\n    ctx.fillStyle = '#000000';\\n    var fontSize = Math.floor(canv.height * configVisual.fontSize);\\n    if (fontSize < configVisual.fontSizeMin) fontSize = configVisual.fontSizeMin;\\n    ctx.font = \\\"\\\" + fontSize + \\\"px bold Arial\\\";\\n    var offsetTextX = (barWidth <= 3 * fontSize) ? 0 : fontSize;\\n    for (var i = 0; i < data.values.length; i++) {\\n      var yValue, yLabel;\\n      if (data.values[i] > 0) {\\n        yValue = originY - fontSize * configVisual.valueMargin;\\n        yLabel = originY + fontSize * (configVisual.labelMargin + 1);\\n      } else {\\n        yValue = originY + fontSize * (configVisual.valueMargin + 1);\\n        yLabel = originY - fontSize * configVisual.labelMargin;\\n      }\\n      var x = marginX + offsetTextX + i * barWidth;\\n      ctx.fillText(data.values[i], x, yValue);\\n      ctx.fillText(data.labels[i], x, yLabel);\\n    }\\n  };\\n\\n  Graph.GraphHorizontalBar = function(spreadsheet, range, gview, gtype, helpflag){\\n    fonc = \\\"Graph.GraphHorizontalBar\\\";\\n    var scc = SocialCalc.Constants;\\n    var str;\\n    if (helpflag || !range) {\\n      str = \\\"<input type=\\\\\\\"button\\\\\\\" value=\\\" + scc.s_loc_hide_help + \\\" onclick=\\\\\\\"Graph.DoGraph(false,false);\\\\\\\"><br><br>\\\" + scc.s_graph_help_intro + SocialCalc.GraphTypesInfo[gtype].display + \\\".<br><br>\\\" + scc.s_graph_HorizontalBar_help + \\\"<br><br><input type=\\\\\\\"button\\\\\\\" value=\\\" + scc.s_loc_hide_help + \\\" onclick=\\\\\\\"Graph.DoGraph(false,false);\\\\\\\">\\\";\\n      gview.innerHTML = str;\\n      return;\\n    }\\n    var data = cellRangeToDisplay(range);\\n    if (!data) {\\n      gview.innerHTML = scc.s_graph_error_selection;\\n      return;\\n    }\\n    var graphLimits = document.getElementById(spreadsheet.idPrefix + \\\"graphLimits\\\");\\n    graphLimits.style.display = \\\"none\\\";\\n\\n    // Create display\\n    str = \\\"<table cellspacing=\\\\\\\"0\\\\\\\" cellpadding=\\\\\\\"0\\\\\\\" style=\\\\\\\"width:100%;\\\\\\\"><tr><td><canvas id=\\\\\\\"\\\"+spreadsheet.idPrefix+\\\"myBarCanvas\\\\\\\" style=\\\\\\\"border:1px solid black;\\\\\\\"></canvas></td></tr></table>\\\";\\n    gview.innerHTML = str;\\n    var canv = document.getElementById(spreadsheet.idPrefix+\\\"myBarCanvas\\\");\\n\\n    // The canvas must be explicitly resized to fill space\\n    canv.width = 0 + gview.style.width.replace(\\\"px\\\", \\\"\\\") - 4;\\n    canv.height = 0 + gview.style.height.replace(\\\"px\\\", \\\"\\\") - 4;\\n\\n    var configVisual = SocialCalc.GraphTypesInfo.visual;\\n    var marginX = Math.floor(canv.width * configVisual.marginX);\\n    var marginY = Math.floor(canv.height * configVisual.marginY);\\n    totalWidth = canv.width - 2 * marginX;\\n    totalHeight = canv.height - 2 * marginY;\\n\\n    // Draw Y axis\\n    var ctx = canv.getContext(\\\"2d\\\");\\n    barColor = getBarColor();\\n    ctx.fillStyle = \\\"#\\\" + barColor;\\n    var originX = totalWidth * (1 - (data.maxval / (data.maxval - data.minval))) + marginX;\\n    ctx.lineWidth = totalWidth * configVisual.axisWidth;\\n    ctx.moveTo(originX, 0);\\n    ctx.lineTo(originX, canv.height);\\n    ctx.stroke();\\n\\n    // Draw bars\\n    var barWidth = Math.floor(totalHeight / (data.values.length || 1));\\n    var yScale = totalWidth / (data.maxval - data.minval);\\n    for (var i = 0; i < data.values.length; i++) {\\n      ctx.fillRect(originX + yScale * data.values[i], marginY + i * barWidth, - yScale * data.values[i], barWidth);\\n      barColor = getBarColor();\\n      ctx.fillStyle = \\\"#\\\" + barColor;\\n    }\\n\\n    // Draw labels\\n    ctx.strokeStyle = \\\"#000000\\\";\\n    ctx.fillStyle = \\\"#000000\\\";\\n    var fontSize = Math.floor(canv.height * configVisual.fontSize);\\n    if (fontSize < configVisual.fontSizeMin) fontSize = configVisual.fontSizeMin;\\n    ctx.font = \\\"\\\" + fontSize + \\\"px bold Arial\\\";\\n    var offsetTextY = (barWidth <= 3 * fontSize) ? 0 : 2 * fontSize;\\n    for (var i = 0; i < data.values.length; i++) {\\n      var xValue, xLabel;\\n      if (data.values[i] > 0) {\\n        xValue = originX + fontSize * configVisual.valueMargin;\\n        xLabel = originX - fontSize * (configVisual.labelMargin + 1);\\n      } else {\\n        xValue = originX - fontSize * configVisual.valueMargin - ctx.measureText(\\\"\\\"+data.values[i]).width;\\n        xLabel = originX + fontSize * configVisual.labelMargin;\\n      }\\n      var y = marginY + offsetTextY + i * barWidth;\\n      ctx.fillText(data.values[i], xValue, y);\\n      ctx.save();\\n      ctx.translate(xLabel, y);\\n      ctx.rotate(90 * Math.PI/180);\\n      ctx.fillText(data.labels[i], 0, 0);\\n      ctx.restore();\\n    }\\n  };\\n\\n  Graph.MakePieChart = function(spreadsheet, range, gview, gtype, helpflag){\\n    fonc = \\\"Graph.MakePieChart\\\";\\n    var scc = SocialCalc.Constants;\\n    var str;\\n    if (helpflag || !range) {\\n      str = \\\"<input type=\\\\\\\"button\\\\\\\" value=\\\" + scc.s_loc_hide_help + \\\" onclick=\\\\\\\"Graph.DoGraph(false,false);\\\\\\\"><br><br>\\\" + scc.s_graph_help_intro + SocialCalc.GraphTypesInfo[gtype].display + \\\".<br><br>\\\" + scc.s_graph_PieChart_help + \\\"<br><br><input type=\\\\\\\"button\\\\\\\" value=\\\" + scc.s_loc_hide_help + \\\" onclick=\\\\\\\"Graph.DoGraph(false,false);\\\\\\\">\\\";\\n      str = SocialCalc.LocalizeSubstrings(str);\\n      gview.innerHTML = str;\\n      return;\\n    }\\n    var data = cellRangeToDisplay(range);\\n    if (!data) {\\n      gview.innerHTML = scc.s_graph_error_selection;\\n      return;\\n    }\\n    for (var i = 0; i < data.values.length; i++) {\\n      if (data.values[i] < 0) {\\n        gview.innerHTML = scc.s_graph_PieChart_error_selection;\\n        return;\\n      }\\n    }\\n    var graphLimits = document.getElementById(spreadsheet.idPrefix + \\\"graphLimits\\\");\\n    graphLimits.style.display = \\\"none\\\";\\n\\n    // Create display\\n    str = \\\"<table cellspacing=\\\\\\\"0\\\\\\\" cellpadding=\\\\\\\"0\\\\\\\" style=\\\\\\\"width:100%;\\\\\\\"><tr><td><canvas id=\\\\\\\"\\\"+spreadsheet.idPrefix+\\\"myCanvas\\\\\\\" style=\\\\\\\"border:1px solid black;\\\\\\\"></canvas></td></tr></table>\\\";\\n    gview.innerHTML = str;\\n    var canv = document.getElementById(spreadsheet.idPrefix+\\\"myCanvas\\\");\\n\\n    // The canvas must be explicitly resized to fill space\\n    canv.width = 0 + gview.style.width.replace(\\\"px\\\", \\\"\\\") - 4;\\n    canv.height = 0 + gview.style.height.replace(\\\"px\\\", \\\"\\\") - 4;\\n\\n    var ctx = canv.getContext(\\\"2d\\\");\\n    var configVisual = SocialCalc.GraphTypesInfo.visual;\\n    var fontSize = Math.floor(canv.height * configVisual.fontSize);\\n    if (fontSize < configVisual.fontSizeMin) fontSize = configVisual.fontSizeMin;\\n    ctx.font = \\\"\\\" + fontSize + \\\"px bold Arial\\\";\\n    var total = 0;\\n    for (var i = 0; i < data.values.length; i++) {\\n      total += data.values[i];\\n    }\\n    centerX = canv.width / 2;\\n    centerY = canv.height / 2;\\n    var rad = centerY - 50;\\n    var textRad = rad * 1.1;\\n    var lastStart = 0;\\n    for (var i = 0; i < data.values.length; i++) {\\n      if (Number(data.values[i]) === 0) continue;\\n      ctx.beginPath();\\n      ctx.moveTo(centerX, centerY);\\n      var arcColor = getDrawColor();\\n      ctx.fillStyle = arcColor;\\n      var arcRads = 2 * Math.PI * (data.values[i] / total);\\n      ctx.arc(centerX, centerY, rad, lastStart, lastStart + arcRads, false);\\n      ctx.closePath();\\n      ctx.fill();\\n      ctx.fillStyle = \\\"black\\\";\\n      var centralRad = lastStart + 0.5 * arcRads;\\n      var leftBias = 0;\\n      if (centralRad > 1.5 && centralRad < 4.6) {\\n        leftBias = 55;\\n      }\\n      ctx.translate(centerX + Math.cos(centralRad) * textRad - leftBias, centerY + Math.sin(centralRad) * textRad);\\n      ctx.fillText(data.labels[i] + \\\" (\\\" + Math.round(data.values[i] / total * 100) + \\\"%)\\\", 0, 0);\\n      ctx.translate(-1 * centerX - Math.cos(centralRad) * textRad + leftBias, -1 * centerY - Math.sin(centralRad) * textRad);\\n      ctx.fillRect(1, 1, 1, 1);\\n      ctx.closePath();\\n      lastStart += arcRads;\\n    }\\n  };\\n\\n  // Extract XY display data from a range of cell\\n  var cellRangeToDisplay2 = function(range, isResize) {\\n    var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\\n    var values = [];\\n    var labels = [];\\n    var nitems, byrow;\\n    if (range.left === range.right) {\\n      nitems = range.bottom - range.top + 1;\\n      byrow = true;\\n    } else {\\n      nitems = range.right - range.left + 1;\\n      byrow = false;\\n    }\\n    var val = null, minX = null, maxX = null, minval = null, maxval = null;\\n    if (isResize) {\\n      try {\\n        minX = 1 * document.getElementById(spreadsheet.idPrefix+\\\"graphMinX\\\").value;\\n      } catch (e$) {\\n        e = e$;\\n        minX = null;\\n      }\\n      try {\\n        maxX = 1 * document.getElementById(spreadsheet.idPrefix+\\\"graphMaxX\\\").value;\\n      } catch (e$) {\\n        e = e$;\\n        maxX = null;\\n      }\\n      try {\\n        minval = 1 * document.getElementById(spreadsheet.idPrefix+\\\"graphMinY\\\").value;\\n      } catch (e$) {\\n        e = e$;\\n        minval = null;\\n      }\\n      try {\\n        maxval = 1 * document.getElementById(spreadsheet.idPrefix+\\\"graphMaxY\\\").value;\\n      } catch (e$) {\\n        e = e$;\\n        maxval = null;\\n      }\\n    }\\n    dotSizes = new Array();\\n    var evenlySpaced = false;\\n    for (var i = 0; i < nitems; i++) {\\n      cr = byrow\\n        ? SocialCalc.rcColname(range.left) + (i + range.top)\\n        : SocialCalc.rcColname(i + range.left) + range.top;\\n      cr1 = byrow\\n        ? SocialCalc.rcColname(range.left - 1 || 1) + (i + range.top)\\n        : SocialCalc.rcColname(i + range.left) + (range.top - 1 || 1);\\n      cr2 = byrow\\n        ? SocialCalc.rcColname(range.left + 1 || 2) + (i + range.top)\\n        : SocialCalc.rcColname(i + range.left) + (range.top + 1 || 2);\\n      cell = spreadsheet.sheet.GetAssuredCell(cr);\\n      if (cell.valuetype.charAt(0) === \\\"n\\\") {\\n        val = cell.datavalue - 0;\\n        if ((maxval == null || maxval < val) && !isResize) maxval = val;\\n        if ((minval == null || minval > val) && !isResize) minval = val;\\n        values.push(val);\\n        cell = spreadsheet.sheet.GetAssuredCell(cr1);\\n        if ((range.right === range.left || range.top === range.bottom) && (cell.valuetype.charAt(0) === \\\"t\\\" || cell.valuetype.charAt(0) === \\\"n\\\")) {\\n          labels.push(cell.datavalue + \\\"\\\");\\n          if ((maxX == null || maxX < cell.datavalue) && !isResize) maxX = cell.datavalue;\\n          if ((minX == null || minX > cell.datavalue) && !isResize) minX = cell.datavalue;\\n        } else {\\n          labels.push(cr);\\n          evenlySpaced = true;\\n        }\\n        cell = spreadsheet.sheet.GetAssuredCell(cr2);\\n        if ((range.right === range.left || range.top === range.bottom) && (cell.valuetype.charAt(0) === \\\"t\\\" || cell.valuetype.charAt(0) === \\\"n\\\"))\\n          dotSizes.push(cell.datavalue + \\\"\\\");\\n        else\\n          dotSizes.push(\\\"5\\\");\\n      }\\n    }\\n    if (evenlySpaced) {\\n      for (var i = 0; i < values.length; i++) {\\n        labels[i] = i;\\n      }\\n      if (!isResize) {\\n        minX = 0;\\n        maxX = values.length - 1;\\n      }\\n    }\\n\\n    return {values: values, labels: labels, dotSizes: dotSizes, minval: minval, maxval: maxval, minX: minX, maxX: maxX};\\n  };\\n\\n  Graph.MakeLineChart = function(spreadsheet, range, gview, gtype, helpflag, isResize){\\n    fonc = \\\"Graph.MakeLineChart\\\";\\n    var scc = SocialCalc.Constants;\\n    var str;\\n    if (helpflag || !range) {\\n      str = \\\"<input type=\\\\\\\"button\\\\\\\" value=\\\" + scc.s_loc_hide_help + \\\" onclick=\\\\\\\"Graph.DoGraph(false,false);\\\\\\\"><br><br>\\\" + scc.s_graph_help_intro + SocialCalc.GraphTypesInfo[gtype].display + \\\".<br><br>\\\" + scc.s_graph_LineChart_help + \\\"<br><br><input type=\\\\\\\"button\\\\\\\" value=\\\" + scc.s_loc_hide_help + \\\" onclick=\\\\\\\"Graph.DoGraph(false,false);\\\\\\\">\\\";\\n      str = SocialCalc.LocalizeSubstrings(str);\\n      gview.innerHTML = str;\\n      return;\\n    }\\n    var data = cellRangeToDisplay2(range, isResize);\\n    if (!data) {\\n      gview.innerHTML = scc.s_graph_error_selection;\\n      return;\\n    }\\n    var graphLimits = document.getElementById(spreadsheet.idPrefix + \\\"graphLimits\\\");\\n    graphLimits.style.display = \\\"block\\\";\\n\\n    // Create display\\n    str = \\\"<table cellspacing=\\\\\\\"0\\\\\\\" cellpadding=\\\\\\\"0\\\\\\\" style=\\\\\\\"width:100%;\\\\\\\"><tr><td><canvas id=\\\\\\\"\\\"+spreadsheet.idPrefix+\\\"myLineCanvas\\\\\\\" style=\\\\\\\"border:1px solid black;\\\\\\\"></canvas></td></tr></table>\\\";\\n    gview.innerHTML = str;\\n    if (!isResize) {\\n      document.getElementById(spreadsheet.idPrefix+\\\"graphMinX\\\").value = data.minX;\\n      spreadsheet.graphMinX = minX;\\n      document.getElementById(spreadsheet.idPrefix+\\\"graphMaxX\\\").value = data.maxX;\\n      spreadsheet.graphMaxX = maxX;\\n      document.getElementById(spreadsheet.idPrefix+\\\"graphMinY\\\").value = data.minval;\\n      spreadsheet.graphMinY = minval;\\n      document.getElementById(spreadsheet.idPrefix+\\\"graphMaxY\\\").value = data.maxval;\\n      spreadsheet.graphMaxY = maxval;\\n    }\\n    var canv = document.getElementById(spreadsheet.idPrefix+\\\"myLineCanvas\\\");\\n\\n    // The canvas must be explicitly resized to fill space\\n    canv.width = 0 + gview.style.width.replace(\\\"px\\\", \\\"\\\") - 4;\\n    canv.height = 0 + gview.style.height.replace(\\\"px\\\", \\\"\\\") - 4;\\n\\n    var ctx = canv.getContext(\\\"2d\\\");\\n    var minX = data.minX, maxX = data.maxX, minval = data.minval, maxval = data.maxval;\\n    var scaleFactorX = (canv.width - 40) / (maxX - minX);\\n    var scaleFactorY = (canv.height - 40) / (maxval - minval);\\n    var topY = canv.height;\\n    var colorArray = [];\\n    for (var i = 0; i < data.values.length; i++) {\\n      var lastX, lastY, drawColor;\\n      if ((i > 0) && (data.labels[i] * 1 > data.labels[i - 1] * 1)) {\\n        ctx.moveTo(lastX, topY - lastY);\\n        ctx.lineTo(scaleFactorX * (data.labels[i] - minX) + 20, topY - (scaleFactorY * (data.values[i] - minval) + 20));\\n        ctx.stroke();\\n      } else {\\n        ctx.beginPath();\\n        drawColor = getDrawColor();\\n        colorArray.push(drawColor.replace(\\\"#\\\", \\\"\\\"));\\n        ctx.strokeStyle = drawColor;\\n        ctx.fillStyle = drawColor;\\n      }\\n      lastX = scaleFactorX * (data.labels[i] - minX) + 20;\\n      lastY = scaleFactorY * (data.values[i] - minval) + 20;\\n      if ((colorArray.length - 1) % 3 === 0) {\\n        ctx.fillRect(lastX - 3, topY - lastY - 3, 6, 6);\\n      } else if ((colorArray.length - 1) % 3 === 1) {\\n        ctx.beginPath();\\n        ctx.arc(lastX, topY - lastY, 3, 0, Math.PI * 2, false);\\n        ctx.fill();\\n      } else {\\n        ctx.fillRect(lastX, topY - lastY - 3, 2, 8);\\n        ctx.fillRect(lastX - 3, topY - lastY, 8, 2);\\n      }\\n    }\\n    ctx.stroke();\\n    for (var i = 0; i < colorArray.length; i++) {\\n      if (i % 3 === 0)\\n        colorArray[i] = \\\"s,\\\" + colorArray[i] + \\\",\\\" + i + \\\",-1,6\\\";\\n      else if (i % 3 === 1)\\n        colorArray[i] = \\\"o,\\\" + colorArray[i] + \\\",\\\" + i + \\\",-1,6\\\";\\n      else\\n        colorArray[i] = \\\"c,\\\" + colorArray[i] + \\\",\\\" + i + \\\",-1,10\\\";\\n    }\\n    if (minval <= 0 && maxval >= 0) {\\n      ctx.beginPath();\\n      ctx.strokeStyle = \\\"#000000\\\";\\n      ctx.moveTo(0, canv.height - (scaleFactorY * -1 * minval + 20));\\n      ctx.lineTo(canv.width, canv.height - (scaleFactorY * -1 * minval + 20));\\n      ctx.stroke();\\n      graphPlace = 1 - (canv.height - (scaleFactorY * -1 * minval + 20)) / canv.height;\\n    }\\n    if (minX <= 0 && maxX >= 0) {\\n      ctx.beginPath();\\n      ctx.strokeStyle = \\\"#000000\\\";\\n      ctx.moveTo(scaleFactorX * -1 * minX + 20, 0);\\n      ctx.lineTo(scaleFactorX * -1 * minX + 20, canv.height);\\n      ctx.stroke();\\n      graphPlace = (scaleFactorX * -1 * minX + 20) / canv.width;\\n    }\\n    minX -= (maxX - minX) / 23;\\n    maxX += (maxX - minX) / 23;\\n    minval -= (maxval - minval) / 18;\\n    maxval += (maxval - minval) / 18;\\n  };\\n\\n  Graph.MakeScatterChart = function(spreadsheet, range, gview, gtype, helpflag, isResize){\\n    fonc = \\\"Graph.MakeScatterChart\\\";\\n    var scc = SocialCalc.Constants;\\n    var str;\\n    if (helpflag || !range) {\\n      str = \\\"<input type=\\\\\\\"button\\\\\\\" value=\\\" + scc.s_loc_hide_help + \\\" onclick=\\\\\\\"Graph.DoGraph(false,false);\\\\\\\"><br><br>\\\" + scc.s_graph_help_intro + SocialCalc.GraphTypesInfo[gtype].display + \\\".<br><br>\\\" + scc.s_graph_ScatterChart_help + \\\"<br><br><input type=\\\\\\\"button\\\\\\\" value=\\\" + scc.s_loc_hide_help + \\\" onclick=\\\\\\\"Graph.DoGraph(false,false);\\\\\\\">\\\";\\n      str = SocialCalc.LocalizeSubstrings(str);\\n      gview.innerHTML = str;\\n      return;\\n    }\\n    var data = cellRangeToDisplay2(range, isResize);\\n    if (!data) {\\n      gview.innerHTML = scc.s_graph_error_selection;\\n      return;\\n    }\\n    var graphLimits = document.getElementById(spreadsheet.idPrefix + \\\"graphLimits\\\");\\n    graphLimits.style.display = \\\"block\\\";\\n\\n    // Create display\\n    str = \\\"<table cellspacing=\\\\\\\"0\\\\\\\" cellpadding=\\\\\\\"0\\\\\\\" style=\\\\\\\"width:100%;\\\\\\\"><tr><td><canvas id=\\\\\\\"\\\"+spreadsheet.idPrefix+\\\"myScatterCanvas\\\\\\\" style=\\\\\\\"border:1px solid black;\\\\\\\"></canvas></td></tr></table>\\\";\\n    gview.innerHTML = str;\\n    if (!isResize) {\\n      document.getElementById(spreadsheet.idPrefix+\\\"graphMinX\\\").value = data.minX;\\n      spreadsheet.graphMinX = minX;\\n      document.getElementById(spreadsheet.idPrefix+\\\"graphMaxX\\\").value = data.maxX;\\n      spreadsheet.graphMaxX = maxX;\\n      document.getElementById(spreadsheet.idPrefix+\\\"graphMinY\\\").value = data.minval;\\n      spreadsheet.graphMinY = minval;\\n      document.getElementById(spreadsheet.idPrefix+\\\"graphMaxY\\\").value = data.maxval;\\n      spreadsheet.graphMaxY = maxval;\\n    }\\n    var canv = document.getElementById(spreadsheet.idPrefix+\\\"myScatterCanvas\\\");\\n\\n    // The canvas must be explicitly resized to fill space\\n    canv.width = 0 + gview.style.width.replace(\\\"px\\\", \\\"\\\") - 4;\\n    canv.height = 0 + gview.style.height.replace(\\\"px\\\", \\\"\\\") - 4;\\n\\n    var ctx = canv.getContext(\\\"2d\\\");\\n    var minX = data.minX, maxX = data.maxX, minval = data.minval, maxval = data.maxval;\\n    var scaleFactorX = (canv.width - 40) / (maxX - minX);\\n    var scaleFactorY = (canv.height - 40) / (maxval - minval);\\n    var topY = canv.height;\\n\\n    lastX = scaleFactorX * (data.labels[0] - minX) + 20;\\n    lastY = scaleFactorY * (data.values[0] - minval) + 20;\\n    drawColor = getDrawColor();\\n    ctx.fillStyle = drawColor;\\n    ctx.beginPath();\\n    ctx.arc(lastX, topY - lastY, data.dotSizes[0], 0, 2 * Math.PI, false);\\n    ctx.fill();\\n    for (var i = 1; i < data.values.length; i++) {\\n      ctx.moveTo(lastX, topY - lastY);\\n      lastX = scaleFactorX * (data.labels[i] - minX) + 20;\\n      lastY = scaleFactorY * (data.values[i] - minval) + 20;\\n      ctx.beginPath();\\n      ctx.arc(lastX, topY - lastY, data.dotSizes[i], 0, 2 * Math.PI, false);\\n      ctx.fill();\\n    }\\n    if (minval <= 0 && maxval >= 0) {\\n      ctx.beginPath();\\n      ctx.strokeStyle = \\\"#000000\\\";\\n      ctx.moveTo(0, canv.height - (scaleFactorY * -1 * minval + 20));\\n      ctx.lineTo(canv.width, canv.height - (scaleFactorY * -1 * minval + 20));\\n      ctx.stroke();\\n      graphPlace = 1 - (canv.height - (scaleFactorY * -1 * minval + 20)) / canv.height;\\n    }\\n    if (minX <= 0 && maxX >= 0) {\\n      ctx.beginPath();\\n      ctx.strokeStyle = \\\"#000000\\\";\\n      ctx.moveTo(scaleFactorX * -1 * minX + 20, 0);\\n      ctx.lineTo(scaleFactorX * -1 * minX + 20, canv.height);\\n      ctx.stroke();\\n      graphPlace = (scaleFactorX * -1 * minX + 20) / canv.width;\\n    }\\n    minX -= (maxX - minX) / 23;\\n    maxX += (maxX - minX) / 23;\\n    minval -= (maxval - minval) / 18;\\n    maxval += (maxval - minval) / 18;\\n  };\\n\\n  exports.Graph = Graph;\\n})();\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/socialcalc.css\": {\n            \"type\": \"text/css\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/socialcalc.css\",\n            \"tags\": \"[[$:/tags/Stylesheet]]\",\n            \"text\": \"/*\\n// The optional default CSS style sheet for the SocialCalc package.\\n// SocialCalc can run without a style sheet (the default) or with one.\\n//\\n// (c) Copyright 2008 Socialtext, Inc.\\n// All Rights Reserved.\\n//\\n// The contents of this file are subject to the Artistic License 2.0; you may not\\n// use this file except in compliance with the License. You may obtain a copy of \\n// the License at http://socialcalc.org/licenses/al-20/.\\n//\\n// Some of the other files in the SocialCalc package are licensed under\\n// different licenses. Please note the licenses of the modules you use.\\n//\\n// Code History:\\n//\\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\\n*/\\n\\nbody:last-child .defaultPeer {\\n    border-collapse: separate;\\n    filter: none;\\n}\\n\\n.defaultPeer {\\n    box-shadow: inset 0 0 0 2px blue;\\n    -webkit-box-shadow: inset 0 0 0 2px blue;\\n    -moz-box-shadow: inset 0 0 0 2px blue;\\n    *background: white;\\n    filter: progid:DXImageTransform.Microsoft.DropShadow(OffX=1, OffY=1, Color=#0000ff),\\n            progid:DXImageTransform.Microsoft.DropShadow(OffX=-1, OffY=1, Color=#0000ff),\\n            progid:DXImageTransform.Microsoft.DropShadow(OffX=1, OffY=-1, Color=#0000ff),\\n            progid:DXImageTransform.Microsoft.DropShadow(OffX=-1, OffY=-1, Color=#0000ff),\\n            progid:DXImageTransform.Microsoft.Chroma(Color=#FFFFFF);\\n    /*\\n     * concat peer combinations into multishadows:\\n    inset 0 0 0 4px orange,\\n    inset 0 0 0 6px yellow,\\n    inset 0 0 0 8px lime,\\n    inset 0 0 0 10px cyan,\\n    inset 0 0 0 12px blue,\\n    inset 0 0 0 14px purple; \\n    */\\n}\\n.defaultComment {background-repeat:no-repeat;background-position:top right;background-image:url(images/sc-commentbg.gif);}\\n.defaultCommentNoGridStyle {}\\n.defaultHighlightTypeCursor {color:#FFF;background-color:#A6A6A6;}\\n.defaultHighlightTypeRange {color:#000;background-color:#E5E5E5;}\\n.defaultColname {font-size:small;text-align:center;color:#FFFFFF;background-color:#808080;cursor:e-resize;}\\n.defaultSelectedColname {font-size:small;text-align:center;color:#FFFFFF;background-color:#404040;cursor:e-resize;}\\n.defaultRowname {font-size:small;text-align:right;color:#FFFFFF;background-color:#808080;}\\n.defaultSelectedRowname {font-size:small;text-align:right;color:#FFFFFF;background-color:#404040;}\\n.defaultUpperLeft {font-size:small;}\\n.defaultSkippedCell {font-size:small;background-color:#CCC;}\\n.defaultPaneDivider {font-size:small;background-color:#ECECEC;padding:0px;}\\n.cteGriddiv {}\\n.defaultInputEcho {background-color:#FFD;border:1px solid #884;\\n  font-size:small;padding:2px 10px 1px 2px;cursor:default;}\\n.TCmain {background-color:#EEE;}\\n.TCendcap {background-color:#FFF;}\\n.TCpaneslider {background-color:#CCC;}\\n.TClessbutton {background-color:#AAA;}\\n.TCmorebutton {background-color:#AAA;}\\n.TCscrollarea {background-color:#DDD;}\\n.TCthumb {background-color:#CCC;}\\n.TCPStrackingline {overflow:hidden;position:absolute;z-index:100;}\\n.TCTDFSthumbstatus {height:20px;width:auto;border:1px solid black;padding:2px;\\n background-color:#FFF;font-size:small;position:absolute;z-index:100;}\\n.TDpopupElement {border:1px solid black;padding:1px 2px 2px 2px;text-align:center;background-color:#FFF;\\n font-size:7pt;font-family:Verdana,Arial,Helvetica,sans-serif;\\n position:absolute;width:auto;z-index:110;}\\n\\n#te_fullgrid {\\n    table-layout: fixed;\\n}\\n\\n#te_fullgrid td {\\n    overflow: hidden;\\n    word-break: break-all;\\n    word-wrap: break-word;\\n}\\n\\n#SocialCalc-settings-savecell, #SocialCalc-settings-savesheet {\\n    background: #AEF;\\n    font-weight: bold;\\n}\\n\"\n        },\n        \"$:/plugins/rboue/SocialCalc/config.css\": {\n            \"type\": \"text/css\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/config.css\",\n            \"tags\": \"[[$:/tags/Stylesheet]]\",\n            \"text\": \"/* Root node */\\n.SocialCalcWidget {\\n  font-family: verdana,helvetica,sans-serif;\\n  font-size: small;\\n  margin: 0;\\n  padding: 0;\\n  padding-bottom: 4px;\\n  border: none;\\n}\\n\\n/* Toolbars */\\n.SocialCalc-toolbar {\\n  padding: 8px 8px 8px 8px;\\n  height: 60px;\\n}\\n\\n/* Comment text area */\\n.SocialCalc-commenttext {\\n  width: 500px;\\n  height: 32px;\\n}\\n\\n/* Function chooser */\\n.SocialCalc-functiondialogbody {\\n  padding: 8px 8px 8px 8px;\\n}\\n\\n/* Status line */\\n.SocialCalc-statusline {\\n  font-size: 10px;\\n  padding: 3px 0 2px 0;\\n}\\n\\n/* Fix conflicts with TiddlyWiki defaults\\n*/\\n.SocialCalcWidget {\\n  line-height: 10pt;\\n}\\n.SocialCalcWidget table {\\n  margin: 0;\\n  padding: 0;\\n  border: none;\\n}\\n.SocialCalcWidget table td {\\n  margin: 0;\\n  padding: 0;\\n  border: none;\\n}\\n.SocialCalcWidget table td p {\\n  margin: 0;\\n}\\n.SocialCalcWidget #te_logo div {\\n  line-height: 3pt;\\n}\\n#SocialCalc-functiondialog div {\\n  padding: 4px 4px 4px 8px;\\n}\\n\\n/* Transparent keyboard management (no more dashed border with focus) */\\n.SocialCalcWidget :focus {\\n  outline: none;\\n}\\n\\n/* Fix color pickers */\\n.SocialCalc-colorchooser {\\n  line-height: 1px;\\n}\\n\\n/* Sheet aspect (cf. SocialCalc.ConstantsSetClasses())\\n */\\n.SocialCalc-defaultComment { /* cells with non-null comments when grid enabled */\\n  background-repeat: no-repeat;\\n  background-position: top right;\\n}\\n.SocialCalc-defaultCommentNoGrid {} /* cells with non-null comments when grid not enabled */\\n.SocialCalc-defaultHighlightTypeCursor {\\n  color: #FFF;\\n  background-color: #A6A6A6;\\n}\\n.SocialCalc-defaultHighlightTypeRange {\\n  color: #000;\\n  background-color: #E5E5E5;\\n}\\n.SocialCalc-defaultColname { /* regular column heading letters, needs a cursor property */\\n  font-size: small;\\n  text-align: center;\\n  color: #FFFFFF;\\n  background-color: #808080;\\n  cursor: e-resize;\\n}\\n.SocialCalc-defaultSelectedColname { /* column with selected cell, needs a cursor property */\\n  font-size: small;\\n  text-align: center;\\n  color: #FFFFFF;\\n  background-color: #404040;\\n  cursor: e-resize;\\n}\\n.SocialCalc-defaultRowname { /* regular row heading numbers */\\n  font-size: small;\\n  text-align: right;\\n  color: #FFFFFF;\\n  background-color: #808080;\\n  direction: rtl;\\n}\\n.SocialCalc-defaultSelectedRowname { /* column with selected cell, needs a cursor property */\\n  font-size: small;\\n  text-align: right;\\n  color: #FFFFFF;\\n  background-color: #404040;\\n} \\n.SocialCalc-defaultUpperLeft { /* Corner cell in upper left */\\n  font-size: small;\\n}\\n.SocialCalc-defaultSkippedCell { /* used if present for spanned cells peeking into a pane */\\n  font-size: small;\\n  background-color: #CCC\\n}\\n.SocialCalc-defaultPaneDivider { /* used if present for the look of the space between panes */\\n  font-size: small;\\n  background-color: #C0C0C0;\\n  padding: 0px;\\n}\\n.SocialCalc-cteGriddiv {} /* the TableEditor griddiv element */\\n.SocialCalc-defaultInputEcho { /* the popup inputEcho div */\\n  filter: alpha(opacity=90);\\n  opacity: .9;\\n  background-color: #FFD;\\n  border: 1px solid #884;\\n}\\n.SocialCalc-TCmain { /* pseudo style (text-align is textAlign) for main div of a table control */\\n  background-color: #EEE;\\n}\\n.SocialCalc-TCendcap { /* may be used while waiting for image that may not come */\\n  background-color: #FFF;\\n}\\n.SocialCalc-TCpaneslider {\\n  background-color: #CCC;\\n}\\n.SocialCalc-TClessbutton {\\n  background-color: #AAA;\\n}\\n.SocialCalc-TCmorebutton {\\n  background-color: #AAA;\\n}\\n.SocialCalc-TCscrollarea {\\n  background-color: #DDD;\\n}\\n.SocialCalc-TCthumb {\\n  background-color: #CCC;\\n}\\n.SocialCalc-TCPStrackingline { /* pane slider tracking line display in table control */\\n  overflow: hidden;\\n  position: absolute;\\n  z-index: 100;\\n}\\n.SocialCalc-TCTDFSthumbstatus { /* vertical thumb dragging status display in table control */\\n  height: 20px;\\n  width: auto;\\n  border: 3px solid #808080;\\n  overflow: hidden;\\n  background-color: #FFF;\\n  font-size: small;\\n  position: absolute;\\n  z-index:100;\\n}\\n.SocialCalc-TDpopupElement { /* tooltip display */\\n  border: 1px solid black;\\n  padding: 1px 2px 2px 2px;\\n  text-align: center;\\n  background-color: #FFF;\\n  font-size: 7pt;\\n  font-family: Verdana,Arial,Helvetica,sans-serif;\\n  position: absolute;\\n  width: auto;\\n  z-index: 110;\\n}\"\n        },\n        \"$:/plugins/rboue/SocialCalc/LEGAL.txt\": {\n            \"type\": \"text/plain\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/LEGAL.txt\",\n            \"text\": \"SOCIALCALC LEGAL.txt FILE:\\n\\nLEGAL INFORMATION\\n\\nThis LEGAL.txt file accompanies the SocialCalc program. It includes notices required by the \\nlicenses as well as general legal notices.\\n\\n=========================================\\n    COPYRIGHT AND ATTRIBUTION NOTICES\\n=========================================\\n\\nCopyright (C) 2009 Socialtext, Inc. \\nAll Rights Reserved.\\n\\nimage:sc-logo.gif\\n\\\"SocialCalc\\\"\\nhttp://www.socialcalc.org/xoattrib\\n\\n=========================================\\n     SOURCE CODE AVAILABILITY NOTICE\\n=========================================\\n\\nThe source code for this product is available from:\\nhttp://socialcalc.org/.\\n\\n=========================================\\n          GENERAL LEGAL NOTICES\\n=========================================\\n\\nwikiCalc, Garden, and Software Garden are registered trademarks of Software Garden, Inc.\\nSocialtext and SocialCalc are registered trademarks of Socialtext, Inc.\\nThe Socialtext logo and Dreamcatcher are trademarks of Socialtext, Inc.\\n\\n=========================================\\n  LEGAL NOTICES REQUIRED BY THE LICENSE\\n=========================================\\n\\nCHANGES MADE TO THE COVERED CODE (see CPAL Version 1.0 Section 3.3):\\n\\n2012-04-21:\\n Incorporated charting framework from OLPC Sugar into player.coffee.\\n\\n The pie, line and bar chart tools was developed by Nicholas Doiron,\\n an engineering student from Carnegie Mellon University, U.S.A under\\n the guidance of Manusheel Gupta.\\n\\n2008-02-08:\\n Original Code started as a translation to JavaScript of code in SocialCalc 1.1.0 plus\\n much new code.\\n\\n Python code for the OLPC XO-1 initially coded by Luke Closs of Socialtext, Inc.\\n\\n JavaScript initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\\n Based in part on the SocialCalc 1.1.0 code written in Perl.\\n The SocialCalc 1.1.0 code was:\\n    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\\n    All Rights Reserved.\\n    Portions (c) Copyright 2007 Socialtext, Inc.\\n    All Rights Reserved.\\n The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\\n wikiCalc 1.0 was written by Software Garden, Inc.\\n Unless otherwise specified, referring to \\\"SocialCalc\\\" in comments refers to this\\n JavaScript version of the code, not the SocialCalc Perl code.\\n\\n----------\\n\\n(Documentation of future changes as the result of Modifications, including the date of \\nchange, will go here in this LEGAL.txt file. This documentation may be summaries of \\nchanges with the more detailed descriptions included in the actual modified files as \\nappropriate.)\\n\\n==========\\n\\nTHIRD PARTY CLAIMS (see CPAL Version 1.0 Section 3.4(a)):\\n\\nNone.\\n\\n[End of LEGAL.txt]\\n\\n\"\n        },\n        \"$:/plugins/rboue/SocialCalc/LICENSE.txt\": {\n            \"type\": \"text/plain\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/LICENSE.txt\",\n            \"text\": \"SOCIALCALC LICENSE.txt FILE:\\n\\n=========================================\\n             ABOUT THIS FILE\\n=========================================\\n\\nThis file includes copies of the Common Public Attribution License (CPAL) and\\nthe Artistic License 2.0.\\n\\nThis product consists of components licensed under different licenses.\\nCheck the contents of each file for a statement of the license for that file.\\nFiles without license information are licensed under the Artistic License 2.0.\\n\\n======================================================\\n  COMMON PUBLIC ATTRIBUTION LICENSE VERSION 1.0 (CPAL)\\n======================================================\\n\\nCommon Public Attribution License Version 1.0 (CPAL)\\n\\n1. \\\"Definitions\\\"\\n\\n1.0.1 \\\"Commercial Use\\\" means distribution or otherwise making the Covered Code \\navailable to a third party.\\n\\n1.1 \\\"Contributor\\\" means each entity that creates or contributes to the creation \\nof Modifications.\\n\\n1.2 \\\"Contributor Version\\\" means the combination of the Original Code, prior \\nModifications used by a Contributor, and the Modifications made by that particular \\nContributor.\\n\\n1.3 \\\"Covered Code\\\" means the Original Code or Modifications or the combination of \\nthe Original Code and Modifications, in each case including portions thereof.\\n\\n1.4 \\\"Electronic Distribution Mechanism\\\" means a mechanism generally accepted in \\nthe software development community for the electronic transfer of data.\\n\\n1.5 \\\"Executable\\\" means Covered Code in any form other than Source Code.\\n\\n1.6 \\\"Initial Developer\\\" means the individual or entity identified as the Initial \\nDeveloper in the Source Code notice required by Exhibit A.\\n\\n1.7 \\\"Larger Work\\\" means a work which combines Covered Code or portions thereof with \\ncode not governed by the terms of this License.\\n\\n1.8 \\\"License\\\" means this document.\\n\\n1.8.1 \\\"Licensable\\\" means having the right to grant, to the maximum extent possible, \\nwhether at the time of the initial grant or subsequently acquired, any and all of \\nthe rights conveyed herein.\\n\\n1.9 \\\"Modifications\\\" means any addition to or deletion from the substance or structure \\nof either the Original Code or any previous Modifications. When Covered Code is \\nreleased as a series of files, a Modification is:\\n\\nA. Any addition to or deletion from the contents of a file containing Original Code \\nor previous Modifications.\\n\\nB. Any new file that contains any part of the Original Code or previous Modifications.\\n\\n1.10 \\\"Original Code\\\" means Source Code of computer software code which is described in \\nthe Source Code notice required by Exhibit A as Original Code, and which, at the time \\nof its release under this License is not already Covered Code governed by this License.\\n\\n1.10.1 \\\"Patent Claims\\\" means any patent claim(s), now owned or hereafter acquired, \\nincluding without limitation, method, process, and apparatus claims, in any patent \\nLicensable by grantor.\\n\\n1.11 \\\"Source Code\\\" means the preferred form of the Covered Code for making modifications \\nto it, including all modules it contains, plus any associated interface definition files, \\nscripts used to control compilation and installation of an Executable, or source code \\ndifferential comparisons against either the Original Code or another well known, \\navailable Covered Code of the Contributor�s choice. The Source Code can be in a compressed \\nor archival form, provided the appropriate decompression or de-archiving software is \\nwidely available for no charge.\\n\\n1.12 \\\"You\\\" (or \\\"Your\\\") means an individual or a legal entity exercising rights under, and \\ncomplying with all of the terms of, this License or a future version of this License \\nissued under Section 6.1. For legal entities, \\\"You\\\" includes any entity which controls, \\nis controlled by, or is under common control with You. For purposes of this definition, \\n\\\"control\\\" means (a) the power, direct or indirect, to cause the direction or management \\nof such entity, whether by contract or otherwise, or (b) ownership of more than fifty \\npercent (50%) of the outstanding shares or beneficial ownership of such entity.\\n\\n2. Source Code License.\\n\\n2.1 The Initial Developer Grant.\\n\\nThe Initial Developer hereby grants You a world-wide, royalty-free, non-exclusive \\nlicense, subject to third party intellectual property claims:\\n\\n(a) under intellectual property rights (other than patent or trademark) Licensable by \\nInitial Developer to use, reproduce, modify, display, perform, sublicense and distribute \\nthe Original Code (or portions thereof) with or without Modifications, and/or as part \\nof a Larger Work; and\\n\\n(b) under Patents Claims infringed by the making, using or selling of Original Code, to \\nmake, have made, use, practice, sell, and offer for sale, and/or otherwise dispose of \\nthe Original Code (or portions thereof).\\n\\n(c) the licenses granted in this Section 2.1(a) and (b) are effective on the date \\nInitial Developer first distributes Original Code under the terms of this License.\\n\\n(d) Notwithstanding Section 2.1(b) above, no patent license is granted: 1) for code \\nthat You delete from the Original Code; 2) separate from the Original Code; or 3) for \\ninfringements caused by: i) the modification of the Original Code or ii) the combination \\nof the Original Code with other software or devices.\\n\\n2.2 Contributor Grant.\\n\\nSubject to third party intellectual property claims, each Contributor hereby grants You \\na world-wide, royalty-free, non-exclusive license\\n\\n(a) under intellectual property rights (other than patent or trademark) Licensable by \\nContributor, to use, reproduce, modify, display, perform, sublicense and distribute \\nthe Modifications created by such Contributor (or portions thereof) either on an \\nunmodified basis, with other Modifications, as Covered Code and/or as part of a Larger \\nWork; and\\n\\n(b) under Patent Claims infringed by the making, using, or selling of Modifications \\nmade by that Contributor either alone and/or in combination with its Contributor \\nVersion (or portions of such combination), to make, use, sell, offer for sale, have \\nmade, and/or otherwise dispose of: 1) Modifications made by that Contributor (or \\nportions thereof); and 2) the combination of Modifications made by that Contributor \\nwith its Contributor Version (or portions of such combination).\\n\\n(c) the licenses granted in Sections 2.2(a) and 2.2(b) are effective on the date \\nContributor first makes Commercial Use of the Covered Code.\\n\\n(d) Notwithstanding Section 2.2(b) above, no patent license is granted: 1) for any code \\nthat Contributor has deleted from the Contributor Version; 2) separate from the \\nContributor Version; 3) for infringements caused by: i) third party modifications of \\nContributor Version or ii) the combination of Modifications made by that Contributor \\nwith other software (except as part of the Contributor Version) or other devices; or \\n4) under Patent Claims infringed by Covered Code in the absence of Modifications made \\nby that Contributor.\\n\\n3. Distribution Obligations.\\n\\n3.1 Application of License.\\n\\nThe Modifications which You create or to which You contribute are governed by the terms \\nof this License, including without limitation Section 2.2. The Source Code version of \\nCovered Code may be distributed only under the terms of this License or a future version \\nof this License released under Section 6.1, and You must include a copy of this License \\nwith every copy of the Source Code You distribute. You may not offer or impose any terms \\non any Source Code version that alters or restricts the applicable version of this License \\nor the recipients� rights hereunder. However, You may include an additional document \\noffering the additional rights described in Section 3.5.\\n\\n3.2 Availability of Source Code.\\n\\nAny Modification which You create or to which You contribute must be made available in \\nSource Code form under the terms of this License either on the same media as an Executable \\nversion or via an accepted Electronic Distribution Mechanism to anyone to whom you made \\nan Executable version available; and if made available via Electronic Distribution \\nMechanism, must remain available for at least twelve (12) months after the date it \\ninitially became available, or at least six (6) months after a subsequent version of that \\nparticular Modification has been made available to such recipients. You are responsible \\nfor ensuring that the Source Code version remains available even if the Electronic \\nDistribution Mechanism is maintained by a third party.\\n\\n3.3 Description of Modifications.\\n\\nYou must cause all Covered Code to which You contribute to contain a file documenting the \\nchanges You made to create that Covered Code and the date of any change. You must include \\na prominent statement that the Modification is derived, directly or indirectly, from \\nOriginal Code provided by the Initial Developer and including the name of the Initial \\nDeveloper in (a) the Source Code, and (b) in any notice in an Executable version or \\nrelated documentation in which You describe the origin or ownership of the Covered Code.\\n\\n3.4 Intellectual Property Matters\\n\\n(a) Third Party Claims.\\n\\nIf Contributor has knowledge that a license under a third party�s intellectual property \\nrights is required to exercise the rights granted by such Contributor under Sections 2.1 \\nor 2.2, Contributor must include a text file with the Source Code distribution titled \\\"LEGAL\\\" \\nwhich describes the claim and the party making the claim in sufficient detail that a \\nrecipient will know whom to contact. If Contributor obtains such knowledge after the \\nModification is made available as described in Section 3.2, Contributor shall promptly \\nmodify the LEGAL file in all copies Contributor makes available thereafter and shall take \\nother steps (such as notifying appropriate mailing lists or newsgroups) reasonably \\ncalculated to inform those who received the Covered Code that new knowledge has been obtained.\\n\\n(b) Contributor APIs.\\n\\nIf Contributor�s Modifications include an application programming interface and Contributor \\nhas knowledge of patent licenses which are reasonably necessary to implement that API, \\nContributor must also include this information in the LEGAL file.\\n\\n(c) Representations.\\n\\nContributor represents that, except as disclosed pursuant to Section 3.4(a) above, Contributor \\nbelieves that Contributor�s Modifications are Contributor�s original creation(s) and/or \\nContributor has sufficient rights to grant the rights conveyed by this License.\\n\\n3.5 Required Notices.\\n\\nYou must duplicate the notice in Exhibit A in each file of the Source Code. If it is not \\npossible to put such notice in a particular Source Code file due to its structure, then \\nYou must include such notice in a location (such as a relevant directory) where a user \\nwould be likely to look for such a notice. If You created one or more Modification(s) \\nYou may add your name as a Contributor to the notice described in Exhibit A. You must \\nalso duplicate this License in any documentation for the Source Code where You describe \\nrecipients� rights or ownership rights relating to Covered Code. You may choose to offer, \\nand to charge a fee for, warranty, support, indemnity or liability obligations to one or \\nmore recipients of Covered Code. However, You may do so only on Your own behalf, and not \\non behalf of the Initial Developer or any Contributor. You must make it absolutely clear \\nthan any such warranty, support, indemnity or liability obligation is offered by You alone, \\nand You hereby agree to indemnify the Initial Developer and every Contributor for any \\nliability incurred by the Initial Developer or such Contributor as a result of warranty, \\nsupport, indemnity or liability terms You offer.\\n\\n3.6 Distribution of Executable Versions.\\n\\nYou may distribute Covered Code in Executable form only if the requirements of Section \\n3.1-3.5 have been met for that Covered Code, and if You include a notice stating that the \\nSource Code version of the Covered Code is available under the terms of this License, \\nincluding a description of how and where You have fulfilled the obligations of Section \\n3.2. The notice must be conspicuously included in any notice in an Executable version, \\nrelated documentation or collateral in which You describe recipients� rights relating to \\nthe Covered Code. You may distribute the Executable version of Covered Code or ownership \\nrights under a license of Your choice, which may contain terms different from this License, \\nprovided that You are in compliance with the terms of this License and that the license for \\nthe Executable version does not attempt to limit or alter the recipient�s rights in the \\nSource Code version from the rights set forth in this License. If You distribute the \\nExecutable version under a different license You must make it absolutely clear that any \\nterms which differ from this License are offered by You alone, not by the Initial Developer, \\nOriginal Developer or any Contributor. You hereby agree to indemnify the Initial Developer, \\nOriginal Developer and every Contributor for any liability incurred by the Initial Developer, \\nOriginal Developer or such Contributor as a result of any such terms You offer.\\n\\n3.7 Larger Works.\\n\\nYou may create a Larger Work by combining Covered Code with other code not governed by the \\nterms of this License and distribute the Larger Work as a single product. In such a case, You \\nmust make sure the requirements of this License are fulfilled for the Covered Code.\\n\\n4. Inability to Comply Due to Statute or Regulation.\\n\\nIf it is impossible for You to comply with any of the terms of this License with respect to \\nsome or all of the Covered Code due to statute, judicial order, or regulation then You must: \\n(a) comply with the terms of this License to the maximum extent possible; and (b) describe the \\nlimitations and the code they affect. Such description must be included in the LEGAL file \\ndescribed in Section 3.4 and must be included with all distributions of the Source Code. \\nExcept to the extent prohibited by statute or regulation, such description must be \\nsufficiently detailed for a recipient of ordinary skill to be able to understand it.\\n\\n5. Application of this License.\\n\\nThis License applies to code to which the Initial Developer has attached the notice in Exhibit \\nA and to related Covered Code.\\n\\n6. Versions of the License.\\n\\n6.1 New Versions.\\n\\nSocialtext, Inc. (\\\"Socialtext\\\") may publish revised and/or new versions of the License from \\ntime to time. Each version will be given a distinguishing version number.\\n\\n6.2 Effect of New Versions.\\n\\nOnce Covered Code has been published under a particular version of the License, You may always \\ncontinue to use it under the terms of that version. You may also choose to use such Covered \\nCode under the terms of any subsequent version of the License published by Socialtext. No one \\nother than Socialtext has the right to modify the terms applicable to Covered Code created \\nunder this License.\\n\\n6.3 Derivative Works.\\n\\nIf You create or use a modified version of this License (which you may only do in order to \\napply it to code which is not already Covered Code governed by this License), You must (a) \\nrename Your license so that the phrases \\\"Socialtext\\\", \\\"CPAL\\\" or any confusingly similar phrase \\ndo not appear in your license (except to note that your license differs from this License) and \\n(b) otherwise make it clear that Your version of the license contains terms which differ from \\nthe CPAL. (Filling in the name of the Initial Developer, Original Developer, Original Code or \\nContributor in the notice described in Exhibit A shall not of themselves be deemed to be \\nmodifications of this License.)\\n\\n7. DISCLAIMER OF WARRANTY.\\n\\nCOVERED CODE IS PROVIDED UNDER THIS LICENSE ON AN \\\"AS IS\\\" BASIS, WITHOUT WARRANTY OF ANY KIND, \\nEITHER EXPRESSED OR IMPLIED, INCLUDING, WITHOUT LIMITATION, WARRANTIES THAT THE COVERED CODE IS \\nFREE OF DEFECTS, MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE OR NON-INFRINGING. THE ENTIRE RISK \\nAS TO THE QUALITY AND PERFORMANCE OF THE COVERED CODE IS WITH YOU. SHOULD ANY COVERED CODE PROVE \\nDEFECTIVE IN ANY RESPECT, YOU (NOT THE INITIAL DEVELOPER, ORIGINAL DEVELOPER OR ANY OTHER \\nCONTRIBUTOR) ASSUME THE COST OF ANY NECESSARY SERVICING, REPAIR OR CORRECTION. THIS DISCLAIMER \\nOF WARRANTY CONSTITUTES AN ESSENTIAL PART OF THIS LICENSE. NO USE OF ANY COVERED CODE IS \\nAUTHORIZED HEREUNDER EXCEPT UNDER THIS DISCLAIMER.\\n\\n8. TERMINATION.\\n\\n8.1 This License and the rights granted hereunder will terminate automatically if You fail to \\ncomply with terms herein and fail to cure such breach within 30 days of becoming aware of the \\nbreach. All sublicenses to the Covered Code which are properly granted shall survive any \\ntermination of this License. Provisions which, by their nature, must remain in effect beyond \\nthe termination of this License shall survive.\\n\\n8.2 If You initiate litigation by asserting a patent infringement claim (excluding declatory \\njudgment actions) against Initial Developer, Original Developer or a Contributor (the Initial \\nDeveloper, Original Developer or Contributor against whom You file such action is referred to \\nas \\\"Participant\\\") alleging that:\\n\\n(a) such Participant�s Contributor Version directly or indirectly infringes any patent, then \\nany and all rights granted by such Participant to You under Sections 2.1 and/or 2.2 of this \\nLicense shall, upon 60 days notice from Participant terminate prospectively, unless if within \\n60 days after receipt of notice You either: (i) agree in writing to pay Participant a mutually \\nagreeable reasonable royalty for Your past and future use of Modifications made by such \\nParticipant, or (ii) withdraw Your litigation claim with respect to the Contributor Version \\nagainst such Participant. If within 60 days of notice, a reasonable royalty and payment \\narrangement are not mutually agreed upon in writing by the parties or the litigation claim is \\nnot withdrawn, the rights granted by Participant to You under Sections 2.1 and/or 2.2 \\nautomatically terminate at the expiration of the 60 day notice period specified above.\\n\\n(b) any software, hardware, or device, other than such Participant�s Contributor Version, \\ndirectly or indirectly infringes any patent, then any rights granted to You by such Participant \\nunder Sections 2.1(b) and 2.2(b) are revoked effective as of the date You first made, used, \\nsold, distributed, or had made, Modifications made by that Participant.\\n\\n8.3 If You assert a patent infringement claim against Participant alleging that such \\nParticipant�s Contributor Version directly or indirectly infringes any patent where such claim \\nis resolved (such as by license or settlement) prior to the initiation of patent infringement \\nlitigation, then the reasonable value of the licenses granted by such Participant under Sections \\n2.1 or 2.2 shall be taken into account in determining the amount or value of any payment or \\nlicense.\\n\\n8.4 In the event of termination under Sections 8.1 or 8.2 above, all end user license agreements \\n(excluding distributors and resellers) which have been validly granted by You or any distributor \\nhereunder prior to termination shall survive termination.\\n\\n9. LIMITATION OF LIABILITY.\\n\\nUNDER NO CIRCUMSTANCES AND UNDER NO LEGAL THEORY, WHETHER TORT (INCLUDING NEGLIGENCE), CONTRACT, \\nOR OTHERWISE, SHALL YOU, THE INITIAL DEVELOPER, ORIGINAL DEVELOPER, ANY OTHER CONTRIBUTOR, OR \\nANY DISTRIBUTOR OF COVERED CODE, OR ANY SUPPLIER OF ANY OF SUCH PARTIES, BE LIABLE TO ANY PERSON \\nFOR ANY INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES OF ANY CHARACTER INCLUDING, \\nWITHOUT LIMITATION, DAMAGES FOR LOSS OF GOODWILL, WORK STOPPAGE, COMPUTER FAILURE OR MALFUNCTION, \\nOR ANY AND ALL OTHER COMMERCIAL DAMAGES OR LOSSES, EVEN IF SUCH PARTY SHALL HAVE BEEN INFORMED OF \\nTHE POSSIBILITY OF SUCH DAMAGES. THIS LIMITATION OF LIABILITY SHALL NOT APPLY TO LIABILITY FOR \\nDEATH OR PERSONAL INJURY RESULTING FROM SUCH PARTY�S NEGLIGENCE TO THE EXTENT APPLICABLE LAW \\nPROHIBITS SUCH LIMITATION. SOME JURISDICTIONS DO NOT ALLOW THE EXCLUSION OR LIMITATION OF \\nINCIDENTAL OR CONSEQUENTIAL DAMAGES, SO THIS EXCLUSION AND LIMITATION MAY NOT APPLY TO YOU.\\n\\n10. U.S. GOVERNMENT END USERS.\\n\\nThe Covered Code is a \\\"commercial item,\\\" as that term is defined in 48 C.F.R. 2.101 (Oct. 1995), \\nconsisting of \\\"commercial computer software\\\" and \\\"commercial computer software documentation,\\\" as \\nsuch terms are used in 48 C.F.R. 12.212 (Sept. 1995). Consistent with 48 C.F.R. 12.212 and 48 \\nC.F.R. 227.7202-1 through 227.7202-4 (June 1995), all U.S. Government End Users acquire Covered \\nCode with only those rights set forth herein.\\n\\n11. MISCELLANEOUS.\\n\\nThis License represents the complete agreement concerning subject matter hereof. If any provision \\nof this License is held to be unenforceable, such provision shall be reformed only to the extent \\nnecessary to make it enforceable. This License shall be governed by California law provisions \\n(except to the extent applicable law, if any, provides otherwise), excluding its conflict-of-law \\nprovisions. With respect to disputes in which at least one party is a citizen of, or an entity \\nchartered or registered to do business in the United States of America, any litigation relating to \\nthis License shall be subject to the jurisdiction of the Federal Courts of the Northern District \\nof California, with venue lying in Santa Clara County, California, with the losing party \\nresponsible for costs, including without limitation, court costs and reasonable attorneys� fees \\nand expenses. The application of the United Nations Convention on Contracts for the International \\nSale of Goods is expressly excluded. Any law or regulation which provides that the language of a \\ncontract shall be construed against the drafter shall not apply to this License.\\n\\n12. RESPONSIBILITY FOR CLAIMS.\\n\\nAs between Initial Developer, Original Developer and the Contributors, each party is responsible \\nfor claims and damages arising, directly or indirectly, out of its utilization of rights under \\nthis License and You agree to work with Initial Developer, Original Developer and Contributors to \\ndistribute such responsibility on an equitable basis. Nothing herein is intended or shall be \\ndeemed to constitute any admission of liability.\\n\\n13. MULTIPLE-LICENSED CODE.\\n\\nInitial Developer may designate portions of the Covered Code as Multiple-Licensed. \\nMultiple-Licensed means that the Initial Developer permits you to utilize portions of the Covered \\nCode under Your choice of the CPAL or the alternative licenses, if any, specified by the Initial \\nDeveloper in the file described in Exhibit A.\\n\\n14. ADDITIONAL TERM: ATTRIBUTION\\n\\n(a) As a modest attribution to the organizer of the development of the Original Code (\\\"Original \\nDeveloper\\\"), in the hope that its promotional value may help justify the time, money and effort \\ninvested in writing the Original Code, the Original Developer may include in Exhibit B \\n(\\\"Attribution Information\\\") a requirement that each time an Executable and Source Code or a Larger \\nWork is launched or initially run (which includes initiating a session), a prominent display of \\nthe Original Developer�s Attribution Information (as defined below) must occur on the graphic user \\ninterface employed by the end user to access such Covered Code (which may include display on a \\nsplash screen), if any. The size of the graphic image should be consistent with the size of the \\nother elements of the Attribution Information. If the access by the end user to the Executable and \\nSource Code does not create a graphic user interface for access to the Covered Code, this \\nobligation shall not apply. If the Original Code displays such Attribution Information in a \\nparticular form (such as in the form of a splash screen, notice at login, an \\\"about\\\" display, or \\ndedicated attribution area on user interface screens), continued use of such form for that \\nAttribution Information is one way of meeting this requirement for notice.\\n\\n(b) Attribution information may only include a copyright notice, a brief phrase, graphic image and \\na URL (\\\"Attribution Information\\\") and is subject to the Attribution Limits as defined below. For \\nthese purposes, prominent shall mean display for sufficient duration to give reasonable notice to \\nthe user of the identity of the Original Developer and that if You include Attribution Information \\nor similar information for other parties, You must ensure that the Attribution Information for the \\nOriginal Developer shall be no less prominent than such Attribution Information or similar \\ninformation for the other party. For greater certainty, the Original Developer may choose to \\nspecify in Exhibit B below that the above attribution requirement only applies to an Executable \\nand Source Code resulting from the Original Code or any Modification, but not a Larger Work. The \\nintent is to provide for reasonably modest attribution, therefore the Original Developer cannot \\nrequire that You display, at any time, more than the following information as Attribution \\nInformation: (a) a copyright notice including the name of the Original Developer; (b) a word or \\none phrase (not exceeding 10 words); (c) one graphic image provided by the Original Developer; and \\n(d) a URL (collectively, the \\\"Attribution Limits\\\").\\n\\n(c) If Exhibit B does not include any Attribution Information, then there are no requirements for \\nYou to display any Attribution Information of the Original Developer.\\n\\n(d) You acknowledge that all trademarks, service marks and/or trade names contained within the \\nAttribution Information distributed with the Covered Code are the exclusive property of their \\nowners and may only be used with the permission of their owners, or under circumstances otherwise \\npermitted by law or as expressly set out in this License.\\n\\n15. ADDITIONAL TERM: NETWORK USE.\\nThe term \\\"External Deployment\\\" means the use, distribution, or communication of the Original Code \\nor Modifications in any way such that the Original Code or Modifications may be used by anyone \\nother than You, whether those works are distributed or communicated to those persons or made \\navailable as an application intended for use over a network. As an express condition for the grants \\nof license hereunder, You must treat any External Deployment by You of the Original Code or \\nModifications as a distribution under section 3.1 and make Source Code available under Section 3.2.\\n\\nEXHIBIT A. Common Public Attribution License Version 1.0.\\n\\n\\\"The contents of this file are subject to the Common Public Attribution License Version 1.0 (the \\n\\\"License\\\"); you may not use this file except in compliance with the License. You may obtain a copy \\nof the License at _____________. The License is based on the Mozilla Public License Version 1.1 but \\nSections 14 and 15 have been added to cover use of software over a computer network and provide for \\nlimited attribution for the Original Developer. In addition, Exhibit A has been modified to be \\nconsistent with Exhibit B.\\n\\nSoftware distributed under the License is distributed on an \\\"AS IS\\\" basis, WITHOUT WARRANTY OF ANY \\nKIND, either express or implied. See the License for the specific language governing rights and \\nlimitations under the License.\\n\\nThe Original Code is______________________.\\n\\nThe Original Developer is not the Initial Developer and is __________. If left blank, the Original \\nDeveloper is the Initial Developer.\\n\\nThe Initial Developer of the Original Code is ____________. All portions of the code written by \\n___________ are Copyright (c) _____. All Rights Reserved.\\n\\nContributor ______________________.\\n\\nAlternatively, the contents of this file may be used under the terms of the _____ license (the \\n[___] License), in which case the provisions of [______] License are applicable instead of those \\nabove.\\n\\nIf you wish to allow use of your version of this file only under the terms of the [____] License \\nand not to allow others to use your version of this file under the CPAL, indicate your decision by \\ndeleting the provisions above and replace them with the notice and other provisions required by \\nthe [___] License. If you do not delete the provisions above, a recipient may use your version of \\nthis file under either the CPAL or the [___] License.\\\"\\n\\n[NOTE: The text of this Exhibit A may differ slightly from the text of the notices in the Source \\nCode files of the Original Code. You should use the text of this Exhibit A rather than the text \\nfound in the Original Code Source Code for Your Modifications.]\\n\\nEXHIBIT B. Attribution Information\\n\\nWhen the TableEditor is producing and/or controlling the display the Graphic Image must be\\ndisplayed on the screen visible to the user in a manner comparable to that in the \\nOriginal Code. The Attribution Phrase must be displayed as a \\\"tooltip\\\" or \\\"hover-text\\\" for\\nthat image. The image must be linked to the Attribution URL so as to access that page\\nwhen clicked. If the user interface includes a prominent \\\"about\\\" display which includes\\nfactual prominent attribution in a form similar to that in the \\\"about\\\" display included\\nwith the Original Code, including Socialtext copyright notices and URLs, then the image\\nneed not be linked to the Attribution URL but the \\\"tool-tip\\\" is still required.\\n\\nAttribution Copyright Notice:\\n\\n Copyright (C) 2009 Socialtext, Inc.\\n All Rights Reserved.\\n\\nAttribution Phrase (not exceeding 10 words): SocialCalc\\n\\nAttribution URL: http://www.socialcalc.org\\n\\nGraphic Image: The contents of the sc-logo.gif file in the Original Code or\\na suitable replacement from http://www.socialcalc.org/licenses specified as\\nbeing for SocialCalc.\\n\\nDisplay of Attribution Information is required in Larger Works which are defined \\nin the CPAL as a work which combines Covered Code or portions thereof with code \\nnot governed by the terms of the CPAL.\\n\\n\\n=========================================\\n        THE ARTISTIC LICENSE 2.0\\n=========================================\\n\\n\\t\\t       The Artistic License 2.0\\n\\n\\t    Copyright (c) 2000-2006, The Perl Foundation.\\n\\n     Everyone is permitted to copy and distribute verbatim copies\\n      of this license document, but changing it is not allowed.\\n\\nPreamble\\n\\nThis license establishes the terms under which a given free software\\nPackage may be copied, modified, distributed, and/or redistributed.\\nThe intent is that the Copyright Holder maintains some artistic\\ncontrol over the development of that Package while still keeping the\\nPackage available as open source and free software.\\n\\nYou are always permitted to make arrangements wholly outside of this\\nlicense directly with the Copyright Holder of a given Package.  If the\\nterms of this license do not permit the full use that you propose to\\nmake of the Package, you should contact the Copyright Holder and seek\\na different licensing arrangement. \\n\\nDefinitions\\n\\n    \\\"Copyright Holder\\\" means the individual(s) or organization(s)\\n    named in the copyright notice for the entire Package.\\n\\n    \\\"Contributor\\\" means any party that has contributed code or other\\n    material to the Package, in accordance with the Copyright Holder's\\n    procedures.\\n\\n    \\\"You\\\" and \\\"your\\\" means any person who would like to copy,\\n    distribute, or modify the Package.\\n\\n    \\\"Package\\\" means the collection of files distributed by the\\n    Copyright Holder, and derivatives of that collection and/or of\\n    those files. A given Package may consist of either the Standard\\n    Version, or a Modified Version.\\n\\n    \\\"Distribute\\\" means providing a copy of the Package or making it\\n    accessible to anyone else, or in the case of a company or\\n    organization, to others outside of your company or organization.\\n\\n    \\\"Distributor Fee\\\" means any fee that you charge for Distributing\\n    this Package or providing support for this Package to another\\n    party.  It does not mean licensing fees.\\n\\n    \\\"Standard Version\\\" refers to the Package if it has not been\\n    modified, or has been modified only in ways explicitly requested\\n    by the Copyright Holder.\\n\\n    \\\"Modified Version\\\" means the Package, if it has been changed, and\\n    such changes were not explicitly requested by the Copyright\\n    Holder. \\n\\n    \\\"Original License\\\" means this Artistic License as Distributed with\\n    the Standard Version of the Package, in its current version or as\\n    it may be modified by The Perl Foundation in the future.\\n\\n    \\\"Source\\\" form means the source code, documentation source, and\\n    configuration files for the Package.\\n\\n    \\\"Compiled\\\" form means the compiled bytecode, object code, binary,\\n    or any other form resulting from mechanical transformation or\\n    translation of the Source form.\\n\\n\\nPermission for Use and Modification Without Distribution\\n\\n(1)  You are permitted to use the Standard Version and create and use\\nModified Versions for any purpose without restriction, provided that\\nyou do not Distribute the Modified Version.\\n\\n\\nPermissions for Redistribution of the Standard Version\\n\\n(2)  You may Distribute verbatim copies of the Source form of the\\nStandard Version of this Package in any medium without restriction,\\neither gratis or for a Distributor Fee, provided that you duplicate\\nall of the original copyright notices and associated disclaimers.  At\\nyour discretion, such verbatim copies may or may not include a\\nCompiled form of the Package.\\n\\n(3)  You may apply any bug fixes, portability changes, and other\\nmodifications made available from the Copyright Holder.  The resulting\\nPackage will still be considered the Standard Version, and as such\\nwill be subject to the Original License.\\n\\n\\nDistribution of Modified Versions of the Package as Source \\n\\n(4)  You may Distribute your Modified Version as Source (either gratis\\nor for a Distributor Fee, and with or without a Compiled form of the\\nModified Version) provided that you clearly document how it differs\\nfrom the Standard Version, including, but not limited to, documenting\\nany non-standard features, executables, or modules, and provided that\\nyou do at least ONE of the following:\\n\\n    (a)  make the Modified Version available to the Copyright Holder\\n    of the Standard Version, under the Original License, so that the\\n    Copyright Holder may include your modifications in the Standard\\n    Version.\\n\\n    (b)  ensure that installation of your Modified Version does not\\n    prevent the user installing or running the Standard Version. In\\n    addition, the Modified Version must bear a name that is different\\n    from the name of the Standard Version.\\n\\n    (c)  allow anyone who receives a copy of the Modified Version to\\n    make the Source form of the Modified Version available to others\\n    under\\n\\t\\n        (i)  the Original License or\\n\\n        (ii)  a license that permits the licensee to freely copy,\\n        modify and redistribute the Modified Version using the same\\n        licensing terms that apply to the copy that the licensee\\n        received, and requires that the Source form of the Modified\\n        Version, and of any works derived from it, be made freely\\n        available in that license fees are prohibited but Distributor\\n        Fees are allowed.\\n\\n\\nDistribution of Compiled Forms of the Standard Version \\nor Modified Versions without the Source\\n\\n(5)  You may Distribute Compiled forms of the Standard Version without\\nthe Source, provided that you include complete instructions on how to\\nget the Source of the Standard Version.  Such instructions must be\\nvalid at the time of your distribution.  If these instructions, at any\\ntime while you are carrying out such distribution, become invalid, you\\nmust provide new instructions on demand or cease further distribution.\\nIf you provide valid instructions or cease distribution within thirty\\ndays after you become aware that the instructions are invalid, then\\nyou do not forfeit any of your rights under this license.\\n\\n(6)  You may Distribute a Modified Version in Compiled form without\\nthe Source, provided that you comply with Section 4 with respect to\\nthe Source of the Modified Version.\\n\\n\\nAggregating or Linking the Package \\n\\n(7)  You may aggregate the Package (either the Standard Version or\\nModified Version) with other packages and Distribute the resulting\\naggregation provided that you do not charge a licensing fee for the\\nPackage.  Distributor Fees are permitted, and licensing fees for other\\ncomponents in the aggregation are permitted. The terms of this license\\napply to the use and Distribution of the Standard or Modified Versions\\nas included in the aggregation.\\n\\n(8) You are permitted to link Modified and Standard Versions with\\nother works, to embed the Package in a larger work of your own, or to\\nbuild stand-alone binary or bytecode versions of applications that\\ninclude the Package, and Distribute the result without restriction,\\nprovided the result does not expose a direct interface to the Package.\\n\\n\\nItems That are Not Considered Part of a Modified Version \\n\\n(9) Works (including, but not limited to, modules and scripts) that\\nmerely extend or make use of the Package, do not, by themselves, cause\\nthe Package to be a Modified Version.  In addition, such works are not\\nconsidered parts of the Package itself, and are not subject to the\\nterms of this license.\\n\\n\\nGeneral Provisions\\n\\n(10)  Any use, modification, and distribution of the Standard or\\nModified Versions is governed by this Artistic License. By using,\\nmodifying or distributing the Package, you accept this license. Do not\\nuse, modify, or distribute the Package, if you do not accept this\\nlicense.\\n\\n(11)  If your Modified Version has been derived from a Modified\\nVersion made by someone other than you, you are nevertheless required\\nto ensure that your Modified Version complies with the requirements of\\nthis license.\\n\\n(12)  This license does not grant you the right to use any trademark,\\nservice mark, tradename, or logo of the Copyright Holder.\\n\\n(13)  This license includes the non-exclusive, worldwide,\\nfree-of-charge patent license to make, have made, use, offer to sell,\\nsell, import and otherwise transfer the Package with respect to any\\npatent claims licensable by the Copyright Holder that are necessarily\\ninfringed by the Package. If you institute patent litigation\\n(including a cross-claim or counterclaim) against any party alleging\\nthat the Package constitutes direct or contributory patent\\ninfringement, then this Artistic License to you shall terminate on the\\ndate that such litigation is filed.\\n\\n(14)  Disclaimer of Warranty:\\nTHE PACKAGE IS PROVIDED BY THE COPYRIGHT HOLDER AND CONTRIBUTORS \\\"AS\\nIS\\\" AND WITHOUT ANY EXPRESS OR IMPLIED WARRANTIES. THE IMPLIED\\nWARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, OR\\nNON-INFRINGEMENT ARE DISCLAIMED TO THE EXTENT PERMITTED BY YOUR LOCAL\\nLAW. UNLESS REQUIRED BY LAW, NO COPYRIGHT HOLDER OR CONTRIBUTOR WILL\\nBE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL\\nDAMAGES ARISING IN ANY WAY OUT OF THE USE OF THE PACKAGE, EVEN IF\\nADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\\n\\n[End of LICENSE.txt]\\n\\n\\n\"\n        },\n        \"$:/plugins/rboue/SocialCalc/CHANGES.txt\": {\n            \"type\": \"text/plain\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/CHANGES.txt\",\n            \"text\": \"SocialCalc sources modification\\n-------------------------------\\n\\nAll modifications are under if(TiddlyWiki) test or identified with comments (\\\"*tiddlywiki*\\\" string).\\n\\nVersion 1.0.0 : 2015-02-01\\n  formula1.js :\\n    Modify Sheet Cache to handle sheet data in tiddlers.\\n  socialcalc-3.js :\\n    Add a callback to monitor commands.\\n    Replace images or icon's url by tiddler images.\\n    Modify link behaviour to handle specific TiddlyWiki URL's like <tw:a-tiddler-to-get>.\\n  socialcalcpopup.js :\\n    Replace images or icon's url by tiddler images.\\n  socialcalcspreadsheetcontrol.js and socialcalcviewer.js :\\n    Add a TiddlyWiki interface object.\\n    Adapt visual interface to tiddler's smallness.\\n    Replace images or icon's url by tiddler images.\\n    Add class attribute to essential DOM elements.\\n    Enhance events and keyboard management : switch between widget's sheet pages.\\n  socialcalctableeditor.js :\\n    Implement a copy functionnality (Ctrl-s).\\n    Enhance events and keyboard management : grid navigation without browser's interception and\\n    focus management.\\n    Replace images or icon's url by tiddler images.\\n  Other :\\n    Enhance graph visual and behaviour.\\n    Add an export to tiddler functionality.\\n\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/export.png\": {\n            \"type\": \"image/png\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/export.png\",\n            \"text\": \"iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAMAAABhEH5lAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAADeUExURf///ygoKHx8fDExMTAwMDQ0NCkpKTMzMy0tLSYmJnl5eTIyMv7+/vn5+eTk5Dg4ODs7O+zs7CwsLEZGRsrKyioqKkJCQvv7+/T09P39/XZ2dn5+fnp6evz8/ODg4BsbG2ZmZra2tjU1NcbGxsjIyCIiIsDAwF5eXsPDwzc3NzY2NmJiYmxsbHh4eObm5m9vby8vL+Xl5UFBQaamplBQUG1tbbCwsFtbW7m5ubKyspeXl9/f34uLi5WVlYmJiYiIiJ2dncHBwfb29vHx8Z6eniAgIJGRkVpaWiEhIa6urtMWpG0AAACnSURBVBjThY/lDsJAEISvdnvXQr3F3d3dHd7/hagAIW0C82ey32Y3Mwj9VDSMxHQkiPK5VOLrRuvKcsuibMaftdFkbKuKIgBQMeaS6ZBi0uc5TgKQaDKO0AIT+EggkEUnQwfgdcwwDC8AKVYROljAYXXW67CswZNm3fl0dpbLgReoXWmUXL9S8nglqZGy5/vL7R2uYPpu3nfBFkd7Eyq7XYfQao7+6gkNmwxuhUmepgAAAABJRU5ErkJggg==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-1x1.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-1x1.gif\",\n            \"text\": \"R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAEBMgA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-aligncenter.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-aligncenter.gif\",\n            \"text\": \"R0lGODlhFAAUAIABAP///////yH5BAEAAAEALAAAAAAUABQAAAIdjI+py+0PD5i02hnh3bkb62XbGD4jUJonlbbu+xYAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-alignleft.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-alignleft.gif\",\n            \"text\": \"R0lGODlhFAAUAIABAP///////yH5BAEAAAEALAAAAAAUABQAAAIdjI+py+0PowO02ktlw1jH7oXcCITLaEpklrbumxQAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-alignright.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-alignright.gif\",\n            \"text\": \"R0lGODlhFAAUAIABAP///////yH5BAEAAAEALAAAAAAUABQAAAIejI+py+0PEZi02hlzuFf7030KRwJiRp5OianuC2cFADs=\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-bordersoff.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-bordersoff.gif\",\n            \"text\": \"R0lGODlhFAAUAIABAP///////yH5BAEAAAEALAAAAAAUABQAAAIdjI+pywr4TjSz2YuzxrXDDYai6EnfiKZqUFLnGhYAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-borderson.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-borderson.gif\",\n            \"text\": \"R0lGODlhFAAUAIABAP///////yH5BAEAAAEALAAAAAAUABQAAAIwjI+pywoPowSIHmtw0Lz6+2XhNnbXhD7lCraiS8LmS8d1mrK3bvezz/vhUI2i8VgAADs=\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-chooserarrow.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-chooserarrow.gif\",\n            \"text\": \"R0lGODlhBQAKAMQCAAAAAP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAAIALAAAAAAFAAoAAAUTYCCMwieOn4mmYsq6rVqeAk2SIQA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-commentbg.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-commentbg.gif\",\n            \"text\": \"R0lGODlhBAAEAJECAP////8CAv///wAAACH5BAEAAAIALAAAAAAEAAQAAAIHRC4WkstQAAA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-copy.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-copy.gif\",\n            \"text\": \"R0lGODlhFAAUAIABAP///////yH5BAEAAAEALAAAAAAUABQAAAI4jI+pEOytopzwgIvzlWx26HyRiITaY4hksqbNiYIv1YIYa5U092quG9qNhIuer1b7LWAZivM5KQAAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-cursorinsertleft.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-cursorinsertleft.gif\",\n            \"text\": \"R0lGODlhBAAEAIAAAP///////yH5BAEAAAEALAAAAAAEAAQAAAIFRB6GelAAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-cursorinsertup.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-cursorinsertup.gif\",\n            \"text\": \"R0lGODlhBAAEAIAAAP///////yH5BAEAAAEALAAAAAAEAAQAAAIFRB6GelAAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-cut.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-cut.gif\",\n            \"text\": \"R0lGODlhFAAUAIABAP///////yH5BAEAAAEALAAAAAAUABQAAAIujI+pCNvL0oNnGkvDxHln1XBf+DmleUZip6VX5XolQFc15cloq4NwD7pphC5IAQA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-defaultcolor.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-defaultcolor.gif\",\n            \"text\": \"R0lGODlhBAAEAIAAAKampv///yH5BAEAAAEALAAAAAAEAAQAAAIFRB6GelAAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-deletecol.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-deletecol.gif\",\n            \"text\": \"R0lGODlhFAAUAIABAP///////yH5BAEAAAEALAAAAAAUABQAAAI2jI+pwHzwGjQzVFTz25Rbj3laR37lJabaaJrQxMbp2cHzt94ozbdyGer9fCCdRHRUKJfMZqAAADs=\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-delete.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-delete.gif\",\n            \"text\": \"R0lGODlhFAAUAIABAP///////yH5BAEAAAEALAAAAAAUABQAAAIrjI+pywrxIpyy2fTuXBmz3hmgNTYh5V0n550rUn6HO8uOrWq6xKOvDgwCCwA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-deleterow.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-deleterow.gif\",\n            \"text\": \"R0lGODlhFAAUAIABAP///////yH5BAEAAAEALAAAAAAUABQAAAIvjI+pwO3PDlDUTFvpDTtLCYWNR1ZbV05oonIf1mZxidX0LeYvfd6unQLlIL4iqQAAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-divider1.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-divider1.gif\",\n            \"text\": \"R0lGODlhAQAUAIAAAJmZmQAAACH5BAAAAAAALAAAAAABABQAAAIEhI+ZBQA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-drag-handles.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-drag-handles.gif\",\n            \"text\": \"R0lGODlhWgBaAOZ/AKjZiGt7raO2t1x1tVeY25nLkb6+vreolra2to7m88Wbe5CImPWuYXWnpj9vz6qqqu3t7UJ701OFuaSwsMyqhF+k377rfUqG1rHIkoLV7rbVi5j0993d3Z7T1czMzMXFxfuvXd/f37Ljg7Ozs8OpjZ3Z2rvlgqu1nUl1zZzd3uKtcqLAwdureN6lbmibrp/Ky5Oq2HK+596sd4q7mpjv8jVozHvM60Z4wmSr4eHh4evw+r/we9Ld9HGU28bU8d/n91iC1f///0x50q3C65Ww5WSL2LrL7n2d3vv7+8HBwa+vr6G56Imm4dvb27vG3djb4Ojo6MfHx9fX1/z8/NLS0vLy8uDg4GOI0uvr69TU1LjbiKK12uetb5zh5Jrp60BrxbGnnYnf8bTPjn+xoF6QszVny32Bozxvx2qz40p9v6/Al6aopk9wvdOgc9arfe6uaKimpLfZiLnehq6/l66+mYGCoaCOj62TiLCUh+WnaamwoKiuoeqpZzNmzKampv///yH5BAEAAH8ALAAAAABaAFoAAAf/gH+Cg4SFhoeIiYqLjI2Oj5CRkpOUkA9KCAZRVCEQSJWgoY9+pKWkIx9SWKKsrYOmsKRrBlkQrreUsbp+Dx9WU7jBjbvEBhyfwsmGxMxJOcrQgszMDx620cLT0whN2MHa02seVd6u4NpJUOWs59oIz+ug7dojHPGV89pK3feSNF5dSrxYMSEfLCX2+kHawLAhjRQvBBg8BU9hIwcRLhBAYyMBQxolVqwxiECdRUZ9UqqMQCCGxw0pVhhMQu6kIpU4U0bAkYFhB4nzPNi8mTPnzjAbvLyYt4bfUENFo16I4bPgOQTXnhKKGrVGBaQlgIITqnUrTgdcUxLomULstAcV/8viBKJjSdo+F2zAdNsMmdyUdH3UvZt3Qwmr2hL+pTtkiA4dQwj37HDOALC/PhrrYPLDyN0+BJAuBWel7B+VRDb/4OGgB5C7FZLy3fXBNM4eq+k+jsy1BlXK2h5kHXp2iIPVQnroQMv1AlKZ2rL8zamDSB8my5lHxQFz5DQD03Hy+LFEh+cf1qNG6Amd2ZpVT6MKMcLDuvIiabmXACdF6+c+PvDQxxHpGZUADbPFUlt8d9E1XnVcUTUaMyP4ddJn5W3WRw/4FUUATOAMZ5ETMFzBlQP4CfHDbkVFcCBixITwVA45PAEDCmnxoAMPR+ggRFF6tUcMFTPSmMMWOEZVnf9gyxWFxgYTEhNFkUbCwJUPPgBhRIE4fbjfd1TS+ISJRQkhWFoXbNCFO2HSaOV/LSalT5s5OAFnUQ5sQENwNgXh559GGsnBROH0iVMQgdI4KKHErEHIA9owAMIXd+bkRKI5BHEojXZWqtIZO1jA5yBKaPMGCGx4qhIMmGqqEqI5vKlqGjuYMOcgCGjDBQgB5FREh3dd8USirqaE6JiqpiTBDnKwOYgB2sgAQh049QjZf6wG+iegshYFhA/a5eTCDhpoA94gUWhDAQh2qMQEdj32kBKwOaGwBaaBIsmVbqxFNcYOGGgz5SBUaEMCCAqkdJ95RqQIYVQowDBsojYmGZX/A0So2G9OBexAhzZEDhKCNmAwwEeqffAQoA44CfYjV1fAcGmdJe4LrkoaO3CESjeIYIEe2sg4CATgqACCGSnNp8POKTkm7380NvjYxn2ouOJrfYyrRYiEIDGCuiDgwZXTd0adFsY5q1Te033MADA9Fv7xgTYHMJDHADgRwYMROrCdUrg5mf1Zzjv3rVIaPp+gzYKESAEOCyAskJNgTPdRBBPlAa4SBxxciXXSP1ydUwPk8mcIFt4xc3AbKKuEpUqM+Z0TKRdvFu7aOd0AwA5zaPPeIdBOA4fRkp/1Odlp0R6Vg9oZPvoOcaReDCJZgHNwC3j7urfzPTxNr/KA1dcH/xFLrIYiVxLsrgY40h0CAaTaQH5HGUVRXvWKkKUGLPh9mFe51SwrSg3cVq7giIgQc6PbqYo3ucjwgDXKWRpO+KeDIhjhc7grCulMoLjFKcIK51hXC3pVOyb0wTGVSwn/+Ea1IcguJWTYXcBIo4gpBE8bbkBY9oqyGr7tjEMqWeFjPoe+jomhMpdJxKJIJi0F7PAslFMRi/rAvyKYSQdEzIkEOqaBPZxDMYlAQhLOcQCjOZEr8tIRj3xERT9ExQc/KOIOtNBBdMQNETmAH93MSEIlEYFJaOEfTuilEjJ0jI7ngMsjPNCOA0irBQugX/2ytCUVuhFONWjA7jRQR22Qxf8REMjVOcCQQxDc4YlJO1MQL/kZCbhtB2Lw4lUOuIgmSE9dp4Jk67giyKLcQJO1muE5mjIJRs7jAJADQRsWgMoJsrIoaQAmuTo5FkpUYYz5IIHRQJAHPJhhl5b0pQtmIIIdQG99+aBJJaAgynnAgQQskBQI+KAAO9QhAGz4AinOkAYJuGAMBShnqDQwh1uCoyShyMHXJnIACqhAniCIKAhIYc6KhkoLGKBmO0YQl0pwoFSMAgMJKCADLryBAaSwgAnkoAEM0AFojEKIK5oAUkbZFBz7wAUHFnrTnuqiHsLIQTt9StR3KAMK2CRqT9MRjSp4wKBKbYc4aoKNJgw1qldicUo5IOABPWKVGtawSA6S+lVdOGMoSODADctKCmPc0SJTsMIHvErUXvzCNISAQBYMANV8zKIWeE0EFqTwAZ5uNBXwCSwjkACBEFAhCgZAgBIesIY1XCITm+jEWxXL2c4qJBAAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-drag-handles.png\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-drag-handles.png\",\n            \"text\": \"iVBORw0KGgoAAAANSUhEUgAAAFoAAABaCAYAAAA4qEECAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAEERJREFUeNrsXQl0FPUZ/3KwySYbls19kUBCQkgACSDIHSqxog+qVvQpvr5qQX1ate3rq0dtLdWi9vVS1KdCra9VVLTUgoo1KDGiHObAADEkJCQhm829SfZI2Fyd32QmnSyz1z+zm6P53vveJrMzs//9zTe//3ftf/wGBwdpSrwv/lMQ+EYCxT/8/Pwm2ti3cNrLqY3THk6tnFo4NXHaJWjfWA9SZIzACW4kUDWnWpn3AbiR0zZOWwUde4uehBImaBIMi9NmTps4bRTAnwLaCwJejBF0HqcNnOo5ree0fwpo78g0TpMFNXBaJ2jfFNDekzhBEzmtEQCfAtqLksBpLKfRnFZz2j7lR3tPAjhN43QZp3OmgPa+6DhdyukSwWuZAtrLXko6p9mCpzIFtA+4O1vwxaeA9gGVXMFp6hTQ3hcNpwtGM0n6iUmPiZZUeqG909Jnu2S6ZLYYrR3Glo6Ghsamyor68vwjdacOHmzy0sd2c3qa0yp3DxjGd6IC/bK5WzaR3mezWToNhgpD+bflZ/Pyyo68/FKVwh9t5vQbd4MbRYFWuniw9J4il/sEqQMGgzUBFKqdRmERKpoRrSJdXDBFJgaTWhMogm5tqa4qOf/ll8Xv73ii0NLe3qvQEJEVLKGhJNXEAtodcO0/Vm5jWLiKYlNCKD4tlBI4DZ0xjd/ecqG66Fx+/ldvPHD/MYXA1gtgmyYE0AwAOwVaKuGchSdnhdGshWGcpasxzgH9mdMFJ95+Kz/vub9UKAA2zlE0roEeBcBuAz1s5Ry1zFmspTlLtBzFBJG1o6P+3Of5h3f/4I68gf7+wVGOoZDT8+MSaAVA9ghoUaKT1ZRxlY7mLtfx/1/4+utDB5/67aGyTw+PpvoCvj5JDhJRYwK0QgAzA81/T38/ylodzuv0SBVxLuGxw7ueP/DFa3+tHcVYKgXLHnugFQZZFmiNOoDM3e4VTMDdC9dH8hNnW21tyacvvrD/s5deYHUF8aHH5Vw+ERufRIZeAPkySeMmu/d2ZNGD3090a//asyY6+UETXfzWTBHJydlX3//jm9bc9aNkxo9HinUWOcnv+08WkHc9mEaV9d103fJwt8FuqrFS0cfNw2BveODBzZlXb4gcRQIqaUyA9iXIBaWdZGi38dsA9mN3uGecLRe7qSSvhRqrrRSTlr5i0+O/3ugfEMDKo0mCdfsOaF+ADHnwpkQeZMjahVp67SMDz9Nh6gC3zwHLLj3SSl2tNpp95ZUbt//9jVzG4Yj1R99Th7flgecrqZGzZBHkW9ZHk8naT797o5bfBot3l7PPHh3y0Oauy9mQ+9BP0kdBIZd7O97wOnxkzSM+FKCCmwHyzjdreToRBRa/8w3X3htcvzVb4ng/u/50af5TK5a/yjAu5FOOkNCk4zWvw1eUYS/FlWZeYeFPb08hQ5uN7ny2nAcYF0HjBpUMDgxS+XEjdTRfooT5C9besevFFQxDQXIldtJRhyjgZYCKV4D6xelOHuzYcNUIP9uVNNd20/miTtzh/nNzclaGhodPYxhOjFeBHitrthcALLp5d10XRyWcpeMCvP5IBv+/Kzlf3EmtnKsYNTtlyQ1P7FjKMAT0h0ROSouWymN7qnmfOnuOhvblt9Cju6uH6aOk0uTyeBN3oWpKh/abs2rVYpZI3x7owMlmzaJFA1ypbMmJ5rfDumHtsRFBvJfizAuZt1JHUSmp2evvvS+VoVITMektWi6oEd08d8P0dkMP6SstFKhShWTl5mYyfKxOasj/F0BvXD5kXHERKtp3pJmu/UUpna+3UnaaxulxDZWWoeMy5mUwfCy6nKYrSh1jQRuddV/eEKybvXSaWrfWP1C91tm+oIgvSjt42gDYsGrRA3HmYyMs7zb3kTYuLn3Rpk0xDNV1AN0+oS36/McPlZx5a/Pu6sOP3mszG57y9x9odOb6AWTIzm0pPMjg6+f/Wc9PkgBfdlLkIs7W+h7QR2hGzvokRqueHNTRWXfUcnrvpt2W1gvPOAN7OBkB+uA8EYAvcjWiSUdiNPQMOcZp6YkMwwuddBxd9t6t/+rpatrjaj/R7Xt+fz1v5SLojqSjeSgjOCM+PpZhWCGTcjKsO/rs3oG+7gJn+yAPAkEuBC6gMxdP9Kl5xGboohiGFKy4Hz1eaKS321gQFOZ4cgQ3Ix/irlg6h3pugjShOoYhqSate9djvFCo6PnMQ7QSqApiaUofzpMokiZdcnehz4AsfGWJbCWYG7+jkgr8uKvG6Lpz8A6+PWGpw95v58Af92OWAr3FU+At727dowr0D8k9fIlMvUGKBiPwk2XffMV5a8Oca5/L1iatel+psajVvfTkjg+oz9ZvzY1+ZpuHh/fLcbTHnZaXevv5FJdOZVX06iPiG4tj5USjucS/2mz9JobDe+WAtnl6FnNPH9qhKCrYIvs+cgmu8gmyMwgXVmuTVod6ehyOwbFKAq2d3s2/dpttRobDbXLUgRBI68lZOsy2ljidOiNB3UlFdsVfaX+FuzW74asfqF6btPrh20/vPbrbwYQoexyOcZX3gCCTh+o5/GhXnU3hEUN3q7mjp4XFaZGzaI/vf327lQ95kzUj+/tuyYkaTtqI+QSo1NJdhlSayG2ZN79zo5x3IafYN3h61DZ3QEawIr66Km9FRw0xRovB1MgAtFUOaIunZ6nQd2F1AErV/G9VBgCKclGlfuiWW7NwBh/qmgTLQa4BxVNXJaU+mhYbFp70yILbD253RiN4D/uERiY/MjAQ6DJMRsCCsBuF27CQAJdgx8Z28a8XK9vqGYC2yAHtMdl/Vmqos/UNWOZqWyhe3TVME/gyd22M419hvbhFxewZtiHfAKt3lDWTgq3SxD2esuHpl+ffdmA7PAqpd4FteA/7OANZar2gCoTdYoQoBRt0N4I2wq2UmNABj8NS/HkNyw/yTXJAd3l6ln+fuNhkaLdWwOtYFK4f3o6aHb4QgAR1SAWtWvji4GxDm81tzg4Ki39c6rbhb2xzxcnOqEIKNgq3mFOkDTcps1t5r6O10Vxx9MNzLL/06nIEtMdWXXaxs5yPDiPqR3wBWDEqGR+daB8BMqgFIIttXN4WV1SB9zEWbMO4cLeJkpo6NP/VlreUM1qzLNBYGMRjF+Y/JQ1lHH1Yr4yoo9SwyxvnwcV/eziD52VnIGs86JXzyAV1gyrwaj+uOI6b09Na+EDl5KfVZQwfbSTJYiv2SSWP1xp68cPyqiqDqSQ62Exroqsve19sOgRXg0akXwbbwNW4ZaXlJRcSQA46NqUi0oVc5s6eKnDn2V/8rCwDabXdpK82lux/5WuWBvURWNoDDZP0+CcLR8uaivGaE1NFCSGXWyu+HG5JsUgqtTZYvHjbutmtf5WrJBHOBwCR4Le/eM6oQpSIcAvNz2rg/y49VlfMkkwiu1XJ5IBu9vSsv3rzVGF1o6koQ9tM18Sdk90HnI2qhlTQa8FfqNIORTkbFwwXFxdRzn2To4oREW12PSUmdlDDBWPRnifzWVKTza6Ahng8u7aZLvUeOd341eAgDVybUE7zZzTKfnm+jMTRhSPOZglspN4Fziv65/DfMRFLOVk8nxxViJKc1E6Lsy8SvktxQc1XXe3dLL+2bXKWvRMFKGHJMo+a++596fixK9MiFyycRTmbZ56hss4YGhi8PMct9sFJORtuoNTyVnPb0PMM/pb64K44Gfs1tl0anhsg7+Y38++Bk3F+gOzQjfQfpOXLaig62kRVZ5oK/vjQRyy/su0VMCRXFg0Sb2C5Zd/8vDrfaLbVb048S1uSv3G4n8jZi9KGihZoAUAl+uYnzg632QJkXAh3QBZlHwcqLFk6CdpzsjNZtbKali2rJVNHT33eO2fyGZmrQc6pcFTK0rN8wp/eL6vgKOQwz78c0HJeiBRsfHEAAIs+dKKNt/TVHFBijkTqg7sSXBDQEdp07QMhEWRn80BWpoFWrRpyLkoKag6/s+s460+YZbFzBDRmLQPLp9z+h4K8kxWthxJDOmhrSjEt0BlcTlxQeCQib4sg429P06y4aPahvSuQZyW3U866SoqMsNC3hfpDO+7cn8caHwnYuQ00/Cymxfb6BwYHf/PWN4cq9F3HFun0dGfqSZqndT6//vCZ8hG8XXLezPvViCQBvju/sAJtIPoDJcn50I5kZqKRrr76HM2e3YbE0bHXdhYcGuhnXkWgjhwswenv4iAmCsk71dD65wNlB2qbzSUro2poe9pxp5YtumOwPFiyJ21bUuoQAxKAjQvkSmDJ11xTTvMyGqmxrrNk34snDhR+Vt06CspwaJyBTpNnQ8tIxroTidnLnk8qa9WqgP0PbZpHK6NrskMCe+nN6sX0RbNjAMTbW2zbQsDhTtuWHP+7ohxwMugClgyQ33vp5P4PXi9h/T14v4BVHwvQolUjqkhj+fRdH5RXddv69/10c2bPogRaETnPQvEhXfRu7RWyrp8o0rYtpFuR23b3N95SC3fkwsG7wMQHTgZdwJJHATKk2hXVutPXgcwLlpHUsY4id1F85G9uu2LjsvTIjfj/QH0WHbg4n850xDqc0B7bmjych5BK0atLb+ezhXcX7vV0HAhG4CfDhYNg4gMnj4IuxOSRYstIYBkyVJeZu2wC/P389v58be76BbEbdBpVYq1FRx/rM+gTw1zSW90vVbIAjdwFwmpEfAhG4CfDhYN3MYqJT8xpuLUwirt9HDgR0GD9NSnvjdz6+88/+dkNmTVb16XkLEimtfekH/NfF1NF+U2pPHdXmSJJSUGqE1k4JIiQu0BYjYgPwcgo/OQRLOcMZE+pQxSEcSglJSgBwsv3XbWCs+6VKbFhfEm7uUdDX7clUVFbIp1qT6CG7ulMFo3yEyojSNojn4xUJx+uXTAWIXfBGFY78jLcXrzKk84knBCpuZDR8LU0NxIRFlT45NZFS1dnxixOjRvIvj6hLIRTMtpC6FxnFFWZI6jWHE76bi219ITy20VBBxHKTOi7QEsAqtUopKLGJza9IGlfW24sQaoTWTjGBJEjXj5HHlSkWJoc8RMDrNWpUfI2v//6jNTvZsdnZs7UZsSFh6SrAv1lK9/TbvwHb9FHOn4pa9EopKLGh/ITKiOMSXunwSwxLDDI0uRYJ2T2sFanWqnRo1ID5f48+L3lM2O+szAuKT1hemJCeEjsDI0qShMcqAuaFhAmAdSKNi10EKG5BX0XaAlAtZqxkOqOgIfKWKLm0bTtwhOZryTY41wA8hl3Jz8lLFrqieAsmUrTyDgUs2DJzDSkRCN6kgC2bpKCbGSlC5aAxZVg2YS5Srl+40j0gnfBzPlKPysLAxEfCpY2mghynMigEIxUEENTkbeoQ26SnDOBqcQozD/nFbliXl6oG4moFEEDJgjA/UIWTtEH3vhqRXRMlLMmAHeDi2vIC49w8uXS84EC4NC4cQaw1x9KNhZr/INCEgXrjicP+0YUFOQ7fPaYvbF+mAKa8GIFtzDaB17KmD04cjw9tSJS0AjBU1Hq+VTj4lGo4/XxIODz6YICcGTwkBvFKgEqgW4CJF7ChHm4r9/Uc8F9I1OPcPKR/FeAAQBhzQayRWqS/QAAAABJRU5ErkJggg==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-endcap-h.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-endcap-h.gif\",\n            \"text\": \"R0lGODlhFAAUAPcAAAAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnZ6enp+fn6CgoKGhoaKioqOjo6SkpKWlpaampqenp6ioqKmpqaqqqqurq6ysrK2tra6urq+vr7CwsLGxsbKysrOzs7S0tLW1tba2tre3t7i4uLm5ubq6uru7u7y8vL29vb6+vr+/v8DAwMHBwcLCwsPDw8TExMXFxcbGxsfHx8jIyMnJycrKysvLy8zMzM3Nzc7Ozs/Pz9DQ0NHR0dLS0tPT09TU1NXV1dbW1tfX19jY2NnZ2dra2tvb29zc3N3d3d7e3t/f3+Dg4OHh4eLi4uPj4+Tk5OXl5ebm5ufn5+jo6Onp6erq6uvr6+zs7O3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09PX19fb29vf39/j4+Pn5+fr6+vv7+/z8/P39/f7+/v///ywAAAAAFAAUAAAITwBNmSo1UGCpgwILEiQ48J/DhxAjQiwlsaJEihYz/jOlMSPGjhdBVuQoMiLJkg9Poty48uHHlS9RqkQZs+RMmy0d1hR5U+RCgwMZLmQYNCAAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-endcap-v.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-endcap-v.gif\",\n            \"text\": \"R0lGODlhFAAUAPcAAAAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnZ6enp+fn6CgoKGhoaKioqOjo6SkpKWlpaampqenp6ioqKmpqaqqqqurq6ysrK2tra6urq+vr7CwsLGxsbKysrOzs7S0tLW1tba2tre3t7i4uLm5ubq6uru7u7y8vL29vb6+vr+/v8DAwMHBwcLCwsPDw8TExMXFxcbGxsfHx8jIyMnJycrKysvLy8zMzM3Nzc7Ozs/Pz9DQ0NHR0dLS0tPT09TU1NXV1dbW1tfX19jY2NnZ2dra2tvb29zc3N3d3d7e3t/f3+Dg4OHh4eLi4uPj4+Tk5OXl5ebm5ufn5+jo6Onp6erq6uvr6+zs7O3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09PX19fb29vf39/j4+Pn5+fr6+vv7+/z8/P39/f7+/v///ywAAAAAFAAUAAAISgD/CRxIsGDBUqVMmUq4EKHChg8TljJI8aCpihj/KcxYESFHihs/WhRZcCFJgiZPCkyocuXFliFVeoT5UmVKmzVPsmy50+ZEngEBADs=\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-filldown.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-filldown.gif\",\n            \"text\": \"R0lGODlhFAAUAIABAP///////yH5BAEAAAEALAAAAAAUABQAAAJAjI+pAe3vDECTplola2xPbEUfBx6ZZnUmxJaoeb3dN9eqfKPnmat7C5HxhkKdMUdM/YARZEyZgoU4uCRvgTUUAAA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-fillright.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-fillright.gif\",\n            \"text\": \"R0lGODlhFAAUAIABAP///////yH5BAEAAAEALAAAAAAUABQAAAI7jI+pwO3fDEDz1HAlnlx7u2GUmJFddZXZClLQ63xiO4MM+akh2413n0qwaCqYUYFMKpMpI2zJhEqnigIAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-formuladialog.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-formuladialog.gif\",\n            \"text\": \"R0lGODlhEgAMAIAAAAQEBP///yH5BAEAAAEALAAAAAASAAwAAAIjjI+pAb3rwJEMUnNrcljlxmXdBI6IyGnndomqlKpyuZnPbRQAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-hidecol.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-hidecol.gif\",\n            \"text\": \"R0lGODlhFAAUAIABAP///wAAACH5BAEAAAEALAAAAAAUABQAAAIyjI+pwHzwGjQzVFTz25Rbj3laR37lJaanaiZj+8YgK6+2S+d3eNfw3JOIhIqi8YgMFAAAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-hiderow.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-hiderow.gif\",\n            \"text\": \"R0lGODlhFAAUAIABAP///wAAACH5BAEAAAEALAAAAAAUABQAAAIrjI+pwO3PDlDUTFvpDTtLCYWNR5bm+U0qx64dCsekSH/n9no4itOhDEwUAAA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-insertcol.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-insertcol.gif\",\n            \"text\": \"R0lGODlhFAAUAIABAP///////yH5BAEAAAEALAAAAAAUABQAAAI7jI+pwGz9GjjzxVpD3td6TXXgx2nOiJZQGnpryZpYG7+0esL4TFKSdAv9YrVcsIckInS05Q24gCqm0wIAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-insertrow.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-insertrow.gif\",\n            \"text\": \"R0lGODlhFAAUAIABAP///////yH5BAEAAAEALAAAAAAUABQAAAItjI+pwO3fDFD0zHDrkppeCD6dNVaMF4pJCq1sVCJnLJtvi9Fcrn86f8P9hooCADs=\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-less-hd.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-less-hd.gif\",\n            \"text\": \"R0lGODlhFAAUAPcAAAAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnZ6enp+fn6CgoKGhoaKioqOjo6SkpKWlpaampqenp6ioqKmpqaqqqqurq6ysrK2tra6urq+vr7CwsLGxsbKysrOzs7S0tLW1tba2tre3t7i4uLm5ubq6uru7u7y8vL29vb6+vr+/v8DAwMHBwcLCwsPDw8TExMXFxcbGxsfHx8jIyMnJycrKysvLy8zMzM3Nzc7Ozs/Pz9DQ0NHR0dLS0tPT09TU1NXV1dbW1tfX19jY2NnZ2dra2tvb29zc3N3d3d7e3t/f3+Dg4OHh4eLi4uPj4+Tk5OXl5ebm5ufn5+jo6Onp6erq6uvr6+zs7O3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09PX19fb29vf39/j4+Pn5+fr6+vv7+/z8/P39/f7+/v///ywAAAAAFAAUAAAIjABNmSpFcCDBgqUEJhQ4ENu1a9gcRpwIUSJEgeHCiROnMSPHjR01iiP4r6TJkyhNJkyJkkzKlSxLkimTcmDMf2Vy1iwVM6dOlDBR+vx5kmTLoTSB8hSK9KUpljNzukRpE6rPmk97ElWZNeZMpzdl7gwbkyDHjGg/nvWYUeBEiW8rRqx48KBChQsNHgwIADs=\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-less-hh.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-less-hh.gif\",\n            \"text\": \"R0lGODlhFAAUAKIAANfX1+Li4uHh4djY2KWlpaampv///wAAACH5BAAAAAAALAAAAAAUABQAAANWSFRb3C6qOEC9I+s9XBBg8IljKHyMoa5suypuS7hOvNYtHkd0YS8w2cwF8cmMLMiiR5voXkgWg3f8TZi2Kda6zXZtzRMJRP6UQQqNpbLmaCTTOHyiSAAAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-less-hn.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-less-hn.gif\",\n            \"text\": \"R0lGODlhFAAUAPcAAAAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnZ6enp+fn6CgoKGhoaKioqOjo6SkpKWlpaampqenp6ioqKmpqaqqqqurq6ysrK2tra6urq+vr7CwsLGxsbKysrOzs7S0tLW1tba2tre3t7i4uLm5ubq6uru7u7y8vL29vb6+vr+/v8DAwMHBwcLCwsPDw8TExMXFxcbGxsfHx8jIyMnJycrKysvLy8zMzM3Nzc7Ozs/Pz9DQ0NHR0dLS0tPT09TU1NXV1dbW1tfX19jY2NnZ2dra2tvb29zc3N3d3d7e3t/f3+Dg4OHh4eLi4uPj4+Tk5OXl5ebm5ufn5+jo6Onp6erq6uvr6+zs7O3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09PX19fb29vf39/j4+Pn5+fr6+vv7+/z8/P39/f7+/v///ywAAAAAFAAUAAAIiQBNlRpYypRBgQUPFiRoCptDh9ciPpSI7VpFg+HEhcvIcaPHjRrDCVxHsqTJkyULojxZqqQ6kgNXpmzJkubKhChjrhRoMKepmwpRjqzJ0+ZMoUV/slR6kmfPpTIXMp35cudTk0NlXi25dSdSmWDXDQSZMWTZsiHFDXzItm3FiQYHxkW4kCFCUwEBADs=\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-less-vd.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-less-vd.gif\",\n            \"text\": \"R0lGODlhFAAUAPcAAAAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnZ6enp+fn6CgoKGhoaKioqOjo6SkpKWlpaampqenp6ioqKmpqaqqqqurq6ysrK2tra6urq+vr7CwsLGxsbKysrOzs7S0tLW1tba2tre3t7i4uLm5ubq6uru7u7y8vL29vb6+vr+/v8DAwMHBwcLCwsPDw8TExMXFxcbGxsfHx8jIyMnJycrKysvLy8zMzM3Nzc7Ozs/Pz9DQ0NHR0dLS0tPT09TU1NXV1dbW1tfX19jY2NnZ2dra2tvb29zc3N3d3d7e3t/f3+Dg4OHh4eLi4uPj4+Tk5OXl5ebm5ufn5+jo6Onp6erq6uvr6+zs7O3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09PX19fb29vf39/j4+Pn5+fr6+vv7+/z8/P39/f7+/v///ywAAAAAFAAUAAAIjQBLlTJFcKDBgaYECixoClu4fxAjSpQYDltCbOImaowoDttAjBs3ViR47WHIiRU/mjwZcWTDjCw5WizlUGOZMhpH0oQZ8eZNlB5fSvTpU2JHlRHJkCG6lOO1iyaXLi0jVSnElA0fMiVatCPBmjGvBgUbVifIsP+8CkUb7hpStF5prozpMiFCgnYXKiwYEAA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-less-vh.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-less-vh.gif\",\n            \"text\": \"R0lGODlhFAAUAKIAANfX1+Hh4eLi4tjY2KWlpaampv///wAAACH5BAAAAAAALAAAAAAUABQAAANjWErFvY0wR4YwOGstgATXJmIBoADBOAoDA6oiywwprAVD89oZ29AiRqxVAGoehQ1OV8MgJZxWJWR4OBQ9UzEUUUSEBlkBVfVOzkmxhdfLTdkk0xuubvJ8W7hhmafnvFZPV2cJADs=\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-less-vn.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-less-vn.gif\",\n            \"text\": \"R0lGODlhFAAUAPcAAAAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnZ6enp+fn6CgoKGhoaKioqOjo6SkpKWlpaampqenp6ioqKmpqaqqqqurq6ysrK2tra6urq+vr7CwsLGxsbKysrOzs7S0tLW1tba2tre3t7i4uLm5ubq6uru7u7y8vL29vb6+vr+/v8DAwMHBwcLCwsPDw8TExMXFxcbGxsfHx8jIyMnJycrKysvLy8zMzM3Nzc7Ozs/Pz9DQ0NHR0dLS0tPT09TU1NXV1dbW1tfX19jY2NnZ2dra2tvb29zc3N3d3d7e3t/f3+Dg4OHh4eLi4uPj4+Tk5OXl5ebm5ufn5+jo6Onp6erq6uvr6+zs7O3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09PX19fb29vf39/j4+Pn5+fr6+vv7+/z8/P39/f7+/v///ywAAAAAFAAUAAAIlQBLCTRVypRBgQMJFjxYCpu4dRAjRlQnMRw2gg4hUpTIcZ1FgdjCdRzpEVvBjCQ5WsQoMqVEcSZNoXQJEWbBaw85Cuy4UmbLiApLbax5UWZOiAQNEqxYNOQ6igcVGoxo0yjEhVGTQuyZMSlCr0thGpw5dOTHhkdp2iyFk2ZErj9TUhRrqq3bdXSd3l2JsK/UggMBlwoIADs=\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-linkdialog.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-linkdialog.gif\",\n            \"text\": \"R0lGODlhEgAMAIAAAAQEBP///yH5BAEAAAEALAAAAAASAAwAAAIejI+py+0BYkRyGpAwzPcdDVZit3ml9pHpVVGtCTsFADs=\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-linkout.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-linkout.gif\",\n            \"text\": \"R0lGODlhFAALANUCAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAAIALAAAAAAUAAsAAAYwQIEQQCwajcLhkRhoOpGCZdHZREqN1KuUGtAen1UvMwzoip/aKJYsVU7N6aS4mAwCADs=\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-lockbg.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-lockbg.gif\",\n            \"text\": \"R0lGODlhBAAEAJECAP////8CAv///wAAACH5BAEAAAIALAAAAAAEAAQAAAIHRC4WkstQAAA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-lock.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-lock.gif\",\n            \"text\": \"R0lGODlhDQAUAMIGAGFhYbm5ucLCwt3d3fHx8f39/QAAAAAAACH5BAEKAAcALAAAAAANABQAAAMqeLrc/jDKuYq1DyvNSvNfKFYdYZ6mRkTgunFtJx/uNtcHaOfse/0cCiUBADs=\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-logo.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-logo.gif\",\n            \"text\": \"R0lGODlhEAAQANU5AJeXl5qamufn55ubm/X19dbW1q2trYGBgYyMjLe3t8PDw+Dg4IuLi4aGhllZWdvb28LCwmVlZWZmZm1tbW9vb66urubm5sXFxYeHh25ublpaWmlpadra2qKiooCAgGpqanh4eJCQkOvr68zMzHNzc5GRkcfHx9zc3MbGxqSkpGNjY1JSUqysrPT09PLy8vPz89DQ0HZ2dnd3d7i4uM/Pz2BgYKGhoVFRUVBQUP///wAAAAAAAAAAAAAAAAAAAAAAACH5BAEAADkALAAAAAAQABAAAAbEwJyL5prJYghGLDYbWnICBw4HcIk2tZELMHU8bLewLVeo1QI52hRng61nuUGDNCA8cOHZ7HAAqDIQOTkEERMAHgczMS9QeDaPYDgtOS9HBAsDJXCCaR0BBQsyIB81KTQ0nIIwCWYUEmYhNDCpOTAVZhEyARgYF7OpKAMGRjKMCysajIITNwSUMjMINgo3OAYwNBfVCjYMMxzVbCYNCQYBJyx4N9xTN2MQZhVpazYW4QgvZTUJW+2oAjZoKJLhKgY0gKiCAAA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-main-h.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-main-h.gif\",\n            \"text\": \"R0lGODlhCgAUAPcAAAAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnZ6enp+fn6CgoKGhoaKioqOjo6SkpKWlpaampqenp6ioqKmpqaqqqqurq6ysrK2tra6urq+vr7CwsLGxsbKysrOzs7S0tLW1tba2tre3t7i4uLm5ubq6uru7u7y8vL29vb6+vr+/v8DAwMHBwcLCwsPDw8TExMXFxcbGxsfHx8jIyMnJycrKysvLy8zMzM3Nzc7Ozs/Pz9DQ0NHR0dLS0tPT09TU1NXV1dbW1tfX19jY2NnZ2dra2tvb29zc3N3d3d7e3t/f3+Dg4OHh4eLi4uPj4+Tk5OXl5ebm5ufn5+jo6Onp6erq6uvr6+zs7O3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09PX19fb29vf39/j4+Pn5+fr6+vv7+/z8/P39/f7+/v///ywAAAAACgAUAAAIKgBVuXoFi5UqVaxeufrHsKHDhxAjSpxIsaLFixgzatzIcWKpj6ZKhRwZEAA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-main-v.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-main-v.gif\",\n            \"text\": \"R0lGODlhFAAKAPcAAAAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnZ6enp+fn6CgoKGhoaKioqOjo6SkpKWlpaampqenp6ioqKmpqaqqqqurq6ysrK2tra6urq+vr7CwsLGxsbKysrOzs7S0tLW1tba2tre3t7i4uLm5ubq6uru7u7y8vL29vb6+vr+/v8DAwMHBwcLCwsPDw8TExMXFxcbGxsfHx8jIyMnJycrKysvLy8zMzM3Nzc7Ozs/Pz9DQ0NHR0dLS0tPT09TU1NXV1dbW1tfX19jY2NnZ2dra2tvb29zc3N3d3d7e3t/f3+Dg4OHh4eLi4uPj4+Tk5OXl5ebm5ufn5+jo6Onp6erq6uvr6+zs7O3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09PX19fb29vf39/j4+Pn5+fr6+vv7+/z8/P39/f7+/v///ywAAAAAFAAKAAAINABN/RtIsKBBgqoEHlxY0FUphhD/vVIY8SAsihULssKYcaCqhx0LpgIZcuAqkiVdcez4KiAAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-merge.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-merge.gif\",\n            \"text\": \"R0lGODlhFAAUAIABAP///////yH5BAEAAAEALAAAAAAUABQAAAIxjI+pywoBnpQQvobRNbueDmpiRkbmiUZjuWYh6XFwbKV2NzvtK3973phUVEIc8IgoAAA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-more-hd.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-more-hd.gif\",\n            \"text\": \"R0lGODlhFAAUAPcAAAAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnZ6enp+fn6CgoKGhoaKioqOjo6SkpKWlpaampqenp6ioqKmpqaqqqqurq6ysrK2tra6urq+vr7CwsLGxsbKysrOzs7S0tLW1tba2tre3t7i4uLm5ubq6uru7u7y8vL29vb6+vr+/v8DAwMHBwcLCwsPDw8TExMXFxcbGxsfHx8jIyMnJycrKysvLy8zMzM3Nzc7Ozs/Pz9DQ0NHR0dLS0tPT09TU1NXV1dbW1tfX19jY2NnZ2dra2tvb29zc3N3d3d7e3t/f3+Dg4OHh4eLi4uPj4+Tk5OXl5ebm5ufn5+jo6Onp6erq6uvr6+zs7O3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09PX19fb29vf39/j4+Pn5+fr6+vv7+/z8/P39/f7+/v///ywAAAAAFAAUAAAIjgBNlRJoqmCpgQUFIkRoCts1bA4hSpzo8OFBceEyZsQoriNHjBkL/htJsqRJkiJNljlpUuDJMmRYkhz4ssxKmTRVkrEp06VKmzxPpiy5E+jNkjlL2ty5U6ipk0ybCi0FFSjOpz+POq0pc+RQkjG7/jsotqcpjRo7hgOZNuPAiBCvPYw4d+JBgwwXKiQoMCAAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-more-hh.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-more-hh.gif\",\n            \"text\": \"R0lGODlhFAAUAPcAAAAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnZ6enp+fn6CgoKGhoaKioqOjo6SkpKWlpaampqenp6ioqKmpqaqqqqurq6ysrK2tra6urq+vr7CwsLGxsbKysrOzs7S0tLW1tba2tre3t7i4uLm5ubq6uru7u7y8vL29vb6+vr+/v8DAwMHBwcLCwsPDw8TExMXFxcbGxsfHx8jIyMnJycrKysvLy8zMzM3Nzc7Ozs/Pz9DQ0NHR0dLS0tPT09TU1NXV1dbW1tfX19jY2NnZ2dra2tvb29zc3N3d3d7e3t/f3+Dg4OHh4eLi4uPj4+Tk5OXl5ebm5ufn5+jo6Onp6erq6uvr6+zs7O3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09PX19fb29vf39/j4+Pn5+fr6+vv7+/z8/P39/f7+/v///ywAAAAAFAAUAAAIhQBLmRo4sJRAggYFHjR47Rq2hw8bQnQIEdvAcOIyhtuIcaPGjuEE/htJsqRJkqZKnVR5sqRIky9b/jN4kqDMmSxdKpQ5sGbKnitNBUXoM+jCojBTxiwJVGdTk09HKr25dGTVpDVvWs2pFaopjxnFeewYFqO4gRXTVpSI7dpPgnALJkRYKiAAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-more-hn.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-more-hn.gif\",\n            \"text\": \"R0lGODlhFAAUAPcAAAAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnZ6enp+fn6CgoKGhoaKioqOjo6SkpKWlpaampqenp6ioqKmpqaqqqqurq6ysrK2tra6urq+vr7CwsLGxsbKysrOzs7S0tLW1tba2tre3t7i4uLm5ubq6uru7u7y8vL29vb6+vr+/v8DAwMHBwcLCwsPDw8TExMXFxcbGxsfHx8jIyMnJycrKysvLy8zMzM3Nzc7Ozs/Pz9DQ0NHR0dLS0tPT09TU1NXV1dbW1tfX19jY2NnZ2dra2tvb29zc3N3d3d7e3t/f3+Dg4OHh4eLi4uPj4+Tk5OXl5ebm5ufn5+jo6Onp6erq6uvr6+zs7O3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09PX19fb29vf39/j4+Pn5+fr6+vv7+/z8/P39/f7+/v///ywAAAAAFAAUAAAIiQBLCSxlimBBggNNHUSIraHDaw6xQYyIrWA4ceIuYrwYTqNHcQrXiRSpbqTJkwRPriul8mRBlS9HljQZ0mXMlilRCjTVct3NkQWDtqwp86BCni5Z6jQKEylNhTltNiWaVOXOnj6V0tSK0ylQrCKpgn2qEWPGjmY3oi0ocSLFiNcmDpxrEGHdugEBADs=\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-more-vd.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-more-vd.gif\",\n            \"text\": \"R0lGODlhFAAUAPcAAAAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnZ6enp+fn6CgoKGhoaKioqOjo6SkpKWlpaampqenp6ioqKmpqaqqqqurq6ysrK2tra6urq+vr7CwsLGxsbKysrOzs7S0tLW1tba2tre3t7i4uLm5ubq6uru7u7y8vL29vb6+vr+/v8DAwMHBwcLCwsPDw8TExMXFxcbGxsfHx8jIyMnJycrKysvLy8zMzM3Nzc7Ozs/Pz9DQ0NHR0dLS0tPT09TU1NXV1dbW1tfX19jY2NnZ2dra2tvb29zc3N3d3d7e3t/f3+Dg4OHh4eLi4uPj4+Tk5OXl5ebm5ufn5+jo6Onp6erq6uvr6+zs7O3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09PX19fb29vf39/j4+Pn5+fr6+vv7+/z8/P39/f7+/v///ywAAAAAFAAUAAAIlABNlTJFsNTAgQINClxIEJu4fxAjSpQoDttAbOEmaoxYsWHGjRrDXWv4EOREkRdLmowYDhvJlRJbGnT4r0wZMjZx5rT5r+LMjzdt7uT5T6YpjBGFktFZhqVFU9c+QgwqlOLIUkglCm0a0+VRlUm5UvSaFWZRsmBXGqVptufIo1JhGo3atqdLrHHVXkNY8OBCvwQLBgQAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-more-vh.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-more-vh.gif\",\n            \"text\": \"R0lGODlhFAAUAKIAANfX1+Hh4eLi4tjY2KWlpaampv///wAAACH5BAAAAAAALAAAAAAUABQAAANkSEW6vLDANoS5OGcxZNUgxjFfCAYAaZkaqgwB23YELG/01yj8Uxichc3AkxgZl1FtZXDsCBiUMIaJSHAe5sXxywRoAGpmAQoWSjfDd5q+rGvi2+gcl63PWllw2VYPdkYSPkc9CQA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-more-vn.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-more-vn.gif\",\n            \"text\": \"R0lGODlhFAAUAPcAAAAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnZ6enp+fn6CgoKGhoaKioqOjo6SkpKWlpaampqenp6ioqKmpqaqqqqurq6ysrK2tra6urq+vr7CwsLGxsbKysrOzs7S0tLW1tba2tre3t7i4uLm5ubq6uru7u7y8vL29vb6+vr+/v8DAwMHBwcLCwsPDw8TExMXFxcbGxsfHx8jIyMnJycrKysvLy8zMzM3Nzc7Ozs/Pz9DQ0NHR0dLS0tPT09TU1NXV1dbW1tfX19jY2NnZ2dra2tvb29zc3N3d3d7e3t/f3+Dg4OHh4eLi4uPj4+Tk5OXl5ebm5ufn5+jo6Onp6erq6uvr6+zs7O3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09PX19fb29vf39/j4+Pn5+fr6+vv7+/z8/P39/f7+/v///ywAAAAAFAAUAAAIjwBLlTIlcCDBggcHGjSFLdy6hxAjRhSHzRRDhxIzPgyHTeA1h+o0SqRIEJs4kRk5CmyIcmTHUixFhoTIseRJhQRzCiS4TiXMk+sWKlS48dpAkxBx6oRIcSXQhxYXRqx5UaLBUhJrwsQY0WJGkqU+tpxa8edYpi9jnlXJ8OlYcUbNnl0HFulctgstHsyp92pAADs=\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-movefrom.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-movefrom.gif\",\n            \"text\": \"R0lGODlhFAAUAIAAAP///////yH5BAEAAAEALAAAAAAUABQAAAI7jI+pwO2sDJQHBBstvnUnvIURR5UeMpHcWanhg5ZuS8+2JFK5Xqce2KtdHkThKHNMspLDBvOTehqliQIAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-movefromoff.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-movefromoff.gif\",\n            \"text\": \"R0lGODlhFAAUAIAAAP///////yH5BAEAAAEALAAAAAAUABQAAAIwjI+pEOwNlVyTzXveixRjHVndBZRixqHGeX4UyLGeOscICK/1uOt9Y2p5TD9fEVEAADs=\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-moveinsert.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-moveinsert.gif\",\n            \"text\": \"R0lGODlhFAAUAIAAAP///////yH5BAEAAAEALAAAAAAUABQAAAI4jI+pkOAPnWGIqonrPdTi+ARds2WeKILMqJUsWprcuUxgTEt4HcP8LKFlNkKYykdyEXcXVaQXKwAAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-moveinsertoff.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-moveinsertoff.gif\",\n            \"text\": \"R0lGODlhFAAUAIAAAP///////yH5BAEAAAEALAAAAAAUABQAAAIzjI+pkOzxmJGqwtlsXvfdf1AaiESfJI4baaFhqgHyDJdLreJ2lXpq3MKYfkEe0WjyHREFADs=\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-movepaste.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-movepaste.gif\",\n            \"text\": \"R0lGODlhFAAUAIAAAP///////yH5BAEAAAEALAAAAAAUABQAAAI2jI+poL0ODYtu0nfxAbx7LiVWM42BKYYI83WnWkbxydLta3uyWK+uOasIc7+hMQVBSVqfjKMAADs=\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-movepasteoff.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-movepasteoff.gif\",\n            \"text\": \"R0lGODlhFAAUAIAAAP///////yH5BAEAAAEALAAAAAAUABQAAAIxjI+poL0ODYtu0nfxYTx0a2VT6InNV6ajZHpg2anATGcbya6Ibj8ozurZgLBiTIgoAAA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-multilinedialog.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-multilinedialog.gif\",\n            \"text\": \"R0lGODlhEgAMAIAAAAQEBP///yH5BAEAAAEALAAAAAASAAwAAAIWjI+JwO0KY3JA2htow/zo30lbSJZBAQA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-paneslider-h.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-paneslider-h.gif\",\n            \"text\": \"R0lGODlhCQAUAPcAAAAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnZ6enp+fn6CgoKGhoaKioqOjo6SkpKWlpaampqenp6ioqKmpqaqqqqurq6ysrK2tra6urq+vr7CwsLGxsbKysrOzs7S0tLW1tba2tre3t7i4uLm5ubq6uru7u7y8vL29vb6+vr+/v8DAwMHBwcLCwsPDw8TExMXFxcbGxsfHx8jIyMnJycrKysvLy8zMzM3Nzc7Ozs/Pz9DQ0NHR0dLS0tPT09TU1NXV1dbW1tfX19jY2NnZ2dra2tvb29zc3N3d3d7e3t/f3+Dg4OHh4eLi4uPj4+Tk5OXl5ebm5ufn5+jo6Onp6erq6uvr6+zs7O3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09PX19fb29vf39/j4+Pn5+fr6+vv7+/z8/P39/f7+/v///ywAAAAACQAUAAAIZgBLmRpoSqDBa9gSKiyITZxDceGuDcQW7p/FiKVKXat4UaIpihb/icM2kaNIkh/FhQyHsuFKbAJBWhxZ8JrKmTBThqRZyiVOhiZ5+hR5TaDNnRJ73vzHsuRDljGxXUOYkGBBgxkDAgA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-paneslider-v.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-paneslider-v.gif\",\n            \"text\": \"R0lGODlhFAAJAPcAAAAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnZ6enp+fn6CgoKGhoaKioqOjo6SkpKWlpaampqenp6ioqKmpqaqqqqurq6ysrK2tra6urq+vr7CwsLGxsbKysrOzs7S0tLW1tba2tre3t7i4uLm5ubq6uru7u7y8vL29vb6+vr+/v8DAwMHBwcLCwsPDw8TExMXFxcbGxsfHx8jIyMnJycrKysvLy8zMzM3Nzc7Ozs/Pz9DQ0NHR0dLS0tPT09TU1NXV1dbW1tfX19jY2NnZ2dra2tvb29zc3N3d3d7e3t/f3+Dg4OHh4eLi4uPj4+Tk5OXl5ebm5ufn5+jo6Onp6erq6uvr6+zs7O3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09PX19fb29vf39/j4+Pn5+fr6+vv7+/z8/P39/f7+/v///ywAAAAAFAAJAAAIWQBNCTRViiDBggUFIkSI7Rq2hw8dQpz4UCA2cRjDaRSncSNGjNgKXvxHsqRJk+GuEcQW7qTLkilLlRr50qU4bBbDfeTIsePOlCshXhsasehEmQcHIjy4MGFAADs=\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-pasteformats.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-pasteformats.gif\",\n            \"text\": \"R0lGODlhFAAUAIABAP///////yH5BAEAAAEALAAAAAAUABQAAAI6jI+pwO2tAjAT1ZruuxFH2YHTKIafxCxnmZUe2Z6wtc4HiVNgbO735/EJfyrKJlWUuYaqXHBxfK4UBQA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-paste.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-paste.gif\",\n            \"text\": \"R0lGODlhFAAUAIABAP///////yH5BAEAAAEALAAAAAAUABQAAAI7jI+pwO2tAjAT1ZruuxFH2YHTeHjldy7L5lCi+3GZtIG2hXIkQ/OpeVMFXSwbEPgrKnPMWLPDgqCmgQIAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-peerbg.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-peerbg.gif\",\n            \"text\": \"R0lGODlhBAAEAJEAAP////8AAP///wAAACH5BAEAAAIALAAAAAAEAAQAAAIHjHESIMJdAAA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-range2.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-range2.gif\",\n            \"text\": \"R0lGODlhBAAEAIAAAKampv///yH5BAEAAAEALAAAAAAEAAQAAAIFRB6GelAAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-recalc.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-recalc.gif\",\n            \"text\": \"R0lGODlhFAAUAMQBAP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAAEALAAAAAAUABQAAAU7YCCOZGmeAYCuKaCyKem+byzL7qjW7Sz6uhMPGOP9cLTgigjT5ZpIaFSqrFKFM+MvC9M2mV5T+EpehQAAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-redo.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-redo.gif\",\n            \"text\": \"R0lGODlhFAAUAIABAP///////yH5BAEAAAEALAAAAAAUABQAAAIwjI+pyx0Aozuxgmmtq1Qy310fpICJaaDhoj5k+Z5xmskiotnsvLLjPekFhcOikVEAADs=\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-scrollarea-h.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-scrollarea-h.gif\",\n            \"text\": \"R0lGODlhCgAUAPcAAAAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnZ6enp+fn6CgoKGhoaKioqOjo6SkpKWlpaampqenp6ioqKmpqaqqqqurq6ysrK2tra6urq+vr7CwsLGxsbKysrOzs7S0tLW1tba2tre3t7i4uLm5ubq6uru7u7y8vL29vb6+vr+/v8DAwMHBwcLCwsPDw8TExMXFxcbGxsfHx8jIyMnJycrKysvLy8zMzM3Nzc7Ozs/Pz9DQ0NHR0dLS0tPT09TU1NXV1dbW1tfX19jY2NnZ2dra2tvb29zc3N3d3d7e3t/f3+Dg4OHh4eLi4uPj4+Tk5OXl5ebm5ufn5+jo6Onp6erq6uvr6+zs7O3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09PX19fb29vf39/j4+Pn5+fr6+vv7+/z8/P39/f7+/v///ywAAAAACgAUAAAIPwBNlTJFcKDAUtiwXUvIMGG4hxDDiXu4rqLFi/8yatzIsaPHjyBDihxJsqTJiyjXSZQ4EaI4hQ0ZXhtI0+DAgAA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-scrollarea-v.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-scrollarea-v.gif\",\n            \"text\": \"R0lGODlhFAAKAPcAAAAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnZ6enp+fn6CgoKGhoaKioqOjo6SkpKWlpaampqenp6ioqKmpqaqqqqurq6ysrK2tra6urq+vr7CwsLGxsbKysrOzs7S0tLW1tba2tre3t7i4uLm5ubq6uru7u7y8vL29vb6+vr+/v8DAwMHBwcLCwsPDw8TExMXFxcbGxsfHx8jIyMnJycrKysvLy8zMzM3Nzc7Ozs/Pz9DQ0NHR0dLS0tPT09TU1NXV1dbW1tfX19jY2NnZ2dra2tvb29zc3N3d3d7e3t/f3+Dg4OHh4eLi4uPj4+Tk5OXl5ebm5ufn5+jo6Onp6erq6uvr6+zs7O3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09PX19fb29vf39/j4+Pn5+fr6+vv7+/z8/P39/f7+/v///ywAAAAAFAAKAAAIUABNYRO37p/BgwgNrguHzZSpawQTSvy38JrDgQUnIlwnDlupUtjCZdSosONHjCQPLmwIUmTKkixDjiS50lSpa+HUvaTIsJTAiC8rngSasmZAADs=\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-sumdialog.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-sumdialog.gif\",\n            \"text\": \"R0lGODlhEgAMAIAAAAQEBP///yH5BAEAAAEALAAAAAASAAwAAAIcjI+pwO16nIQRJEsNy3Tzi31aKHpRJj1QqopZAQA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-swapcolors.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-swapcolors.gif\",\n            \"text\": \"R0lGODlhFAAUAIAAAP///////yH5BAEAAAEALAAAAAAUABQAAAI3jI+py40A3IJQvhiq1YYz32GfeICJaV7USpaZ1L5ORNJuG+PyW+/2o9CJfh3frnjiKW0xi1NSAAA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-thumb-hd.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-thumb-hd.gif\",\n            \"text\": \"R0lGODlhDwAUAPcAAAAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnZ6enp+fn6CgoKGhoaKioqOjo6SkpKWlpaampqenp6ioqKmpqaqqqqurq6ysrK2tra6urq+vr7CwsLGxsbKysrOzs7S0tLW1tba2tre3t7i4uLm5ubq6uru7u7y8vL29vb6+vr+/v8DAwMHBwcLCwsPDw8TExMXFxcbGxsfHx8jIyMnJycrKysvLy8zMzM3Nzc7Ozs/Pz9DQ0NHR0dLS0tPT09TU1NXV1dbW1tfX19jY2NnZ2dra2tvb29zc3N3d3d7e3t/f3+Dg4OHh4eLi4uPj4+Tk5OXl5ebm5ufn5+jo6Onp6erq6uvr6+zs7O3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09PX19fb29vf39/j4+Pn5+fr6+vv7+/z8/P39/f7+/v///ywAAAAADwAUAAAIZQBNlRJYaqCpgwcHFvzHsKHDhgIfSmQ48GGZiw8PWiRDJqOpjWU8gny40OHFjg41OiSDMeVHkxxFrmwJ8WXDMixJlrKIUyfPkCl3rszpsORNmhRtMsQJtOZEiRWfukSYkGDVUgEBADs=\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-thumb-hh.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-thumb-hh.gif\",\n            \"text\": \"R0lGODlhDwAUAPcAAAAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnZ6enp+fn6CgoKGhoaKioqOjo6SkpKWlpaampqenp6ioqKmpqaqqqqurq6ysrK2tra6urq+vr7CwsLGxsbKysrOzs7S0tLW1tba2tre3t7i4uLm5ubq6uru7u7y8vL29vb6+vr+/v8DAwMHBwcLCwsPDw8TExMXFxcbGxsfHx8jIyMnJycrKysvLy8zMzM3Nzc7Ozs/Pz9DQ0NHR0dLS0tPT09TU1NXV1dbW1tfX19jY2NnZ2dra2tvb29zc3N3d3d7e3t/f3+Dg4OHh4eLi4uPj4+Tk5OXl5ebm5ufn5+jo6Onp6erq6uvr6+zs7O3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09PX19fb29vf39/j4+Pn5+fr6+vv7+/z8/P39/f7+/v///ywAAAAADwAUAAAIWQBLmRookKCpggdN/VvIsCHDgw4jLoTYMKFDig8HXlRYUWPHjaUcCtzIMePFkR87lpwYsmEplCZdvtxIkqbMlf9gLhTYMmZGnDpzBg0qMSfOojwTDkz4smBAADs=\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-thumb-hn.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-thumb-hn.gif\",\n            \"text\": \"R0lGODlhDwAUAPcAAAAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnZ6enp+fn6CgoKGhoaKioqOjo6SkpKWlpaampqenp6ioqKmpqaqqqqurq6ysrK2tra6urq+vr7CwsLGxsbKysrOzs7S0tLW1tba2tre3t7i4uLm5ubq6uru7u7y8vL29vb6+vr+/v8DAwMHBwcLCwsPDw8TExMXFxcbGxsfHx8jIyMnJycrKysvLy8zMzM3Nzc7Ozs/Pz9DQ0NHR0dLS0tPT09TU1NXV1dbW1tfX19jY2NnZ2dra2tvb29zc3N3d3d7e3t/f3+Dg4OHh4eLi4uPj4+Tk5OXl5ebm5ufn5+jo6Onp6erq6uvr6+zs7O3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09PX19fb29vf39/j4+Pn5+fr6+vv7+/z8/P39/f7+/v///ywAAAAADwAUAAAIkABNCRxYqpTAggdLYVvIsCFDgdjCSZwoUVw4cdgKYrNocaA4i+EymtpYEeFFidggVgxn0NRHiylHXrRosNREcdcgcmQpcGa4nKauUTx4EqMphRRrggxpkKREoiCBRpyplGPMqRehwjxKkubRmRgNXluqtGJKpCBr3rx6MhzRk2x9vnwpleG1hXcbIkyIcK/AgAA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-thumb-vd.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-thumb-vd.gif\",\n            \"text\": \"R0lGODlhFAAPAPcAAAAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnZ6enp+fn6CgoKGhoaKioqOjo6SkpKWlpaampqenp6ioqKmpqaqqqqurq6ysrK2tra6urq+vr7CwsLGxsbKysrOzs7S0tLW1tba2tre3t7i4uLm5ubq6uru7u7y8vL29vb6+vr+/v8DAwMHBwcLCwsPDw8TExMXFxcbGxsfHx8jIyMnJycrKysvLy8zMzM3Nzc7Ozs/Pz9DQ0NHR0dLS0tPT09TU1NXV1dbW1tfX19jY2NnZ2dra2tvb29zc3N3d3d7e3t/f3+Dg4OHh4eLi4uPj4+Tk5OXl5ebm5ufn5+jo6Onp6erq6uvr6+zs7O3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09PX19fb29vf39/j4+Pn5+fr6+vv7+/z8/P39/f7+/v///ywAAAAAFAAPAAAIWQBNCRRYqtTAgggJmjL4r6HDhxAdCoxIEeLEihgZYqyocWPEi2TKiBw5MqTIhgsblixDxqRIkyhNqSRJk2TDgh4ppswJESfPhzt/oiwl1KHBggsVHlx41GBAADs=\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-thumb-vh.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-thumb-vh.gif\",\n            \"text\": \"R0lGODlhFAAPAPcAAAAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnZ6enp+fn6CgoKGhoaKioqOjo6SkpKWlpaampqenp6ioqKmpqaqqqqurq6ysrK2tra6urq+vr7CwsLGxsbKysrOzs7S0tLW1tba2tre3t7i4uLm5ubq6uru7u7y8vL29vb6+vr+/v8DAwMHBwcLCwsPDw8TExMXFxcbGxsfHx8jIyMnJycrKysvLy8zMzM3Nzc7Ozs/Pz9DQ0NHR0dLS0tPT09TU1NXV1dbW1tfX19jY2NnZ2dra2tvb29zc3N3d3d7e3t/f3+Dg4OHh4eLi4uPj4+Tk5OXl5ebm5ufn5+jo6Onp6erq6uvr6+zs7O3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09PX19fb29vf39/j4+Pn5+fr6+vv7+/z8/P39/f7+/v///ywAAAAAFAAPAAAIVgBLmRpYSqCpggILEiRY6p/DhxAjPhQosWLEgRYz/qOoseLBjh5NOVxocODBgw03pkxokqHClB83mjTIEuVIkSAv4sz5ECPPnjt/+vypEuXJozONmgoIADs=\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-thumb-vn.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-thumb-vn.gif\",\n            \"text\": \"R0lGODlhFAAPAPcAAAAAAAEBAQICAgMDAwQEBAUFBQYGBgcHBwgICAkJCQoKCgsLCwwMDA0NDQ4ODg8PDxAQEBERERISEhMTExQUFBUVFRYWFhcXFxgYGBkZGRoaGhsbGxwcHB0dHR4eHh8fHyAgICEhISIiIiMjIyQkJCUlJSYmJicnJygoKCkpKSoqKisrKywsLC0tLS4uLi8vLzAwMDExMTIyMjMzMzQ0NDU1NTY2Njc3Nzg4ODk5OTo6Ojs7Ozw8PD09PT4+Pj8/P0BAQEFBQUJCQkNDQ0REREVFRUZGRkdHR0hISElJSUpKSktLS0xMTE1NTU5OTk9PT1BQUFFRUVJSUlNTU1RUVFVVVVZWVldXV1hYWFlZWVpaWltbW1xcXF1dXV5eXl9fX2BgYGFhYWJiYmNjY2RkZGVlZWZmZmdnZ2hoaGlpaWpqamtra2xsbG1tbW5ubm9vb3BwcHFxcXJycnNzc3R0dHV1dXZ2dnd3d3h4eHl5eXp6ent7e3x8fH19fX5+fn9/f4CAgIGBgYKCgoODg4SEhIWFhYaGhoeHh4iIiImJiYqKiouLi4yMjI2NjY6Ojo+Pj5CQkJGRkZKSkpOTk5SUlJWVlZaWlpeXl5iYmJmZmZqampubm5ycnJ2dnZ6enp+fn6CgoKGhoaKioqOjo6SkpKWlpaampqenp6ioqKmpqaqqqqurq6ysrK2tra6urq+vr7CwsLGxsbKysrOzs7S0tLW1tba2tre3t7i4uLm5ubq6uru7u7y8vL29vb6+vr+/v8DAwMHBwcLCwsPDw8TExMXFxcbGxsfHx8jIyMnJycrKysvLy8zMzM3Nzc7Ozs/Pz9DQ0NHR0dLS0tPT09TU1NXV1dbW1tfX19jY2NnZ2dra2tvb29zc3N3d3d7e3t/f3+Dg4OHh4eLi4uPj4+Tk5OXl5ebm5ufn5+jo6Onp6erq6uvr6+zs7O3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09PX19fb29vf39/j4+Pn5+fr6+vv7+/z8/P39/f7+/v///ywAAAAAFAAPAAAIjgBNCSxVaiBBUwQLIixIENs1bA4fRoToEOK1awixhRMnbqNHjh07bsRWEJvIkyhBiiNZymS4lxtFvlQpDqMplxw/wszZkaSpa+EEGhTKsGA4nxoRKl0odOFRgSaLNp1qqmZDnjNjhhSJDerHkFnBrsw4E+RXjyNL7kR7sqzNiw8vWpxLEeJBhksTKtVrKiAAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-trackingline-h.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-trackingline-h.gif\",\n            \"text\": \"R0lGODlhAgAIAJECAKampqWlpf///wAAACH5BAEAAAIALAAAAAACAAgAAAIHjCEpAaZSAAA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-trackingline-v.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-trackingline-v.gif\",\n            \"text\": \"R0lGODlhCAACAJECAKWlpaampv///wAAACH5BAEAAAIALAAAAAAIAAIAAAIHRCRxYhiACgA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-undo.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-undo.gif\",\n            \"text\": \"R0lGODlhFAAUAIABAP///////yH5BAEAAAEALAAAAAAUABQAAAIxjI+py30Ao3uxzopBs4YviYCKSGkfNKKpmZDlyXZZq4beu8JMbPNT4PoFL7Wf8WgoAAA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-unhidebottom.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-unhidebottom.gif\",\n            \"text\": \"R0lGODlhDAAJAKEBAMzMzP///////////yH5BAEKAAIALAAAAAAMAAkAAAIUjI8BycvogJzxUKeghAkb/1wiIBQAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-unhideleft.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-unhideleft.gif\",\n            \"text\": \"R0lGODlhCQAMAKEBAMzMzP///////////yH5BAEKAAIALAAAAAAJAAwAAAIWRI5niavd3AIU0vrChUomz2ShcJVAAQA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-unhideright.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-unhideright.gif\",\n            \"text\": \"R0lGODlhCQAMAKEBAMzMzP///////////yH5BAEKAAIALAAAAAAJAAwAAAIWjG+AqMkHWpCx0TphdInCt3BhRUZCAQA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-unhidetop.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-unhidetop.gif\",\n            \"text\": \"R0lGODlhDAAJAKEBAMzMzP///////////yH5BAEKAAIALAAAAAAMAAkAAAIUhI8gwe0BXnSTHdpStmnWt4GYmBUAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-unlock.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-unlock.gif\",\n            \"text\": \"R0lGODlhDQAUAMIGAGFhYbm5ucLCwt3d3fHx8f39/QAAAAAAACH5BAEKAAcALAAAAAANABQAAAMreLrc/jDKU2p9V2VWWp+fFEZjQZzomRGkwmrb92qcWy/yTVMtZf2WiZCRAAA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-unmerge.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-unmerge.gif\",\n            \"text\": \"R0lGODlhFAAUAIABAP///////yH5BAEAAAEALAAAAAAUABQAAAI0jI+pywoBnpQQvobRNbueDmpiRkbmiUYjt3rs14bw/NbuDaa6Smay/cO1eotJRWXsEJeNAgA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-wikiflag.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-wikiflag.gif\",\n            \"text\": \"R0lGODlhDQAMAJEAABrH7P///////wAAACH5BAEAAAIALAAAAAANAAwAAAIijI8hEuD/FAPJ0NWyzZjSfU1aFpJm6Z2SlnJihULQWiFLAQA7\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-wikilinkflag.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-wikilinkflag.gif\",\n            \"text\": \"R0lGODlhEAAMAJEAABrH7P///////wAAACH5BAEAAAIALAAAAAAQAAwAAAIplIKpagEP4wsNrGWrUxblY3Ve922htGmiQ1LglojluXoufNmVxN/5VQAAOw==\"\n        },\n        \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-save.gif\": {\n            \"type\": \"image/gif\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/Lib/Images/sc-save.gif\",\n            \"text\": \"R0lGODlhFAAUAIAAAP///////yH5BAEKAAEALAAAAAAUABQAAAI2jI+pCw0Lg3tRzWodTnefXk2ixoyiZZgkJTWp+VLdGMvuR8Y6cuM2G1nlSjeV8Xc81ZJAT6IAADs=\"\n        },\n        \"$:/plugins/rboue/SocialCalc/config.json\": {\n            \"title\": \"$:/plugins/rboue/SocialCalc/config.json\",\n            \"type\": \"application/json\",\n            \"text\": \"{\\n\\\"\\\":\\\"Localisation\\\",\\n  \\\"LANG\\\": \\\"en-GB\\\",\\n\\n\\\"\\\":\\\"Graphics of the Graph tab. Actually the only choice is \\\\\\\"native\\\\\\\".\\\",\\n  \\\"graphics\\\": \\\"native\\\",\\n\\n\\\"\\\":\\\"Visualization mode. \\\\\\\"edit\\\\\\\" to modify the sheet. \\\\\\\"view\\\\\\\" to view the sheet in read-only mode.\\\",\\n  \\\"mode\\\": \\\"edit\\\",\\n\\n\\\"\\\":\\\"Display grid (\\\\\\\"yes\\\\\\\") or no (\\\\\\\"no\\\\\\\").\\\",\\n  \\\"displayGrid\\\": \\\"yes\\\",\\n\\n\\\"\\\":\\\"Height of widget in pixel when in tiddler editor.\\\",\\n  \\\"heightInTiddlerEditor\\\": \\\"400\\\",\\n\\n\\n\\\"\\\":\\\"\\\"\\n}\"\n        },\n        \"$:/plugins/rboue/SocialCalc/edit-socialcalc.js\": {\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/rboue/SocialCalc/edit-socialcalc.js\\ntype: application/javascript\\nmodule-type: widget\\n\\nThe edit-socialcalc widget edit a SocialCalc sheet stored in a tiddler.\\n\\n```\\n<$edit-socialcalc tiddler=\\\"myTiddler\\\" height=\\\"400\\\"/>\\n```\\n\\nThe widget displays a SocialCalc sheet stored in the specified tiddler.\\nThe width and height attribute are interpreted as a number of pixels, and do not need to include the \\\"px\\\" suffix.\\nThe mode attribute defines the type of display : \\\"edit\\\" to edit the data (default value), \\\"view\\\" to\\ndisplay without modification\\nThe grid attribute defines the display grid behaviour : \\\"yes\\\" to display the grid (default\\nvalue), \\\"no\\\" otherwise.\\n\\n\\\\*/\\n(function(){\\n\\n/*jslint node: true, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\nvar CONST_NODE_ID_PREFIX = \\\"SocialCalcWidget\\\"; // prefix of root node's id attribute\\nvar CONST_NODE_CLASS = \\\"SocialCalcWidget\\\";     // class of root node\\nvar CONST_MIN_HEIGHT = 300;                    // root node minimal height\\nvar CONST_PLUGIN_PATH = \\\"$:/plugins/rboue/SocialCalc\\\";\\nvar CONST_CONFIG_TIDDLER = \\\"$:/config/rboue/SocialCalc\\\";\\nvar CONST_CONFIG_DEFAULT_TIDDLER = CONST_PLUGIN_PATH+\\\"/config.json\\\";\\nvar CONST_SHEET_TIDDLER_TYPE = \\\"application/x-socialcalc\\\"; // type of sheet tiddler\\n\\n// Get session configuration.\\nvar sessionConfig = null;\\nvar configTiddler = $tw.wiki.getTiddler(CONST_CONFIG_TIDDLER);\\nif ((typeof(configTiddler) != \\\"undefined\\\") && configTiddler) {\\n  sessionConfig = $tw.wiki.getTiddlerData(configTiddler, null)\\n}\\nif (!sessionConfig) {\\n  var configTiddlerDefault = $tw.wiki.getTiddler(CONST_CONFIG_DEFAULT_TIDDLER);\\n  if ((typeof(configTiddlerDefault) != \\\"undefined\\\") && configTiddlerDefault) {\\n    sessionConfig = $tw.wiki.getTiddlerData(configTiddlerDefault, null)\\n  }\\n}\\n\\n// Create objects\\nvar Widget = require(\\\"$:/core/modules/widgets/widget.js\\\").widget;\\nvar SocialCalc = require(\\\"./Lib/socialcalc-min.js\\\").SocialCalc;\\nvar Graph = require(\\\"./Lib/graph.js\\\").Graph;\\n  Graph.init(SocialCalc, sessionConfig);\\nvar TiddlyWiki = require(\\\"./tiddlywiki.js\\\").TiddlyWiki;\\n  TiddlyWiki.init(SocialCalc, sessionConfig);\\n\\nvar EditSCWidget = function(parseTreeNode,options) {\\n  this.initialise(parseTreeNode,options);\\n};\\nEditSCWidget.instanceNb = 0; // count class instances\\n\\n// Inherit from the base widget class\\nEditSCWidget.prototype = new Widget();\\n\\n//=======================================================================================\\n\\n// Render this widget into the DOM\\nEditSCWidget.prototype.render = function(parent, nextSibling) {\\n  var fonc = \\\"EditSCWidget.render\\\";\\n  var self = this;\\n\\n  // Debug tools\\n  var hack = {\\n    flagActiv: true, // Activate the logs\\n    log: function(mess, flagNoLog, fonc) {\\n      if (!hack.flagActiv || flagNoLog) return;\\n      var id = \\\"[]\\\";\\n      var ss = SocialCalc.GetSpreadsheetControlObject();\\n      if (ss) id = \\\"[\\\"+ss.idPrefix+\\\"]\\\";\\n      console.log(id+(fonc ? fonc+\\\": \\\" : \\\"\\\")+mess);\\n    },\\n    // Following are flags activating logs for specific fonctionnalities.\\n    // Value : false to activate, true to desactivate (no log).\\n    bug: false,       // current bug investigation\\n    com: true,        // command execution\\n    save: true,      // tiddlywiki-save commande\\n    recalc: true,     // recalc\\n    recalcLink: true, // recalc : page link in formula\\n    link: true,       // page link in formula loaded as tiddler\\n    url: true,       // text-link cell\\n    filesystem: true, // filesystem\\n    keyboard: true,   // keyboard\\n    loc: true        // localization\\n  };\\n  if (!window.hack) window.hack = hack;\\n\\n  this.parentDomNode = parent;\\n  this.computeAttributes();\\n  this.flagEditWidget = this.execute();\\n\\n  // Create element and assign attributes\\n  this.nodeRoot = this.document.createElement(\\\"div\\\");\\n  this.nodeRootId = CONST_NODE_ID_PREFIX + \\\"-\\\" + ++EditSCWidget.instanceNb;\\n  this.nodeRoot.setAttribute(\\\"id\\\", this.nodeRootId);\\n  this.nodeRoot.setAttribute(\\\"class\\\", CONST_NODE_CLASS);\\n  if (this[\\\"class\\\"])\\n    this.nodeRoot.setAttribute(\\\"class\\\", CONST_NODE_CLASS + \\\" \\\" + this[\\\"class\\\"]);\\n  if (this.width)\\n    this.nodeRoot.setAttribute(\\\"width\\\", \\\"\\\"+this.width+\\\"px\\\");\\n  if (this.height)\\n    this.nodeRoot.setAttribute(\\\"height\\\", \\\"\\\"+this.height+\\\"px\\\");\\n\\n  // Insert element\\n  parent.insertBefore(this.nodeRoot, nextSibling);\\n  this.domNodes.push(this.nodeRoot);\\n\\n  // Get data tiddler\\n  if (!this.tiddler) {\\n    nodeRoot.innerHTML = \\\"Error: you must specify a SocialCalc data tiddler\\\";\\n    return;\\n  }\\n\\n  var tiddler = null;\\n  var tiddler1 = this.wiki.getTiddler(this.tiddler);\\n  if ((typeof(tiddler1) == \\\"undefined\\\") || !tiddler1) {\\n    this.wiki.addTiddler(new $tw.Tiddler({title: this.tiddler, type: CONST_SHEET_TIDDLER_TYPE, text: \\\"\\\"}));\\n    tiddler = this.wiki.getTiddler(this.tiddler);\\n  } else\\n    tiddler = tiddler1;\\n\\n  // Get widget configuration\\n  this.flagView = false;\\n  if (this.mode && (this.mode.toLowerCase() == \\\"view\\\") ||\\n      (sessionConfig && sessionConfig.mode && (sessionConfig.mode.toLowerCase() == \\\"view\\\")))\\n    this.flagView = true;\\n  this.flagDisplayGrid = true;\\n  if (this.grid && (this.grid.toLowerCase() == \\\"no\\\") ||\\n      (sessionConfig && sessionConfig.grid && (sessionConfig.grid.toLowerCase() == \\\"no\\\")))\\n  this.flagDisplayGrid = false;\\n  if (sessionConfig && sessionConfig.heightInTiddlerEditor && this.flagEditWidget)\\n    this.height = sessionConfig.heightInTiddlerEditor;\\n  \\n  var widgetConfig = {\\n    mode: this.flagView ? \\\"view\\\" : \\\"edit\\\"\\n  };\\n  if (sessionConfig && sessionConfig.filesystem) {\\n    widgetConfig.filesystem = {};\\n    if (sessionConfig.filesystem.PATH)\\n      widgetConfig.filesystem.PATH = sessionConfig.filesystem.PATH;\\n  }\\n\\n  // Get Socialcalc and adapt it to TiddlyWiki\\n  if (!SocialCalc) {\\n    this.nodeRoot.innerHTML = \\\"Error: SocialCalc missing !\\\";\\n    return;\\n  }\\n\\n  // Hack : execution of handlers defined with raw HTML, like onclick=\\\"SocialCalc.Bazz()\\\".\\n  // SocialCalc must be defined at top level.\\n  if (!window.SocialCalc) window.SocialCalc = SocialCalc;\\n  // Hack : TiddlyWiki must be defined at top level.\\n  if (!window.TiddlyWiki) window.TiddlyWiki = TiddlyWiki;\\n\\n  this.tiddlyWiki = new TiddlyWiki(this, this.tiddler, widgetConfig);\\n  this.setSheetGeometry(this.nodeRoot);\\n\\n  // Activate wiki-text\\n  if (Document && Document.Parser) {\\n    SocialCalc.Callbacks.expand_wiki = function(val){\\n      return \\\"<div class=\\\\\\\"wiki\\\\\\\">\\\" + new Document.Parser.Wikitext().parse(val, new Document.Emitter.HTML()) + \\\"</div>\\\";\\n    };\\n  }\\n\\n  hack.log(\\\"tiddler: \\\"+this.tiddler, hack.com, fonc);\\n\\n  if (!this.flagView) {\\n    // Edit mode\\n\\n    // Create spreadsheet\\n    this.spreadsheet = new SocialCalc.SpreadsheetControl(\\\"SocialCalc-\\\"+EditSCWidget.instanceNb+\\\"-\\\", this.tiddlyWiki);\\n\\n    // Add graph tab\\n    // Hack : execution of handlers defined with raw HTML, like onclick=\\\"Graph.Bazz()\\\".\\n    // Graph must be defined at top level.\\n    if (!window.Graph) window.Graph = Graph;\\n    Graph.addGraphTab(this.spreadsheet);\\n    \\n    // Initialise UI\\n    this.spreadsheet.InitializeSpreadsheetControl(this.nodeRootId, 0, 0, 0);\\n    this.tiddlyWiki.addImportExportUI(this.spreadsheet);\\n    \\n    // Execute initial commands\\n    this.spreadsheet.ExecuteCommand(\\\"redisplay\\\", \\\"\\\");\\n    \\n    // Load data from tiddler\\n    this.loadData(tiddler);\\n    \\n    // Add new commands\\n    this.tiddlyWiki.addNewCommands(this.spreadsheet, this.tiddler);\\n    \\n    // Start monitoring\\n    this.tiddlyWiki.monitor(this.spreadsheet);\\n\\n  } else {\\n    // View mode\\n\\n    // Create spreadsheet\\n    this.spreadsheet = new SocialCalc.SpreadsheetViewer(\\\"SocialCalc-\\\"+EditSCWidget.instanceNb+\\\"-\\\", this.tiddlyWiki);\\n    if (!this.flagDisplayGrid)\\n      this.spreadsheet.context.showGrid = false;\\n\\n    // Initialise UI\\n    this.spreadsheet.InitializeSpreadsheetViewer(this.nodeRootId, 0, 0, 0);\\n\\n    // Execute initial commands\\n    this.spreadsheet.editor.EditorScheduleSheetCommands(\\\"redisplay\\\");\\n\\n    // Load data from tiddler\\n    this.loadData(tiddler);    \\n  }\\n};\\n  \\n//=======================================================================================\\n\\n// Compute the internal state of the widget\\nEditSCWidget.prototype.execute = function() {\\n  var fonc = \\\"EditSCWidget.execute\\\";\\n\\n  // Get our parameters\\n\\n  var flagEditWidget = false;\\n  this.tiddler = this.getAttribute(\\\"tiddler\\\", this.getVariable(\\\"currentTiddler\\\"));\\n  var tiddler = this.wiki.getTiddler(this.tiddler);\\n  if (this.tiddler && tiddler && tiddler.isDraft()) {\\n    // The tiddler is a draft.\\n    // We suspect that widget is used as default editor for tiddlers of type application/x-socialcalc.\\n    flagEditWidget = true;\\n  }\\n\\n  this.width = this.getAttribute(\\\"width\\\");\\n  this.height = this.getAttribute(\\\"height\\\");\\n  this.mode = this.getAttribute(\\\"mode\\\");\\n  this.grid = this.getAttribute(\\\"grid\\\");\\n  this[\\\"class\\\"] = this.getAttribute(\\\"class\\\");\\n\\n  return flagEditWidget;\\n};\\n\\n// Selectively refreshes the widget if needed. Returns true if the widget or any\\n// of its children needed re-rendering\\nEditSCWidget.prototype.refresh = function(changedTiddlers) {\\n  var fonc = \\\"EditSCWidget.refresh\\\";\\n  SocialCalc.SetSpreadsheetControlObject(this.spreadsheet);\\n\\n  // Resize calc sheet\\n  this.setSheetGeometry(this.nodeRoot);\\n  SocialCalc.DoOnResize(this.spreadsheet);\\n  if (this.spreadsheet.currentTab && this.spreadsheet.tabs[this.spreadsheet.currentTab].name == \\\"graph\\\")\\n    Graph.DoGraph(false, false);\\n\\n  var changedAttributes = this.computeAttributes();\\n  if (changedAttributes.tiddler ||\\n      changedAttributes.width ||\\n      changedAttributes.height ||\\n      changedAttributes.mode ||\\n      changedAttributes.grid ||\\n      changedAttributes[\\\"class\\\"]) {\\n    this.refreshSelf();\\n    return true;\\n  } else if (changedTiddlers[this.tiddler]) {\\n    // Remove tiddler from sheet cache to force a reload and a recalc in other pages.\\n    TiddlyWiki.removeTiddlerFromSheetCache(this.tiddler);\\n    this.refreshSelf();\\n    return true;\\n  } else if (this.spreadsheet.editor.context.sheetobj.attribs.recalc != \\\"off\\\") {\\n    // Recalc to update cells with references to external sheets, if any\\n    this.spreadsheet.editor.EditorScheduleSheetCommands(\\\"recalc\\\");\\n    return true;\\n  } else {\\n    return false;\\t\\t\\n  }\\n};\\n\\n// Geometry preparation for sheet display\\nEditSCWidget.prototype.setSheetGeometry = function(nodeRoot) {\\n  var calcWidth = nodeRoot.offsetWidth; // maximal width\\n  if (this.width && (this.width <= calcWidth))\\n    calcWidth = this.width;\\n  var calcHeight = CONST_MIN_HEIGHT;\\n  if (this.height)\\n    calcHeight = this.height;\\n\\n  TiddlyWiki.modifyViewport(calcWidth, calcHeight);\\n}\\n\\n// Load sheet\\nEditSCWidget.prototype.loadData = function(tiddler) {\\n  var fonc = \\\"EditSCWidget.loadData\\\";\\n  if (!tiddler) return;\\n\\n  var calcData = tiddler.fields.text;\\n  var parts = this.spreadsheet.DecodeSpreadsheetSave(calcData);\\n  if (parts) {\\n    if (parts.sheet) {\\n      this.spreadsheet.sheet.ResetSheet();\\n      this.spreadsheet.sheet.ParseSheetSave(calcData.substring(parts.sheet.start, parts.sheet.end));\\n    }\\n    if (parts.edit) {\\n      this.spreadsheet.editor.LoadEditorSettings(calcData.substring(parts.edit.start, parts.edit.end));\\n    }\\n  }\\n  if (this.spreadsheet.editor.context.sheetobj.attribs.recalc == \\\"off\\\")\\n    this.spreadsheet.editor.ScheduleRender();\\n  else {\\n    this.spreadsheet.editor.EditorScheduleSheetCommands(\\\"recalc\\\");\\n  }\\n}\\n\\nexports[\\\"edit-socialcalc\\\"] = EditSCWidget;\\n\\n})();\\n\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/edit-socialcalc.js\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"widget\"\n        },\n        \"$:/config/EditorTypeMappings/application/x-socialcalc\": {\n            \"title\": \"$:/config/EditorTypeMappings/application/x-socialcalc\",\n            \"text\": \"socialcalc\"\n        },\n        \"$:/plugins/rboue/SocialCalc/icon\": {\n            \"created\": \"20150122113649353\",\n            \"modified\": \"20150122113650949\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/icon\",\n            \"type\": \"image/png\",\n            \"text\": \"iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAABmJLR0QA/wD/AP+gvaeTAAAACXBI\\nWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3wMRCAYZvJsQjgAAABl0RVh0Q29tbWVudABDcmVhdGVk\\nIHdpdGggR0lNUFeBDhcAABHaSURBVHja7Z15VJNX3se/N7IoWElQgwiEVUBZBJdSSweFEZdaWjew\\nIrZqO9O302l9562n9cx5zxydMzOnp6eli+2r09KilipuoxVKlUarUOqGBRcUiBKIiQjGLEAggZD7\\n/kHTwRGyB7I837845Fnuc3+f53eX53d/l1BK4UqilOLBgwdob2+HQqGAQqGAUqmEWq2GUDMxPFWe\\n22To/CrOvohw7wfCsWPHgs1mw8/PD2w2GwEBAfD39wchxKXqizg7ACqVCiKRCCKRCGKxGMHtm+36\\nQGLuRyQ4OBihoaEICQmBr68vA8BISqfTQSQSQSAQoPJ2j9E32t4Sct4jUVFRiIqKAo/HA4vFYgCw\\nh1tvampCXV0dvOtyHbrAvfH7SVxcHMLDw52iuXBoANra2nDp0iV4XnveKdupvoRiMnfuXAQEBDAA\\nmOVWhUKcO3cOE1t+7xI9VFnY52TevHkICwtjADDk5uvr61FRUYEw2ZuuNTT5RS0T80laWhpiYmIc\\npnlwCAAaGxvxww8/uKzhhwIhPT0d06ZNc28A7ty5gxMnToAn/ZNbGP6R55/8IVmyZAmCg4PdC4De\\n3l6cOnUKrNpstzT8I5p1hGRkZMDT09P1ARAIBGg6nMwYfghF5VwhkZGRrgmAWq1GSUkJJtzayBjf\\ngLpjvyLLli2Dl5fXiNxvRKat2trasL3wdD5jfOPyqV9P//blifD79++7hgeoqalB+4nfMIa3QAFL\\nfyRJSUnOCQClFHw+H7rqFYzxrZBnynGSnp5ut3kDuzQBWq0WBw4cYIxvA/VdeJYePHgQWq3WOQDQ\\naDQoKioCR/gyY3wbid30Ev3666+h0WgcG4DOzk78vfBkeGDrHxnj21hT7r5G/154Mryzs9MxAVAq\\nlTh6dOfPo/193pWVKs9t+kdRZX5HR4djdQK7urpQtWMK89aPJAyv3yPjx48ffQ+gVqvxbtHpcMYk\\nI6t3i06Hq9Xq0fUAWq0WRUVFYNr80dG9qZ+SdevWwcPDY+Q9gE6nw6FDhxjjj3LH8PDhw7DmJbbY\\nA5SXl4NeXskY3wHkmXKcZGRkjJwHqKmpYYzvQOq78Cytr68fGQDa29uZuX0HVMvROdSSOQKzAOjr\\n68MHR6rzmep2TB04cAD9/f326wOUlZVhzJUc5u13YLHmHCWZmZm29wDNzc2M8Z1AuuoV9M6dO7YF\\noLe3Fw374xnjO4l2fXslT6fT2a4J4PP56L+0nAFgBNXs/z6ZPn06OBwOfHx80N/fD5VKBbFYDK/r\\na43awi+dT5544gnrAWhvb0fNFxEuZ3wx9yPC5XIxbtw4AAMBLDKZDOyml0b1WaW8f5KFCxciICBg\\n2HJQSnH16lVyryzVYFlTXhUTNpttHQB79+5FgOQPLgFA57TdJD4+HhEREdRQ0KVUKs2pr68/pKpc\\nMqLPHZR1nsTHm97UarVafPPNN2R844tDnqOM/JLk5ORYDsDt27dx6+BMpzd+R1QhycjIeHvixInv\\nmNWh0ulQU1NDpOXz7V4HcevrSXBwsNn3+SX0jgwXfRWz9joxtCaRZejCe76vc/qvfNwllSQ7O5ua\\na3wAYLFYmD17Nn3qjTa0Bn5it8V8kdm1FhkfAAghWLhwIe2K3jNk+U6dOmWZB6irq4P4eIpTv/0z\\nN94iU6bYJk6BUopTp04RW3eGe6YXkeXLl9O+vj6cPHmSnD17Fh0dHQgMDMTSpUuRkmKaDdRqNc5+\\nMGnI32Jz60hoaKh5AOzatQvh8i1OC0DyS03+XC5XZuvrlpaWElvmK0h5VUxqa2vxyiuvoLGx8ZHr\\nLly4kBQUFCA0NNToPX/88UcyVL9FyvsnWbdunekA3Lp1C7cPJTmt8X9ZYmWX8ut0OhQVFRFbdIxl\\nYZ8THx8frF69mhqK+p00aVLOhQsXDkVEGB6N9fT0oOLDyUP+NiPvJgkJCTGtD3D+/Hnn9fuzjjxk\\n/I6ODpSXl5Pdu3eTvXv3kjNnzhBrImlYLBZWrVplE7i4XC42bNhw21jIt1QqPfjCCy8Y/e4/btw4\\nSAI+HrIvUFVVZVonUCaTYfKd/3Lat3/+/IEee01NDVmxYgXhcrlYvHgx3bhxI33xxRdpeno65XK5\\n2LRpExEKhRZ17Hx9feHz1HdWdwq1F5+jCoUiwpRjq6qqKJ/PN3rPwMDAIf/PEb5M5XK5cQCqq6ud\\n9uUf++S3xNvbG9u3bydz5syhx44do0PF0nd2dqKwsJBOnz6d7tmzxyJDmto5M6StB6eZde+ysjKj\\nxzz22GPD/nb58mXDAPT39zt1oMfcuXOxZcsWsm3bNmrKXLhGo8HGjRvpzp07zYbAy8sLZPa/rPIC\\nYrE425zjm5ubjR5jKD6w/9LyR+rlIQAEAoHTvv13p+wgx44dQ35+vlkAU0qxefNmev78ebONGRsb\\na1WZvb29D5lzvI+Pj9FjjAWF3Lp1a3gA6urqnBYAHo+HLVu2WHRuX18fXn/9dbODKy2dvNHL3BxB\\niYmJxkcWMsMj3xs3bgwNgFarxXBzys4g7cXnaGtrq8Xlr66uNtsLsFgstAfvtLgZ2Lroksnl9fLy\\nwpo1awzXgVZr9GPWuJt5dHDU0K8ACIVCOLM+PZdhda+8pKTE7HOMfW0zprS0NJPK/dZbb5GwsDBq\\nxL2bdK3BfQmWK7T/ANDQ0GD1NSxpAr29va2655tvvomEhASDhsvJySHbtm2jxiaoLl48/rMp9xxs\\n618B4PQc6XJmAGQyWba115BKpSNebu+6XFpWVobt27eT4ODgh0CYOXMmKSwsJMXFxXTMmDEGr3Pp\\n0iUSIPlrsin3PCvU5T8EgFKpREfjAafOe+7n53fI2mtwOByzz+np6bG67J+V/hy+detW2tLSQhsb\\nG0l1dTWRSCSktraWbtiwgRrLDiIUConi9G9N7k8sUOT8Sb/CmAUMJGx0dg03A2aOwsPDLfE8Vt83\\nVZ7b9LcvT0R0dHQ0TZs2jc6ePZtOnTrVJINeuXKFNBYnmN35FYvFrgXA/z5dY/UIJisry6zjKaWY\\neu91m4ycUuW5TRd2BkfU1taaFKepUqnw7bffGg0LG04ikejfANy9e9fpAajgFK83NA1qTJGRkSQ9\\nPd2symxtbbV5kEjbd0/RP+/67oPKykoilUpzBg/Zent70dTUREpLS8mPHwfA4+oai+FrbW0FABCd\\nTofydx5zmaDPJX9WWXTewYMHSXa2ealry8vLiTNPnS/a2klYQ30hclbR5MNk6dKlZr+Vr732mtnG\\nV6lUTr9AVqlUgjUaQx97idSsprt378amTZtMgoDFYuGdd94hO3bsMNuQFRUVTr99mFQqhUt5AGAg\\n8KGgoADFxcUkLCxsWCMlJSURPp9P3n77bWpuEkaZTPaZK2Q6l8vl8FAoFC4FgE/9elpd/QNZs2YN\\nzc7Oxrlz50hFRQXu3r0LFosFHo+HzMxMJCYmWmRAjUaD0tKCuQEuUFcKhQIeSqUSfnAtyfjpVDK1\\ngQQFBdHU1FSamppqmz4GpSgpKSEBkr+6RKdZqVSC1d3dDVfU9b0xtL6+3mbttEajwb59+8hjgg0u\\nM2JSqVRgCdST8uCiajk6h/70009W50JUKBRNe/bsIZNEr7jUGsmenh6QE//wdflVv21Bf6mZM+eZ\\nWdOnTzerw9fV1YUzZ84QZ9230KSRkzsAoJeY+xFJTk5GdHQ0HS7LJqUUYrGYXL9+3S32NHIrAAZr\\nQvQa1e2e9PH67/mUUiiVSrfbwcxtAWA0IBZTBQwAjBgAGDEAMHJPAKo4+yKYanBPCTnvEVbEWJmQ\\nqQr3lI+PD1imrDdj5MIAWLuyhZHzis1mMwAwADAAuDcAkydPZmrCTcXlchkP4M6aMGECWIQQiLkf\\nEaY63Et3p+wgwC8zgcHBwUyNuJn0NmcBA+lVGLmX9EkjGQ/AADCQW66CU7yeqRb3kJDzHvH19f03\\nAAAwP8KriKka91BUVNSvf3sM/qfgMlM55qot6P+Iv78//Pz84OHhAS8vL3h7e4PFGni3ent7odVq\\nodFooNFoIJPJIJfLRzX2cEgAeDweBIw9DUoZ+SUJDQ0Fj8cDl8vV5+2x0JC/Q3d3N8RiMWlpaUFL\\nSwtC7v/3iEAxOGv4Q4smjh07hnE385gg0UHSJR0iCQkJVieFNEUajQY3b94k165dA1f8ql3up4nb\\nR5599tmhARAIBGg6nOz2AFRwitfnzY8siomJoXpXPtLq6urCuXPnht0LyGL3P7CXwtAA9Pf3g/+u\\nn1sDELjsJ5KQkGD2knF7qbOzE2fOnCGm7BVoijLf7iCDoX4I7zFjxsDj8W/cclr43tRPyW82tyMx\\nMdFhjK8fomdlZdHQFdVWF8rriRLynx7tEf+WnJzsdsaXhX1O8vLyqCNHR8XGxtL4FxqsgiApKemR\\n/z0CgL+/P+ThBW7jBSZEr1GtXr3aaCZOR1BQUBANee6iRbZRRHxBhkqEOWQPx5Q9Z11FPlFvjPf0\\n9HSa8s6YMYO2TMw3G4Inn3xyyP8PCUBYWBiEnPfcwgtER0dTJyyzWceLJn0w5I5hwwIAAOnp6W7h\\nAcaOHet0ZdZveG2qDNlyWABiYmLcIlBEKpXOcbYy379/3+RjWwM/IYOnfk0GAAAWLFjg8h7g8lBb\\naTmwenp6YE7Gkvnz5xv83SAAkZGRLj8iIDWrqUgkcopnpJSirKzM5LJ2x35FjGVANzrPuXjxYpf3\\nAje/nkElEglxdOOfPHmSmLOv06JFi4weYxQADoeDMXOPuXxf4PreGFpbW+uQz9nT04P9+/cTUrPa\\nZOP7pfN/DfqwCgB9L9IdIobavnuK/mXX8YgbN244BAgajQZ8Pp9UfDgZE1t+b7Lx70z+kKSkpJjW\\nBJqaQ6+5uRkN++Pd5kPR/ZBdZNasWYiOjqaGduO0h+RyOf/atWuZPVVPW1Tfw+0UbhUAAMDn89F/\\nabnbfS1Uz/iaxMTEgMfj2eV7AaUU7e3tRCgUoq6uDsHtmy2u43GpZSQtLc30TrA5APT396OgoABh\\nsjfd9pNxBad4/bxgFHG5XLDZbLDZbA6bzZZ5eXmZZOiuri4oFAqiUCggl8shkUjg3/w7m9Rne/BO\\nkpeXB3O+ZpqdRrW9vR01X0QwUUMGAInwbCvy8vICpRRqtRqhD/5nROrryT+2EnO3zbEoj25DQwOa\\n/zWbgcCBFJtbR0JDQ80+z6J4p5iYGKu3TmdkO3mmHLfI+BYDAACZmZnQxO1jIBjtoWLcPmLNhzuL\\nASCEICsrC4qILxgIRknKyC9JVlYWrAlhsyrklRCCVatW/brUmNHI6e6UHWTlypWwNn7R6phnDw8P\\n5Obmuk0AiSOo2f99kpubC1tMUNkk6N3b2xtr165FW9Bfahjz2Fdn2Ac/WLt2rdXb1ls1DBxOarUa\\n+/fvt9l+uoweVmvgJ+T555+3aRSTTQEABmYLjxw5Ar/bmxgIbKiOqEKycuVK2Dp62eYAAANTnqWl\\npbDVahZ3V19CMVm2bBnssWDFLgDoITh9+jS0F59jILBCXk+UkAULFsBeq5XsBoBeLS0tqN8Xx0Bg\\ngeJfaCBBQUF2vYfdAQCA7u5uHD16FK6275699CD0M7J8+XKMxFK1EQFA3yRcvHgRitO/ZSAwIHbG\\nKfL4449jpBaojhgAeonFYpSWliJcvoUBYZCa/d8nzzzzDOzt8kcdAL03uHr1Ku6VpTIQAJjydBVJ\\nTEzEaCxLHxUA9Orq6sL3338Pn/r1bglCd+xXZNGiRTAletclAdBLIBDg7NmzI5YkabTVMjGfZGRk\\nwNCSLbcCQC+hUIjKykoESP5AXdXwaWlpAwE1DpKFxKEA0EsikaCyshIc4csuAYIs7HMyb948hIWF\\nOVzZHBIAvTo7O3H16lV0VSx2ShDGp50kM2fOxHA7lTMAmDFqaGpqQl1dHbzrch26wL3x+0lcXBzC\\nw8PhSMmmnBqAwdLpdBCJRBAIBKi83ROeKs9tGtV+C+c9EhUVhaioKPB4PIxWXkG3AeA/pVKpIBKJ\\nIBKJIJFIENT2hl0fSBLwMQkKCkJoaChCQkJGdQjHADCMOjo6IJVKoVQqoVAooFAo0N3dDZVKZXSR\\nRsvEfOLr6wsfHx/9yh+w2WxMmjQJ5i66cAb9P0ino5gBTAIlAAAAAElFTkSuQmCC\\n\"\n        },\n        \"$:/plugins/rboue/SocialCalc/license\": {\n            \"title\": \"$:/plugins/rboue/SocialCalc/license\",\n            \"text\": \"!Plugin license\\nCopyright (C) 2015 René Boué (rboue) &lt;rboue01 (at) gmail (dot) com&gt;<br>\\nAll rights reserved.\\n\\nThis program is free software: you can redistribute it and/or modify\\nit under the terms of the GNU General Public License as published by\\nthe Free Software Foundation, either version 3 of the License, or\\n(at your option) any later version.\\n\\nThis program is distributed in the hope that it will be useful,\\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\\nGNU General Public License for more details.\\n\\nYou should have received a copy of the GNU General Public License\\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\\n\\n!Modification of the ~SocialCalc code\\nSee [[CHANGES.txt|$:/plugins/rboue/SocialCalc/CHANGES.txt]] tiddler.\\n\\n!Traduction française\\nMartin Gubri pour [[Framasoft|http://www.framasoft.org/]].\\n\\n<<<\\nJuste pour préciser : j'avais traduit une bonne partie d'Ethercalc, mais\\nje m'étais en partie servi de la traduction partielle qu'avait fait le\\n[[CRDP de Versailles|http://www.crdp.ac-versailles.fr/]].\\n<<<\\n\\nA voir : [[Framacalc|http://www.framacalc.org]].\\n\\n!~SocialCalc license\\n(c) Copyright 2009 Socialtext, Inc.<br>\\nAll Rights Reserved.<br>\\n\\nOriginal components licensed under different licenses. Some are licensed under the Common Public Attribution License (CPAL) and others under the Artistic License 2.0. Check the contents of each file for a statement of the license for that file. Files without license information (e.g., image files) are licensed under the Artistic License 2.0.<br>\\nSee [[LEGAL.txt|$:/plugins/rboue/SocialCalc/LEGAL.txt]] and [[LICENSE.txt|$:/plugins/rboue/SocialCalc/LICENSE.txt]] for details.<br>\\n\\nThe ~JavaScript ~SocialCalc code was initially coded by Dan Bricklin of Software Garden, Inc., for ~Socialtext, Inc.<br>\\nBased in part on the ~SocialCalc 1.1.0 code written in Perl.<br>\\nThe ~SocialCalc 1.1.0 code was:<br>\\n\\n    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\\n    All Rights Reserved.\\n    Portions (c) Copyright 2007 Socialtext, Inc.\\n    All Rights Reserved.<br>\\n\\nThe Perl ~SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.<br>\\nwikiCalc 1.0 was written by Software Garden, Inc.<br>\\n\\nwikiCalc, Garden, and Software Garden are registered trademarks of Software Garden, Inc.<br>\\nSocialtext, ~SocialCalc, and the Socialtext logo and Dreamcatcher are trademarks of Socialtext, Inc.<br>\\nDan Bricklin's is a registered trademark of Daniel Bricklin.\"\n        },\n        \"$:/plugins/rboue/SocialCalc/parser.js\": {\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/rboue/SocialCalc/parser.js\\ntype: application/javascript\\nmodule-type: parser\\n\\nThe SocialCalc parser parses SocialCalc's save format into single text node (like \\\"text/plain\\\" parser)\\n\\n\\\\*/\\n(function(){\\n\\n/*jslint node: true, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\nvar SocialCalcParser = function(type,text,options) {\\n  this.tree = [{\\n    type: \\\"codeblock\\\",\\n    attributes: {\\n      code: {type: \\\"string\\\", value: text},\\n      language: {type: \\\"string\\\", value: type}\\n    }\\n  }];\\n};\\n\\nexports[\\\"application/x-socialcalc\\\"] = SocialCalcParser;\\n\\n})();\\n\\n\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/parser.js\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"parser\"\n        },\n        \"$:/plugins/rboue/SocialCalc/readme\": {\n            \"title\": \"$:/plugins/rboue/SocialCalc/readme\",\n            \"text\": \"~SocialCalc for ~TiddlyWiki.\"\n        },\n        \"$:/plugins/rboue/SocialCalc/tiddlywiki.js\": {\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/rboue/SocialCalc/tiddlywiki.js\\ntype: application/javascript\\nmodule-type: library\\n\\n  Adaptation of SocialCalc to TiddlyWiki.\\n\\n\\\\*/\\n(function() {\\n\\n  // TiddlyWiki environnement for a SocialCalc sheet\\n  // Manage all interactions and interfaces with TiddlyWiki system.\\n  //\\n  var TiddlyWiki = function(widget, tiddlerTitle, widgetConfiguration) {\\n    this.widget = widget; // widget\\n    this.tiddlerTitle = tiddlerTitle;   // title of the sheet data tiddler\\n    this.widgetConfiguration = widgetConfiguration; // widget's configuration object\\n    this.flagView = (this.widgetConfiguration.mode && this.widgetConfiguration.mode == \\\"view\\\") ? true : false; // display mode\\n\\n    // Management of notification that sheet needs saving (You ! Your sheet has been modified.\\n    // Remember to save it !)\\n    // Notification consists of changing background color of the toobar save button.\\n    this.saveTodo = {\\n      flagStart: false, // start monitoring anything related to saving of data\\n      button: {\\n        image: TiddlyWiki.pathImages+\\\"/sc-save.gif\\\", // image tiddler\\n        idSuffix: \\\"button_save\\\",          // suffix of id attribute (prefix is stylesheet.idPrefix)\\n        index: null,                           // index of saveButton in SocialCalc.ButtonInfo.registeredElements (read at start)\\n        normalBackgroundColor: null,           // initial background color (read at start)\\n        needSavingBackgroundColor: \\\"#0000ff\\\",  // new background when need saving\\n        style: null,                           // initial style (read at start)\\n        needSavingStyle: null                  // style used when need saving\\n      }\\n    }\\n\\n    // Enable/block key events propagation (keyboard share between input box and grid)\\n    // Allow to forbid tiddler scrolling by the browser when we just want to move current\\n    // cell in the grid with up and down keys.\\n    this.inputboxHasKeyboard = false;\\n    // Callback to monitor commands : function(cmd) {}\\n    this.monitorCallback = null;\\n  };\\n\\n  // Static members\\n\\n  // Overall parameters\\n  TiddlyWiki.pluginPath = \\\"$:/plugins/rboue/SocialCalc\\\";\\n  TiddlyWiki.configTiddler = \\\"$:/config/rboue/SocialCalc\\\";\\n  TiddlyWiki.configDefaultTiddler = TiddlyWiki.pluginPath + \\\"/config.json\\\";\\n  TiddlyWiki.pathImages = TiddlyWiki.pluginPath + \\\"/Lib/Images\\\";\\n  TiddlyWiki.curentLanguageTiddler = \\\"$:/language\\\";\\n  TiddlyWiki.defaultLanguage = \\\"en-GB\\\";\\n  TiddlyWiki.pathLanguages = TiddlyWiki.pluginPath + \\\"/Languages\\\";\\n  TiddlyWiki.saveNotificationTiddlerSuffix = \\\"--save-notification\\\";\\n  TiddlyWiki.saveCommandKeyword = \\\"tiddlywiki-save\\\"; // keyword of save command\\n  TiddlyWiki.exportCommandKeyword = \\\"tiddlywiki-export\\\"; // keyword of export command\\n  TiddlyWiki.importCommandKeyword = \\\"tiddlywiki-import\\\"; // keyword of import command\\n  TiddlyWiki.sheetTiddlerType = \\\"application/x-socialcalc\\\"; // type of tiddler with sheet data\\n  TiddlyWiki.dataTiddlerType = \\\"text/plain\\\"; // type of tiddler with import/export data\\n\\n  // Initialized at TiddlyWiki session opening\\n  TiddlyWiki.sessionConfiguration = null; // Session configuration\\n  TiddlyWiki.currentLanguage = null; // current language\\n\\n  // Static initialisations\\n  TiddlyWiki.init = function(sc, sessionConfiguration) {\\n    TiddlyWiki.sessionConfiguration = sessionConfiguration;\\n\\n    // Normalization of sheet names.\\n    // Sheet name are tiddler title and therefore could have Uppercase/lowercase characters.\\n    sc.Callbacks.NormalizeSheetName = function(sheetName) {return sheetName;};\\n\\n    // Add class attribute to DOM nodes pertaining to sheet visual\\n    sc.ConstantsSetClasses(\\\"SocialCalc-\\\");\\n\\n    // Background images redefinition\\n    sc.Constants.defaultCommentStyle = TiddlyWiki.getModifiedCssImageStyle(sc.Constants.defaultCommentStyle);\\n    sc.Constants.defaultReadonlyStyle = TiddlyWiki.getModifiedCssImageStyle(sc.Constants.defaultReadonlyStyle);\\n    sc.Constants.defaultUnhideLeftStyle = TiddlyWiki.getModifiedCssImageStyle(sc.Constants.defaultUnhideLeftStyle);\\n    sc.Constants.defaultUnhideRightStyle = TiddlyWiki.getModifiedCssImageStyle(sc.Constants.defaultUnhideRightStyle);\\n    sc.Constants.defaultUnhideTopStyle = TiddlyWiki.getModifiedCssImageStyle(sc.Constants.defaultUnhideTopStyle);\\n    sc.Constants.defaultUnhideBottomStyle = TiddlyWiki.getModifiedCssImageStyle(sc.Constants.defaultUnhideBottomStyle);\\n\\n    // Management of indirect calc data (data referenced in other sheet).\\n    // With TiddlyWiki, other sheets are tiddlers with SocialCalc data.\\n    sc.RecalcInfo.LoadSheet = function(pageName) {\\n      var spreadsheet = sc.GetSpreadsheetControlObject();\\n      if (spreadsheet && spreadsheet.tiddlyWiki)\\n        return spreadsheet.tiddlyWiki.getCalcPage(pageName);\\n      return false;\\n    };\\n\\n    // Localization with current langage.\\n    TiddlyWiki.localize(sc);\\n  };\\n\\n  // Localization with current langage.\\n  TiddlyWiki.localize = function(sc) {\\n    var fonc = \\\"TiddlyWiki.localize\\\";\\n\\n    // Get configuration\\n    var configLang = (TiddlyWiki.sessionConfiguration ? TiddlyWiki.sessionConfiguration.LANG : null);\\n\\n    // Replace all strings in SocialCalc.Constants with a translation of the current language\\n    // <lang> kept in $<colon>/plugins/SocialCalc/Languages/<lang> tiddler.\\n    // Current language read in $<colon>/language tiddler.\\n    // Default language is \\\"en-GB\\\". It is statically implemented and don't needs translation.\\n\\n    // Current language\\n    var language = null;\\n    if (configLang) {\\n      language = configLang;\\n    } else {\\n      language = $tw.wiki.getTiddlerText(TiddlyWiki.curentLanguageTiddler);\\n      language = language.replace(/^\\\\$\\\\/:languages\\\\//, \\\"\\\");\\n    }\\n    TiddlyWiki.currentLanguage = language;\\n    \\n    if (language == TiddlyWiki.defaultLanguage) return;\\n    //console.log(fonc+\\\":language = \\\"+language);\\n\\n    // Read translations\\n    var translations = $tw.wiki.getTiddlerData(TiddlyWiki.pathLanguages + \\\"/\\\" + language);\\n    if (!translations) return;\\n    for (var trans in translations) {\\n      //console.log(fonc+\\\": \\\"+trans + \\\" = \\\"+translations[trans]);\\n      if (typeof(sc.Constants[trans]) == \\\"undefined\\\") continue;\\n      sc.Constants[trans] = translations[trans];\\n    }\\n  };\\n\\n  // Redefine viewport geometry (now a tiddler)\\n  TiddlyWiki.modifyViewport = function(width, height) {\\n    // Ugly hack...\\n    SocialCalc.GetViewportInfo = function () {\\n      return {\\n        width: width,\\n        height: height,\\n        horizontalScrol: null,\\n        verticalScroll: null\\n      };\\n    }\\n  };\\n\\n  // Modify CSS style of image with tiddler raw image syntax\\n  TiddlyWiki.getModifiedCssImageStyle = function(style) {\\n    var pattern = \\\".*?url(.+).*\\\";\\n    var regexp = \\\".*?url[(][\\\\\\\"]?.*?images/\\\\(.+?\\\\)[\\\\\\\"]?[)].*$\\\";\\n\\n    if (!style) return false;\\n    if (!style.match(pattern)) return false;\\n    // File image extraction\\n    var reg = new RegExp(regexp, \\\"\\\");\\n    var tab = reg.exec(style);\\n    if (! tab || tab.length < 2) return false;\\n    // Get tiddler\\n    var tiddlerName = TiddlyWiki.pathImages+\\\"/\\\"+tab[1];\\n    var src = TiddlyWiki.getRawTiddlerImage(tiddlerName);\\n    if (!src) return false;\\n    var newStyle = style.replace(/url[(].+?[)]/, \\\"url(\\\"+src+\\\")\\\");\\n    \\n    return(newStyle);\\n  };\\n\\n  // Modify \\\"src\\\" attribute of <img> node with tiddler raw image data\\n  TiddlyWiki.getModifiedImgSrc = function(src) {\\n    var regexp = \\\".*images/\\\\(.+?\\\\)$\\\";\\n\\n    if (!src) return false;\\n    // File image extraction\\n    var reg = new RegExp(regexp, \\\"\\\");\\n    var tab = reg.exec(src);\\n    if (! tab || tab.length < 2) return false;\\n    // Get tiddler\\n    var tiddlerName = TiddlyWiki.pathImages+\\\"/\\\"+tab[1];\\n    var newSrc = TiddlyWiki.getRawTiddlerImage(tiddlerName);\\n    if (!newSrc) return false;\\n\\n    return newSrc;\\n  };\\n\\n  // Get CSS raw source of a tiddler image\\n  TiddlyWiki.getRawTiddlerImage = function(tiddlerName) {\\n    if (!$tw || !$tw.wiki) return false;\\n    // Check if it is an image tiddler\\n    if (!$tw.wiki.isImageTiddler(tiddlerName)) return false;\\n    var tiddler = $tw.wiki.getTiddler(tiddlerName);\\n    if ((typeof(tiddler) == \\\"undefined\\\") || !tiddler) return false;\\n    var text = tiddler.fields.text;\\n    if (!text) return false;\\n    var type = tiddler.fields.type;\\n    // Render the appropriate element for the image type\\n    var src = \\\"\\\";\\n    switch(type) {\\n    case \\\"image/svg+xml\\\":\\n      src = \\\"data:image/svg+xml,\\\" + encodeURIComponent(text);\\n      break;\\n    default:\\n      src = \\\"data:\\\" + type + \\\";base64,\\\" + text;\\n      break;\\n    }\\n\\n    return src;\\n  }; \\n\\n  // Execute extension command\\n  TiddlyWiki.executeExtensionCmd = function(spreadsheet, com) {\\n    spreadsheet.editor.EditorScheduleSheetCommands(\\\"startcmdextension \\\"+com);\\n  };\\n\\n  // Remove tiddler from sheet cache\\n  TiddlyWiki.removeTiddlerFromSheetCache = function(tiddlerTitle) {\\n    var fonc = \\\"TiddlyWiki.removeTiddlerFromSheetCache\\\";\\n    var sfsc = SocialCalc.Formula.SheetCache;\\n    if (sfsc.tiddlersToSheets[tiddlerTitle])\\n      sfsc.tiddlersToSheets[tiddlerTitle] = undefined;\\n    for (var sheetname in sfsc.sheets) {\\n      if (sfsc.sheets[sheetname].tiddlerTitle == tiddlerTitle) {\\n        delete sfsc.sheets[sheetname];\\n        sfsc.sheets[sheetname] = undefined;\\n      }\\n    }\\n    hack.log(\\\"Tiddler removed from cache: \\\"+tiddlerTitle, hack.recalcLink, fonc);\\n  };\\n\\n  // Navigate to a tiddler.\\n  // Called by cell's link (cf. SocialCalc.expand_text_link()).\\n  TiddlyWiki.navigateToTiddler = function(tiddlerTitle) {\\n    var fonc = \\\"TiddlyWiki.navigateToTiddler\\\";\\n    var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\\n\\n    // Send a \\\"tm-navigate\\\" event from widget to tiddler\\n    var bounds = spreadsheet.tiddlyWiki.widget.domNodes[0].getBoundingClientRect();\\n    spreadsheet.tiddlyWiki.widget.dispatchEvent({\\n      type: \\\"tm-navigate\\\",\\n      navigateTo: tiddlerTitle,\\n      navigateFromTitle: spreadsheet.tiddlyWiki.tiddlerTitle,\\n      navigateFromNode:  spreadsheet.tiddlyWiki.widget,\\n      navigateFromClientRect: { top: bounds.top, left: bounds.left, width: bounds.width, right: bounds.right, bottom: bounds.bottom, height: bounds.height},\\n      navigateSuppressNavigation: false\\n    });\\n  };\\n\\n  // Instance members\\n\\n  TiddlyWiki.prototype = {\\n\\n    // Resolve file path.\\n    //\\n    // Following behaviour apply only if SocialCalc's configuration's object property \\\"filesystem\\\"\\n    // is defined. If not, file is assumed to be a tiddler's title.\\n    //\\n    // File path resolution is inspired by Unix.\\n    // We make assumption that tiddler title follows classical Unix Path pattern\\n    // like : /dir1/dir2/ ... /dir/file. If not the case, file should be\\n    // in the directories of the PATH (see below), or completely out of path convention.\\n    // There is no notion of curent directory (if any).\\n    //\\n    // Unlike Unix, there is no notion of root directory or \\\"/\\\". TiddlyWiki has no\\n    // real filesystem so we can't rely on a root node. Relative versus absolute\\n    // path is deduced from the following. If the first caracter of a file\\n    // path is \\\"/\\\", and there is no more \\\"/\\\" after that, then the path is absolute.\\n    // In that case, the behavior is identical to Unix. A file path beginning with a \\\"/\\\"\\n    // will be directly converted in a tiddler title.\\n    // By default (and unlike Unix), malformed path like multiple \\\"/\\\" instead of one\\n    // are not accepted. For example \\\"//\\\" is not reduced to \\\"/\\\" and treated like a\\n    // path separator. It is the responsibility of the user to be clear about the significance of\\n    // it's file reference, path-like name or tiddler title.\\n    // With optionnal <flagNormalize> parameter set, malformed path are normalized like\\n    // Unix does.\\n    //\\n    // A file is searched under a collection of path directories, pre-defined in the PATH\\n    // variable. Those directories are absolute.\\n    // Syntax of the PATH variable :\\n    //   <path1>';'<path2>';' ... ';'<pathN>\\n    // The PATH is defined in the widget's configuration object, under filesystem.PATH property.\\n    // The widget's configuration object is searched first in $:/config/SocialCalc tiddler of\\n    // \\\"application/json\\\" type, then in $:/plugins/SocialCalc/config-defaults tiddler.\\n    //\\n    // Search algorithm :\\n    //   <file> : input file path.\\n    //   PATH <- value of a \\\"path\\\"\\n    //   if <PATH> exists then\\n    //     for all <dir> in <PATH>\\n    //       if tiddler <dir>/<file> found then return <dir>/<file>\\n    //     end for\\n    //   end if\\n    //   if tiddler <file> found then return file\\n    //\\n    resolvePath: function(file, flagNormalize) {\\n      var fonc = \\\"TiddlyWiki.resolvePath\\\";\\n\\n      hack.log(\\\"==<<== file = \\\"+file, hack.filesystem, fonc);\\n\\n      if (!file) return null;\\n      var tiddlerTitle = \\\"\\\";\\n      var tiddler = false;\\n      if (!this.widgetConfiguration || !this.widgetConfiguration.filesystem) {\\n        hack.log(\\\"no filesystem in widget's configuration !\\\", hack.filesystem, fonc);\\n        return(file);\\n      }\\n\\n      // Get PATH\\n      var tabPath = null;\\n      if (this.widgetConfiguration.filesystem.PATH && this.widgetConfiguration.filesystem.PATH != \\\"\\\")\\n        tabPath = this.widgetConfiguration.filesystem.PATH.split(/[\\\\s]*;[\\\\s]*/);\\n      hack.log(\\\"tabPath = \\\"+(tabPath ? tabPath.join(\\\" | \\\"): tabPath), hack.filesystem, fonc);\\n\\n      var flagFind = false;\\n          \\n      if (!flagFind && tabPath) {\\n        // Search under PATH directories\\n        for (var i = 0; i < tabPath.length; i++) {\\n          var file1 = tabPath[i] + \\\"/\\\" + file;\\n          if (flagNormalize) {\\n            // File normalization\\n            file1 = file.replace(/[\\\\/][\\\\/]+/g, \\\"/\\\").replace(/\\\\/\\\\.\\\\//g, \\\"/\\\");\\n          }\\n          tiddlerTitle = file1;\\n          var tiddler2 = $tw.wiki.getTiddler(tiddlerTitle);\\n          if ((typeof(tiddler2) != \\\"undefined\\\") && tiddler2) {\\n            flagFind = true;\\n            break;\\n          }\\n        }\\n      }\\n      \\n      // Maybe a tiddler already\\n      if (!flagFind) {\\n        if (flagNormalize) {\\n          // File normalization\\n          file = file.replace(/[\\\\/][\\\\/]+/g, \\\"/\\\").replace(/\\\\/\\\\.\\\\//g, \\\"/\\\");\\n        }\\n        tiddlerTitle = file;\\n      }\\n\\n      hack.log(\\\"==>>== tiddler = \\\"+tiddlerTitle, hack.filesystem, fonc);\\n      return tiddlerTitle;\\n    },\\n\\n    // Get a tiddler calc page referenced in a page\\n    //\\n    // Status :\\n    //   True if page found and loaded, false otherwise.\\n    //\\n    // A page reference appears in formulae to access data on other pages.\\n    // Exemple :\\n    //   =\\\"My root calc data page\\\"!C3 aims to access C3 cell in a page named\\n    // \\\"My root calc data page\\\".\\n    // If widget's configuration object property \\\"filesystem\\\" is defined this page name is\\n    // a file path. Otherwise this is a tiddler's title.\\n    //\\n    getCalcPage: function(pageName) {\\n      var fonc = \\\"TiddlyWiki.getCalcPage\\\";\\n\\n      hack.log(\\\"==<<== pageName = \\\"+pageName, hack.link, fonc);\\n\\n      var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\\n      var tiddlerTitle = this.resolvePath(pageName);\\n      hack.log(\\\"tiddlerTitle = \\\"+tiddlerTitle, hack.link, fonc);\\n\\n      // Is the tiddler already referenced in cache ?\\n      if (SocialCalc.Formula.SheetCache.tiddlersToSheets[tiddlerTitle]) {\\n        // We just add the page to the cache\\n        SocialCalc.Formula.AddSheetToCache(pageName, null, null, tiddlerTitle);\\n        // Fake call to continue recalc\\n        SocialCalc.RecalcLoadedSheet(pageName, null, false, null, tiddlerTitle);\\n        hack.log(\\\"Sheet already in cache, tiddler not loaded: \\\"+tiddlerTitle, hack.recalcLink, fonc);\\n      } else {\\n        // We read the tiddler\\n        var tiddler = $tw.wiki.getTiddler(tiddlerTitle);\\n        if ((typeof(tiddler) == \\\"undefined\\\") || !tiddler) return false;\\n        hack.log(\\\"checked tiddler\\\", hack.link, fonc);\\n        var calcData = tiddler.fields.text;\\n        if (!calcData) return false;\\n        hack.log(\\\"checked calcData\\\", hack.link, fonc);\\n        var parts = spreadsheet.DecodeSpreadsheetSave(calcData);\\n        if (!parts) return false;\\n        hack.log(\\\"checked parts\\\", hack.link, fonc);\\n        var page = calcData.substring(parts.sheet.start, parts.sheet.end);\\n        \\n        // Tell Socialcalc to load this sheet page and recalc\\n        SocialCalc.RecalcLoadedSheet(pageName, page, true, null, tiddlerTitle);\\n        hack.log(\\\"Tiddler loaded: \\\"+tiddlerTitle, hack.recalcLink, fonc);\\n      }\\n      return true;\\n    },\\n\\n    // Add UI for extension commands.\\n    addExtensionCmdUI: function(spreadsheet) {\\n      // Save command button\\n      // First button on the left in the toobar.\\n      var scc = SocialCalc.Constants;\\n      var SCLoc = SocialCalc.LocalizeString;\\n      \\n      var divToolbar = null;\\n      var tabDiv = spreadsheet.spreadsheetDiv.getElementsByTagName(\\\"div\\\");\\n      if (!tabDiv || tabDiv.length == 0) return;\\n      for (var i = 0; i < tabDiv.length; i++) {\\n        if (tabDiv[i].getAttribute(\\\"id\\\") == spreadsheet.idPrefix+\\\"edittools\\\") {\\n          divToolbar = tabDiv[i];\\n          break;\\n        }\\n      }\\n      if (!divToolbar) return;\\n      var saveButton = document.createElement(\\\"img\\\");\\n      if (!saveButton) return;\\n      saveButton.id = spreadsheet.idPrefix + this.saveTodo.button.id;\\n      saveButton.style = \\\"vertical-align: bottom; border: 1px solid rgb(64, 64, 64); background-color: rgb(64, 64, 64); margin-right: 8px;\\\";\\n      saveButton.src = TiddlyWiki.getRawTiddlerImage(this.saveTodo.button.image);\\n      divToolbar.insertBefore(saveButton, divToolbar.getElementsByTagName(\\\"img\\\")[0]);\\n      var saveButtonStyle = {\\n        name: \\\"saveButton\\\",\\n        normalstyle: \\\"border:1px solid \\\"+scc.ISCButtonBorderNormal+\\\";background-color:\\\"+scc.ISCButtonBorderNormal+\\\";\\\",\\n        hoverstyle: \\\"border:1px solid \\\"+scc.ISCButtonBorderHover+\\\";background-color:\\\"+scc.ISCButtonBorderNormal+\\\";\\\",\\n        downstyle: \\\"border:1px solid \\\"+scc.ISCButtonBorderDown+\\\";background-color:\\\"+scc.ISCButtonDownBackground+\\\";\\\"\\n      };\\n      var saveButtonNeedSavingStyle = {\\n        name: \\\"saveButton\\\",\\n        normalstyle: \\\"border:1px solid \\\"+scc.ISCButtonBorderNormal+\\\";background-color:\\\"+this.saveTodo.button.needSavingBackgroundColor+\\\";\\\",\\n        hoverstyle: \\\"border:1px solid \\\"+scc.ISCButtonBorderHover+\\\";background-color:\\\"+this.saveTodo.button.needSavingBackgroundColor+\\\";\\\",\\n        downstyle: \\\"border:1px solid \\\"+scc.ISCButtonBorderDown+\\\";background-color:\\\"+this.saveTodo.button.needSavingBackgroundColor+\\\";\\\"\\n      };\\n      SocialCalc.TooltipRegister(saveButton, SCLoc(\\\"Save changes\\\"), {}, spreadsheet.spreadsheetDiv);\\n      var self = this;\\n      SocialCalc.ButtonRegister(spreadsheet.editor, saveButton, saveButtonStyle, {\\n        MouseDown: function() {\\n          TiddlyWiki.executeExtensionCmd(spreadsheet, TiddlyWiki.saveCommandKeyword);\\n        },\\n        Disabled: function() {}\\n      });\\n\\n      // Remember initial style data\\n      this.saveTodo.button.index = SocialCalc.ButtonInfo.registeredElements.length - 1;\\n      this.saveTodo.button.style = saveButtonStyle;\\n      this.saveTodo.button.normalBackgroundColor = saveButton.style.backgroundColor;\\n\\n      // Remember need saving style\\n      this.saveTodo.button.needSavingStyle = saveButtonNeedSavingStyle;\\n    },\\n\\n    // Change the save button visual\\n    changeSaveButtonVisual: function(flagNeedSavingStyle) {\\n      // Get registered button element\\n      if (!SocialCalc.ButtonInfo.registeredElements || this.saveTodo.button.index == null) return;\\n      var elem = SocialCalc.ButtonInfo.registeredElements[this.saveTodo.button.index];\\n      if (elem.name != \\\"saveButton\\\") return;\\n      // Change style\\n      if (flagNeedSavingStyle) {\\n        elem.element.style.backgroundColor = this.saveTodo.button.needSavingBackgroundColor;\\n        elem.normalstyle = this.saveTodo.button.needSavingStyle.normalstyle;\\n        elem.hoverstyle = this.saveTodo.button.needSavingStyle.hoverstyle;\\n        elem.downstyle = this.saveTodo.button.needSavingStyle.downstyle;\\n      } else {\\n        elem.element.style.backgroundColor = this.saveTodo.button.normalBackgroundColor;\\n        elem.normalstyle = this.saveTodo.button.style.normalstyle;\\n        elem.hoverstyle = this.saveTodo.button.style.hoverstyle;\\n        elem.downstyle = this.saveTodo.button.style.downstyle;\\n        this.saveTodo.flagStart = false;\\n      }\\n    },\\n\\n    // Add UI for import/export (cf. Clipboard tab).\\n    addImportExportUI: function(spreadsheet) {\\n      // The UI skeleton is defined in HTML. See SocialCalc.SpreadsheetControl(), clipboard tab.\\n      \\n      if (!spreadsheet.importExport) spreadsheet.importExport = {};\\n\\n      // Populate format selection\\n      var select = document.getElementById(spreadsheet.idPrefix+\\\"clipboard-export-select-format\\\");\\n      if (!select) return;\\n      var tabFormat = [\\\"Tab-delimited\\\", \\\"CSV\\\", \\\"SocialCalc-save\\\"];\\n      select.length = 0;\\n      for (i=0; i < tabFormat.length; i++) {\\n        var name = tabFormat[i];\\n        select.options[i] = new Option(name, name);\\n      }\\n      select.options[0].selected = true;\\n\\n       // Click on Export button\\n      var buttonExport = document.getElementById(spreadsheet.idPrefix+\\\"clipboard-export\\\");\\n      if (!buttonExport) return;\\n      buttonExport.addEventListener(\\\"click\\\", function() {\\n        TiddlyWiki.executeExtensionCmd(spreadsheet, TiddlyWiki.exportCommandKeyword);\\n      }, false);\\n\\n      // Click on Import button      \\n      var buttonImport = document.getElementById(spreadsheet.idPrefix+\\\"clipboard-import\\\");\\n      if (!buttonImport) return;\\n      buttonImport.addEventListener(\\\"DOMNodeRemoved\\\", function() {\\n        TiddlyWiki.executeExtensionCmd(spreadsheet, TiddlyWiki.importCommandKeyword);\\n      }, false);\\n    },\\n\\n    // Tab click management for import/export (cf. Clipboard tab).\\n    clickImportExportUI: function(spreadsheet) {\\n      // Refresh export selection\\n      var tabNames = [];\\n      var select = document.getElementById(spreadsheet.idPrefix+\\\"clipboard-export-select-source\\\");\\n      if (!select) return;\\n      for (name in spreadsheet.sheet.names) {\\n        tabNames.push(name);\\n      }\\n      tabNames.sort();\\n      select.length = 0;\\n      select.options[0] = new Option(SocialCalc.LocalizeString(\\\"[Clipboard]\\\"));\\n      for (i=0; i < tabNames.length; i++) {\\n        var name = tabNames[i];\\n        select.options[i+1] = new Option(name, name);\\n      }\\n      select.options[0].selected = true;\\n    },\\n\\n    // Add new commands\\n    addNewCommands: function(spreadsheet, sheetTiddlerTitle) {\\n      var self = this;\\n\\n      // Extension commands callback\\n      var comTiddlywiki = function(cmdname, data, sheet, cmd, saveundo) {\\n        var fonc = \\\"addNewCommands/comTiddlywiki\\\";\\n        if (!cmdname || !sheet) return;\\n\\n        if (cmdname == TiddlyWiki.saveCommandKeyword) {\\n          // SAVE SHEET TO TIDDLER\\n          // Activated by Ctrl-S or the toolbar save button.\\n\\n          // Serialize sheet data\\n          var calcData = SocialCalc.SpreadsheetControlCreateSpreadsheetSave(spreadsheet);\\n\\n          // Save data to tiddler\\n          if (!sheetTiddlerTitle) return;\\n          var tiddler = $tw.wiki.getTiddler(sheetTiddlerTitle);\\n          if (typeof(tiddler) == \\\"undefined\\\" || !tiddler) return;\\n          $tw.wiki.addTiddler(new $tw.Tiddler(tiddler, {type: TiddlyWiki.sheetTiddlerType, text: calcData}));\\n          \\n          // Remove tiddler from sheet cache to force a reload, then a recalc of all\\n          // sheets in SocialCalc widgets with references to this sheet.\\n          TiddlyWiki.removeTiddlerFromSheetCache(sheetTiddlerTitle);\\n           \\n          // Notification\\n          var language = TiddlyWiki.currentLanguage ? TiddlyWiki.currentLanguage : \\\"en-GB\\\";\\n          var tiddlerTitle = TiddlyWiki.pathLanguages + \\\"/\\\" + language + TiddlyWiki.saveNotificationTiddlerSuffix;\\n          var tiddlerNotification = $tw.wiki.getTiddler(tiddlerTitle);\\n          if ($tw.notifier) {\\n            if (typeof(tiddlerNotification) != \\\"undefined\\\" && tiddlerNotification)\\n              $tw.notifier.display(tiddlerTitle);\\n            else {\\n              // Try with default language\\n              tiddlerTitle = TiddlyWiki.pathLanguages + \\\"/\\\" + TiddlyWiki.defaultLanguage + TiddlyWiki.saveNotificationTiddlerSuffix;\\n              var tiddlerNotification1 = $tw.wiki.getTiddler(tiddlerTitle);\\n              if (typeof(tiddlerNotification1) != \\\"undefined\\\" && tiddlerNotification1)\\n                $tw.notifier.display(tiddlerTitle);\\n            }\\n          }\\n\\n          // Give the save button it's normal aspect\\n          spreadsheet.tiddlyWiki.changeSaveButtonVisual(false);\\n\\n        } else if (cmdname == TiddlyWiki.exportCommandKeyword) {\\n          // EXPORT DATA TO TIDDLER\\n          // Set type to \\\"text/plain\\\" and \\\"format\\\" field to \\\"tab\\\", \\\"csv\\\" or \\\"scsave\\\".\\n\\n          var inputTiddler = document.getElementById(spreadsheet.idPrefix+\\\"clipboard-tiddler\\\");\\n          if (!inputTiddler) return;\\n          var tiddlerTitle = self.resolvePath(inputTiddler.value);\\n          if (!tiddlerTitle) return;\\n\\n          // Choosen format\\n          var select = document.getElementById(spreadsheet.idPrefix+\\\"clipboard-export-select-format\\\");\\n          if (!select) return;\\n          var format = select.options[select.selectedIndex >= 0 ? select.selectedIndex : 0].text;\\n          if (format == \\\"Tab-delimited\\\") format = \\\"tab\\\";\\n          else if (format == \\\"CSV\\\") format = \\\"csv\\\";\\n          else format = \\\"scsave\\\";\\n\\n          // Read and format data\\n          var data = \\\"\\\";\\n          select = document.getElementById(spreadsheet.idPrefix+\\\"clipboard-export-select-source\\\");\\n          if (!select) return;\\n          if (select.selectedIndex <= 0) {\\n            // Clipboard\\n            data = SocialCalc.ConvertSaveToOtherFormat(SocialCalc.Clipboard.clipboard, format);\\n          } else {\\n            // Named selection\\n            var name = spreadsheet.sheet.names[select.options[select.selectedIndex].text.toUpperCase()];\\n            if (!name || !name.definition) return;\\n            var sel = name.definition;\\n            var data = SocialCalc.ConvertSaveToOtherFormat(SocialCalc.CreateSheetSave(spreadsheet.editor.context.sheetobj, sel), format);\\n          }\\n\\n          // Save data to tiddler\\n          var tiddler = $tw.wiki.getTiddler(tiddlerTitle);\\n          if (typeof(tiddler) != \\\"undefined\\\" && tiddler) {\\n            // Ask confirmation before smashing tiddler\\n            spreadsheet.tiddlyWiki.createDialog(spreadsheet, SocialCalc.Constants.s_clipboard_export_error_tiddler_exists + \\\" : <b>\\\"+tiddlerTitle+\\\"</b>.<br>\\\" + SocialCalc.Constants.s_clipboard_export_error_tiddler_overwrite, true, function() {\\n              $tw.wiki.addTiddler(new $tw.Tiddler({title: tiddlerTitle, type: TiddlyWiki.dataTiddlerType, text: data, format: format}));\\n            });\\n          } else\\n            $tw.wiki.addTiddler(new $tw.Tiddler({title: tiddlerTitle, type: TiddlyWiki.dataTiddlerType, text: data, format: format}));\\n\\n        } else if (cmdname == TiddlyWiki.importCommandKeyword) {\\n          // IMPORT DATA TIDDLER TO CLIPBOARD\\n          // Expect \\\"format\\\" field to be \\\"tab\\\", \\\"csv\\\" or \\\"scsave\\\". If no format field, assume\\n          // Tab-delimited format.\\n          // Don't check tiddler's type.\\n\\n          var inputTiddler = document.getElementById(spreadsheet.idPrefix+\\\"clipboard-tiddler\\\");\\n          if (!inputTiddler) return;\\n          var tiddlerTitle = self.resolvePath(inputTiddler.value);\\n          if (!tiddlerTitle) return;\\n          var tiddler = $tw.wiki.getTiddler(tiddlerTitle);\\n          if (typeof(tiddler) == \\\"undefined\\\" || !tiddler) return;\\n          var format = null;\\n          if (tiddler.fields)\\n            var format = tiddler.fields.format;\\n          if (format && (format != \\\"tab\\\") && (format != \\\"csv\\\") && (format != \\\"scsave\\\")) {\\n            alert(SocialCalc.Constants.s_clipboard_import_error_tiddler_format);\\n            return;\\n          }\\n          if (!format) format = \\\"tab\\\";\\n          var data = tiddler.fields.text;\\n\\n          // Fill clipboard area with data\\n          var radioTab = document.getElementById(spreadsheet.idPrefix+\\\"clipboardformat-tab\\\");\\n          radioTab.click();\\n          SocialCalc.Clipboard.clipboard = SocialCalc.ConvertOtherFormatToSave(data, format) ;\\n          SocialCalc.SpreadsheetControlClipboardFormat(\\\"tab\\\");\\n        }\\n      };\\n      if (!spreadsheet.sheet || !spreadsheet.sheet.sci) return;\\n      spreadsheet.sheet.sci.CmdExtensionCallbacks[TiddlyWiki.saveCommandKeyword] = {func:comTiddlywiki, data:null};\\n      spreadsheet.sheet.sci.CmdExtensionCallbacks[TiddlyWiki.exportCommandKeyword] = {func:comTiddlywiki, data:null};\\n      spreadsheet.sheet.sci.CmdExtensionCallbacks[TiddlyWiki.importCommandKeyword] = {func:comTiddlywiki, data:null};\\n      \\n      // Add UI for the commands (buttons in the toolbar)\\n      this.addExtensionCmdUI(spreadsheet);\\n    },\\n\\n    // Create a simple modal dialog to query a OK or Cancel answer and do something if OK\\n    createDialog: function(spreadsheet, mess, flagDoIfOK, func) {\\n      // (Inspired by SocialCalc.SpreadsheetControl.DoFunctionList())\\n\\n      self = this;\\n      var scc = SocialCalc.Constants;\\n      var idp = spreadsheet.idPrefix+\\\"dialog\\\";\\n\\n      // Visual\\n      var win = document.createElement(\\\"div\\\");\\n      win.id = idp;\\n      win.style.position = \\\"absolute\\\";\\n      var vp = SocialCalc.GetViewportInfo();\\n      var pos = SocialCalc.GetElementPositionWithScroll(spreadsheet.spreadsheetDiv);\\n      win.style.top = ((vp.height/2)-pos.top)+\\\"px\\\";\\n      win.style.left = ((vp.width/2)-pos.left)+\\\"px\\\";\\n      win.style.zIndex = 100;\\n      win.style.backgroundColor = \\\"#FFF\\\";\\n      win.style.border = \\\"1px solid black\\\";\\n\\n      var str =\\n        '<div class=\\\"SocialCalc-dialog\\\" style=\\\"width:100%;background-color:#DDD;\\\">'+\\n        '  <table>'+\\n        '    <tr>'+\\n        '      <td>'+\\n        '        <div style=\\\"padding:6px 6px 6px 6px;font-size:small;\\\">'+ mess + '</div>'+\\n        '      </td>'+\\n        '    </tr>'+\\n        '    <tr>'+\\n        '      <td>'+\\n        '        <div style=\\\"text-align:right;padding:12px 6px 6px 6px;font-size:small;\\\">'+\\n        '          <input type=\\\"button\\\" value=\\\"%loc!OK!\\\" id=\\\"'+idp+'-ok\\\" style=\\\"font-size:smaller;\\\">&nbsp;'+\\n        '          <input type=\\\"button\\\" value=\\\"%loc!Cancel!\\\" id=\\\"'+idp+'-cancel\\\" style=\\\"font-size:smaller;\\\">'+\\n        '        </div>'+\\n        '      </td>'+\\n        '    </tr>'+\\n        '  </table>'+\\n        '</div>';\\n\\n      win.innerHTML = SocialCalc.LocalizeSubstrings(str);\\n      spreadsheet.spreadsheetDiv.appendChild(win);\\n\\n      // Buttons behaviour\\n      var deleteWin = function() {\\n        if (win.parentNode)\\n          win.parentNode.removeChild(win);\\n        SocialCalc.KeyboardFocus();\\n      };\\n      var buttonOK = document.getElementById(idp+\\\"-ok\\\");\\n      buttonOK.addEventListener(\\\"click\\\", function() {\\n        if (flagDoIfOK && func) func();\\n        deleteWin();\\n      }, false);\\n      var buttonCancel = document.getElementById(idp+\\\"-cancel\\\");\\n      buttonCancel.addEventListener(\\\"click\\\", function() {\\n        deleteWin();\\n      }, false);\\n    },\\n\\n    // Monitoring\\n    monitor: function(spreadsheet) {\\n      var self = this;\\n\\n      // Register an editor callback (called at almost every steps)\\n      this.monitorCallback = function(cmdComplete) {\\n        //console.log(\\\"TiddlyWiki.monitorCallback: cmd = \\\"+cmdComplete);\\n        var tabTokens = cmdComplete.toLowerCase().split(/[\\\\s]+/);\\n        var cmd = tabTokens[0];\\n        var doChange = function(tab) {\\n          var tabCmdNoChange = [\\\"copy\\\", \\\"cut\\\", \\\"clearclipboard\\\", \\\"recalc\\\", \\\"redisplay\\\"];\\n          var cmd = tab[0];\\n          for (var i = 0; i < tabCmdNoChange.length; i++) {\\n            if (cmd == tabCmdNoChange[i]) return false;\\n          }\\n          if (cmd == \\\"loadclipboard\\\" && tabTokens.length == 1) return false;\\n          return true;\\n        };\\n\\n        // Change button color when need saving\\n        if (self.saveTodo.flagStart && doChange(tabTokens)) {\\n          self.changeSaveButtonVisual(true);\\n        }\\n      }\\n    }\\n\\n  };\\n\\n  exports.TiddlyWiki = TiddlyWiki;\\n\\n})();\",\n            \"title\": \"$:/plugins/rboue/SocialCalc/tiddlywiki.js\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"library\"\n        }\n    }\n}","author":"rboue","bag":"default","core-version":">=5.1.1","dependents":"","description":"SocialCalc","list":"readme license","plugin-type":"plugin","revision":"0","title":"$:/plugins/rboue/SocialCalc","version":"1.0.0","name":"SocialCalc"}